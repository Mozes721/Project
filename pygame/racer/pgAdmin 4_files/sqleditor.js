define(["translations","pgadmin.browser.endpoints","pgadmin.browser.utils","pgadmin.user_management.current_user","pgadmin.browser.messages","pgadmin.server.supported_servers"],function(e,t,n,i,o,a){return webpackJsonp([0,3],[,,function(e,t,n){"use strict";var i,o;i=[n(49)],void 0!==(o=function(e){return function(t,n){var i,o=e[t]?e[t]:t,a=/([^%]*)%\(([^\)]+)\)s(.*)/,r=o;do{i=!1,r=r.replace(a,function(e,t,o,a){return i=!0,t+n[o]+a})}while(i);return r}}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";(function(n){var i,o,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i=[],void 0!==(o=function(){var e=window.pgAdmin=window.pgAdmin||{};return function(e,t,n){function i(e,t,i,a){i=i||"width";var r,s,d,p=(t.match(c)||[])[2],f="px"===p?1:u[p+"toPx"],m=/r?em/i;if(f||m.test(p)&&!a)e=f?e:"rem"===p?l:"fontSize"===i?e.parentNode||e:e,f=f||parseFloat(o(e,"fontSize")),d=parseFloat(t)*f;else{r=e.style,s=r[i];try{r[i]=t}catch(e){return 0}d=r[i]?parseFloat(o(e,i)):0,r[i]=s!==n?s:null}return d}function o(e,t){var n,r,l,s,u,p=/^top|bottom/,f=["paddingTop","paddingBottom","borderTop","borderBottom"],m=4;if(n=d?d(e)[t]:(r=e.style["pixel"+t.charAt(0).toUpperCase()+t.slice(1)])?r+"px":"fontSize"===t?i(e,"1em","left",1)+"px":e.currentStyle[t],"%"===(l=(n.match(c)||[])[2])&&a)if(p.test(t)){for(s=(u=e.parentNode||e).offsetHeight;m--;)s-=parseFloat(o(u,f[m]));n=parseFloat(n)/100*s+"px"}else n=i(e,n);else("auto"===n||l&&"px"!==l)&&d?n=0:l&&"px"!==l&&!d&&(n=i(e,n)+"px");return n}var a,r=t.createElement("test"),l=t.documentElement,s=t.defaultView,d=s&&s.getComputedStyle,c=/^(-?[\d+\.\-]+)([a-z]+|%)$/i,u={},p=[1/25.4,1/2.54,1/72,1/6],f=["mm","cm","pt","pc","in","mozmm"],m=6;for(l.appendChild(r),d&&(r.style.marginTop="1%",a="1%"===d(r).marginTop);m--;)u[f[m]+"toPx"]=p[m]?p[m]*u.inToPx:i(r,"1"+f[m]);l.removeChild(r),r=n,e.toPx=i}(e,window.document),e.natural_sort=function(e,t,n){n=n||{};var i,o,r=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,l=/(^[ ]*|[ ]*$)/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,d=/^0x[0-9a-f]+$/i,c=/^0/,u=function(e){return n.insensitive&&(""+e).toLowerCase()||""+e},p=u(e).replace(l,"")||"",f=u(t).replace(l,"")||"",m=p.replace(r,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),h=f.replace(r,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),g=parseInt(p.match(d))||1!==m.length&&p.match(s)&&Date.parse(p),b=parseInt(f.match(d))||g&&f.match(s)&&Date.parse(f)||null,_=n.desc?-1:1;if(b){if(g<b)return-1*_;if(g>b)return 1*_}for(var v=0,y=Math.max(m.length,h.length);v<y;v++){if(i=!(m[v]||"").match(c)&&parseFloat(m[v])||m[v]||0,o=!(h[v]||"").match(c)&&parseFloat(h[v])||h[v]||0,isNaN(i)!==isNaN(o))return(isNaN(i)?1:-1)*_;if((void 0===i?"undefined":a(i))!==(void 0===o?"undefined":a(o))&&(i+="",o+=""),i<o)return-1*_;if(i>o)return 1*_}return 0},e}.apply(t,i))&&(e.exports=o)}).call(t,n(3))},function(e,t,n){"use strict";var i,o;i=[n(50)],void 0!==(o=function(e){return function(t,n){var i=e[t],o=/([<])([^:^>]*:)?([^>]+)([>])/g,a=i;return i?a=a.replace(o,function(e,t,i,o){return o in n?n[o]:e}):i}}.apply(t,i))&&(e.exports=o)},,,,,,,,function(e,t,n){"use strict";function i(e,t,n){if(n&&!1===n.check)return!0;var i=l.treeMenu.findNodeByDomElement(t);return!!i&&i.anyFamilyMember(function(e){return"schema"===e.getData()._type})}function o(e,t){var n=l.treeMenu.findNodeByDomElement(t);return!!n&&a(n)}function a(e){return e.anyParent(function(e){return"schema"===e.getData()._type})}Object.defineProperty(t,"__esModule",{value:!0}),t.childCreateMenuEnabled=i,t.isTreeItemOfChildOfSchema=o,t.isTreeNodeOfSchemaChild=a;var r=n(5),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(r)},,function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SchemaChildNode=void 0;var o=n(25),a=i(o),r=n(12),l=i(r),s=a.extend({parent_type:["schema","catalog"],canDrop:l.isTreeItemOfChildOfSchema,canDropCascade:l.isTreeItemOfChildOfSchema,canCreate:l.childCreateMenuEnabled},!1);t.SchemaChildNode=s},,,,function(e,t,n){"use strict";function i(e){var t="";return e.alt&&(t+="alt+"),e.shift&&(t+="shift+"),e.control&&(t+="ctrl+"),t+=e.key.char.toLowerCase()}function o(e){0!=e.length&&setTimeout(function(){var t=e.find("button.fa-plus:first");0==t.length&&(t=e.find(".pgadmin-controls:first input:enabled,.CodeMirror-scroll")),t.length>0?t[0].focus():e[0].focus()},200)}function a(e){var t=e||new Date;return parseInt(t.getTime()/1e3)}function r(e){var t=function e(t,n){return 0==t?n:e(n%t,t)},n=e.length;if(n<=2)return t(e[0],e[1]);for(var i=e[0],o=1;o<n;o++)i=t(e[o],i);return i}Object.defineProperty(t,"__esModule",{value:!0}),t.isString=t.isFunction=t.isValidData=void 0,t.parseShortcutValue=i,t.findAndSetFocus=o,t.getEpoch=a,t.getGCD=r;var l=n(1),s=function(e){return e&&e.__esModule?e:{default:e}}(l),d=function(e){return!s.default.isUndefined(e)&&!s.default.isNull(e)},c=function(e){return s.default.isFunction(e)},u=function(e){return s.default.isString(e)};t.isValidData=d,t.isFunction=c,t.isString=u},,,,,function(e,t,n){var i,o;!function(a,r){i=[n(1),n(0),n(10)],void 0!==(o=function(e,t,n){return r(a,e,t,n)}.apply(t,i))&&(e.exports=o)}(this,function(e,t,n,i){Backform=e.Backform={formClassName:"backform form-inline",groupClassName:"form-group row",controlLabelClassName:"col-sm-2 col-form-label",controlContainerClassName:"col-sm-10",controlsClassName:"col-sm-8",controlClassName:"form-control",controlFormInlineClassName:"form-inline",helpClassName:"form-text",errorClassName:"has-error",helpMessageClassName:"form-text text-muted",hiddenClassName:"d-none",requiredInputClassName:void 0,resolveNameToClass:function(e,n){if(t.isString(e)){var i=t.map(e.split("-"),function(e){return e.slice(0,1).toUpperCase()+e.slice(1)}).join("")+n,o=Backform[i];if(t.isUndefined(o))throw new ReferenceError("Class '"+i+"' not found");return o}return e}};var o=(Backform.Form=i.View.extend({fields:void 0,errorModel:void 0,tagName:"form",className:function(){return Backform.formClassName},initialize:function(e){e.fields instanceof i.Collection||(e.fields=new l(e.fields||this.fields)),this.fields=e.fields,this.model.errorModel=e.errorModel||this.model.errorModel||new i.Model,this.controls=[]},cleanup:function(){t.each(this.controls,function(e){e.remove()}),this.controls.length=0},remove:function(){this.cleanup(),i.View.prototype.remove.apply(this,arguments)},render:function(){this.cleanup(),this.$el.empty();var e=this.$el,t=this.model,n=this.controls;return this.fields.each(function(i){var o=new(i.get("control"))({field:i,model:t});e.append(o.render().$el),n.push(o)}),this}}),Backform.ControlFormatter=function(){});t.extend(o.prototype,{fromRaw:function(e,t){return e},toRaw:function(e,t){return e}});var a=Backform.JSONFormatter=function(){};t.extend(a.prototype,{fromRaw:function(e,t){return JSON.stringify(e)},toRaw:function(e,t){return JSON.parse(e)}});var r=Backform.Field=i.Model.extend({defaults:{name:"",placeholder:"",disabled:!1,visible:!0,required:!1,value:void 0,control:void 0,formatter:void 0},initialize:function(e,t){var n=Backform.resolveNameToClass(this.get("control"),"Control");this.set({control:n},{silent:!0})}}),l=Backform.Fields=i.Collection.extend({model:r}),s=Backform.Control=i.View.extend({defaults:{},className:function(){return Backform.groupClassName},events:{"keydown :input":"processTab"},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <span readonly class="<%=Backform.controlClassName%>" value="<%=value%>">',"</div>"].join("\n")),initialize:function(e){this.field=e.field;var n=Backform.resolveNameToClass(this.field.get("formatter")||this.formatter,"Formatter");t.isFunction(n.fromRaw)||t.isFunction(n.toRaw)||(n=new n),this.formatter=n;var o=this.field.get("name").split("."),a=o.shift();this.listenTo(this.model,"change:"+a,this.render),this.model.errorModel instanceof i.Model&&this.listenTo(this.model.errorModel,"change:"+a,this.updateInvalid)},formatter:o,getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find(".uneditable-input").text(),this.model)},onChange:function(e){var o=this.model,a=(n(e.target),this.field.get("name").split(".")),r=a.shift(),l=a.join("."),s=this.getValueFromDOM(),d={};if(this.model.errorModel instanceof i.Model)if(t.isEmpty(l))this.model.errorModel.unset(r);else{var c=this.model.errorModel.get(r);c&&(this.keyPathSetter(c,l,null),this.model.errorModel.set(r,c))}d[r]=t.isEmpty(l)?s:t.clone(o.get(r))||{},t.isEmpty(l)||this.keyPathSetter(d[r],l,s),this.stopListening(this.model,"change:"+r,this.render),o.set(d),this.listenTo(this.model,"change:"+r,this.render)},render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),n=this.model.toJSON(),i=e.name.split("."),o=i.shift(),a=i.join("."),r=this.keyPathAccessor(n[o],a),l=t.extend(e,{rawValue:r,value:this.formatter.fromRaw(r,this.model),attributes:n,formatter:this.formatter}),s=function(e,n){return t.isFunction(e)?!!e(n):!!e};return t.extend(l,{disabled:s(l.disabled,this.model),visible:s(l.visible,this.model),required:s(l.required,this.model)}),this.$el.removeClass(Backform.hiddenClassName),l.visible||this.$el.addClass(Backform.hiddenClassName),Backform.requiredInputClassName&&this.$el.removeClass(Backform.requiredInputClassName),l.required&&this.$el.addClass(Backform.requiredInputClassName),this.$el.html(this.template(l)).addClass(e.name),this.updateInvalid(),this},clearInvalid:function(){return this.$el.removeClass(Backform.errorClassName).find("."+Backform.helpClassName+".error").remove(),this},updateInvalid:function(){var e=this,o=this.model.errorModel;return o instanceof i.Model?(this.clearInvalid(),this.$el.find(":input").not("button").each(function(i,a){var r=n(a).attr("name").split("."),l=(r.shift(),r.join("."),e.keyPathAccessor(o.toJSON(),n(a).attr("name")));t.isEmpty(l)||(e.$el.addClass(Backform.errorClassName),0===i&&e.$el.find("."+Backform.controlsClassName).append('<span class="'+Backform.helpClassName+' error">'+(t.isArray(l)?l.join(", "):l)+"</span>"))}),this):this},keyPathAccessor:function(e,n){var i=e;n=n.split(".");for(var o=0;o<n.length;o++){if(t.isNull(i))return null;t.isEmpty(n[o])||(t.isUndefined(i[n[o]])||(i=i[n[o]]))}return t.isObject(i)&&!t.isArray(i)?null:i},keyPathSetter:function(e,t,n){for(t=t.split(".");t.length>1;)e[t[0]]||(e[t[0]]={}),e=e[t.shift()];return e[t.shift()]=n},processTab:function(e){if(9==e.which){var t=n(e.currentTarget);setTimeout(function(){var n;n=e.shiftKey?t.prevAll(":input:visible").length?t.prevAll(":input:visible").first():t.closest(".control-group:visible").prev(".control-group:visible").find(":input:visible"):t.nextAll(":input:visible").length?t.nextAll(":input:visible").first():t.closest(".control-group:visible").next(".control-group:visible").find(":input:visible"),n.length&&n.first().focus()},0)}}}),d=(Backform.UneditableInputControl=s,Backform.HelpControl=s.extend({template:t.template(['<label class="<%=Backform.controlLabelClassName%>">&nbsp;</label>','<div class="<%=Backform.controlsClassName%>">','  <span class="<%=Backform.helpMessageClassName%> help-block"><%=label%></span>',"</div>"].join("\n"))}),Backform.SpacerControl=s.extend({template:t.template(['<div class="<%=Backform.controlsClassName%>"></div>'].join("\n"))}),Backform.TextareaControl=s.extend({defaults:{label:"",maxlength:4e3,extraClasses:[],helpMessage:null},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <textarea class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" maxlength="<%=maxlength%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),events:t.extend({},s.prototype.events,{"change textarea":"onChange","focus textarea":"clearInvalid"}),getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("textarea").val(),this.model)}}),Backform.SelectControl=s.extend({defaults:{label:"",options:[],extraClasses:[]},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <select class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> >',"    <% for (var i=0; i < options.length; i++) { %>","      <% var option = options[i]; %>",'      <option value="<%-formatter.fromRaw(option.value)%>" <%=option.value === rawValue ? "selected=\'selected\'" : ""%> <%=option.disabled ? "disabled=\'disabled\'" : ""%>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n")),events:t.extend({},s.prototype.events,{"change select":"onChange","focus select":"clearInvalid"}),formatter:a,getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("select").val(),this.model)}})),c=(Backform.MultiSelectControl=d.extend({defaults:{label:"",options:[],extraClasses:[],height:"78px"},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <select multiple="multiple" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-JSON.stringify(value)%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> style="height:<%=height%>">',"    <% for (var i=0; i < options.length; i++) { %>","      <% var option = options[i]; %>",'      <option value="<%-option.value%>" <%=value != null && _.indexOf(value, option.value) != -1 ? "selected=\'selected\'" : ""%> <%=option.disabled ? "disabled=\'disabled\'" : ""%>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n")),events:t.extend({},s.prototype.events,{"change select":"onChange","dblclick select":"onDoubleClick","focus select":"clearInvalid"}),formatter:{fromRaw:function(e,t){return e},toRaw:function(e,t){return"object"==typeof e?e:JSON.parse(e)}},onDoubleClick:function(e){this.model.trigger("doubleclick",e)}}),Backform.InputControl=s.extend({defaults:{type:"text",label:"",maxlength:255,extraClasses:[],helpMessage:null},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <input type="<%=type%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),events:t.extend({},s.prototype.events,{"change input":"onChange","focus input":"clearInvalid"}),getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("input").val(),this.model)}})),u=Backform.BooleanControl=c.extend({defaults:{type:"checkbox",label:"",controlLabel:"&nbsp;",extraClasses:[],id:t.uniqueId("bf_")},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=controlLabel%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <div class="form-check">','    <input type="<%=type%>" class="form-check-input <%=extraClasses.join(\' \')%>" id="<%=id%>" name="<%=name%>" <%=value ? "checked=\'checked\'" : ""%> <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />','    <label class="form-check-label" for="<%=id%>"><%=label%></label>',"  </div>","</div>"].join("\n")),getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("input").is(":checked"),this.model)}});Backform.CheckboxControl=u,Backform.RadioControl=c.extend({defaults:{type:"radio",label:"",options:[],extraClasses:[],helpMessage:null},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlContainerClassName%> d-flex">',"  <% for (var i=0; i < options.length; i++) { %>","    <% var option = options[i]; %>",'    <% var id = _.uniqueId("bf_"); %>','  <div class="form-check">','    <input type="<%=type%>" class="<%=extraClasses.join(\' \')%>" id="<%=id%>" name="<%=name%>" value="<%-formatter.fromRaw(option.value)%>" <%=rawValue == option.value ? "checked=\'checked\'" : ""%> <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />','    <label class="form-check-label" for="<%=id%>"><%-option.label%></label>',"  </div>","  <% } %>","  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),formatter:a,getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("input:checked").val(),this.model)},bootstrap2:function(){Backform.radioControlsClassName="controls",Backform.radioLabelClassName="radio inline"}});t.extend(Backform,{radioControlsClassName:"checkbox",radioLabelClassName:"checkbox-inline"});Backform.DatepickerControl=c.extend({defaults:{type:"text",label:"",options:{},extraClasses:[],maxlength:255,helpMessage:null},events:t.extend({},s.prototype.events,{"blur input":"onChange","change input":"onChange","changeDate input":"onChange","focus input":"clearInvalid"}),render:function(){return c.prototype.render.apply(this,arguments),this.$el.find("input").datepicker(this.field.get("options")),this}}),Backform.ButtonControl=s.extend({defaults:{type:"submit",label:"Submit",status:void 0,message:void 0,extraClasses:[]},template:t.template(['<label class="<%=Backform.controlLabelClassName%>">&nbsp;</label>','<div class="<%=Backform.controlsClassName%>">','  <button type="<%=type%>" name="<%=name%>" class="btn <%=extraClasses.join(\' \')%>" <%=disabled ? "disabled" : ""%> ><%=label%></button>','  <% var cls = ""; if (status == "error") cls = Backform.buttonStatusErrorClassName; if (status == "success") cls = Backform.buttonStatusSuccessClassname; %>','  <span class="status <%=cls%>"><%=message%></span>',"</div>"].join("\n")),initialize:function(){s.prototype.initialize.apply(this,arguments),this.listenTo(this.field,"change:status",this.render),this.listenTo(this.field,"change:message",this.render)},bootstrap2:function(){Backform.buttonStatusErrorClassName="text-error",Backform.buttonStatusSuccessClassname="text-success"}});return t.extend(Backform,{buttonStatusErrorClassName:"text-danger",buttonStatusSuccessClassname:"text-success"}),Backform})},,,function(e,t,n){"use strict";(function(e){function n(e,t){return o.call(e,t)}function i(e){var t=this.treeMenu.translateTreeNodeIdFromACITree(e),n=this.treeMenu.findNode(t);return o.call(this,n)}function o(t){var n=0,i=0,o={};do{var r=t.getData();if(r._type in this.Nodes&&this.Nodes[r._type].hasId){var l=a(r._type,i);void 0===o[l]&&(o[l]=e.extend({},r,{priority:n}),n-=1)}i+=1,t=t.hasParent()?t.parent():null}while(t);return o}function a(e,t){return"partition"===e&&t>0?"table":e}Object.defineProperty(t,"__esModule",{value:!0}),t.getTreeNodeHierarchyFromElement=n,t.getTreeNodeHierarchyFromIdentifier=i,t.getTreeNodeHierarchy=o}).call(t,n(1))},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(15),o=function(e){return e&&e.__esModule?e:{default:e}}(i);n(55),n(91),n(92),n(73),n(93),n(94),n(95),n(96),n(56),n(97),n(74),n(98),n(99),n(100),n(101),n(38),n(51),t.default=o.default},function(e,t,n){"use strict";var i,o;i=[n(0),n(2),n(4)],void 0!==(o=function(e,t,n){var i={epicRandomString:function(e){for(var t=[],n="0123456789abcdef",i=0;i<36;i++)t[i]=n.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=n.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("").replace(/-/g,"").substr(0,e)},getHash:function(e){for(var t=0,n=e.length,i=0;i<n;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return t},calculateColumnWidth:function(t){e("body").append('<span id="pg_text" style="visibility: hidden;">'+t+"</span>");var n=e("#pg_text").width()+23;return e("#pg_text").remove(),n},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},previousStatus:null,fetchConnectionStatus:function(o,a,r){var l=n("sqleditor.connection_status",{trans_id:o.transId});if("visible"===document.visibilityState&&"visible"===a.data("panel-visible")){var s=o;e.ajax({url:l,method:"GET"}).done(function(e){if(e&&e.data){var n=e.data.status,o=e.data.message,l=!1;switch(s.update_notifications(e.data.notifies),n){case 1:n!=i.previousStatus||r.hasClass("fa-hourglass-half")||(r.removeClass().addClass("fa fa-hourglass-half"),l=!0);break;case 2:i.previousStatus==n||r.hasClass("fa-clock-o")||(r.removeClass().addClass("fa fa-clock-o"),l=!0);break;case 3:i.previousStatus==n||r.hasClass("fa-exclamation-circle")||(r.removeClass().addClass("fa fa-exclamation-circle"),l=!0);break;case 4:i.previousStatus==n||r.hasClass("fa-exclamation-triangle")||(r.removeClass().addClass("fa fa-exclamation-triangle"),l=!0);break;default:i.previousStatus==n||r.hasClass("fa-query_tool_connected")||(r.removeClass().addClass("fa-custom fa-query-tool-connected"),l=!0)}i.previousStatus=n,l&&(a.popover("hide"),a.attr("data-content",o))}else i.previousStatus=-99,o=t("An unexpected error occurred - ensure you are logged into the application."),a.attr("data-content",o),r.hasClass("fa-query-tool-disconnected")||(a.popover("hide"),r.removeClass().addClass("fa-custom fa-query-tool-disconnected"))}).fail(function(e){i.previousStatus=-1;var n=t("Transaction status check failed.");0==e.readyState?n=t("Not connected to the server or the connection to the server has been closed."):e.responseJSON&&e.responseJSON.errormsg&&(n=e.responseJSON.errormsg),a.attr("data-content",n),r.hasClass("fa-query-tool-disconnected")||(a.popover("hide"),r.removeClass().addClass("fa-custom fa-query-tool-disconnected"))})}},updateConnectionStatusFlag:function(t){var n=e(".connection_status");n.data("panel-visible")!=t&&n.data("panel-visible",t)},calcFontSize:function(e){if(e){var t=Number(Math.round(e+"e+2")+"e-2");if(t>0)return t+"em"}return"1em"},removeSlashInTheString:function(e){for(var t=[],n=0;e&&-1!==e.indexOf("/");)t.push(e.indexOf("/")+n),e=e.replace("/",""),n++;return{slashLocations:t.join(","),title:encodeURIComponent(e)}}};return i}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";(function(i){var o,a;o=[n(87)],void 0!==(a=function(){function e(e){return i.findIndex(e.getColumns(),function(e){var t=e.pos;return!i.isUndefined(t)&&n(e)})}function t(e){return i.findLastIndex(e.getColumns(),n)}function n(e){return i.isUndefined(e.selectable)||!0===e.selectable}function o(e){var t=b(e);e.getSelectionModel().setSelectedRanges([t])}var a=window.Slick,r=function(e,t){return e.fromCell==t.fromCell&&e.toCell==t.toCell&&e.fromRow==t.fromRow&&e.toRow==t.toRow},l=function(e,t){return i.any(e,function(e){return r(e,t)})},s=function(e,t){return i.any(e,function(e){return e.fromCell<=t&&e.toCell>=t})},d=function(e,t){return i.any(e,function(e){return e.fromRow<=t&&e.toRow>=t})},c=function(e,t){return i.any(e,function(e){return e.fromCell<=t.fromCell&&e.toCell>=t.toCell&&e.fromRow<=t.fromRow&&e.toRow>=t.toRow})},u=function(e,t){return i.filter(e,function(e){return!r(e,t)})},p=function(e,t){return e.push(t),e},f=function(e,t){return i.every(e,function(e){return e.fromRow==e.toRow&&N(t,e)})},m=function(e,t){return i.every(e,C.bind(this,t))},h=function(e,t){var n=e.getColumns();return v(n)?new a.Range(t,0,t,e.getColumns().length-1):new a.Range(t,1,t,e.getColumns().length-1)},g=function(e,t){return new a.Range(0,t,e.getDataLength()-1,t)},b=function(e){return new a.Range(0,1,e.getDataLength()-1,e.getColumns().length-1)},_=function(e){var t=e.getSelectionModel(),n=t.getSelectedRanges();return 1==n.length&&r(n[0],b(e))},v=function(e){return!i.isUndefined(e[0].pos)},y=function(e,t){return i.every(t,function(t){return S(e,t)})},w=function(e,t){return i.every(t,function(t){return N(e,t)})},x=function(e,t){var n=[];return t.forEach(function(t){N(e,t)&&(n=n.concat(i.range(t.fromRow,t.toRow+1)))}),n},C=function(e,t){return t.fromCell==t.toCell&&0==t.fromRow&&t.toRow==e.getDataLength()-1},S=function(e,t){return 0===t.fromRow&&t.toRow===e.getDataLength()-1},N=function(n,i){return i.fromCell===e(n)&&i.toCell===t(n)};return{addRange:p,removeRange:u,isRangeSelected:l,areAllRangesSingleRows:f,areAllRangesSingleColumns:m,areAllRangesCompleteRows:w,areAllRangesCompleteColumns:y,rangeForRow:h,rangeForColumn:g,isEntireGridSelected:_,getRangeOfWholeGrid:b,isFirstColumnData:v,getIndexesOfCompleteRows:x,selectAll:o,isRangeAColumn:C,rangeHasCompleteColumns:S,rangeHasCompleteRows:N,isAnyCellOfColumnSelected:s,isRangeEntirelyWithinSelectedRanges:c,isAnyCellOfRowSelected:d}}.apply(t,o))&&(e.exports=a)}).call(t,n(1))},,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(){return-1!=window.navigator.platform.search("Mac")}function a(e){return e.ctrlKey||e.altKey}function r(e){return e.altKey||e.shiftKey}function l(e){return e.ctrlKey||e.shiftKey}function s(e){return e.ctrlKey||e.altKey||e.shiftKey}function d(e){return e.altKey&&e.shiftKey&&!e.ctrlKey}function c(e){return e.ctrlKey&&e.shiftKey&&!e.altKey}function u(e){return e.ctrlKey&&e.altKey&&!e.shiftKey}function p(e){var t="";return e.key&&e.key.char&&(t=e.key.char.toUpperCase()),t}function f(e,t){var n="";return void 0===t||null===t?n:(t.alt&&(n=(0,C.default)("Alt")+"+"),t.shift&&(n+=(0,C.default)("Shift")+"+"),t.control&&(n+=(0,C.default)("Ctrl")+"+"),n+=p(t),(0,C.default)("%(title)s (%(text_representation)s)",{title:e,text_representation:n}))}function m(e,t){return(0,C.default)("%(title)s (accesskey + %(key)s)",{title:e,key:p(t)})}function h(e){e.cancelBubble=!0,e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}function g(e,t){if(!e)return!1;var n=t.which||t.keyCode;return e.alt==t.altKey&&e.shift==t.shiftKey&&e.control==t.ctrlKey&&e.key.key_code==n}function b(e,t,n){var i=void 0,o=void 0,a=void 0;return this.validateShortcutKeys(n.edit_grid_values,t)?(this._stopEventPropagation(t),o=e.find('div.wcPanelTabContent:not(".wcPanelTabContentHidden")'),o.length&&(a=(0,w.default)(o).find("td.editable:first"),a.length&&a.trigger("click"))):this.validateShortcutKeys(n.move_next,t)?(this._stopEventPropagation(t),i=this.getInnerPanel(e,"right")):this.validateShortcutKeys(n.move_previous,t)&&(this._stopEventPropagation(t),i=this.getInnerPanel(e,"left")),i}function _(e,t){if(!e||!e.length)return!1;var n=e.find(".wcPanelTab");if(!n.length||1==n.length)return!1;var i=(0,w.default)(n).filter(".wcPanelTabActive"),o=parseInt((0,w.default)(i).attr("id")),a=n.length-1;return"left"==t?o>0&&o--:o<a&&o++,o}function v(e,t,n){if(!e.isQueryRunning()){var i=n.which||n.keyCode,o=void 0,a=e.preferences.execute_query,r=e.preferences.explain_query,l=e.preferences.explain_analyze_query,s=e.preferences.download_csv,d=e.preferences.move_next,c=e.preferences.move_previous,u=e.preferences.toggle_case,p=e.preferences.commit_transaction,f=e.preferences.rollback_transaction;if(this.validateShortcutKeys(a,n))this._stopEventPropagation(n),t.executeQuery(e);else if(this.validateShortcutKeys(r,n))this._stopEventPropagation(n),t.explain(e);else if(this.validateShortcutKeys(l,n))this._stopEventPropagation(n),t.explainAnalyze(e);else if(this.validateShortcutKeys(s,n))this._stopEventPropagation(n),t.download(e);else if(this.validateShortcutKeys(u,n))this._stopEventPropagation(n),t.toggleCaseOfSelectedText(e);else if(this.validateShortcutKeys(p,n))e.is_transaction_buttons_disabled||(this._stopEventPropagation(n),t.executeCommit(e));else if(this.validateShortcutKeys(f,n))e.is_transaction_buttons_disabled||(this._stopEventPropagation(n),t.executeRollback(e));else if((this.isMac()&&n.metaKey||!this.isMac()&&n.ctrlKey)&&!n.altKey&&n.shiftKey&&i===N)this._stopEventPropagation(n),t.commentBlockCode(e);else if((this.isMac()&&!this.isKeyCtrlAltShift(n)&&n.metaKey||!this.isMac()&&!this.isKeyAltShift(n)&&n.ctrlKey)&&i===N)this._stopEventPropagation(n),t.commentLineCode(e);else if((this.isMac()&&!this.isKeyCtrlAltShift(n)&&n.metaKey||!this.isMac()&&!this.isKeyAltShift(n)&&n.ctrlKey)&&i===S)this._stopEventPropagation(n),t.uncommentLineCode(e);else if(i==k)t.focusOut(e),(0,w.default)(n.target).hasClass("dropdown-item")&&(0,w.default)(n.target).closest(".dropdown-submenu").length>0&&(0,w.default)(n.target).closest(".dropdown-submenu").find(".dropdown-menu").removeClass("show");else if(this.validateShortcutKeys(d,n))this._stopEventPropagation(n),o=this.getInnerPanel(e.container,"right");else if(this.validateShortcutKeys(c,n))this._stopEventPropagation(n),o=this.getInnerPanel(e.container,"left");else if(i===D||i===O){if((0,w.default)(n.target).closest(".dropdown-menu").length>0){this._stopEventPropagation(n);var m=(0,w.default)(n.target).closest("li");for((0,w.default)(n.target).closest(".dropdown-menu").find(".show").removeClass("show"),i===D?m=m.prev():i===O&&(m=m.next());m.hasClass("dropdown-divider")||m.find(".dropdown-item").first().hasClass("disabled");)i===D?m=m.prev():i===O&&(m=m.next());m.find(".dropdown-item").trigger("focus")}}else if((i===T||i===E)&&(0,w.default)(n.target).closest(".dropdown-menu").length>0){this._stopEventPropagation(n);var h=(0,w.default)(n.target).closest("li");if(i===E)h.hasClass("dropdown-submenu")&&(h.find(".dropdown-menu").addClass("show"),h=h.find(".dropdown-menu .dropdown-item").first().trigger("focus"));else if(i===T){var g=h.closest(".dropdown-menu");g.closest(".dropdown-submenu").length>0&&(g.removeClass("show"),h=g.closest(".dropdown-submenu"),h.find(".dropdown-item").trigger("focus"))}}return o}}var y=n(0),w=i(y),x=n(2),C=i(x),S=190,N=191,k=27,T=37,D=38,E=39,O=40;e.exports={processEventDebugger:b,processEventQueryTool:v,getInnerPanel:_,validateShortcutKeys:g,_stopEventPropagation:h,isMac:o,isKeyCtrlAlt:a,isKeyAltShift:r,isKeyCtrlShift:l,isKeyCtrlAltShift:s,isAltShiftBoth:d,isCtrlShiftBoth:c,isCtrlAltBoth:u,shortcut_key:p,shortcut_title:f,shortcut_accesskey_title:m}},,,,function(e,t,n){"use strict";(function(e){var i,o,a,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(l){"object"==r(t)&&"object"==r(e)?l(n(15)):(o=[n(15)],i=l,void 0!==(a="function"==typeof i?i.apply(t,o):i)&&(e.exports=a))}(function(e){e.pgadminKeywordRangeFinder=function(t,n,i,o){for(var a,r,l=n.line,s=t.getLine(l),d=s.length;d>0;){var c=s.lastIndexOf(i,d),u=i,p=o;if(c<n.ch){if((c=s.lastIndexOf("[",d))<n.ch)break;u="[",p="]"}if(r=t.getTokenAt(e.Pos(l,c+1)).type,!/^(comment|string)/.test(r)){a=c;break}d=c-1}if(!(null==a||s.lastIndexOf(u)>a)){var f,m,h=1,g=t.lineCount();e:for(var b=l+1;b<g;++b)for(var _=t.getLine(b),v=0;;){var y=_.indexOf(u,v),w=_.indexOf(p,v);if(y<0&&(y=_.length),w<0&&(w=_.length),(v=Math.min(y,w))==_.length)break;if(t.getTokenAt(e.Pos(b,v+1)).type==r)if(v==y)++h;else if(!--h){f=b,m=v;break e}++v}if(null!=f&&f!=l+1)return{from:e.Pos(l,a+i.length),to:e.Pos(f,m)}}},e.pgadminBeginRangeFinder=function(t,n){return e.pgadminKeywordRangeFinder(t,n,"BEGIN","END;")},e.pgadminIfRangeFinder=function(t,n){return e.pgadminKeywordRangeFinder(t,n,"IF","END IF")},e.pgadminLoopRangeFinder=function(t,n){return e.pgadminKeywordRangeFinder(t,n,"LOOP","END LOOP")},e.pgadminCaseRangeFinder=function(t,n){return e.pgadminKeywordRangeFinder(t,n,"CASE","END CASE")}})}).call(t,n(28)(e))},,,,,,,,,,,function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";var i=n(15);(function(e){return e&&e.__esModule?e:{default:e}})(i).default.defineExtension("centerOnLine",function(e){var t=this.getScrollInfo().clientHeight,n=this.charCoords({line:e,ch:0},"local");this.scrollTo(null,(n.top+n.bottom-t)/2)})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(){return c.default.isUndefined(window.opener)||c.default.isNull(window.opener)?window.parent.pgAdmin.Browser:window.opener.pgAdmin.Browser}function a(e,t){var n=e.get_preference("browser","enable_acitree_animation").value;c.default.isUndefined(t)&&(t=e.tree),n?t.options({animateRoot:!0,unanimated:!1,show:c.default.extend(t.options().show,{duration:75}),hide:c.default.extend(t.options().hide,{duration:75}),view:c.default.extend(t.options().view,{duration:75})}):t.options({animateRoot:!1,unanimated:!0,show:c.default.extend(t.options().show,{duration:0}),hide:c.default.extend(t.options().hide,{duration:0}),view:c.default.extend(t.options().view,{duration:0})})}function r(e){(c.default.isUndefined(e)||c.default.isNull(e))&&(e=o()),e.get_preference("browser","enable_alertify_animation").value?((0,s.default)(document).find("link#alertify-no-animation").attr("disabled","disabled"),c.default.each(document.getElementsByTagName("iframe"),function(e){(0,s.default)(e.contentDocument).find("link#alertify-no-animation").attr("disabled","disabled")})):((0,s.default)(document).find("link#alertify-no-animation").removeAttr("disabled","disabled"),c.default.each(document.getElementsByTagName("iframe"),function(e){(0,s.default)(e.contentDocument).find("link#alertify-no-animation").removeAttr("disabled","disabled")}))}var l=n(0),s=i(l),d=n(1),c=i(d);e.exports={modifyAcitreeAnimation:a,modifyAlertifyAnimation:r}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(44),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=o.default.shape({query:o.default.string,start_time:o.default.instanceOf(Date),status:o.default.bool,total_time:o.default.string,row_affected:o.default.int,message:o.default.string}),r=o.default.shape({historyList:o.default.array.isRequired,onChange:o.default.func.isRequired}),l=o.default.shape({sql_font_size:o.default.string.isRequired});t.default={historyDetail:a,historyCollectionClass:r,sqlEditorPrefObj:l}},,,function(e,t){e.exports=n},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){e.label in f&&!(c.default.findIndex(m._buttonList,{name:e.label})<0)||(m.addButton(e.label,e.btnClass,e.text,e.label,e.toggled,e.toggleClass,e.parentClass,e.enabled),f[e.label]=e)}function a(e,t){m=e,c.default.each(h,function(e){o(e)}),c.default.each(g,function(e){o(e)}),e.on(t.EVENT.BUTTON,function(e){"name"in e&&e.name===(0,s.default)("Query Tool")?p.default.DataGrid.show_query_tool("",p.default.Browser.tree.selected()):"name"in e&&e.name===(0,s.default)("View Data")?p.default.DataGrid.show_data_grid({mnuid:3},p.default.Browser.tree.selected()):"name"in e&&e.name===(0,s.default)("Filtered Rows")&&p.default.DataGrid.show_filtered_row({mnuid:4},p.default.Browser.tree.selected())})}function r(e,t){e in f&&m.buttonEnable(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.initializeToolbar=a,t.enable=r;var l=n(2),s=i(l),d=n(1),c=i(d),u=n(3),p=i(u),f={},m=null,h=[{label:(0,s.default)("Filtered Rows"),btnClass:"fa fa-filter",text:"",toggled:!1,toggleClass:"",parentClass:"pg-toolbar-btn",enabled:!1},{label:(0,s.default)("View Data"),btnClass:"fa fa-table",text:"",toggled:!1,toggleClass:"",parentClass:"pg-toolbar-btn",enabled:!1},{label:(0,s.default)("Query Tool"),btnClass:"fa fa-bolt",text:"",toggled:!1,toggleClass:"",parentClass:"pg-toolbar-btn",enabled:!1}],g=[]},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){return null===t?e:function e(n){for(var i=0,o=n.children.length;i<o;i++){var a=e(n.children[i]);if(null!==a)return a}return n.path===t?n:null}(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isValidTreeNodeData=t.Tree=t.TreeNode=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(18),l=t.TreeNode=function(){function e(t,n,o,a){i(this,e),this.id=t,this.data=n,this.setParent(a),this.children=[],this.domNode=o}return a(e,[{key:"hasParent",value:function(){return null!==this.parentNode&&void 0!==this.parentNode}},{key:"parent",value:function(){return this.parentNode}},{key:"setParent",value:function(e){this.parentNode=e,this.path=this.id,null!==e&&void 0!==e&&void 0!==e.path&&(this.path=e.path+"."+this.id)}},{key:"getData",value:function(){if(void 0!==this.data)return null===this.data?null:Object.assign({},this.data)}},{key:"getHtmlIdentifier",value:function(){return this.domNode}},{key:"reload",value:function(e){var t=this;this.unload(e),e.aciTreeApi.setInode(this.domNode),e.aciTreeApi.deselect(this.domNode),setTimeout(function(){e.selectNode(t.domNode)},0)}},{key:"unload",value:function(e){this.children=[],e.aciTreeApi.unload(this.domNode)}},{key:"ancestorNode",value:function(e){for(var t=this;t.hasParent();)if(t=t.parent(),e(t))return t;return null}},{key:"anyFamilyMember",value:function(e){return!!e(this)||null!==this.ancestorNode(e)}},{key:"anyParent",value:function(e){return null!==this.ancestorNode(e)}}]),e}(),s=(t.Tree=function(){function e(){i(this,e),this.rootNode=new l(void 0,{}),this.aciTreeApi=void 0}return a(e,[{key:"addNewNode",value:function(e,t,n,i){var o=this.findNode(i);return this.createOrUpdateNode(e,t,o,n)}},{key:"findNode",value:function(e){return null===e||void 0===e||0===e.length?this.rootNode:o(this.rootNode,e.join("."))}},{key:"findNodeByDomElement",value:function(e){var t=this.translateTreeNodeIdFromACITree(e);if(t&&t[0])return this.findNode(t)}},{key:"selected",value:function(){return this.aciTreeApi.selected()}},{key:"selectNode",value:function(e){this.aciTreeApi.select(e)}},{key:"createOrUpdateNode",value:function(e,t,n,i){var o=[e];null!==n&&void 0!==n&&(o=[n.path,e]);var a=this.findNode(o);if(null!==a)return a.data=t,a;var r=new l(e,t,i,n);return n===this.rootNode&&(r.parentNode=null),n.children.push(r),r}},{key:"register",value:function(e){e.on("acitree",function(e,t,n,i){if(t.isItem(n)&&"added"===i){var o=t.getId(n),a=t.itemData(n),r=this.translateTreeNodeIdFromACITree(t.parent(n));this.addNewNode(o,a,n,r)}}.bind(this)),this.aciTreeApi=e.aciTree("api")}},{key:"translateTreeNodeIdFromACITree",value:function(e){for(var t=e,n=[];null!==t&&void 0!==t&&t.length>0&&(n.unshift(this.aciTreeApi.getId(t)),this.aciTreeApi.hasParent(t));)t=this.aciTreeApi.parent(t);return n}}]),e}(),r.isValidData);t.isValidTreeNodeData=s},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(0),l=i(r),s=n(58),d=i(s),c=n(18),u=function(){function e(t,n,i){o(this,e),this.dialogContainer=t,this.tabSwitching=!1,this.tabs=this.dialogContainer.find(".nav-tabs"),this.tabs.length>0&&(this.tabs=this.tabs[0]),this.dialogTabBackward=(0,c.parseShortcutValue)(n),this.dialogTabForward=(0,c.parseShortcutValue)(i),(0,d.default)(this.dialogContainer[0]).bind(this.dialogTabBackward,this.onKeyboardEvent.bind(this)),(0,d.default)(this.dialogContainer[0]).bind(this.dialogTabForward,this.onKeyboardEvent.bind(this))}return a(e,[{key:"onKeyboardEvent",value:function(e,t){var n=this.dialogContainer.find(".tab-content:first > .tab-pane.active:first"),i=this.isActivePaneHasChildTabs(n);if(!this.tabSwitching)if(this.tabSwitching=!0,i){var o=this.navigate(t,i.childTab,i.childTabPane);o||this.navigate(t,this.tabs,n)}else this.navigate(t,this.tabs,n)}},{key:"isActivePaneHasChildTabs",value:function(e){var t,n=e.find(".nav-tabs:first");return n.length>0?(t=e.find(".tab-content:first > .tab-pane.active:first"),{childTab:n,childTabPane:t}):null}},{key:"navigate",value:function(e,t,n){return e==this.dialogTabBackward?this.navigateBackward(t,n):e==this.dialogTabForward&&this.navigateForward(t,n)}},{key:"navigateBackward",value:function(e,t){var n,i,o=this,a=(0,l.default)(e).find("li").has("a.active").prev("li");return a.length>0?(a.find("a").tab("show"),n=t.prev(),i=n.find(".tab-content:first > .tab-pane.active:first"),i.length>0?(0,c.findAndSetFocus)(i):(0,c.findAndSetFocus)(n),setTimeout(function(){o.tabSwitching=!1},200),!0):(this.tabSwitching=!1,!1)}},{key:"navigateForward",value:function(e,t){var n,i,o=this,a=(0,l.default)(e).find("li").has("a.active").next("li");return a.length>0?(a.find("a").tab("show"),n=t.next(),i=n.find(".tab-content:first > .tab-pane.active:first"),i.length>0?(0,c.findAndSetFocus)(i):(0,c.findAndSetFocus)(n),setTimeout(function(){o.tabSwitching=!1},200),!0):(this.tabSwitching=!1,!1)}},{key:"detach",value:function(){(0,d.default)(this.dialogContainer[0]).unbind(this.dialogTabBackward),(0,d.default)(this.dialogContainer[0]).unbind(this.dialogTabForward)}}]),e}();e.exports={dialogTabNavigator:u}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){return c.default.ajax({data:e,type:"POST",async:!1,url:(0,s.default)("file_manager.get_trans_id"),dataType:"json",contentType:"application/json; charset=utf-8"})}function a(e){return c.default.ajax({type:"GET",async:!1,url:(0,s.default)("file_manager.delete_trans_id",{trans_id:e}),dataType:"json",contentType:"application/json; charset=utf-8"})}function r(e,t){return c.default.ajax({url:(0,s.default)("file_manager.save_last_dir",{trans_id:t}),type:"POST",data:JSON.stringify(e),contentType:"application/json"})}Object.defineProperty(t,"__esModule",{value:!0}),t.getTransId=o,t.removeTransId=a,t.set_last_traversed_dir=r;var l=n(4),s=i(l),d=n(0),c=i(d)},,,function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(10),n(8),n(3),n(5),n(174),n(82),n(11),n(6),n(107),n(16)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d,c,u,p){if(!l.Nodes.server){var f=["prefer","require","verify-ca","verify-full"];l.SecLabelModel=l.Node.Model.extend({defaults:{provider:void 0,label:void 0},schema:[{id:"provider",label:e("Provider"),type:"text",editable:!0,cellHeaderClasses:"width_percent_50"},{id:"label",label:e("Security Label"),type:"text",editable:!0,cellHeaderClasses:"override_label_class_font_size"}],validate:function(){if(this.errorModel.clear(),i.isUndefined(this.get("label"))||i.isNull(this.get("label"))||""==String(this.get("label")).replace(/^\s+|\s+$/g,"")){var t=e("Label must be specified.");return this.errorModel.set("label",t),t}return null}}),r.Browser.Nodes.server=r.Browser.Node.extend({parent_type:"server_group",type:"server",dialogHelp:t("help.static",{filename:"server_dialog.html"}),label:e("Server"),canDrop:!0,hasStatistics:!0,hasCollectiveStatistics:!0,can_expand:function(e){return e&&e.connected},Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_server_on_sg",node:"server_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("Server..."),data:{action:"create"},icon:"wcTabIcon icon-server"},{name:"create_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:3,label:e("Server..."),data:{action:"create"},icon:"wcTabIcon icon-server"},{name:"connect_server",node:"server",module:this,applies:["object","context"],callback:"connect_server",category:"connect",priority:4,label:e("Connect Server"),icon:"fa fa-link",enable:"is_not_connected"},{name:"disconnect_server",node:"server",module:this,applies:["object","context"],callback:"disconnect_server",category:"drop",priority:5,label:e("Disconnect Server"),icon:"fa fa-chain-broken",enable:"is_connected"},{name:"reload_configuration",node:"server",module:this,applies:["tools","context"],callback:"reload_configuration",category:"reload",priority:6,label:e("Reload Configuration"),icon:"fa fa-repeat",enable:"enable_reload_config"},{name:"restore_point",node:"server",module:this,applies:["tools","context"],callback:"restore_point",category:"restore",priority:9,label:e("Add Named Restore Point..."),icon:"fa fa-anchor",enable:"is_applicable"},{name:"change_password",node:"server",module:this,applies:["object"],callback:"change_password",label:e("Change Password..."),priority:10,icon:"fa fa-lock",enable:"is_connected"},{name:"wal_replay_pause",node:"server",module:this,applies:["tools","context"],callback:"pause_wal_replay",category:"wal_replay_pause",priority:7,label:e("Pause Replay of WAL"),icon:"fa fa-pause-circle",enable:"wal_pause_enabled"},{name:"wal_replay_resume",node:"server",module:this,applies:["tools","context"],callback:"resume_wal_replay",category:"wal_replay_resume",priority:8,label:e("Resume Replay of WAL"),icon:"fa fa-play-circle",enable:"wal_resume_enabled"},{name:"clear_saved_password",node:"server",module:this,applies:["object","context"],callback:"clear_saved_password",label:e("Clear Saved Password"),icon:"fa fa-eraser",priority:11,enable:function(e){return!(!e||"server"!==e._type||!e.is_password_saved)}},{name:"clear_sshtunnel_password",node:"server",module:this,applies:["object","context"],callback:"clear_sshtunnel_password",label:e("Clear SSH Tunnel Password"),icon:"fa fa-eraser",priority:12,enable:function(e){return!(!e||"server"!==e._type||!e.is_tunnel_password_saved)}}]),i.bindAll(this,"connection_lost"),l.Events.on("pgadmin:server:connection:lost",this.connection_lost))},is_not_connected:function(e){return e&&1!=e.connected},is_connected:function(e){return e&&1==e.connected},enable_reload_config:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser)},is_applicable:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser&&0==e.in_recovery)},wal_pause_enabled:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser&&1==e.in_recovery&&0==e.wal_pause)},wal_resume_enabled:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser&&1==e.in_recovery&&1==e.wal_pause)},callbacks:{connect_server:function(e){var t=e||{},n=this,i=l.tree,o=t.item||i.selected(),a=o&&1==o.length?i.itemData(o):void 0;return!!a&&(m(n,a,i,o,!1),!1)},disconnect_server:function(t,o){var a=t||{},r=this,s=l.tree,d="item"in a?a.item:s.selected(),u=d&&1==d.length?s.itemData(d):void 0;if(!u)return!1;o=o||i.isUndefined(o)||i.isNull(o);var p=function(){n.ajax({url:r.generate_url(d,"connect",u,!0),type:"DELETE"}).done(function(e){if(1==e.success)c.success(e.info),u=s.itemData(d),s.removeIcon(d),u.connected=!1,u.icon="icon-server-not-connected",s.addIcon(d,{icon:u.icon}),r.callbacks.refresh.apply(r,[null,d]),l.serverInfo&&u._id in l.serverInfo&&delete l.serverInfo[u._id],l.enable_disable_menus(d),l.Events.trigger("pgadmin:server:disconnect",{item:d,data:u},!1);else{try{c.error(e.errormsg)}catch(e){}s.unload(d)}}).fail(function(e,t,n){c.pgRespErrorNotify(e,n),s.unload(d)})};return o?c.confirm(e("Disconnect server"),e("Are you sure you want to disconnect the server %(server)s?",{server:u.label}),function(){p()},function(){return!0}):p(),!1},beforeopen:function(e,t){return!(!t||"server"!=t._type)&&(l.tree.addIcon(e,{icon:t.icon}),!!t.connected||(m(this,t,l.tree,e,!1),!1))},added:function(e,t){return l.serverInfo=l.serverInfo||{},l.serverInfo[t._id]=i.extend({},t),r.Browser.Node.callbacks.added.apply(this,arguments),!0},reload_configuration:function(t){var i=t||{},o=this,r=l.tree,s=i.item||r.selected(),d=s&&1==s.length?r.itemData(s):void 0;return!!d&&(c.confirm(e("Reload server configuration"),a(e("Are you sure you want to reload the server configuration on %s?")).sprintf(d.label).value(),function(){n.ajax({url:o.generate_url(s,"reload",d,!0),method:"GET"}).done(function(e){e.data.status?c.success(e.data.result):c.error(e.data.result)}).fail(function(e,t,n){c.pgRespErrorNotify(e,n),r.unload(s)})},function(){return!0}),!1)},restore_point:function(t){var o=t||{},a=this,r=l.tree,s=o.item||r.selected(),d=s&&1==s.length?r.itemData(s):void 0;if(!d)return!1;c.prompt(e("Enter the name of the restore point to add"),"",function(t,o){i.isUndefined(o)||i.isNull(o)||""===o||""===String(o).replace(/^\s+|\s+$/g,"")?(t.cancel=!0,c.error(e("Please enter a valid name."),10)):n.ajax({url:a.generate_url(s,"restore_point",d,!0),method:"POST",data:{value:JSON.stringify(o)}}).done(function(e){c.success(e.data.result,10)}).fail(function(e,t,n){c.pgRespErrorNotify(e,n),r.unload(s)})},function(e){e.cancel=!1}).set({title:e("Restore point name")})},change_password:function(t){var a=t||{},r=this,s=l.tree,d=a.item||s.selected(),p=d&&1==d.length?s.itemData(d):void 0,f=r.generate_url(d,"change_password",p,!0),m=!1,h=r.generate_url(d,"check_pgpass",p,!0);if(!p)return!1;if(!c.changeServerPassword){var g=o.Model.extend({defaults:{user_name:void 0,password:void 0,newPassword:void 0,confirmPassword:void 0},validate:function(){return null}}),b=[{name:"user_name",label:e("User"),type:"text",disabled:!0,control:"input"},{name:"password",label:e("Current Password"),type:"password",disabled:function(){return m},control:"input",required:!0},{name:"newPassword",label:e("New Password"),type:"password",disabled:!1,control:"input",required:!0},{name:"confirmPassword",label:e("Confirm Password"),type:"password",disabled:!1,control:"input",required:!0}];c.dialog("changeServerPassword",function(){return{main:function(t){var n=e("Change Password ");this.set("title",n),this.user_name=t.user.name},setup:function(){return{buttons:[{text:e("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button",attrs:{name:"cancel"}},{text:e("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button",attrs:{name:"submit"}}],options:{padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1}}},hooks:{onclose:function(){this.view&&this.view.remove({data:!0,internal:!0,silent:!0})}},prepare:function(){var t=this;this.__internal.buttons[1].element.disabled=!0;var o=n("<div class='change_password'></div>"),a=new g({user_name:t.user_name});(this.view=new u.Form({el:o,model:a,fields:b})).render(),this.elements.content.appendChild(o.get(0)),this.view.model.on("change",function(){var n=this,o=this.get("password"),a=this.get("newPassword"),r=this.get("confirmPassword");!m&&(i.isUndefined(o)||i.isNull(o)||""==o)||i.isUndefined(a)||i.isNull(a)||""==a||i.isUndefined(r)||i.isNull(r)||""==r?t.__internal.buttons[1].element.disabled=!0:a!=r?(t.__internal.buttons[1].element.disabled=!0,this.errorTimeout&&clearTimeout(this.errorTimeout),this.errorTimeout=setTimeout(function(){n.errorModel.set("confirmPassword",e("Passwords do not match."))},400)):(n.errorModel.clear(),t.__internal.buttons[1].element.disabled=!1)})},callback:function(t){if("submit"==t.button.element.name){var i=this,o=this.view.model.toJSON();t.cancel=!0,n.ajax({url:f,method:"POST",data:{data:JSON.stringify(o)}}).done(function(t){t.success?(m&&c.alert(e("Change Password"),e("Please make sure to disconnect the server and update the new password in the pgpass file before performing any other operation")),c.success(t.info),i.close()):c.error(t.errormsg)}).fail(function(e,t,n){c.pgRespErrorNotify(e,n)})}}}})}return n.ajax({url:h,method:"GET"}).done(function(e){e.success&&e.data.is_pgpass&&(m=!0),c.changeServerPassword(p).resizeTo("40%","52%")}).fail(function(e,t,n){c.pgRespErrorNotify(e,n)}),!1},pause_wal_replay:function(e){var t=e||{},i=this,o=l.tree,a=t.item||o.selected(),r=a&&1==a.length?o.itemData(a):void 0;if(!r)return!1;n.ajax({url:i.generate_url(a,"wal_replay",r,!0),type:"DELETE",dataType:"json"}).done(function(e){1==e.success&&(c.success(e.info),o.itemData(a).wal_pause=e.data.wal_pause,o.unload(a),o.setInode(a),o.deselect(a),setTimeout(function(){o.select(a)},10))}).fail(function(e,t,n){c.pgRespErrorNotify(e,n),o.unload(a)})},resume_wal_replay:function(e){var t=e||{},i=this,o=l.tree,a=t.item||o.selected(),r=a&&1==a.length?o.itemData(a):void 0;if(!r)return!1;n.ajax({url:i.generate_url(a,"wal_replay",r,!0),type:"PUT",dataType:"json"}).done(function(e){1==e.success&&(c.success(e.info),o.itemData(a).wal_pause=e.data.wal_pause,o.unload(a),o.setInode(a),o.deselect(a),setTimeout(function(){o.select(a)},10))}).fail(function(e,t,n){c.pgRespErrorNotify(e,n),o.unload(a)})},clear_saved_password:function(t){var i=t||{},o=this,r=l.tree,s=i.item||r.selected(),d=s&&1==s.length?r.itemData(s):void 0;return!!d&&(c.confirm(e("Clear saved password"),a(e("Are you sure you want to clear the saved password for server %s?")).sprintf(d.label).value(),function(){n.ajax({url:o.generate_url(s,"clear_saved_password",d,!0),method:"PUT"}).done(function(e){1==e.success?(c.success(e.info),r.itemData(s).is_password_saved=e.data.is_password_saved):c.error(e.info)}).fail(function(e,t,n){c.pgRespErrorNotify(e,n)})},function(){return!0}),!1)},clear_sshtunnel_password:function(t){var i=t||{},o=this,r=l.tree,s=i.item||r.selected(),d=s&&1==s.length?r.itemData(s):void 0;return!!d&&(c.confirm(e("Clear SSH Tunnel password"),a(e("Are you sure you want to clear the saved password of SSH Tunnel for server %s?")).sprintf(d.label).value(),function(){n.ajax({url:o.generate_url(s,"clear_sshtunnel_password",d,!0),method:"PUT"}).done(function(e){1==e.success?(c.success(e.info),r.itemData(s).is_tunnel_password_saved=e.data.is_tunnel_password_saved):c.error(e.info)}).fail(function(e,t,n){c.pgRespErrorNotify(e,n)})},function(){return!0}),!1)}},model:r.Browser.Node.Model.extend({defaults:{gid:void 0,id:void 0,name:"",sslmode:"prefer",host:"",hostaddr:"",port:5432,db:"postgres",username:d.name,role:null,connect_now:!0,password:void 0,save_password:!1,db_res:"",passfile:void 0,sslcompression:!1,sslcert:void 0,sslkey:void 0,sslrootcert:void 0,sslcrl:void 0,service:void 0,use_ssh_tunnel:0,tunnel_host:void 0,tunnel_port:22,tunnel_username:void 0,tunnel_identity_file:void 0,tunnel_password:void 0,tunnel_authentication:0,save_tunnel_password:!1,connect_timeout:0},initialize:function(e,t){0===i.size(e)&&this.set({gid:t.node_info.server_group._id}),r.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"id",label:e("ID"),type:"int",mode:["properties"]},{id:"name",label:e("Name"),type:"text",mode:["properties","edit","create"]},{id:"gid",label:e("Server group"),type:"int",control:"node-list-by-id",node:"server_group",mode:["create","edit"],select2:{allowClear:!1}},{id:"server_type",label:e("Server type"),type:"options",mode:["properties"],visible:"isConnected",options:s},{id:"connected",label:e("Connected?"),type:"switch",mode:["properties"],group:e("Connection"),options:{onText:e("True"),offText:e("False"),size:"mini"}},{id:"version",label:e("Version"),type:"text",group:null,mode:["properties"],visible:"isConnected"},{id:"bgcolor",label:e("Background"),type:"color",group:null,mode:["edit","create"],disabled:"isfgColorSet",deps:["fgcolor"]},{id:"fgcolor",label:e("Foreground"),type:"color",group:null,mode:["edit","create"],disabled:"isConnected"},{id:"connect_now",controlLabel:e("Connect now?"),type:"checkbox",group:null,mode:["create"]},{id:"comment",label:e("Comments"),type:"multiline",group:null,mode:["properties","edit","create"]},{id:"host",label:e("Host name/address"),type:"text",group:e("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"port",label:e("Port"),type:"int",group:e("Connection"),mode:["properties","edit","create"],disabled:"isConnected",min:1,max:65535},{id:"db",label:e("Maintenance database"),type:"text",group:e("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"username",label:e("Username"),type:"text",group:e("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"password",label:e("Password"),type:"password",group:e("Connection"),control:"input",mode:["create"],deps:["connect_now"],visible:function(e){return e.get("connect_now")&&e.isNew()}},{id:"save_password",controlLabel:e("Save password?"),type:"checkbox",group:e("Connection"),mode:["create"],deps:["connect_now"],visible:function(e){return e.get("connect_now")&&e.isNew()},disabled:function(){return!d.allow_save_password}},{id:"role",label:e("Role"),type:"text",group:e("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"sslmode",label:e("SSL mode"),type:"options",group:e("SSL"),mode:["properties","edit","create"],disabled:"isConnected",options:[{label:e("Allow"),value:"allow"},{label:e("Prefer"),value:"prefer"},{label:e("Require"),value:"require"},{label:e("Disable"),value:"disable"},{label:e("Verify-CA"),value:"verify-ca"},{label:e("Verify-Full"),value:"verify-full"}]},{id:"sslcert",label:e("Client certificate"),type:"text",group:e("SSL"),mode:["edit","create"],disabled:"isSSL",control:u.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslkey",label:e("Client certificate key"),type:"text",group:e("SSL"),mode:["edit","create"],disabled:"isSSL",control:u.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslrootcert",label:e("Root certificate"),type:"text",group:e("SSL"),mode:["edit","create"],disabled:"isSSL",control:u.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslcrl",label:e("Certificate revocation list"),type:"text",group:e("SSL"),mode:["edit","create"],disabled:"isSSL",control:u.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslcompression",label:e("SSL compression?"),type:"switch",mode:["edit","create"],group:e("SSL"),options:{size:"mini"},deps:["sslmode"],disabled:"isSSL"},{id:"sslcert",label:e("Client certificate"),type:"text",group:e("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslcert");return!i.isUndefined(t)&&!i.isNull(t)}},{id:"sslkey",label:e("Client certificate key"),type:"text",group:e("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslkey");return!i.isUndefined(t)&&!i.isNull(t)}},{id:"sslrootcert",label:e("Root certificate"),type:"text",group:e("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslrootcert");return!i.isUndefined(t)&&!i.isNull(t)}},{id:"sslcrl",label:e("Certificate revocation list"),type:"text",group:e("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslcrl");return!i.isUndefined(t)&&!i.isNull(t)}},{id:"sslcompression",label:e("SSL compression?"),type:"switch",mode:["properties"],group:e("SSL"),options:{size:"mini"},deps:["sslmode"],visible:function(e){var t=e.get("sslmode");return-1!=i.indexOf(f,t)}},{id:"use_ssh_tunnel",label:e("Use SSH tunneling"),type:"switch",mode:["properties","edit","create"],group:e("SSH Tunnel"),options:{size:"mini"},disabled:function(e){return r.Browser.utils.support_ssh_tunnel?e.get("connected"):(setTimeout(function(){e.set("use_ssh_tunnel",0)},10),!0)}},{id:"tunnel_host",label:e("Tunnel host"),type:"text",group:e("SSH Tunnel"),mode:["properties","edit","create"],deps:["use_ssh_tunnel"],disabled:function(e){return!e.get("use_ssh_tunnel")}},{id:"tunnel_port",label:e("Tunnel port"),type:"int",group:e("SSH Tunnel"),mode:["properties","edit","create"],deps:["use_ssh_tunnel"],max:65535,disabled:function(e){return!e.get("use_ssh_tunnel")}},{id:"tunnel_username",label:e("Username"),type:"text",group:e("SSH Tunnel"),mode:["properties","edit","create"],deps:["use_ssh_tunnel"],disabled:function(e){return!e.get("use_ssh_tunnel")}},{id:"tunnel_authentication",label:e("Authentication"),type:"switch",mode:["properties","edit","create"],group:e("SSH Tunnel"),options:{onText:e("Identity file"),offText:e("Password"),size:"mini",width:"90"},deps:["use_ssh_tunnel"],disabled:function(e){return!e.get("use_ssh_tunnel")}},{id:"tunnel_identity_file",label:e("Identity file"),type:"text",group:e("SSH Tunnel"),mode:["edit","create"],control:u.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["tunnel_authentication","use_ssh_tunnel"],disabled:function(e){var t=e.get("tunnel_identity_file");return!e.get("tunnel_authentication")&&t&&setTimeout(function(){e.set("tunnel_identity_file",null)},10),!e.get("tunnel_authentication")||!e.get("use_ssh_tunnel")}},{id:"tunnel_identity_file",label:e("Identity file"),type:"text",group:e("SSH Tunnel"),mode:["properties"]},{id:"tunnel_password",label:e("Password"),type:"password",group:e("SSH Tunnel"),control:"input",mode:["create"],deps:["use_ssh_tunnel"],disabled:function(e){return!e.get("use_ssh_tunnel")}},{id:"save_tunnel_password",controlLabel:e("Save password?"),type:"checkbox",group:e("SSH Tunnel"),mode:["create"],deps:["connect_now","use_ssh_tunnel"],visible:function(e){return e.get("connect_now")&&e.isNew()},disabled:function(e){return!d.allow_save_tunnel_password||!e.get("use_ssh_tunnel")}},{id:"hostaddr",label:e("Host address"),type:"text",group:e("Advanced"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"db_res",label:e("DB restriction"),type:"select2",group:e("Advanced"),mode:["properties","edit","create"],disabled:"isConnected",select2:{multiple:!0,allowClear:!1,tags:!0,tokenSeparators:[","],first_empty:!1,selectOnClose:!0,emptyOptions:!0}},{id:"passfile",label:e("Password file"),type:"text",group:e("Advanced"),mode:["edit","create"],disabled:"isConnectedWithValidLib",control:u.FileControl,dialog_type:"select_file",supp_types:["*"]},{id:"passfile",label:e("Password file"),type:"text",group:e("Advanced"),mode:["properties"],visible:function(e){var t=e.get("passfile");return!i.isUndefined(t)&&!i.isNull(t)}},{id:"service",label:e("Service"),type:"text",mode:["properties","edit","create"],disabled:"isConnected",group:e("Connection")},{id:"connect_timeout",label:e("Connection timeout (seconds)"),type:"int",group:e("Advanced"),mode:["properties","edit","create"],disabled:"isConnected",min:0}],validate:function(){return new p.ModelValidation(this).validate()},isConnected:function(e){return e.get("connected")},isfgColorSet:function(e){var t=e.get("bgcolor"),n=e.get("fgcolor");return!!e.get("connected")||((i.isUndefined(t)||i.isNull(t)||!t)&&n&&e.set("bgcolor","#ffffff"),!1)},isSSL:function(e){var t=e.get("sslmode");return!!e.get("connected")||-1==i.indexOf(f,t)},isConnectedWithValidLib:function(e){return!!e.get("connected")||l.utils.pg_libpq_version<1e5}}),connection_lost:function(t,n){if(l.tree){for(var o=l.tree,a=t&&o.itemData(t),r=this;a&&"server"!=a._type;)t=o.parent(t),a=t&&o.itemData(t);if(t&&a&&"server"==a._type&&(i.isUndefined(a.is_connecting)||!a.is_connecting)){a.is_connecting=!0;var s=function e(i){a._id==i&&(a.is_connecting=!1,l.Events.off("pgadmin:server:connect:cancelled",e),l.Events.trigger("pgadmin:database:connect:cancelled",i,n.data.database||a.db),l.Events.trigger("pgadmin:server:disconnect",{item:t,data:a},!1))};l.Events.on("pgadmin:server:connect:cancelled",s),c.confirm(e("Connection lost"),e("Would you like to reconnect to the database?"),function(){m(r,a,o,t,!0)},function(){a.is_connecting=!1,o.unload(t),o.setInode(t),o.addIcon(t,{icon:"icon-database-not-connected"}),l.Events.trigger("pgadmin:server:connect:cancelled",t,a,r),o.select(t)})}}}});var m=function(t,o,a,r,s){var d=s||o.connected,u=function(t,n,i,r,l,s,d,u){o.connected=!1,u||(a.setInode(d),a.addIcon(d,{icon:"icon-server-not-connected"})),c.pgNotifier("error",t,i,function(t){setTimeout(function(){c.dlgServerPass(e("Connect to Server"),t,r,l,s,d,u).resizeTo()},100)})},p=function(e,n,o,a,r,s){if(e&&e.data){"string"==typeof e.data.icon&&(a.removeIcon(r),o.icon=e.data.icon,a.addIcon(r,{icon:o.icon})),i.extend(o,e.data),o.is_connecting=!1;(l.serverInfo=l.serverInfo||{})[o._id]=i.extend({},o),c.success(e.info),t.trigger("connected",t,r,o),l.Events.trigger("pgadmin:server:connected",o._id,r,o),l.Events.trigger("pgadmin:database:connected",o._id,o.db,r,o),s?setTimeout(function(){n.callbacks.refresh.apply(n,[!0])},10):(a.setInode(r),a.deselect(r),setTimeout(function(){a.select(r),a.open(r)},10))}};c.dlgServerPass||c.dialog("dlgServerPass",function(){return{main:function(e,t,n,i,o,a,r,l,s,d){this.set("title",e),this.message=t,this.tree=o,this.nodeData=i,this.nodeItem=a,this.node=n,this.connected=r,this.onSuccess=l||p,this.onFailure=s||u,this.onCancel=d||f},setup:function(){return{buttons:[{text:e("Cancel"),className:"btn btn-secondary fa fa-times pg-alertify-button",key:27},{text:e("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button"}],focus:{element:"#password",select:!0},options:{modal:0,resizable:!1,maximizable:!1,pinnable:!1}}},build:function(){},prepare:function(){this.setContent(this.message)},callback:function(t){var i=this.tree,o=this.nodeItem,a=this.node,r=this.nodeData,l=this.connected,s=this.onSuccess,d=this.onFailure,c=this.onCancel;if(t.button.text==e("OK")){var u=a.generate_url(o,"connect",r,!0);l||(i.setLeaf(o),i.removeIcon(o),i.addIcon(o,{icon:"icon-server-connecting"})),n.ajax({type:"POST",timeout:3e4,url:u,data:n("#frmPassword").serialize()}).done(function(e){return s(e,a,r,i,o,l)}).fail(function(e,t,n){return d(e,t,n,a,r,i,o,l)})}else c&&"function"==typeof c&&c(i,o,r,l)}}});var f=function(e,n,i,a){i.is_connecting=!1,e.unload(n),e.setInode(n),e.removeIcon(n),e.addIcon(n,{icon:"icon-server-not-connected"}),t.trigger("connect:cancelled",o._id,o.db,t,n,i),l.Events.trigger("pgadmin:server:connect:cancelled",o._id,n,i,t),l.Events.trigger("pgadmin:database:connect:cancelled",o._id,o.db,n,i,t),a&&e.select(n)};o.is_connecting=!0;var m=t.generate_url(r,"connect",o,!0);n.post(m).done(function(e){if(1==e.success)return p(e,t,o,a,r,d)}).fail(function(e,n,i){return u(e,0,i,t,o,a,r,d)})}}return l.Nodes.server}.apply(t,i))&&(e.exports=o)},function(e,t){e.exports=i},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(10),n(3),n(5),n(6),n(14),n(12),n(7),n(16)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d){r.Nodes["coll-function"]||(r.Nodes["coll-function"]=r.Collection.extend({node:"function",label:e("Functions"),type:"coll-function",columns:["name","funcowner","description"],hasStatistics:!0,canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema}));var c=r.Node.Model.extend({idAttribute:"argid",defaults:{argid:void 0,argtype:void 0,argmode:void 0,argname:void 0,argdefval:void 0},schema:[{id:"argid",visible:!1,type:"text",mode:["properties","edit","create"]},{id:"argtype",label:e("Data Type"),cell:"node-ajax-options",cellHeaderClasses:"width_percent_30",control:"node-ajax-options",type:"text",url:"get_types",editable:function(e){var t=this.get("node_info");return!(t&&"catalog"in t)&&(!!i.isUndefined(e.isNew)||e.isNew())},first_empty:!0},{id:"argmode",label:e("Mode"),type:"options",control:"node-ajax-options",cellHeaderClasses:"width_percent_20",options:[{label:"IN",value:"IN"},{label:"OUT",value:"OUT"},{label:"INOUT",value:"INOUT"},{label:"VARIADIC",value:"VARIADIC"}],editable:function(e){var t=this.get("node_info");return!(t&&"catalog"in t)&&(!!i.isUndefined(e.isNew)||e.isNew())}},{id:"argname",label:e("Argument Name"),type:"text",cell:"string",editable:"isInCatalog",cellHeaderClasses:"width_percent_30"},{id:"argdefval",label:e("Default Value"),type:"text",cell:"string",editable:"isInCatalog",cellHeaderClasses:"width_percent_20"}],toJSON:o.Model.prototype.toJSON,isInCatalog:function(e){var t=this.get("node_info");return!(t&&"catalog"in t)&&!!(i.isUndefined(e.get("argmode"))||i.isUndefined(this.get("name"))||"argdefval"!=this.get("name")||"INOUT"!=e.get("argmode")&&"OUT"!=e.get("argmode"))},validate:function(){}});return r.Nodes.function||(r.Nodes.function=s.SchemaChildNode.extend({type:"function",sqlAlterHelp:"sql-alterfunction.html",sqlCreateHelp:"sql-createfunction.html",dialogHelp:t("help.static",{filename:"function_dialog.html"}),label:e("Function"),collection_type:"coll-function",hasSQL:!0,hasDepends:!0,width:r.stdW.md+"px",hasStatistics:function(e){return"gpdb"!==e.server.server_type},hasScriptTypes:["create","select"],Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_function_on_coll",node:"coll-function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_function",node:"function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_function",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:!1},enable:"canCreate"}]))},model:r.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){if(0===i.size(e)){var n=t.node_info.schema._id;this.set({pronamespace:n},{silent:!0});var o=r.serverInfo[t.node_info.server._id].user;this.set({funcowner:o.name},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,xmin:void 0,funcowner:void 0,pronamespace:void 0,description:void 0,pronargs:void 0,proargs:void 0,proargtypenames:void 0,prorettypename:void 0,lanname:"sql",provolatile:void 0,proretset:void 0,proisstrict:void 0,prosecdef:void 0,proiswindow:void 0,proparallel:void 0,procost:void 0,prorows:void 0,proleakproof:void 0,arguments:[],prosrc:void 0,prosrc_c:void 0,probin:"$libdir/",options:[],variables:[],proacl:void 0,seclabels:[],acl:[],sysfunc:void 0,sysproc:void 0},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"isDisabled"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:e("Owner"),cell:"string",control:l.NodeListByNameControl,node:"role",type:"text",disabled:"isDisabled"},{id:"pronamespace",label:e("Schema"),cell:"string",control:"node-list-by-id",type:"text",cache_level:"database",node:"schema",disabled:"isDisabled",mode:["create","edit"]},{id:"sysfunc",label:e("System function?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"sysproc",label:e("System procedure?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",disabled:"isDisabled"},{id:"pronargs",label:e("Argument count"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"proargs",label:e("Arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties","edit"],disabled:"isDisabled"},{id:"proargtypenames",label:e("Signature arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"],disabled:"isDisabled"},{id:"prorettypename",label:e("Return type"),cell:"string",control:"node-ajax-options",type:"text",group:e("Definition"),url:"get_types",disabled:"isDisabled",first_empty:!0,mode:["create"],visible:"isVisible"},{id:"prorettypename",label:e("Return type"),cell:"string",type:"text",group:e("Definition"),mode:["properties","edit"],disabled:"isDisabled",visible:"isVisible"},{id:"lanname",label:e("Language"),cell:"string",control:"node-ajax-options",type:"text",group:e("Definition"),url:"get_languages",disabled:"isDisabled"},{id:"prosrc",label:e("Code"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Definition"),deps:["lanname"],control:l.SqlFieldControl,extraClasses:["custom_height_css_class"],visible:function(e){return"c"!=e.get("lanname")},disabled:"isDisabled"},{id:"probin",label:e("Object file"),cell:"string",type:"text",group:e("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled"},{id:"prosrc_c",label:e("Link symbol"),cell:"string",type:"text",group:e("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled"},{id:"provolatile",label:e("Volatility"),cell:"string",control:"node-ajax-options",type:"text",group:e("Options"),deps:["lanname"],options:[{label:"VOLATILE",value:"v"},{label:"STABLE",value:"s"},{label:"IMMUTABLE",value:"i"}],disabled:"isDisabled",select2:{allowClear:!1}},{id:"proretset",label:e("Returns a set?"),type:"switch",disabled:"isDisabled",group:e("Options"),visible:"isVisible"},{id:"proisstrict",label:e("Strict?"),type:"switch",group:e("Options"),disabled:"isDisabled",deps:["lanname"]},{id:"prosecdef",label:e("Security of definer?"),group:e("Options"),type:"switch",disabled:"isDisabled"},{id:"proiswindow",label:e("Window?"),group:e("Options"),cell:"boolean",type:"switch",disabled:"isDisabled",visible:"isVisible"},{id:"proparallel",label:e("Parallel"),cell:"string",control:"node-ajax-options",type:"text",group:e("Options"),deps:["lanname"],options:[{label:"UNSAFE",value:"u"},{label:"RESTRICTED",value:"r"},{label:"SAFE",value:"s"}],disabled:"isDisabled",min_version:90600,select2:{allowClear:!1}},{id:"procost",label:e("Estimated cost"),group:e("Options"),cell:"string",type:"text",disabled:"isDisabled",deps:["lanname"]},{id:"prorows",label:e("Estimated rows"),type:"text",deps:["proretset"],visible:"isVisible",disabled:"isDisabled",group:e("Options")},{id:"proleakproof",label:e("Leak proof?"),group:e("Options"),cell:"boolean",type:"switch",min_version:90200,disabled:"isDisabled",deps:["lanname"]},{id:"proacl",label:e("Privileges"),type:"text",mode:["properties"],group:e("Security")},{id:"arguments",label:e("Arguments"),cell:"string",group:e("Arguments"),type:"collection",canAdd:function(e){return e.isNew()},canDelete:!0,model:c,mode:["create","edit"],columns:["argtype","argmode","argname","argdefval"],disabled:"isDisabled",canDeleteRow:function(e){return e.isNew()}},{id:"variables",label:e("Parameters"),type:"collection",group:e("Parameters"),control:"variable-collection",model:r.Node.VariableModel,mode:["edit","create"],canAdd:"canVarAdd",canEdit:!1,canDelete:!0,disabled:"isDisabled"},r.SecurityGroupSchema,{id:"acl",label:e("Privileges"),editable:!1,model:r.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],type:"collection",group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection",disabled:"isDisabled"},{id:"seclabels",label:e("Security Labels"),canAdd:!0,model:r.SecLabelModel,type:"collection",min_version:90100,group:"security",mode:["edit","create"],canEdit:!1,canDelete:!0,uniqueCol:["provider"],disabled:"isDisabled",control:"unique-col-collection",visible:function(){return this.node&&"procedure"!=this.node.type}}],validate:function(){var t,n={},o=this.get("seclabels");if((i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(n.name=e("Name cannot be empty."),t=t||n.name),(i.isUndefined(this.get("funcowner"))||""==String(this.get("funcowner")).replace(/^\s+|\s+$/g,""))&&(n.funcowner=e("Owner cannot be empty."),t=t||n.funcowner),(i.isUndefined(this.get("pronamespace"))||""==String(this.get("pronamespace")).replace(/^\s+|\s+$/g,""))&&(n.pronamespace=e("Schema cannot be empty."),t=t||n.pronamespace),(i.isUndefined(this.get("prorettypename"))||""==String(this.get("prorettypename")).replace(/^\s+|\s+$/g,""))&&(n.prorettypename=e("Return type cannot be empty."),t=t||n.prorettypename),(i.isUndefined(this.get("lanname"))||""==String(this.get("lanname")).replace(/^\s+|\s+$/g,""))&&(n.lanname=e("Language cannot be empty."),t=t||n.lanname),"c"==String(this.get("lanname"))?((i.isUndefined(this.get("probin"))||""==String(this.get("probin")).replace(/^\s+|\s+$/g,""))&&(n.probin=e("Object File cannot be empty."),t=t||n.probin),(i.isUndefined(this.get("prosrc_c"))||""==String(this.get("prosrc_c")).replace(/^\s+|\s+$/g,""))&&(n.prosrc_c=e("Link Symbol cannot be empty."),t=t||n.prosrc_c)):(i.isUndefined(this.get("prosrc"))||""==String(this.get("prosrc")).replace(/^\s+|\s+$/g,""))&&(n.prosrc=e("Code cannot be empty."),t=t||n.prosrc),o)for(var a,r=0;r<o.models.length&&!a;r++)(a=o.models[r].validate.apply(o.models[r]))&&(n.seclabels=a,t=t||a);return this.errorModel.clear().set(n),i.size(n)?(this.trigger("on-status",{msg:t}),t):null},isVisible:function(){return"sysproc"!=this.name},isDisabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;switch(this.name){case"proargs":case"proargtypenames":case"prorettypename":case"proretset":case"proiswindow":return!e.isNew();case"prorows":return 1!=e.get("proretset");default:return!1}},canVarAdd:function(){return!(this.node_info&&"catalog"in this.node_info)}})})),r.Nodes.function}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(5),n(6),n(7),n(16)],void 0!==(o=function(e,t,n,i,o,a,r){return a.Nodes["coll-edbfunc"]||(a.Nodes["coll-edbfunc"]=a.Collection.extend({node:"edbfunc",label:e("Functions"),type:"coll-edbfunc",columns:["name","funcowner","description"],canDrop:!1,canDropCascade:!1})),a.Nodes.edbfunc||(a.Nodes.edbfunc=a.Node.extend({type:"edbfunc",dialogHelp:t("help.static",{filename:"edbfunc_dialog.html"}),label:e("Function"),collection_type:"coll-edbfunc",hasDepends:!0,canEdit:!1,hasSQL:!0,hasScriptTypes:[],parent_type:["package"],Init:function(){this.initialized||(this.initialized=!0)},canDrop:!1,canDropCascade:!1,model:a.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,funcowner:void 0,pronargs:void 0,proargs:void 0,proargtypenames:void 0,prorettypename:void 0,lanname:"sql",prosrc:void 0,proacl:void 0,visibility:"Unknown"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties"],disabled:!0},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:e("Owner"),cell:"string",type:"text",disabled:!0},{id:"pronargs",label:e("Argument count"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"proargs",label:e("Arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"],disabled:!0},{id:"proargtypenames",label:e("Signature arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"],disabled:!0},{id:"prorettypename",label:e("Return type"),cell:"string",type:"text",group:e("Definition"),disabled:!0,mode:["properties"],visible:"isVisible"},{id:"visibility",label:e("Visibility"),cell:"string",type:"text",mode:["properties"],disabled:!0},{id:"lanname",label:e("Language"),cell:"string",type:"text",group:e("Definition"),disabled:!0},{id:"prosrc",label:e("Code"),cell:"string",type:"text",mode:["properties"],group:e("Definition"),control:r.SqlFieldControl,extraClasses:["custom_height_css_class"],visible:function(e){return"c"!=e.get("lanname")},disabled:!0}],validate:function(){return null},isVisible:function(){return"sysproc"!=this.name}})})),a.Nodes.edbfunc}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(5),n(6),n(12)],void 0!==(o=function(e,t,n,i,o,a,r,l){return a.Nodes["coll-rule"]||(o.Browser.Nodes["coll-rule"]=o.Browser.Collection.extend({node:"rule",label:e("Rules"),type:"coll-rule",columns:["name","owner","comment"],canDrop:l.isTreeItemOfChildOfSchema,canDropCascade:l.isTreeItemOfChildOfSchema})),a.Nodes.rule||(o.Browser.Nodes.rule=a.Node.extend({parent_type:["table","view","partition"],type:"rule",sqlAlterHelp:"sql-alterrule.html",sqlCreateHelp:"sql-createrule.html",dialogHelp:t("help.static",{filename:"rule_dialog.html"}),label:e("rule"),collection_type:"coll-table",hasSQL:!0,hasDepends:!0,canDrop:function(e,t){return l.isTreeItemOfChildOfSchema.apply(this,[e,t]),!i.has(e,"label")||"_RETURN"!==e.label},canDropCascade:function(e,t){return l.isTreeItemOfChildOfSchema.apply(this,[e,t]),!i.has(e,"label")||"_RETURN"!==e.label},Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_rule_on_coll",node:"coll-rule",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule",node:"rule",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"}]))},model:o.Browser.Node.Model.extend({idAttribute:"oid",schema:[{id:"name",label:e("Name"),type:"text",disabled:function(e){return!(!e||"_RETURN"!=e.get("name"))||!e.isNew()&&!(e.node_info.server.version>=90400)}},{id:"oid",label:e("OID"),type:"text",disabled:!0,mode:["properties"]},{id:"schema",label:"",type:"text",visible:!1,disabled:function(e){e.set("schema",e.node_info.schema.label)}},{id:"view",label:"",type:"text",visible:!1,disabled:function(e){e.set("view",this.node_data.label)}},{id:"event",label:e("Event"),control:"select2",group:e("Definition"),type:"text",select2:{width:"100%",allowClear:!1},options:[{label:"Select",value:"Select"},{label:"Insert",value:"Insert"},{label:"Update",value:"Update"},{label:"Delete",value:"Delete"}]},{id:"do_instead",label:e("Do Instead"),group:e("Definition"),type:"switch"},{id:"condition",label:e("Condition"),type:"text",group:e("Definition"),control:r.SqlFieldControl},{id:"statements",label:e("Commands"),type:"text",group:e("Definition"),control:r.SqlFieldControl},{id:"system_rule",label:e("System rule?"),type:"switch",mode:["properties"]},{id:"enabled",label:e("Enabled?"),type:"switch",mode:["properties"]},{id:"comment",label:e("Comment"),cell:"string",type:"multiline"}],validate:function(){var t,n={},o=this.get("name");return i.isUndefined(o)||i.isNull(o)||""===String(o).replace(/^\s+|\s+$/g,"")?(n.name=e("Please specify name."),t=t||n.name,this.errorModel.set("name",t),t):(this.errorModel.unset("name"),null)}}),canCreate:function(e,t,n){if(n&&!1===n.check)return!0;for(var o=a.tree,r=t,l=e;r;){if(i.indexOf(["schema"],l._type)>-1)return!0;if("coll-rule"==l._type){var s=o.hasParent(r)?o.parent(r):null,d=o.hasParent(s)?o.parent(s):null,c=d?o.itemData(d):null,u=o.hasParent(d)?o.parent(d):null;return"catalog"!=(u?o.itemData(u):null)._type}if("view"==l._type||"table"==l._type)return s=o.hasParent(r)?o.parent(r):null,d=o.hasParent(s)?o.parent(s):null,c=d?o.itemData(d):null,"schema"==c._type;r=o.hasParent(r)?o.parent(r):null,l=r?o.itemData(r):null}return!0}})),a.Nodes["coll-rule"]}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(0),n(1),n(10),n(5),n(6),n(13),n(7)],void 0!==(o=function(e,t,n,i,o,a,r){r.PartitionRow=r.Row.extend({modelDuplicateClass:"bg-model-duplicate",initialize:function(){r.Row.prototype.initialize.apply(this,arguments);var e=this;e.model.on("change:is_attach",function(){setTimeout(function(){e.columns.each(function(t){if("partition_name"==t.get("name")){var n=e.columns.indexOf(t),i=t.get("cellFunction"),o=new(i.apply(t,[e.model]))({column:t,model:e.model});e.cells[n].remove(),e.cells[n]=o,e.render()}})},10)}),e.listenTo(e.model,"pgadmin-session:model:duplicate",e.modelDuplicate),e.listenTo(e.model,"pgadmin-session:model:unique",e.modelUnique)},modelDuplicate:function(){t(this.el).removeClass("new"),t(this.el).addClass(this.modelDuplicateClass)},modelUnique:function(){t(this.el).removeClass(this.modelDuplicateClass)}});var l=function(e){if(e.get("is_attach")){var t=[];return e.set({partition_name:void 0},{silent:!0}),n.each(e.top.table_options,function(e){t.push([e.label,e.value])}),r.Extension.Select2Cell.extend({optionValues:t})}return r.StringCell};a.PartitionKeyModel=o.Node.Model.extend({defaults:{key_type:"column",pt_column:void 0,expression:void 0},keys:["pt_column"],schema:[{id:"key_type",label:e("Key type"),type:"select2",editable:!0,cell:"select2",cellHeaderClasses:"width_percent_25",select2:{allowClear:!1},options:[{label:e("Column"),value:"column"},{label:e("Expression"),value:"expression"}]},{id:"pt_column",label:e("Column"),type:"text",cell:r.Extension.Select2DepCell.extend({keyPathAccessor:function(e,t){var i=e;if(n.isArray(i))return n.map(i,function(e){return e.pt_column});t=t.split(".");for(var o=0;o<t.length;o++){if(n.isNull(i))return null;n.isEmpty(t[o])||(n.isUndefined(i[t[o]])||(i=i[t[o]]))}return n.isObject(i)&&!n.isArray(i)?null:i},initialize:function(){var e=this;if(this.model.handler){if(r.Extension.Select2DepCell.prototype.initialize.apply(this,arguments),n.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}},resetColOptions:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},custom_options:function(){var e=this.model.top.get("columns"),t=this.model.top.get("typname"),i=this.model.top.of_types_tables,o=[];e.length>0?n.each(e.models,function(e){var t=e.get("name");n.isUndefined(t)||n.isNull(t)||o.push({label:t,value:t,image:"icon-column"})}):!n.isUndefined(t)&&!n.isNull(t)&&!n.isUndefined(i)&&i.length>0&&n.each(i,function(e){e.label==t&&n.each(e.oftype_columns,function(e){o.push({label:e.name,value:e.name,image:"icon-column"})})}),this.column.set("options",o)},remove:function(){if(this.model.handler){var e=this,t=e.model.top.get("columns");e.stopListening(t,"remove",e.resetColOptions),e.stopListening(t,"change:name",e.resetColOptions),r.Extension.Select2DepCell.prototype.remove.apply(this,arguments)}}}),deps:["key_type"],cellHeaderClasses:"width_percent_30",transform:function(e){var t=[];return e&&n.isArray(e)&&n.each(e,function(e){t.push({label:e.label,value:e.label,image:"icon-column"})}),t},select2:{allowClear:!1},editable:function(e){return"expression"!=e.get("key_type")||(setTimeout(function(){e.set("pt_column",void 0)},10),!1)}},{id:"expression",label:e("Expression"),type:"text",cell:r.Extension.StringDepCell,cellHeaderClasses:"width_percent_45",deps:["key_type"],editable:function(e){return"column"!=e.get("key_type")||(setTimeout(function(){e.set("expression",void 0)},10),!1)}}],validate:function(){var t,i=this.get("key_type"),o=this.get("pt_column"),a=this.get("expression");return this.errorModel.clear(),n.isUndefined(i)||n.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(t=e("Partition key type cannot be empty."),this.errorModel.set("key_type",t),t):"column"==i&&n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(t=e("Partition key column cannot be empty."),this.errorModel.set("pt_column",t),t):"expression"==i&&n.isUndefined(a)||n.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(t=e("Partition key expression cannot be empty."),this.errorModel.set("expression",t),t):null}}),a.PartitionsModel=o.Node.Model.extend({idAttribute:"oid",defaults:{oid:void 0,is_attach:!1,partition_name:void 0,values_from:void 0,values_to:void 0,values_in:void 0,values_modulus:void 0,values_remainder:void 0},keys:["partition_name"],schema:[{id:"oid",label:e("OID"),type:"text"},{id:"is_attach",label:e("Operation"),cell:"switch",type:"switch",options:{onText:e("Attach"),offText:e("Create")},cellHeaderClasses:"width_percent_5",editable:function(e){return!(!(e instanceof i.Model&&e.isNew())||e.top.isNew())}},{id:"partition_name",label:e("Name"),type:"text",cell:"string",cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e instanceof i.Model&&e.isNew())},cellFunction:l},{id:"values_from",label:e("From"),type:"text",cell:r.Extension.StringDepCell,cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"range"===e.handler.top.attributes.partition_type&&e instanceof i.Model&&e.isNew())}},{id:"values_to",label:e("To"),type:"text",cell:r.Extension.StringDepCell,cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"range"===e.handler.top.attributes.partition_type&&e instanceof i.Model&&e.isNew())}},{id:"values_in",label:e("In"),type:"text",cell:r.Extension.StringDepCell,cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"list"===e.handler.top.attributes.partition_type&&e instanceof i.Model&&e.isNew())}},{id:"values_modulus",label:e("Modulus"),type:"int",cell:r.Extension.StringDepCell,cellHeaderClasses:"width_percent_15",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"hash"===e.handler.top.attributes.partition_type&&e instanceof i.Model&&e.isNew())}},{id:"values_remainder",label:e("Remainder"),type:"int",cell:r.Extension.StringDepCell,cellHeaderClasses:"width_percent_15 width_percent_20",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"hash"===e.handler.top.attributes.partition_type&&e instanceof i.Model&&e.isNew())}}],validate:function(){var t,i=this.get("partition_name"),o=this.get("values_from"),a=this.get("values_to"),r=this.get("values_in"),l=this.get("values_modulus"),s=this.get("values_remainder");if(this.errorModel.clear(),n.isUndefined(i)||n.isNull(i)||""===String(i).replace(/^\s+|\s+$/g,""))return t=e("Partition name cannot be empty."),this.errorModel.set("partition_name",t),t;if("range"===this.top.get("partition_type")){if(n.isUndefined(o)||n.isNull(o)||""===String(o).replace(/^\s+|\s+$/g,""))return t=e("For range partition From field cannot be empty."),this.errorModel.set("values_from",t),t;if(n.isUndefined(a)||n.isNull(a)||""===String(a).replace(/^\s+|\s+$/g,""))return t=e("For range partition To field cannot be empty."),this.errorModel.set("values_to",t),t}else if("list"===this.top.get("partition_type")){if(n.isUndefined(r)||n.isNull(r)||""===String(r).replace(/^\s+|\s+$/g,""))return t=e("For list partition In field cannot be empty."),this.errorModel.set("values_in",t),t}else if("hash"===this.top.get("partition_type")){if(n.isUndefined(l)||n.isNull(l)||""===String(l).replace(/^\s+|\s+$/g,""))return t=e("For hash partition Modulus field cannot be empty."),this.errorModel.set("values_modulus",t),t;if(n.isUndefined(s)||n.isNull(s)||""===String(s).replace(/^\s+|\s+$/g,""))return t=e("For hash partition Remainder field cannot be empty."),this.errorModel.set("values_remainder",t),t}return null}})}.apply(t,i))&&(e.exports=o)},,,,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e,t,n,i,o,r){var l="";return a.default.each(a.default.sortBy(a.default.pick(t,o),function(e){return e.priority}),function(e){l=l+"/"+encodeURI(e._id)}),l=r?l+"/"+r:l+"/",""+e+i+"/"+n+l}var o=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(o);e.exports={generate_url:i}},,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.browserTreeState=t.pgBrowser=void 0;var a=n(1),r=i(a),l=n(0),s=i(l),d=n(4),c=i(d),u=n(2),p=(i(u),n(3)),f=i(p),m=f.default.Browser=f.default.Browser||{},h=m.browserTreeState=m.browserTreeState||{};r.default.extend(m.browserTreeState,{parent:"server",orig_parent:"server_group",stored_state:{},last_state:{},current_state:{},init:function(){var e=m.get_preference("browser","browser_tree_state_save_interval");r.default.isUndefined(e)||-1===e.value?r.default.isUndefined(e)||s.default.ajax({url:(0,c.default)("settings.reset_tree_state"),type:"DELETE"}).fail(function(e){e.responseText;if(417==e.status||410==e.status||500==e.status)try{JSON.parse(e.responseText).errormsg}catch(e){}}):(setInterval(this.save_state,1e3*e.value),this.fetch_state.apply(this),m.Events.on("pgadmin:browser:tree:expand-from-previous-tree-state",this.expand_from_previous_state,this),m.Events.on("pgadmin:browser:tree:remove-from-tree-state",this.remove_from_cache,this),m.Events.on("pgadmin:browser:tree:update-tree-state",this.update_cache,this))},save_state:function(){var e=m.browserTreeState;e.last_state!=JSON.stringify(e.current_state)&&s.default.ajax({url:(0,c.default)("settings.save_tree_state"),type:"POST",contentType:"application/json",data:JSON.stringify(e.current_state)}).done(function(){e.last_state=JSON.stringify(e.current_state)}).fail(function(e){e.responseText;if(417==e.status||410==e.status||500==e.status)try{JSON.parse(e.responseText).errormsg}catch(e){}})},fetch_state:function(){var e=this;s.default.ajax({url:(0,c.default)("settings.get_tree_state"),type:"GET",dataType:"json",contentType:"application/json"}).done(function(t){e.stored_state=t}).fail(function(e){e.responseText;if(417==e.status||410==e.status||500==e.status)try{JSON.parse(e.responseText).errormsg}catch(e){}})},update_cache:function(e){var t=e&&m.tree.itemData(e),n=t&&m.Nodes[t._type],i=n.getTreeNodeHierarchy(e),o=void 0,a=m.tree.pathId(e),l=a.join(),s=[],d=-1;if(m.tree.hasParent(e)&&this.parent in i){if(o=i[this.parent]._id,m.tree.isOpen(e)){a.push(t.id),s=a.join(),o in this.current_state||(this.current_state[o]={paths:[],selected:{},conn_status:{},is_opened:{}});var c=r.default.find(this.current_state[o].paths,function(e){return-1!==e.search(s)});r.default.isUndefined(c)&&(r.default.isUndefined(this.current_state[o].paths)?this.current_state[o].paths=[]:d=this.current_state[o].paths.indexOf(l),-1!==d?this.current_state[o].paths[d]=s:this.current_state[o].paths.push(s))}this.update_database_status(e),this.update_current_selected_item(i)}},remove_from_cache:function(e){var t=this,n=t.stored_state||{},i=e&&m.tree.itemData(e),o=i&&m.Nodes[i._type],a=o&&o.getTreeNodeHierarchy(e);if(m.tree.hasParent(e)&&t.parent in a){var l=a&&a[t.parent]._id,s=a&&a[t.orig_parent].id;if(this.update_database_status(e),i._type==t.parent||"database"==i._type)return void(l in n&&"paths"in n[l]&&(n[l].paths=t.current_state[l].paths,t.save_state()));if(m.tree.isClosed(e)){var d=t.current_state[l].paths,c=void 0;if("database"in a&&(c=a.database.id),!r.default.isUndefined(d)&&!r.default.isUndefined(d.length)){var u=0,p=void 0;r.default.each(d,function(e){if(!r.default.isUndefined(e)){var n=e.split(",");if(-1!==n.indexOf(i.id)&&(void 0===c||void 0!==c&&-1!==n.indexOf(c))){var o=n.indexOf(i.id);n.splice(o),p=n.join(),p==s?t.current_state[l].paths.splice(e,1):t.current_state[l].paths[u]=p}u++}})}}}},expand_from_previous_state:function(e){var t=this,n=t.stored_state||{},i=e&&m.tree.itemData(e),a=i&&m.Nodes[i._type],l=a&&a.getTreeNodeHierarchy(e);if(m.tree.hasParent(e)&&t.parent in l&&(i._type!=t.parent||!1!==m.tree.isOpen(e))){var s=n[l[t.parent]._id];if(!("database"==i._type&&s&&"conn_status"in s&&"is_opened"in s)||0!==s.conn_status[i.id]&&0!==s.is_opened[i.id]&&i.id in s.is_opened){if(!r.default.isUndefined(s)&&"paths"in s&&!r.default.isUndefined(s.paths.length)){var d=[].concat(o(s.paths)),c=void 0;"database"in l&&(c=l.database.id),r.default.each(d,function(o){if(!r.default.isUndefined(o)){var a=o.split(",");if(-1!==a.indexOf(i.id)&&(void 0===c||void 0!==c&&-1!==a.indexOf(c))){var s=a.indexOf(i.id);if(m.tree.toggle(e),s==a.length-1){var d=n[l[t.parent]._id].paths.indexOf(o);n[l[t.parent]._id].paths.splice(d,1)}}}})}this.select_tree_item(e)}}},update_database_status:function(e){var t=e&&m.tree.itemData(e),n=t&&m.Nodes[t._type],i=n.getTreeNodeHierarchy(e);if("database"in i){var o=i.database.id,a=i&&i[this.parent]._id;a in this.current_state&&"selected"in this.current_state[a]&&(i.database.connected?this.current_state[a].conn_status[o]=1:this.current_state[a].conn_status[o]=0,"database"==t._type&&(m.tree.isOpen(e)?this.current_state[a].is_opened[o]=1:this.current_state[a].is_opened[o]=0))}},update_current_selected_item:function(e){if(this.parent in e){var t=e&&e[this.parent]._id,n=m.tree.itemData(m.tree.selected()),i=void 0;n=n?n.id:void 0,"database"in e&&(i=e.database.id),t in this.current_state&&"selected"in this.current_state[t]&&!r.default.isUndefined(n)&&(this.current_state[t].selected[e[this.parent].id]=n,r.default.isUndefined(i)||(this.current_state[t].selected[i]=n))}},select_tree_item:function(e){var t=this.stored_state||{},n=e&&m.tree.itemData(e),i=n&&m.Nodes[n._type],o=i&&i.getTreeNodeHierarchy(e),a=t[o[this.parent]._id];if("database"in o){var r=o.database.id;a&&"selected"in a&&r in a.selected&&a.selected[r]==n.id&&m.tree.select(e)}}}),t.pgBrowser=m,t.browserTreeState=h},,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.ModelValidation=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(2),l=i(r),s=n(1),d=i(s),c=n(256);t.ModelValidation=function(){function e(t){o(this,e),this.err={},this.errmsg="",this.model=t}return a(e,[{key:"validate",value:function(){var t=this.model.get("service");return!this.model.isNew()&&"id"in this.model.sessAttrs?(this.err.id=(0,l.default)("The ID cannot be changed."),this.errmsg=this.err.id):this.model.errorModel.unset("id"),this.checkForEmpty("name",(0,l.default)("Name must be specified.")),e.isEmptyString(t)?(this.setNullValueForEmptyString("service"),this.checkHostAndHostAddress(),this.checkForEmpty("db",(0,l.default)("Maintenance database must be specified."))):this.clearHostAddressAndDbErrors(),this.checkForEmpty("username",(0,l.default)("Username must be specified.")),this.checkForEmpty("port",(0,l.default)("Port must be specified.")),this.model.get("use_ssh_tunnel")&&(this.checkForEmpty("tunnel_host",(0,l.default)("SSH Tunnel host must be specified.")),this.checkForEmpty("tunnel_port",(0,l.default)("SSH Tunnel port must be specified.")),this.checkForEmpty("tunnel_username",(0,l.default)("SSH Tunnel username must be specified.")),this.model.get("tunnel_authentication")&&this.checkForEmpty("tunnel_identity_file",(0,l.default)("SSH Tunnel identity file must be specified."))),this.model.errorModel.set(this.err),d.default.size(this.err)?this.errmsg:null}},{key:"setNullValueForEmptyString",value:function(e){var t=this.model.get(e);d.default.isUndefined(t)||d.default.isNull(t)||""===String(t).trim()&&this.model.set(e,null)}},{key:"clearHostAddressAndDbErrors",value:function(){var e=this;d.default.each(["host","hostaddr","db"],function(t){e.setNullValueForEmptyString(t),e.model.errorModel.unset(t)})}},{key:"checkHostAndHostAddress",value:function(){var e=(0,l.default)("Either Host name, Address or Service must be specified.");this.checkForEmpty("host",e)&&this.checkForEmpty("hostaddr",e)?this.errmsg=this.errmsg||e:(this.errmsg=void 0,delete this.err.host,delete this.err.hostaddr),this.checkForValidIp(this.model.get("hostaddr"),(0,l.default)("Host address must be valid IPv4 or IPv6 address."))}},{key:"checkForValidIp",value:function(e,t){if(e){var n=new c.Address6(e).isValid();new c.Address4(e).isValid()||n||(this.err.hostaddr=t,this.errmsg=t)}else this.model.errorModel.unset("hostaddr")}},{key:"checkForEmpty",value:function(t,n){var i=this.model.get(t);return e.isEmptyString(i)?(this.err[t]=n,this.errmsg=this.errmsg||n,!0):(this.model.errorModel.unset(t),!1)}}],[{key:"isEmptyString",value:function(e){return d.default.isUndefined(e)||d.default.isNull(e)||""===String(e).trim()}}]),e}()},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(11),n(5),n(10),n(20),n(23),n(25),n(82),n(103),n(89)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d,c,u){if(r.UserManagement)return r.UserManagement;var p=t("user_management.users"),f=t("user_management.roles"),m=function(e){return new s.Extension.ClientSideFilter({collection:e,placeholder:i("Filter by email"),wait:150})};return r.UserManagement={init:function(){if(!this.initialized)return this.initialized=!0,this},change_password:function(n){var i=e("Change Password");a.ChangePassword||a.dialog("ChangePassword",function(){return{main:function(e,t){this.set({title:e,url:t})},build:function(){a.pgDialogBuild.apply(this)},settings:{url:void 0},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:e("Change Password"),url:t("help.static",{filename:"change_user_password.html"})}},{text:e("Close"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button",attrs:{name:"close",type:"button"}}],options:{padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,closable:!1}}},hooks:{onclose:function(){return setTimeout(function(){return a.ChangePassword().destroy()},500)}},prepare:function(){var e=document.createElement("iframe");e.frameBorder="no",e.width="100%",e.height="100%",e.src=this.setting("url"),this.elements.content.appendChild(e)},callback:function(e){if("dialog_help"==e.button.element.name)return e.cancel=!0,void r.showHelp(e.button.element.name,e.button.element.getAttribute("url"),null,null)}}}),a.ChangePassword(i,n).resizeTo(r.stdW.lg,r.stdH.md)},isPgaLoginRequired:function(e){return void 0===e.responseJSON&&void 0!==e.data?401===e.status&&e.data&&e.data.info&&"PGADMIN_LOGIN_REQUIRED"===e.data.info:401===e.status&&e.responseJSON&&e.responseJSON.info&&"PGADMIN_LOGIN_REQUIRED"===e.responseJSON.info},pgaLogin:function(n){var i=e("pgAdmin 4 login");n=n||t("security.login"),a.PgaLogin||a.dialog("PgaLogin",function(){return{main:function(e,t){this.set({title:e,url:t})},build:function(){a.pgDialogBuild.apply(this)},settings:{url:void 0},setup:function(){return{buttons:[{text:e("Close"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button",attrs:{name:"close",type:"button"}}],options:{padding:!1,overflow:!1,modal:!0,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,closable:!1}}},hooks:{onclose:function(){return setTimeout(function(){return a.PgaLogin().destroy()})}},prepare:function(){var e=this,t=document.createElement("iframe"),n=this.setting("url");t.onload=function(){-1==(this.contentDocument||this.contentWindow.document).location.href.indexOf(n)&&(this.contentWindow.stop(),this.onload=null,e.close(),r.Events.trigger("pgadmin:user:logged-in"))},t.frameBorder="no",t.width="100%",t.height="100%",t.src=n,e.elements.content.appendChild(t)}}}),a.PgaLogin(i,n).resizeTo(r.stdW.md,r.stdH.md)},show_users:function(){if(u.is_admin){var c=[],h=r.Node.Model.extend({idAttribute:"id",urlRoot:p,defaults:{id:void 0,email:void 0,active:!0,role:void 0,newPassword:void 0,confirmPassword:void 0},schema:[{id:"email",label:e("Email"),type:"text",cell:s.Extension.StringDepCell,cellHeaderClasses:"width_percent_30",deps:["id"],editable:function(e){return!(e instanceof l.Collection)&&!!e.isNew()}},{id:"role",label:e("Role"),type:"text",control:"Select2",cellHeaderClasses:"width_percent_20",cell:"select2",select2:{allowClear:!1,openOnEnter:!1},options:function(e){var t=[];return e instanceof d.Control?i.each(c,function(e){t.push({label:e.name,value:e.id.toString()})}):i.each(c,function(e){t.push([e.name,e.id.toString()])}),t},editable:function(e){return e instanceof l.Collection||e.get("id")!=u.id}},{id:"active",label:e("Active"),type:"switch",cell:"switch",cellHeaderClasses:"width_percent_10",editable:function(e){return e instanceof l.Collection||e.get("id")!=u.id}},{id:"newPassword",label:e("New password"),type:"password",disabled:!1,control:"input",cell:"password",cellHeaderClasses:"width_percent_20"},{id:"confirmPassword",label:e("Confirm password"),type:"password",disabled:!1,control:"input",cell:"password",cellHeaderClasses:"width_percent_20"}],validate:function(){var t=null,n=this.changed||{},a=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;if(("email"in n||!this.isNew())&&(i.isUndefined(this.get("email"))||i.isNull(this.get("email"))||""==String(this.get("email")).replace(/^\s+|\s+$/g,"")))return t=e("Email address cannot be empty."),this.errorModel.set("email",t),t;if(this.get("email")&&!a.test(this.get("email")))return t=o(e("Invalid email address: %s.")).sprintf(this.get("email")).value(),this.errorModel.set("email",t),t;if(this.get("email")&&this.collection.where({email:this.get("email")}).length>1)return t=o(e("The email address %s already exists.")).sprintf(this.get("email")).value(),this.errorModel.set("email",t),t;if(this.errorModel.unset("email"),"role"in n&&(i.isUndefined(this.get("role"))||i.isNull(this.get("role"))||""==String(this.get("role")).replace(/^\s+|\s+$/g,"")))return t=o(e("Role cannot be empty for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("role",t),t;if(this.errorModel.unset("role"),this.isNew()){if("newPassword"in n&&(i.isUndefined(this.get("newPassword"))||i.isNull(this.get("newPassword"))||""==this.get("newPassword")))return t=o(e("Password cannot be empty for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("newPassword",t),t;if(!i.isUndefined(this.get("newPassword"))&&!i.isNull(this.get("newPassword"))&&this.get("newPassword").length<6)return t=o(e("Password must be at least 6 characters for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("newPassword",t),t;if(this.errorModel.unset("newPassword"),"confirmPassword"in n&&(i.isUndefined(this.get("confirmPassword"))||i.isNull(this.get("confirmPassword"))||""==this.get("confirmPassword")))return t=o(e("Confirm Password cannot be empty for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("confirmPassword",t),t;if(this.errorModel.unset("confirmPassword"),this.get("newPassword")&&this.get("confirmPassword")&&this.get("newPassword")!=this.get("confirmPassword"))return t=o(e("Passwords do not match for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("confirmPassword",t),t;this.errorModel.unset("confirmPassword")}else if((i.isUndefined(this.get("newPassword"))||i.isNull(this.get("newPassword"))||""==this.get("newPassword"))&&(i.isUndefined(this.get("confirmPassword"))||i.isNull(this.get("confirmPassword"))||""==this.get("confirmPassword")))this.errorModel.unset("newPassword"),""==this.get("newPassword")&&this.set({newPassword:void 0}),this.errorModel.unset("confirmPassword"),""==this.get("confirmPassword")&&this.set({confirmPassword:void 0});else{if(!i.isUndefined(this.get("newPassword"))&&!i.isNull(this.get("newPassword"))&&""==!this.get("newPassword")&&this.get("newPassword").length<6)return t=o(e("Password must be at least 6 characters for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("newPassword",t),t;if(i.isUndefined(this.get("confirmPassword"))||i.isNull(this.get("confirmPassword"))||""==this.get("confirmPassword"))return t=o(e("Confirm Password cannot be empty for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("confirmPassword",t),t;if(this.get("newPassword")&&this.get("confirmPassword")&&this.get("newPassword")!=this.get("confirmPassword"))return t=o(e("Passwords do not match for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("confirmPassword",t),t;this.errorModel.unset("newPassword"),this.errorModel.unset("confirmPassword")}return null}}),g=d.generateGridColumnsFromModel(null,h,"edit"),b=s.Extension.DeleteCell.extend({deleteRow:function(t){var n=this;if(t.preventDefault(),n.model.get("id")==u.id)return a.alert(e("Cannot delete user."),e("Cannot delete currently logged in user."),function(){return!0}),!0;!i.isUndefined(this.column.get("canDeleteRow"))&&i.isFunction(this.column.get("canDeleteRow"))&&!s.callByNeed(this.column.get("canDeleteRow"),this.column,this.model)?a.alert(e("Error"),e("This user cannot be deleted."),function(){return!0}):n.model.isNew()?n.model.destroy():a.confirm(e("Delete user?"),e("Are you sure you wish to delete this user?"),function(){n.model.destroy({wait:!0,success:function(){a.success(e("User deleted."))},error:function(){a.error(e("Error during deleting user."))}})},function(){return!0})}});g.columns.unshift({name:"pg-backform-delete",label:"",cell:b,editable:!1,cell_priority:-1,canDeleteRow:!0}),a.UserManagement||a.dialog("UserManagement",function(){return{main:function(e){this.set("title",e)},build:function(){a.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:e("Users"),url:t("help.static",{filename:"pgadmin_user.html"})}},{text:e("Close"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button user_management_pg-alertify-button",attrs:{name:"close",type:"button"}}],options:{title:e("User Management"),padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,closable:!1}}},hooks:{onclose:function(){this.view&&(this.view.remove({data:!0,internal:!0,silent:!0}),this.$content.remove())}},prepare:function(){var t=i.template(['<div class="pg-prop-footer" style="visibility:hidden;">',' <div class="pg-prop-status-bar">','    <div class="error-in-footer"> ','      <div class="d-flex px-2 py-1"> ','        <div class="pr-2"> ','          <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i> ',"        </div> ",'        <div class="alert-text"></div> ','        <div class="ml-auto close-error-bar"> ','          <a class="close-error fa fa-times text-danger"></a> ',"        </div> ","      </div> ","    </div> "," </div>","</div>"].join("\n")),r=n(t()),d=s.Row.extend({userInvalidClass:"bg-user-invalid",initialize:function(){s.Row.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"pgadmin:user:invalid",this.userInvalid),this.listenTo(this.model,"pgadmin:user:valid",this.userValid)},userInvalid:function(){n(this.el).removeClass("new"),n(this.el).addClass(this.userInvalidClass)},userValid:function(){n(this.el).removeClass(this.userInvalidClass)}}),u=l.Collection.extend({model:h,url:p,initialize:function(){l.Collection.prototype.initialize.apply(this,arguments);var e=this;e.changedUser=null,e.invalidUsers={},e.on("add",e.onModelAdd),e.on("remove",e.onModelRemove),e.on("pgadmin-session:model:invalid",function(t,n){e.invalidUsers[n.cid]=t,n.trigger("pgadmin:user:invalid",n),r.find(".alert-text").html(t),r.css("visibility","visible")}),e.on("pgadmin-session:model:valid",function(t){delete e.invalidUsers[t.cid],t.trigger("pgadmin:user:valid",t),this.updateErrorMsg(),this.saveUser(t)})},onModelAdd:function(e){e.startNewSession()},onModelRemove:function(e){delete this.invalidUsers[e.cid],this.updateErrorMsg()},updateErrorMsg:function(){var e=this,t=null;for(var n in e.invalidUsers)if(t=e.invalidUsers[n])break;t?(r.find(".alert-text").html(t),r.css("visibility","visible")):(r.find(".alert-text").empty(),r.css("visibility","hidden"))},saveUser:function(t){var n=t.toJSON(!0);return!(t.isNew()&&!(t.get("email")&&t.get("role")&&t.get("newPassword")&&t.get("confirmPassword")&&t.get("newPassword")==t.get("confirmPassword")))&&(!(!t.isNew()&&t.get("newPassword")!=t.get("confirmPassword"))&&void(t.sessChanged()&&n&&!i.isEmpty(n)&&(t.stopSession(),t.save({},{attrs:n,wait:!0,success:function(){t.set({newPassword:void 0,confirmPassword:void 0}),t.startNewSession(),a.success(o(e("User '%s' saved.")).sprintf(t.get("email")).value())},error:function(n,i){t.startNewSession(),a.error(o(e("Error saving user: '%s'")).sprintf(i.responseJSON.errormsg).value())}}))))}}),b=this.userCollection=new u,_=i.template('<div class="navtab-inline-controls">\n                    <div class="input-group">\n                      <div class="input-group-prepend">\n                        <span class="input-group-text fa fa-search" id="labelSearch"></span>\n                        </div>\n                          <input type="search" class="form-control" id="txtGridSearch" placeholder="Search" aria-label="Search" aria-describedby="labelSearch" />\n                        </div>\n                        <button id="btn_refresh" type="button" class="btn btn-secondary btn-navtab-inline add" title="Add">\n                          <span class="fa fa-plus "></span>\n                        </button>\n                      </div>\n                    </div>\n                  </div>'),v={canAdd:!0,add_title:e("Add new user")},y=n("<div></div>",{class:"user_container"});n.ajax({url:f,method:"GET",async:!1}).done(function(e){c=e}).fail(function(){setTimeout(function(){a.alert(e("Error"),e("Cannot load user roles."))},100)});var w=this.view=new s.Grid({row:d,columns:g.columns,collection:b,className:"backgrid table table-bordered table-noouter-border table-hover"});y.append(w.render().$el[0]),this.$content=n("<div class='user_management object subnode subnode-noouter-border'></div>").append(_(v)).append(y).append(r),this.elements.content.appendChild(this.$content[0]),m(b).setCustomSearchBox(n("#txtGridSearch")),b.fetch(),this.$content.find("a.close-error").on("click",function(){r.find(".alert-text").empty(),r.css("visibility","hidden")}),this.$content.find("button.add").first().on("click",function(e){e.preventDefault();var t=!1,i=null;b.each(function(e){t||(t=e.isNew(),i=e)});var o;if(t){o=b.indexOf(i);var a=w.body.rows[o].$el;return a.addClass("new"),n(a).pgMakeVisible("backform-tab"),!1}n(w.body.$el.find(n("tr.new"))).removeClass("new");var r=new h(null,{handler:b,top:b,collection:b});b.add(r),o=b.indexOf(r);var l=w.body.rows[o].$el;return l.addClass("new"),n(l).pgMakeVisible("backform-tab"),!1})},callback:function(t){if("dialog_help"==t.button.element.name)return t.cancel=!0,void r.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null);if("close"==t.button.element.name){var n=this;i.all(this.userCollection.pluck("id"))&&i.isEmpty(this.userCollection.invalidUsers)||(t.cancel=!0,a.confirm(e("Discard unsaved changes?"),e("Are you sure you want to close the dialog? Any unsaved changes will be lost."),function(){return n.close(),!0},function(){return!0}))}}}}),a.UserManagement(!0).resizeTo(r.stdW.md,r.stdH.md)}}},r.UserManagement}.apply(t,i))&&(e.exports=o)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i,o;i=[n(0),n(1),n(8)],void 0!==(o=function(e,t,n){return function(e,i){if(t.isUndefined(i)||t.isNull(i))return!0;n.startsWith(i,"coll-")&&(i=i.replace("coll-",""));var o=["server_group","server","catalog_object_column"];if(t.indexOf(o,i)>=0)return!0;var a=e.get_preference("browser","show_node_"+i);return!a||a.value}}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";(function(e){function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.pgBrowser=void 0;var a=n(3),r=o(a),l=n(4),s=o(l),d=n(52),c=i(d),u=n(0),p=o(u),f=n(11),m=i(f),h=n(30),g=i(h),b=r.default.Browser=r.default.Browser||{};e.extend(b,{preferences_cache:[],prefcache_version:0,generate_preference_version:function(){return(new Date).getTime()},preference_version:function(e){if(!e)return this.prefcache_version;this.prefcache_version=e},get_preference:function(t,n){var i=this;if(0!=e.size(i.preferences_cache))return e.findWhere(i.preferences_cache,{module:t,name:n});var o=function(){if(i.preferences_cache.length>0)return clearInterval(a),e.findWhere(i.preferences_cache,{module:t,name:n})},a=setInterval(o,1e3)},get_preferences_for_module:function(t){var n=this,i={};if(e.each(e.where(n.preferences_cache,{module:t}),function(e){i[e.name]=e.value}),Object.keys(i).length>0)return i},get_preference_for_id:function(t){var n=this;return e.findWhere(n.preferences_cache,{id:t})},cache_preferences:function(t){var n=this;setTimeout(function(){p.default.ajax({url:(0,s.default)("preferences.get_all")}).done(function(i){n.preferences_cache=i,n.preference_version(n.generate_preference_version()),b.keyboardNavigation.init(),b.tree&&(c.modifyAcitreeAnimation(n),c.modifyAlertifyAnimation(n)),b.browserTreeState.init(),t&&("string"==typeof t?p.default.event.trigger("prefchange:"+t):e.each(t,function(e,t){p.default.event.trigger("prefchange:"+t)}))}).fail(function(e,t,n){m.pgRespErrorNotify(e,n)})},500)},reflectPreferences:function(e){var t=this;if("sqleditor"===e||null===e||void 0===e){var n=t.get_preferences_for_module("sqleditor");(0,p.default)(t.editor.getWrapperElement()).css("font-size",g.calcFontSize(n.sql_font_size)),t.editor.setOption("tabSize",n.tab_size),t.editor.setOption("lineWrapping",n.wrap_code),t.editor.setOption("autoCloseBrackets",n.insert_pair_brackets),t.editor.setOption("matchBrackets",n.brace_matching),t.editor.refresh()}},onPreferencesChange:function(e,t){window.parent.$(parent.document).on("prefchange:"+e,function(e){null===window.top?window.$(document).off(e):t(e)})}}),t.pgBrowser=b}).call(t,n(1))},function(e,t){e.exports=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(1),a=i(o),r=n(3),l=i(r),s=n(0),d=i(s),c=n(58),u=i(c),p=n(18),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(p),m=n(77),h=i(m),g=n(34),b=i(g),_=l.default.Browser=l.default.Browser||{};_.keyboardNavigation=_.keyboardNavigation||{},a.default.extend(_.keyboardNavigation,{init:function(){u.default.reset(),_.preferences_cache.length>0&&(this.keyboardShortcut={file_shortcut:f.parseShortcutValue(_.get_preference("browser","main_menu_file").value),object_shortcut:f.parseShortcutValue(_.get_preference("browser","main_menu_object").value),tools_shortcut:f.parseShortcutValue(_.get_preference("browser","main_menu_tools").value),help_shortcut:f.parseShortcutValue(_.get_preference("browser","main_menu_help").value),left_tree_shortcut:f.parseShortcutValue(_.get_preference("browser","browser_tree").value),tabbed_panel_backward:f.parseShortcutValue(_.get_preference("browser","tabbed_panel_backward").value),tabbed_panel_forward:f.parseShortcutValue(_.get_preference("browser","tabbed_panel_forward").value),sub_menu_query_tool:f.parseShortcutValue(_.get_preference("browser","sub_menu_query_tool").value),sub_menu_view_data:f.parseShortcutValue(_.get_preference("browser","sub_menu_view_data").value),sub_menu_properties:f.parseShortcutValue(_.get_preference("browser","sub_menu_properties").value),sub_menu_create:f.parseShortcutValue(_.get_preference("browser","sub_menu_create").value),sub_menu_delete:f.parseShortcutValue(_.get_preference("browser","sub_menu_delete").value),sub_menu_refresh:f.parseShortcutValue(_.get_preference("browser","sub_menu_refresh").value),context_menu:f.parseShortcutValue(_.get_preference("browser","context_menu").value),direct_debugging:f.parseShortcutValue(_.get_preference("browser","direct_debugging").value),drop_multiple_objects:f.parseShortcutValue(_.get_preference("browser","grid_menu_drop_multiple").value),drop_cascade_multiple_objects:f.parseShortcutValue(_.get_preference("browser","grid_menu_drop_cascade_multiple").value)},this.shortcutMethods={bindMainMenu:{shortcuts:[this.keyboardShortcut.file_shortcut,this.keyboardShortcut.object_shortcut,this.keyboardShortcut.tools_shortcut,this.keyboardShortcut.help_shortcut]},bindRightPanel:{shortcuts:[this.keyboardShortcut.tabbed_panel_backward,this.keyboardShortcut.tabbed_panel_forward]},bindLeftTree:{shortcuts:this.keyboardShortcut.left_tree_shortcut},bindSubMenuQueryTool:{shortcuts:this.keyboardShortcut.sub_menu_query_tool},bindSubMenuViewData:{shortcuts:this.keyboardShortcut.sub_menu_view_data},bindSubMenuProperties:{shortcuts:this.keyboardShortcut.sub_menu_properties},bindSubMenuCreate:{shortcuts:this.keyboardShortcut.sub_menu_create},bindSubMenuDelete:{shortcuts:this.keyboardShortcut.sub_menu_delete},bindSubMenuRefresh:{shortcuts:this.keyboardShortcut.sub_menu_refresh,bindElem:"#tree"},bindContextMenu:{shortcuts:this.keyboardShortcut.context_menu},bindDirectDebugging:{shortcuts:this.keyboardShortcut.direct_debugging},bindDropMultipleObjects:{shortcuts:this.keyboardShortcut.drop_multiple_objects},bindDropCascadeMultipleObjects:{shortcuts:this.keyboardShortcut.drop_cascade_multiple_objects}},this.bindShortcuts())},bindShortcuts:function(){var e=this;a.default.each(e.shortcutMethods,function(t,n){e._bindWithMousetrap(t.shortcuts,e[n],t.bindElem)});(0,d.default)(".pg-navbar").on("keydown",function(t){switch(t.keyCode){case 37:e.bindMainMenuLeft(t);break;case 38:e.bindMainMenuUpDown(t,"up");break;case 39:e.bindMainMenuRight(t);break;case 40:e.bindMainMenuUpDown(t,"down")}})},_bindWithMousetrap:function(e,t,n){var i=this;if(u.default.unbind(e),n){var o=document.querySelector(n);(0,u.default)(o).bind(e,function(){t.apply(this,arguments)}.bind(o))}else u.default.bind(e,function(){t.apply(i,arguments)})},unbindShortcuts:function(){var e=this;a.default.each(e.mousetrapInstances,function(e){e.instance.reset()}),e.mousetrapInstances=[]},bindMainMenu:function(e,t){var n=this.keyboardShortcut;t===n.file_shortcut&&(0,d.default)("#mnu_file a.dropdown-toggle").dropdown("toggle"),t===n.object_shortcut&&(0,d.default)("#mnu_obj a.dropdown-toggle").first().dropdown("toggle"),t===n.tools_shortcut&&(0,d.default)("#mnu_tools a.dropdown-toggle").dropdown("toggle"),t===n.help_shortcut&&(0,d.default)("#mnu_help a.dropdown-toggle").dropdown("toggle")},bindRightPanel:function(e,t){var n=l.default.Browser.docker.findPanels(),i=0,o=n.length,r=0,s=!1,d=this.keyboardShortcut;a.default.each(l.default.Browser.docker.findPanels(),function(e,t){e.isVisible()&&!s&&"browser"!==e._type&&(r=t,s=!0)}),t===d.tabbed_panel_backward?i=r>0?r-1:1:t===d.tabbed_panel_forward&&(i=r<o?r+1:o),l.default.Browser.docker.findPanels()[i].focus(),setTimeout(function(){document.activeElement instanceof HTMLIFrameElement&&document.activeElement.blur()},1e3)},bindMainMenuLeft:function(e){if((0,d.default)(e.target).hasClass("nav-link")){var t=(0,d.default)(e.target).closest(".nav-item");for(b.default._stopEventPropagation(e),t=t.prev(".nav-item");t.hasClass("d-none");)t=t.prev(".nav-item");t.find(".dropdown-toggle").first().dropdown("toggle")}else if((0,d.default)(e.target).closest(".dropdown-menu").length>0){var n=(0,d.default)(e.target).closest("li");b.default._stopEventPropagation(e);var i=n.closest(".dropdown-menu");i.closest(".dropdown-submenu").length>0&&(i.removeClass("show"),i.closest(".dropdown-submenu").removeClass("dropdown-submenu-visible"),n=i.closest(".dropdown-submenu"),n.find(".dropdown-item").trigger("focus"))}},bindMainMenuRight:function(e){if((0,d.default)(e.target).hasClass("nav-link")){var t=(0,d.default)(e.target).closest(".nav-item");for(b.default._stopEventPropagation(e),t=t.next(".nav-item");t.hasClass("d-none");)t=t.next(".nav-item");t.find(".dropdown-toggle").first().dropdown("toggle")}else if((0,d.default)(e.target).closest(".dropdown-menu").length>0){var n=(0,d.default)(e.target).closest("li");b.default._stopEventPropagation(e),n.hasClass("dropdown-submenu")&&(n.addClass("dropdown-submenu-visible"),n.find(".dropdown-menu").addClass("show"),n=n.find(".dropdown-menu .dropdown-item").first().trigger("focus"))}},bindMainMenuUpDown:function(e,t){if((0,d.default)(e.target).closest(".dropdown-menu").length>0){b.default._stopEventPropagation(e);var n=(0,d.default)(e.target).closest("li"),i=(0,d.default)(e.target).closest(".dropdown-menu");for(i.find(".show").removeClass("show"),i.find(".dropdown-submenu").removeClass("dropdown-submenu-visible"),"up"===t?n=n.prev():"down"===t&&(n=n.next());n.hasClass("dropdown-divider")||n.find(".dropdown-item").first().hasClass("disabled");)"up"===t?n=n.prev():"down"===t&&(n=n.next());n.find(".dropdown-item").trigger("focus")}},bindLeftTree:function(){var e=this.getTreeDetails();(0,d.default)("#tree").trigger("focus"),e.t.focus(e.i),e.t.select(e.i)},bindSubMenuQueryTool:function(){var e=this.getTreeDetails();e.d&&l.default.DataGrid.show_query_tool("",e.i)},bindSubMenuViewData:function(){var e=this.getTreeDetails();e.d&&l.default.DataGrid.show_data_grid({mnuid:1},e.i)},bindSubMenuProperties:function(){var e=this.getTreeDetails();e.d&&!0!==l.default.Browser.Nodes[e.t.itemData(e.i)._type].collection_node&&l.default.Browser.Node.callbacks.show_obj_properties.call(l.default.Browser.Nodes[e.t.itemData(e.i)._type],{action:"edit"})},bindSubMenuCreate:function(){var e=this.getTreeDetails();e.d&&!0!==l.default.Browser.Nodes[e.t.itemData(e.i)._type].collection_node&&l.default.Browser.Node.callbacks.show_obj_properties.call(l.default.Browser.Nodes[e.t.itemData(e.i)._type],{action:"create"})},bindSubMenuDelete:function(){var e=this.getTreeDetails();e.d&&!0!==l.default.Browser.Nodes[e.t.itemData(e.i)._type].collection_node&&l.default.Browser.Node.callbacks.delete_obj.call(l.default.Browser.Nodes[e.t.itemData(e.i)._type])},bindSubMenuRefresh:function(e){e.preventDefault();var t=_.keyboardNavigation.getTreeDetails();l.default.Browser.Node.callbacks.refresh.call(l.default.Browser.Nodes[t.t.itemData(t.i)._type])},bindContextMenu:function(e){var t=this.getTreeDetails(),n=(0,d.default)(e.srcElement).find(".aciTreeEntry").position().left+70,i=(0,d.default)(e.srcElement).find(".aciTreeEntry").position().top+70;t.t.blur(t.i),(0,d.default)("#tree").trigger("blur"),t.i.children().contextMenu({x:n,y:i})},bindDirectDebugging:function(){var e=this.getTreeDetails(),t=e.t.itemData(e.i)._type;!e.d||"function"!==t&&"procedure"!==t||l.default.Tools.Debugger.can_debug(e.d,e.i,{debug_type:"direct"})&&l.default.Tools.Debugger.get_function_information(l.default.Browser.Nodes[t])},bindDropMultipleObjects:function(){!0===this.isPropertyPanelVisible()&&(0,d.default)("button.delete_multiple").length>0&&(0,d.default)("button.delete_multiple").click()},bindDropCascadeMultipleObjects:function(){!0===this.isPropertyPanelVisible()&&(0,d.default)("button.delete_multiple_cascade").length>0&&(0,d.default)("button.delete_multiple_cascade").click()},isPropertyPanelVisible:function(){var e=!1;return a.default.each(l.default.Browser.docker.findPanels(),function(t){"properties"===t._type&&(e=t.isVisible())}),e},getTreeDetails:function(){var e=l.default.Browser.tree,t=e.selected().length>0?e.selected():e.first();return{t:e,i:t,d:t&&1===t.length?e.itemData(t):void 0}},getDialogTabNavigator:function(e){var t=_.get_preference("browser","dialog_tab_backward").value,n=_.get_preference("browser","dialog_tab_forward").value;return new h.default.dialogTabNavigator(e,t,n)}}),e.exports=l.default.Browser.keyboardNavigation},,,,,function(e,t,n){"use strict";var i,o,a=a||{};a.dashboard=n(171);var a=a||{};a.tools={},a.tools.user_management=n(108);var a=a||{};a.browser={},a.browser.object_statistics=n(175);var a=a||{};a.browser={},a.browser.dependencies=n(178);var a=a||{};a.browser={},a.browser.dependents=n(179);var a=a||{};a.browser={},a.browser.object_sql=n(180);var a=a||{};a.browser={},a.browser.bgprocess=n(181);var a=a||{};a.node={},a.node.server_group=n(182);var a=a||{};a.node={},a.node.server=n(81);var a=a||{};a.node={},a.node.database=n(183);var a=a||{};a.node={},a.node.role=n(184);var a=a||{};a.node={},a.node.cast=n(185);var a=a||{};a.node={},a.node.tablespace=n(186);var a=a||{};a.node={},a.node.resource_group=n(187);var a=a||{};a.node={},a.node.event_trigger=n(188);var a=a||{};a.node={},a.node.extension=n(189);var a=a||{};a.node={},a.node.language=n(190);var a=a||{};a.node={},a.node.foreign_data_wrapper=n(191);var a=a||{};a.node={},a.node.foreign_server=n(192);var a=a||{};a.node={},a.node.user_mapping=n(193);var a=a||{};a.node={},a.node.schema=n(194);var a=a||{};a.node={},a.node.catalog=n(195);var a=a||{};a.node={},a.node.catalog_object=n(196);var a=a||{};a.node={},a.node.collation=n(197);var a=a||{};a.node={},a.node.domain=n(198);var a=a||{};a.node={},a.node.domain_constraints=n(199);var a=a||{};a.node={},a.node.foreign_table=n(200);var a=a||{};a.node={},a.node.fts_configuration=n(201);var a=a||{};a.node={},a.node.fts_dictionary=n(202);var a=a||{};a.node={},a.node.fts_parser=n(203);var a=a||{};a.node={},a.node.fts_template=n(204);var a=a||{};a.node={},a.node.function=n(83);var a=a||{};a.node={},a.node.procedure=n(205);var a=a||{};a.node={},a.node.edbfunc=n(84);var a=a||{};a.node={},a.node.edbproc=n(206);var a=a||{};a.node={},a.node.edbvar=n(207);var a=a||{};a.node={},a.node.trigger_function=n(208);var a=a||{};a.node={},a.node.package=n(209);var a=a||{};a.node={},a.node.sequence=n(210);var a=a||{};a.node={},a.node.synonym=n(211);var a=a||{};a.node={},a.node.type=n(212);var a=a||{};a.node={},a.node.rule=n(85);var a=a||{};a.node={},a.node.index=n(213);var a=a||{};a.node={},a.node.trigger=n(214);var a=a||{};a.node={},a.node.catalog_object_column=n(215);var a=a||{};a.node={},a.node.view=n(216);var a=a||{};a.node={},a.node.mview=n(217);var a=a||{};a.node={},a.node.table=n(218);var a=a||{};a.node={},a.node.partition=n(228),i=[n(2),n(4),n(0),n(1),n(11),n(3),n(29),n(30),n(10),n(229),n(230),n(231),n(75),n(24)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d,c,u,p){var f=window.wcDocker,m=a.Browser,h=r.default;return a.DataGrid?a.DataGrid:(a.DataGrid=i.extend({init:function(){if(!this.initialized){this.initialized=!0,this.title_index=1;var t=this,n=setInterval(function(){m.preference_version()>0&&(t.preferences=m.get_preferences_for_module("sqleditor"),clearInterval(n))},0);m.onPreferencesChange("sqleditor",function(){t.preferences=m.get_preferences_for_module("sqleditor")}),this.spinner_el='<div class="pg-sp-container">\n              <div class="pg-sp-content">\n                  <div class="row">\n                      <div class="col-12 pg-sp-icon"></div>\n                  </div>\n              </div>\n          </div>';for(var o=["table","view","mview","foreign_table","catalog_object","partition"],r=function(t){var n=function(){return!i.isUndefined(t)&&!i.isNull(t)&&-1!==i.indexOf(o,t._type)}();return p.enable(e("View Data"),n),p.enable(e("Filtered Rows"),n),n},l=function(t){var n=function(){return!i.isUndefined(t)&&!i.isNull(t)&&(-1==i.indexOf(a.unsupported_nodes,t._type)&&(!("database"!=t._type||!t.allowConn)||"database"!=t._type))}();return p.enable(e("Query Tool"),n),n},s=[{name:"query_tool",module:this,applies:["tools"],callback:"show_query_tool",enable:l,priority:1,label:e("Query Tool"),icon:"fa fa-bolt"}],d=0;d<o.length;d++)s.push({name:"view_all_rows_context_"+o[d],node:o[d],module:this,data:{mnuid:3},applies:["context","object"],callback:"show_data_grid",enable:r,category:"view_data",priority:101,label:e("All Rows")},{name:"view_first_100_rows_context_"+o[d],node:o[d],module:this,data:{mnuid:1},applies:["context","object"],callback:"show_data_grid",enable:r,category:"view_data",priority:102,label:e("First 100 Rows")},{name:"view_last_100_rows_context_"+o[d],node:o[d],module:this,data:{mnuid:2},applies:["context","object"],callback:"show_data_grid",enable:r,category:"view_data",priority:103,label:e("Last 100 Rows")},{name:"view_filtered_rows_context_"+o[d],node:o[d],module:this,data:{mnuid:4},applies:["context","object"],callback:"show_filtered_row",enable:r,category:"view_data",priority:104,label:e("Filtered Rows...")});a.Browser.add_menu_category("view_data",e("View/Edit Data"),100,""),a.Browser.add_menus(s);new a.Browser.Frame({name:"frm_datagrid",showTitle:!0,isCloseable:!0,isPrivate:!0,url:"about:blank"}).load(m.docker),this.on("pgadmin-datagrid:transaction:created",function(e){this.launch_grid(e)})}},show_data_grid:function(e,t){d.showDataGrid(this,m,o,e,t)},show_filtered_row:function(i,r){var s=this,c=a.Browser.tree.itemData(r);if(void 0===c)return void o.alert(e("Data Grid Error"),e("No object selected."));var u=m.Nodes[c._type],p=u.getTreeNodeHierarchy(r);if(void 0!==p.server&&void 0!==p.database&&(void 0!==p.schema||void 0!==p.view||void 0!==p.catalog)){var f=d.retrieveNameSpaceName(p),g={cmd_type:i.mnuid,obj_type:c._type,sgid:p.server_group._id,sid:p.server._id,did:p.database._id,obj_id:c._id},b=t("datagrid.initialize_datagrid",g),_=t("datagrid.filter_validate",{sid:g.sid,did:g.did,obj_id:g.obj_id}),v=d.generateDatagridTitle(p,f,c);o.filterDialog||o.dialog("filterDialog",function(){return{main:function(e,t,n,i){this.set("title",e),this.message=t,this.baseUrl=n,this.validateUrl=i},setup:function(){return{buttons:[{text:e("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button"},{text:e("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button"}],options:{modal:0,resizable:!0,maximizable:!1,pinnable:!1,autoReset:!1}}},build:function(){o.pgDialogBuild.apply(this)},prepare:function(){var e=this,t=n(this.message),i=t.find("#sql_filter");n(this.elements.header).attr("data-title",this.get("title")),n(this.elements.body.childNodes[0]).addClass("dataview_filter_dialog"),this.setContent(t.get(0)),e.__internal.buttons[1].element.disabled=!0,this.filter_obj=h.fromTextArea(i.get(0),{lineNumbers:!0,mode:"text/x-pgsql",extraKeys:m.editor_shortcut_keys,indentWithTabs:!s.preferences.use_spaces,indentUnit:s.preferences.tab_size,tabSize:s.preferences.tab_size,lineWrapping:s.preferences.wrap_code,autoCloseBrackets:s.preferences.insert_pair_brackets,matchBrackets:s.preferences.brace_matching});var o=l.calcFontSize(s.preferences.sql_font_size);n(this.filter_obj.getWrapperElement()).css("font-size",o),setTimeout(function(){e.filter_obj.refresh(),e.filter_obj.focus()},500),e.filter_obj.on("change",function(){""!==e.filter_obj.getValue()?e.__internal.buttons[1].element.disabled=!1:e.__internal.buttons[1].element.disabled=!0})},callback:function(t){if(t.button.text==e("OK")){var i=this.filter_obj.getValue(),a=this;t.cancel=!0,n.ajax({url:a.validateUrl,method:"POST",async:!1,contentType:"application/json",data:JSON.stringify(i)}).done(function(t){t.data.status?(s.create_transaction(a.baseUrl,null,"false",p.server.server_type,"",v,i,!1),a.close()):o.alert(e("Validation Error"),t.data.result)}).fail(function(t){o.alert(e("Validation Error"),t)})}}}}),n.get(t("datagrid.filter"),function(e){o.filterDialog("Data Filter",e,b,_).resizeTo(m.stdW.sm,m.stdH.sm)})}},get_panel_title:function(){return c.getPanelTitle(m)},show_query_tool:function(e,t,n){u.showQueryTool(this,m,o,e,t,n)},create_transaction:function(t,i,a,r,l,s,d,c){var u=this;i=i||u,c&&(t+="?recreate=1");var p=null;""!=d&&(p=JSON.stringify(d)),n.ajax({url:t,method:"POST",dataType:"json",data:p,contentType:"application/json"}).done(function(e){e.data.is_query_tool=a,e.data.server_type=r,e.data.sURL=l,e.data.panel_title=s,i.trigger("pgadmin-datagrid:transaction:created",e.data)}).fail(function(t){if(i!==u&&503==t.status&&void 0!=t.responseJSON.info&&"CONNECTION_LOST"==t.responseJSON.info)return void setTimeout(function(){i.handle_connection_lost(!0,t)});try{var n=JSON.parse(t.responseText);o.alert(e("Query Tool initialization error"),n.errormsg)}catch(t){o.alert(e("Query Tool initialization error"),t.statusText)}})},launch_grid:function(i){var o=this,r=i.panel_title,s=o.get_panel_title(),d="",c="";"false"==i.is_query_tool?(s=r+"/"+s,c=e("View/Edit Data - ")+s,r=s,d="fa fa-table"):r?(c=r.toUpperCase()+" "+e("Script - ")+s,r=s,d="fa fa-file-text-o"):(c=e("Query Tool - ")+s,r=s,d="fa fa-bolt");var u=l.removeSlashInTheString(s),p={trans_id:i.gridTransId,is_query_tool:i.is_query_tool,editor_title:u.title},h=t("datagrid.panel",p)+"?query_url="+encodeURI(i.sURL)+"&server_type="+encodeURIComponent(i.server_type)+"&fslashes="+u.slashLocations;if(o.preferences.new_browser_tab){var g=window.open(h,"_blank");g.addEventListener("load",function(){g.document.title=r})}else{var b=m.docker.findPanels("properties"),_=m.docker.addPanel("frm_datagrid",f.DOCK.STACKED,b[0]);_.title('<span title="'+c+'">'+r+"</span>"),_.icon(d),_.focus(),_.on(f.EVENT.CLOSED,function(){n.ajax({url:t("datagrid.close",{trans_id:i.gridTransId}),method:"GET"})});!function e(t){n(t).data("embeddedFrame").$container.append(a.DataGrid.spinner_el),setTimeout(function(){if(n(t).data("frameInitialized")){var i=n(t).data("embeddedFrame");i&&(i.openURL(h),i.$container.find(".pg-sp-container").delay(1e3).hide(1))}else e(t)},100)}(_)}}},s.Events),a.DataGrid)}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o,a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};i=[n(4),n(2),n,n(0),n(1),n(3),n(10),n(20),n(172),n(11),n(6),n(173),n(18),n(5),n(161),n(24)],void 0!==(o=function(e,t,i,o,r,l,s,d,c,u,p,f,m){l.Browser=l.Browser||{};var h=l.Browser;if(!l.Dashboard){var g,b,_=!0,v="",y="",w=!1,x=!1,C=!1,S=d.Extension.DeleteCell.extend({render:function(){return this.$el.empty(),"cancel"===this.column.get("cell_action")?this.$el.html("<i class='fa fa-stop' data-toggle='tooltip' title='"+t("Cancel the active query")+"'></i>"):this.$el.html("<i class='fa fa-times-circle text-danger' data-toggle='tooltip' title='"+t("Terminate the session")+"'></i>"),this.delegateEvents(),this},deleteRow:function(e){var n,i,a,r,l,s=this,c=s.column.get("cell_action");if(e.preventDefault(),d.callByNeed(s.column.get("canDeleteRow"),s.column,s.model)){var p=function(){o("#btn_refresh").trigger("click")};"cancel"===c?(n=t("Cancel Active Query?"),i=t("Are you sure you wish to cancel the active query?"),a=t("Active query cancelled successfully."),r=t("An error occurred whilst cancelling the active query."),l=v+s.model.get("pid")):(n=t("Terminate Session?"),i=t("Are you sure you wish to terminate the session?"),a=t("Session terminated successfully."),r=t("An error occurred whilst terminating the active query."),l=y+s.model.get("pid")),u.confirm(n,i,function(){o.ajax({url:l,type:"DELETE"}).done(function(e){e==t("Success")?(u.success(a),p()):u.error(r)}).fail(function(e,t,n){u.pgRespErrorNotify(e,n)})},function(){return!0})}}}),N=d.Extension.ObjectCell.extend({enterEditMode:function(){this.model.trigger("enteringEditMode",[this]),d.Cell.prototype.enterEditMode.apply(this,arguments),this.delegateEvents(),d.callByNeed(this.column.editable(),this.column,this.model)&&(this.$el.html("<i class='fa fa-caret-down subnode-edit-in-process'></i>"),this.model.trigger("pg-sub-node:opened",this.model,this))},render:function(){return this.$el.empty(),this.$el.html("<i class='fa fa-caret-right' data-toggle='tooltip' title='"+t("View the active session details")+"'></i>"),this.delegateEvents(),this.grabFocus&&this.$el.trigger("focus"),this}}),k=s.Model.extend({defaults:{version:null},schema:[{id:"backend_type",label:t("Backend type"),type:"text",editable:!0,disabled:!0,group:t("Details"),visible:function(){return this.version>=1e5}},{id:"query_start",label:t("Query started at"),type:"text",editable:!1,disabled:!0,group:t("Details")},{id:"state_change",label:t("Last state changed at"),type:"text",editable:!0,disabled:!0,group:t("Details")},{id:"query",label:t("SQL"),type:"text",editable:!0,disabled:!0,control:p.SqlFieldControl,group:t("Details")}]});return l.Dashboard={init:function(){if(!this.initialized){this.initialized=!0,this.sid=this.did=-1,this.version=-1;var n=this.object_selected.bind(this),i=this.object_disconnected.bind(this);h.Events.on("pgadmin-browser:tree:selected",n),h.Events.on("pgadmin:server:disconnect",i);var a=e("dashboard.index");this.chart_store={},this.charts_poller_int_id=-1;var r=h.panels.dashboard.panel;if(r){var l=r.layout().scene().find(".pg-panel-content");l&&(o.ajax({url:a,type:"GET",dataType:"html"}).done(function(e){o(l).html(e)}).fail(function(){o(l).html('<div class="alert alert-danger pg-panel-message" role="alert">'+t("An error occurred whilst loading the dashboard.")+"</div>")}),o(r).data("sid",-1),o(r).data("did",-1))}}},object_disconnected:function(){var e=h.tree.selected(),t=e&&h.tree.itemData(e);0!=e.length&&this.object_selected(e,t,h.Nodes[t._type])},object_selected:function(n,i,a){var l=this;if(!1===_)r.isUndefined(i.connected)||!0===i.connected||l.clearChartFromStore();else if(i&&i._type){var s=a.getTreeNodeHierarchy(n),d=f.url(i,n,s);if(null===d){d=e("dashboard.index"),l.version=s.server&&s.server.version||0,v=d+"cancel_query/",y=d+"terminate_session/";var c=s.server;b=c&&c.db||null,c&&c.user&&c.user.is_superuser?w=!0:(w=!1,g=c&&c.user?c.user.name:null),"database"in s?(l.sid=s.server._id,l.did=s.database._id,x=!1,C=!0,d+=l.sid+"/"+l.did,v+=l.sid+"/"+l.did+"/",y+=l.sid+"/"+l.did+"/"):"server"in s?(l.sid=s.server._id,l.did=-1,x=!0,C=!1,d+=l.sid,v+=l.sid+"/",y+=l.sid+"/"):x=C=!1}else x=C=!1;var u=h.panels.dashboard.panel;if(u){var p=u.layout().scene().find(".pg-panel-content");p&&(i.connected||r.isUndefined(i.connected)?(d!==o(u).data("dashboard_url")||d===o(u).data("dashboard_url")&&0==o(u).data("server_status"))&&(o(p).empty(),l.clearChartFromStore(),o.ajax({url:d,type:"GET",dataType:"html"}).done(function(e){o(p).html(e),l.init_dashboard()}).fail(function(){o(p).html('<div class="alert alert-danger pg-panel-message" role="alert">'+t("An error occurred whilst loading the dashboard.")+"</div>")}),o(u).data("server_status",!0)):(o(p).empty(),r.isUndefined(i.connected)||!0===i.connected||l.clearChartFromStore(),o(p).html('<div class="alert alert-info pg-panel-message" role="alert">'+t("Please connect to the selected server to view the dashboard.")+"</div>"),o(u).data("server_status",!1)),o(u).data("dashboard_url",d))}}},renderCharts:function(e){var t=this,n=function(e,t){return"Seconds ago: "+parseInt(t.x*e)+"</br>\n                  Value: "+t.y},i=m.getEpoch();t.stopChartsPoller(),e.map(function(e){if(t.chart_store[e.chart_name]&&t.old_preferences[e.refresh_pref_name]!=t.preferences[e.refresh_pref_name]&&t.clearChartFromStore(e.chart_name),t.chart_store[e.chart_name]){var o=t.chart_store[e.chart_name].chart_obj;o.setOptions(e.options,!1),o.setTooltipFormatter(n.bind(null,t.preferences[e.refresh_pref_name]))}if(!t.chart_store[e.chart_name]){var a=new c.Chart(e.container,e.options);a.setTooltipFormatter(n.bind(null,t.preferences[e.refresh_pref_name])),a.setOtherData("counter",e.counter),t.chart_store[e.chart_name]={chart_obj:a,refresh_on:i,refresh_rate:t.preferences[e.refresh_pref_name]}}}),t.startChartsPoller(t.chart_store,t.sid,t.did)},getStatsUrl:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=e("dashboard.dashboard_stats");return o+="/"+t,o+=n>0?"/"+n:"",o+="?chart_names="+i.join(",")},updateChart:function(e,t){var n=e.getOtherData("dataset")||[],i=e.getOtherData("counter_prev_data")||t,o=e.getOtherData("counter")||!1;if(0==n.length)for(var a in t)n.push({data:[[0,o?t[a]-i[a]:t[a]]],label:a});else Object.keys(t).map(function(e,a){if(o){if(r.isUndefined(i))return;n[a].data.unshift([0,t[e]-i[e]])}else n[a].data.unshift([0,t[e]]);for(var l=0;l<n[a].data.length;l++)n[a].data[l][0]=l}),i=t;for(var l=0;l<n.length;l++)n[l].data.length>101&&n[l].data.pop();e.setOtherData("dataset",n),e.setOtherData("counter_prev_data",i),e.isInPage()&&e.isVisible()&&e.draw(n)},stopChartsPoller:function(){clearInterval(this.charts_poller_int_id)},startChartsPoller:function(e,n,i){var a=this,l=m.getGCD(Object.values(e).map(function(e){return e.refresh_rate})),s=0;a.stopChartsPoller();var d=function(){var l=m.getEpoch(),d=[];for(var c in e)e[c].refresh_on<=l&&(e[c].refresh_on=l+e[c].refresh_rate,d.push(c));if(0==d.length||s>0)return void s--;var u=a.getStatsUrl(n,i,d);o.ajax({url:u,type:"GET"}).done(function(t){s=0;for(var n in t){var i=e[n].chart_obj;o(i.getContainer()).removeClass("graph-error"),a.updateChart(i,t[n])}}).fail(function(n){s=0;var i="",a="",l="info";0===n.readyState?a=t("Not connected to the server or the connection to the server has been closed."):(i=JSON.parse(n.responseText),a=i.errormsg,428===n.status?(r.isUndefined(a)||r.isNull(a))&&(a=t("Please connect to the selected server to view the graph.")):(a=t("An error occurred whilst rendering the graph."),l="danger"));for(var d in e){var c=e[d].chart_obj;o(c.getContainer()).addClass("graph-error"),o(c.getContainer()).html('<div class="alert alert-'+l+' pg-panel-message" role="alert">'+a+"</div>")}}),s=3};d(),a.charts_poller_int_id=setInterval(d,1e3*l)},add_new_server:function(){if(h&&h.tree){for(var e=0!=h.tree.selected().length?h.tree.selected():h.tree.first(null,!1),t=n(81),i=h.tree.itemData(e);i&&"server_group"!=i._type;)e=h.tree.next(e),i=h.tree.itemData(e);if(!i)return;t&&t.callbacks.show_obj_properties.apply(t,[{action:"create"},e])}},render_grid:function(e,t,n){var i=s.Model.extend({}),a=this,r=t+a.sid;-1!=a.did&&(r+="/"+a.did);var l=s.Collection.extend({model:i,url:r,mode:"client"}),c=new l,u=new d.Grid({emptyText:"No data found",columns:n,collection:c,className:"backgrid presentation table table-bordered table-noouter-border table-hover"});o(e).empty(),o(e).append(u.render().el);var p=new d.Extension.ClientSideFilter({collection:c});p.setCustomSearchBox(o("#txtGridSearch")),o(e).data("data",c),o(e).data("grid",u),o(e).data("filter",p)},render_grid_data:function(e){var n=o(e).data("data"),i=o(e).data("grid"),a=o(e).data("filter");if(r.isUndefined(n))return null;n.fetch({reset:!0,success:function(){o(e).hasClass("grid-error")&&(o(e).removeClass("grid-error"),o(e).html(i.render().el),o(a.el).show()),a.search()},error:function(i,s){var d="",c="",u="info";0===s.readyState?c=t("Not connected to the server or the connection to the server has been closed."):(d=JSON.parse(s.responseText),c=d.errormsg,428===s.status?(r.isUndefined(c)||r.isNull(c))&&(c=t("Please connect to the selected server to view the table.")):(c=t("An error occurred whilst rendering the table."),u="danger")),o(e).hasClass("grid-error")||(o(a.el).hide(),o(e).addClass("grid-error")),o(e).html('<div class="alert alert-'+u+' pg-panel-message" role="alert">'+c+"</div>"),setTimeout(function(){l.Dashboard.render_grid_data(e,n)},5e3)}})},clearChartFromStore:function(e){var t=this;e?delete t.chart_store[e]:(t.stopChartsPoller(),r.each(t.chart_store,function(e,n){delete t.chart_store[n]}))},init_dashboard:function(){var e=this,t=setInterval(function(){try{window.top.pgAdmin.Browser.preference_version()>0&&(clearInterval(t),e.reflectPreferences())}catch(e){throw clearInterval(t),e}},0);h.onPreferencesChange("dashboards",function(){e.reflectPreferences()})},reflectPreferences:function(){var e=this;if(e.preferences?(e.old_preferences=e.preferences,e.preferences=window.top.pgAdmin.Browser.get_preferences_for_module("dashboards")):(e.preferences=window.top.pgAdmin.Browser.get_preferences_for_module("dashboards"),e.old_preferences=e.preferences),x||C){var t=o(".dashboard-container").find("#graph-sessions")[0],n=o(".dashboard-container").find("#graph-tps")[0],i=o(".dashboard-container").find("#graph-ti")[0],r=o(".dashboard-container").find("#graph-to")[0],s=o(".dashboard-container").find("#graph-bio")[0],d={parseFloat:!1,xaxis:{min:100,max:0,autoscale:0},yaxis:{autoscale:1}};e.preferences.graph_data_points&&(d=a({},d,{points:{show:!0,radius:1,hitRadius:3}})),e.preferences.graph_mouse_track&&(d=a({},d,{mouse:{track:!0,position:"sw"}})),e.preferences.show_graphs&&o("#dashboard-graphs").hasClass("dashboard-hidden")?o("#dashboard-graphs").removeClass("dashboard-hidden"):e.preferences.show_graphs||(o("#dashboard-graphs").addClass("dashboard-hidden"),e.clearChartFromStore()),e.preferences.show_activity&&o("#dashboard-activity").hasClass("dashboard-hidden")?o("#dashboard-activity").removeClass("dashboard-hidden"):e.preferences.show_activity||o("#dashboard-activity").addClass("dashboard-hidden"),e.preferences.show_graphs&&l.Dashboard.renderCharts([{chart_name:"session_stats",container:t,options:d,counter:!1,refresh_pref_name:"session_stats_refresh"},{chart_name:"tps_stats",container:n,options:d,counter:!0,refresh_pref_name:"tps_stats_refresh"},{chart_name:"ti_stats",container:i,options:d,counter:!0,refresh_pref_name:"ti_stats_refresh"},{chart_name:"to_stats",container:r,options:d,counter:!0,refresh_pref_name:"to_stats_refresh"},{chart_name:"bio_stats",container:s,options:d,counter:!0,refresh_pref_name:"bio_stats_refresh"}]),e.preferences.show_graphs||e.preferences.show_activity?o("#dashboard-none-show").addClass("dashboard-hidden"):o("#dashboard-none-show").removeClass("dashboard-hidden"),x?e.reflectPreferencesServer():C&&e.reflectPreferencesDatabase()}},reflectPreferencesServer:function(){var n=this,i=o(".dashboard-container"),a=i.find("#server_activity").get(0),s=i.find("#server_locks").get(0),d=i.find("#server_prepared").get(0),c=i.find("#server_config").get(0),u={tab_server_activity:a,tab_server_locks:s,tab_server_prepared:d,tab_server_config:c};if(n.preferences.show_activity){var f=[{name:"pid",label:t("PID"),editable:!1,cell:"string"},{name:"datname",label:t("Database"),editable:!1,cell:"string"},{name:"usename",label:t("User"),editable:!1,cell:"string"},{name:"application_name",label:t("Application"),editable:!1,cell:"string"},{name:"client_addr",label:t("Client"),editable:!1,cell:"string"},{name:"backend_start",label:t("Backend start"),editable:!1,cell:"string"},{name:"state",label:t("State"),editable:!1,cell:"string"}];f=n.version<90600?f.concat([{name:"waiting",label:t("Waiting?"),editable:!1,cell:"string"}]):f.concat([{name:"wait_event",label:t("Wait Event"),editable:!1,cell:"string"},{name:"blocking_pids",label:t("Blocking PIDs"),editable:!1,cell:"string"}]);var m=new k,h=p.generateViewSchema(null,m,"create",null,null,!0);r.each(h[0].fields,function(e){e.version=n.version}),f.unshift({name:"pg-backform-expand",label:"",cell:N,cell_priority:-1,postgres_version:n.version,schema:h}),f.unshift({name:"pg-backform-delete",label:"",cell:S,cell_action:"cancel",editable:!1,cell_priority:-1,canDeleteRow:l.Dashboard.can_take_action,postgres_version:n.version}),f.unshift({name:"pg-backform-delete",label:"",cell:S,cell_action:"terminate",editable:!1,cell_priority:-1,canDeleteRow:l.Dashboard.can_take_action,postgres_version:n.version});var g=[{name:"pid",label:t("PID"),editable:!1,cell:"string"},{name:"datname",label:t("Database"),editable:!1,cell:"string"},{name:"locktype",label:t("Lock type"),editable:!1,cell:"string"},{name:"relation",label:t("Target relation"),editable:!1,cell:"string"},{name:"page",label:t("Page"),editable:!1,cell:"string"},{name:"tuple",label:t("Tuple"),editable:!1,cell:"string"},{name:"virtualxid",label:t("vXID (target)"),editable:!1,cell:"string"},{name:"transactionid",label:t("XID (target)"),editable:!1,cell:"string"},{name:"classid",label:t("Class"),editable:!1,cell:"string"},{name:"objid",label:t("Object ID"),editable:!1,cell:"string"},{name:"virtualtransaction",label:t("vXID (owner)"),editable:!1,cell:"string"},{name:"mode",label:t("Mode"),editable:!1,cell:"string"},{name:"granted",label:t("Granted?"),editable:!1,cell:"string"}],b=[{name:"git",label:t("Name"),editable:!1,cell:"string"},{name:"database",label:t("Database"),editable:!1,cell:"string"},{name:"Owner",label:t("Owner"),editable:!1,cell:"string"},{name:"transaction",label:t("XID"),editable:!1,cell:"string"},{name:"prepared",label:t("Prepared at"),editable:!1,cell:"string"}],_=[{name:"name",label:t("Name"),editable:!1,cell:"string"},{name:"category",label:t("Category"),editable:!1,cell:"string"},{name:"setting",label:t("Setting"),editable:!1,cell:"string"},{name:"unit",label:t("Unit"),editable:!1,cell:"string"},{name:"short_desc",label:t("Description"),editable:!1,cell:"string"}];o(a).addClass("pg-el-container"),o(a).attr("el","sm"),l.Dashboard.render_grid(a,e("dashboard.activity"),f),l.Dashboard.render_grid(s,e("dashboard.locks"),g),l.Dashboard.render_grid(d,e("dashboard.prepared"),b),l.Dashboard.render_grid(c,e("dashboard.config"),_),l.Dashboard.render_grid_data(a),o('a[data-toggle="tab"]').on("shown.bs.tab",function(e){var t=u[o(e.relatedTarget).attr("aria-controls")];o(t).data("filtertext",o("#txtGridSearch").val());var n=u[o(e.target).attr("aria-controls")];o("#txtGridSearch").val(o(n).data("filtertext")),l.Dashboard.render_grid_data(n)}),o("#btn_refresh").off("click").on("click",function(){var e=u[o("#dashboard-activity .nav-tabs .active").attr("aria-controls")];l.Dashboard.render_grid_data(e)})}},reflectPreferencesDatabase:function(){var n=this,i=document.getElementById("database_activity"),a=document.getElementById("database_locks"),s=document.getElementById("database_prepared"),d={tab_database_activity:i,tab_database_locks:a,tab_database_prepared:s};if(n.preferences.show_activity){var c=[{name:"pid",label:t("PID"),editable:!1,cell:"string"},{name:"usename",label:t("User"),editable:!1,cell:"string"},{name:"application_name",label:t("Application"),editable:!1,cell:"string"},{name:"client_addr",label:t("Client"),editable:!1,cell:"string"},{name:"backend_start",label:t("Backend start"),editable:!1,cell:"string"},{name:"state",label:t("State"),editable:!1,cell:"string"}];c=n.version<90600?c.concat([{name:"waiting",label:t("Waiting?"),editable:!1,cell:"string"}]):c.concat([{name:"wait_event",label:t("Wait Event"),editable:!1,cell:"string"},{name:"blocking_pids",label:t("Blocking PIDs"),editable:!1,cell:"string"}]);var u=new k,f=p.generateViewSchema(null,u,"create",null,null,!0);r.each(f[0].fields,function(e){e.version=n.version}),c.unshift({name:"pg-backform-expand",label:"",cell:N,cell_priority:-1,postgres_version:n.version,schema:f}),c.unshift({name:"pg-backform-delete",label:"",cell:S,cell_action:"cancel",editable:!1,cell_priority:-1,canDeleteRow:l.Dashboard.can_take_action,postgres_version:n.version}),c.unshift({name:"pg-backform-delete",label:"",cell:S,cell_action:"terminate",editable:!1,cell_priority:-1,canDeleteRow:l.Dashboard.can_take_action,postgres_version:n.version});var m=[{name:"pid",label:t("PID"),editable:!1,cell:"string"},{name:"locktype",label:t("Lock type"),editable:!1,cell:"string"},{name:"relation",label:t("Target relation"),editable:!1,cell:"string"},{name:"page",label:t("Page"),editable:!1,cell:"string"},{name:"tuple",label:t("Tuple"),editable:!1,cell:"string"},{name:"virtualxid",label:t("vXID (target)"),editable:!1,cell:"string"},{name:"transactionid",label:t("XID (target)"),editable:!1,cell:"string"},{name:"classid",label:t("Class"),editable:!1,cell:"string"},{name:"objid",label:t("Object ID"),editable:!1,cell:"string"},{name:"virtualtransaction",label:t("vXID (owner)"),editable:!1,cell:"string"},{name:"mode",label:t("Mode"),editable:!1,cell:"string"},{name:"granted",label:t("Granted?"),editable:!1,cell:"string"}],h=[{name:"git",label:t("Name"),editable:!1,cell:"string"},{name:"Owner",label:t("Owner"),editable:!1,cell:"string"},{name:"transaction",label:t("XID"),editable:!1,cell:"string"},{name:"prepared",label:t("Prepared at"),editable:!1,cell:"string"}];o(i).addClass("pg-el-container"),o(i).attr("el","sm"),l.Dashboard.render_grid(i,e("dashboard.activity"),c),l.Dashboard.render_grid(a,e("dashboard.locks"),m),l.Dashboard.render_grid(s,e("dashboard.prepared"),h),l.Dashboard.render_grid_data(i),o('a[data-toggle="tab"]').on("shown.bs.tab",function(e){var t=d[o(e.relatedTarget).attr("aria-controls")];o(t).data("filtertext",o("#txtGridSearch").val());var n=d[o(e.target).attr("aria-controls")];o("#txtGridSearch").val(o(n).data("filtertext")),l.Dashboard.render_grid_data(n)}),o("#btn_refresh").off("click").on("click",function(){var e=d[o("#dashboard-activity .nav-tabs .active").attr("aria-controls")];l.Dashboard.render_grid_data(e)})}},toggleVisibility:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];_=e,t&&this.clearChartFromStore()},can_take_action:function(e){var n=e.collection.where({state:"active"}),i=this.get("postgres_version")||null,o=this.get("cell_action")||null,a="cancel"===o,r=t(a?"cancel":"terminate");return i&&i>=1e5&&!e.get("datname")?(u.info(t("You cannot ")+r+t(" background worker processes.")),!1):b==e.get("datname")&&"active"==e.get("state")&&1==n.length?(u.error(t("You are not allowed to ")+r+t(" the main active session.")),!1):a&&"idle"==e.get("state")?(u.info(t("The session is already in idle state.")),!1):!!w||(!(!g||g!=e.get("usename"))||(u.error(t("Superuser privileges are required to ")+r+t(" another users query.")),!1))}},l.Dashboard}}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Chart=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(263),l=function(e){return e&&e.__esModule?e:{default:e}}(r);t.Chart=function(){function e(t,n){i(this,e),this.chartApi=l.default,this._container=t,this._options={},this._defaultOptions={legend:{position:"nw",backgroundColor:"#D2E8FF"},lines:{show:!0,lineWidth:2},shadowSize:0,resolution:3},this._dataset=null,this._tooltipFormatter=null,this._otherData={},this.setOptions(n)}return a(e,[{key:"getContainer",value:function(){return this._container}},{key:"getContainerDimensions",value:function(){return{height:this._container.clientHeight,width:this._container.clientWidth}}},{key:"getOptions",value:function(){return this._options}},{key:"setOptions",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._options=t?o({},this._defaultOptions,this._options,e):o({},this._defaultOptions,e)}},{key:"removeOptions",value:function(e){this._options[e]&&delete this._options[e]}},{key:"getOtherData",value:function(e){if(this._otherData[e])return this._otherData[e]}},{key:"setOtherData",value:function(e,t){this._otherData[e]=t}},{key:"isVisible",value:function(){var e=this.getContainerDimensions();return e.height>0&&e.width>0}},{key:"isInPage",value:function(){return this._container!==document.body&&document.body.contains(this._container)}},{key:"setTooltipFormatter",value:function(e){var t=this.getOptions();this._tooltipFormatter=e,this._tooltipFormatter&&this.setOptions({mouse:o({},t.mouse,{trackFormatter:this._tooltipFormatter})})}},{key:"draw",value:function(e){this._dataset=e,this._container&&l.default.draw(this._container,this._dataset,this._options)}}]),e}()},function(e,t,n){"use strict";function i(e,t,n){var i=r.default.treeMenu.findNodeByDomElement(t),a=null;return i&&i.anyFamilyMember(function(e){var t=e.getData(),i=r.default.Nodes[t._type],l=i&&i.dashboard;return(0,o.isFunction)(l)&&(l=l.apply(i,[e,t,n])),null!==(a=(0,o.isString)(l)?l:null)}),a}Object.defineProperty(t,"__esModule",{value:!0}),t.url=i;var o=n(18),a=n(5),r=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t){e.exports=a},function(e,t,n){"use strict";var i,o;i=[n(2),n(1),n(8),n(0),n(10),n(5),n(13),n(17),n(176),n(177)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d){if(a.NodeStatistics)return a.NodeStatistics;if(a.NodeStatistics=a.NodeStatistics||{},a.NodeStatistics.initialized)return a.NodeStatistics;var c=r.SizeFormatter=function(){};t.extend(c.prototype,{fromRaw:function(e){return s(e)},toRaw:function(e){return e}});var u=r.Extension.SwitchCell.extend({defaults:t.extend({},r.Extension.SwitchCell.prototype.defaults)}),p={16:u,20:r.IntegerCell,21:r.IntegerCell,23:r.IntegerCell,700:r.NumberCell,701:r.NumberCell,1700:r.NumberCell,702:r.DatetimeCell,703:r.DatetimeCell,1082:r.DatetimeCell.extend({includeDate:!0,includeTime:!1,includeMilli:!1}),1083:r.DatetimeCell.extend({includeDate:!1,includeTime:!0,includeMilli:!0}),1114:r.DatetimeCell.extend({includeDate:!0,includeTime:!0,includeMilli:!0}),1184:"string",1266:"string"},f=window.wcDocker;return t.extend(u.prototype.defaults.options,{onText:e("True"),offText:e("False"),onColor:"success",offColor:"primary",size:"mini"}),t.extend(a.NodeStatistics,{init:function(){if(!this.initialized){this.initialized=!0,t.bindAll(this,"showStatistics","panelVisibilityChanged","__createMultiLineStatistics","__createSingleLineStatistics","__loadMoreRows"),t.extend(this,{initialized:!0,collection:new o.Collection(null),statistic_columns:[{editable:!1,name:"statistics",label:e("Statistics"),cell:"string",headerCell:r.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_25"},{editable:!1,name:"value",label:e("Value"),cell:"string"}],panel:a.docker.findPanels("statistics"),columns:null,grid:null});var n=this;a.Events.on("pgadmin-browser:panel-statistics:"+f.EVENT.VISIBILITY_CHANGED,this.panelVisibilityChanged),a.Events.on("pgadmin:browser:node:updated",function(){this.panel&&this.panel.length&&(i(this.panel[0]).data("node-prop",""),this.panelVisibilityChanged(this.panel[0]))},this),0==this.panel.length?a.Events.on("pgadmin-browser:panel-statistics:"+f.EVENT.INIT,function(){n.panel=a.docker.findPanels("statistics"),(n.panel[0].isVisible()||1!=n.panel.length)&&(a.Events.on("pgadmin-browser:tree:selected",this.showStatistics),a.Events.on("pgadmin-browser:tree:refreshing",this.refreshStatistics,this))}.bind(this)):(n.panel[0].isVisible()||1!=n.panel.length)&&(a.Events.on("pgadmin-browser:tree:selected",this.showStatistics),a.Events.on("pgadmin-browser:tree:refreshing",this.refreshStatistics,this)),n.panel.length>0&&n.panel[0].isVisible()&&(a.Events.on("pgadmin-browser:tree:selected",this.showStatistics),a.Events.on("pgadmin-browser:tree:refreshing",this.refreshStatistics,this))}},__updateCollection:function(o,s,c,u){var p=this.panel[0].layout().scene().find(".pg-panel-content"),m=p.find(".pg-panel-statistics-message"),h=p.find(".pg-panel-statistics-container"),g=this.panel,b=this,_="",v=u;if(s){_=e("No statistics are available for the selected object.");var y=s.getTreeNodeHierarchy(c),w={node_type:u,url:o};if(t.isEqual(i(g[0]).data("node-prop"),w))return;if(i(g[0]).data("node-prop",w),d.nodeHasStatistics(s,c)){_="";var x;i.ajax({url:o,type:"GET",beforeSend:function(){x=setTimeout(function(){m.text(e("Retrieving data from the server...")),m.removeClass("d-none"),b.grid&&b.grid.remove()},1e3)}}).done(function(e){if(clearTimeout(x),m.text(""),e.data){var t=b.data=e.data;s.hasCollectiveStatistics||t.rows.length>1?(a.Events.on("pgadmin-browser:panel-statistics:"+f.EVENT.SCROLLED,b.__loadMoreRows),b.__createMultiLineStatistics.call(b,t,s.statsPrettifyFields)):(a.Events.off("pgadmin-browser:panel-statistics:"+f.EVENT.SCROLLED,b.__loadMoreRows),b.__createSingleLineStatistics.call(b,t,s.statsPrettifyFields)),b.grid&&(delete b.grid,b.grid=null),b.grid=new r.Grid({emptyText:"No data found",columns:b.columns,collection:b.collection,className:"backgrid presentation table table-bordered table-noouter-border table-hover"}),b.grid.render(),h.empty(),h.append(b.grid.$el),m.hasClass("d-none")||m.addClass("d-none"),h.removeClass("d-none")}else e.info&&(h.hasClass("d-none")||h.addClass("d-none"),m.text(e.info),m.removeClass("d-none"))}).fail(function(t,i,o){var r=y[v].label;a.Events.trigger("pgadmin:node:retrieval:error","statistics",t,i,o,c),l.pgHandleItemError(t,i,o,{item:c,info:y})||l.pgNotifier(i,t,n(e("Error retrieving the information - %s")).sprintf(o||r).value(),function(){}),m.text(e("Failed to retrieve data from the server."))})}}""!=_&&(h.hasClass("d-none")||h.addClass("d-none"),m.removeClass("d-none"),m.text(_))},refreshStatistics:function(e,n,o){var a=this,r={node_type:n._type,url:o.generate_url(e,"stats",n,!0)};t.isEqual(i(a.panel[0]).data("node-prop"),r)&&(i(a.panel[0]).data("node-prop",""),a.showStatistics(e,n,o))},showStatistics:function(e,t,n){var i=this;n&&n&&(i.timeout&&clearTimeout(i.timeout),i.timeout=setTimeout(function(){i.__updateCollection.call(i,n.generate_url(e,"stats",t,!0),n,e,t._type)},400))},__createMultiLineStatistics:function(e,n){var i=e.rows,o=e.columns;this.columns=[];for(var a in o){var r=o[a],l=p[r.type_code]||"string";"PID"==r.name&&(l=l.extend({orderSeparator:""}));var s={editable:!1,name:r.name,cell:l};-1!=t.indexOf(n,r.name)&&(s.formatter=c),this.columns.push(s)}this.collection.reset(i.splice(0,50))},__loadMoreRows:function(){var e=i(".pg-panel-statistics-container").closest(".wcFrameCenter")[0];if(e.scrollHeight-10<e.scrollTop+e.offsetHeight){var t=this.data.rows;t.length>0&&this.collection.add(t.splice(0,50))}},__createSingleLineStatistics:function(e,n){var i,o=e.rows[0],a=e.columns,r=[];this.columns=this.statistic_columns;for(var l in a)i=a[l].name,r.push({statistics:i,value:o&&o[i]?-1!=t.indexOf(n,i)?s(o[i]):o[i]:null});this.collection.reset(r)},panelVisibilityChanged:function(e){if(e.isVisible()){var t=a.tree,n=t.selected(),i=n&&t.itemData(n),o=n&&i&&a.Nodes[i._type];a.NodeStatistics.showStatistics.apply(a.NodeStatistics,[n,i,o]),a.Events.on("pgadmin-browser:tree:selected",a.NodeStatistics.showStatistics),a.Events.on("pgadmin-browser:tree:refreshing",a.NodeStatistics.refreshStatistics,this)}else a.Events.off("pgadmin-browser:tree:selected",a.NodeStatistics.showStatistics),a.Events.off("pgadmin-browser:tree:refreshing",a.NodeStatistics.refreshStatistics,this)}}),a.NodeStatistics}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[],void 0!==(o=function(){return function(e){var t=Math.abs(e),n=0,i=["bytes","kB","MB","GB","TB","PB"];if(t<10240)return t+" "+i[n];do{t/=1024,n+=1}while(t>10239);return Math.round(t)+" "+i[n]}}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";function i(e,t){if("function"==typeof e.hasStatistics){var n=e.getTreeNodeHierarchy(t);return e.hasStatistics(n)}return e.hasStatistics}Object.defineProperty(t,"__esModule",{value:!0}),t.nodeHasStatistics=i},function(e,t,n){"use strict";var i,o;i=[n(2),n(1),n(8),n(0),n(10),n(5),n(11),n(13)],void 0!==(o=function(e,t,n,i,o,a,r,l){if(a.NodeDependencies)return a.NodeDependencies;var s=window.wcDocker;return a.NodeDependencies=a.NodeDependencies||{},t.extend(a.NodeDependencies,{init:function(){if(!this.initialized){this.initialized=!0,this.dependenciesPanel=a.docker.findPanels("dependencies")[0],t.bindAll(this,"showDependencies","__loadMoreRows","__appendGridToPanel");var e=o.Model.extend({defaults:{icon:"icon-unknown",type:void 0,name:void 0,field:void 0},parse:function(e){var i=a.Nodes[e.type];return e.icon=i?t.isFunction(i.node_image)?i.node_image.apply(i,[null,null]):i.node_image||"icon-"+e.type:"icon-"+e.type,e.type=n.titleize(e.type.replace(/_/g," "),!0),e}});this.dependenciesCollection=new(o.Collection.extend({model:e}))(null),a.Events.on("pgadmin-browser:tree:selected",this.showDependencies),this.__appendGridToPanel()}},__appendGridToPanel:function(){var t=this.dependenciesPanel.layout().scene().find(".pg-panel-content"),n=t.find(".pg-panel-dependencies-container"),o=new l.Grid({emptyText:"No data found",columns:[{name:"type",label:e("Type"),cell:l.Cell.extend({render:function(){return l.Cell.prototype.render.apply(this,arguments),this.$el.prepend(i("<i>",{class:"wcTabIcon "+this.model.get("icon")})),this}}),editable:!1},{name:"name",label:e("Name"),cell:"string",editable:!1},{name:"field",label:"",cell:"string",editable:!1}],collection:this.dependenciesCollection,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});return this.dependenciesGrid=o,n.append(o.render().el),!0},showDependencies:function(t,o,l){var d=this,c=e("Please select an object in the tree view."),u=this.dependenciesPanel,p=u.layout().scene().find(".pg-panel-content"),f=p.find(".pg-panel-depends-message"),m=p.find(".pg-panel-dependencies-container"),h=l.getTreeNodeHierarchy(t),g=o._type,b=l.generate_url(t,"dependency",o,!0);if(l&&(c=e("No dependency information is available for the selected object."),l.hasDepends)){this.dependenciesGrid.columns.models[2].set({label:e("Restriction")}),f.addClass("d-none"),m.removeClass("d-none");var _="";i.ajax({url:b,type:"GET",beforeSend:function(){_=setTimeout(function(){f.text(e("Fetching dependency information from the server...")),f.removeClass("d-none"),c=""},1e3)}}).done(function(e){clearTimeout(_),e.length>0?(f.hasClass("d-none")||f.addClass("d-none"),m.removeClass("d-none"),d.dependenciesData=e,d.dependenciesCollection.reset(d.dependenciesData.splice(0,100),{parse:!0}),a.Events.on("pgadmin-browser:panel-dependencies:"+s.EVENT.SCROLLED,d.__loadMoreRows)):(a.Events.off("pgadmin-browser:panel-dependencies:"+s.EVENT.SCROLLED),d.dependenciesCollection.reset({silent:!0}),f.text(c),f.removeClass("d-none"),m.hasClass("d-none")||m.addClass("d-none"))}).fail(function(i,o,l){var s=h[g].label;a.Events.trigger("pgadmin:node:retrieval:error","depends",i,o,l),r.pgHandleItemError(i,o,l,{item:t,info:h})||r.pgNotifier(o,i,n(e("Error retrieving data from the server: %s")).sprintf(l||s).value(),function(){}),f.text(e("Failed to retrieve data from the server."))})}""!=c&&(f.text(c),f.removeClass("d-none"),m.hasClass("d-none")||m.addClass("d-none"))},__loadMoreRows:function(){if(!(this.dependenciesPanel.length<1)){var e=this.dependenciesPanel.$container.find(".pg-panel-dependencies-container").closest(".wcFrameCenter")[0];e.scrollHeight-10<e.scrollTop+e.offsetHeight&&this.dependenciesData.length>0&&this.dependenciesCollection.add(this.dependenciesData.splice(0,100),{parse:!0})}}}),a.NodeDependencies}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(1),n(8),n(0),n(10),n(5),n(11),n(13)],void 0!==(o=function(e,t,n,i,o,a,r,l){if(a.NodeDependents)return a.NodeDependents;var s=window.wcDocker;return a.NodeDependents=a.NodeDependents||{},t.extend(a.NodeDependents,{init:function(){if(!this.initialized){this.initialized=!0,this.dependentsPanel=a.docker.findPanels("dependents")[0],t.bindAll(this,"showDependents","__loadMoreRows","__appendGridToPanel");var e=o.Model.extend({defaults:{icon:"icon-unknown",type:void 0,name:void 0,field:void 0},parse:function(e){var i=a.Nodes[e.type];return e.icon=i?t.isFunction(i.node_image)?i.node_image.apply(i,[null,null]):i.node_image||"icon-"+e.type:"icon-"+e.type,e.type=n.titleize(e.type.replace(/_/g," "),!0),e}});this.dependentCollection=new(o.Collection.extend({model:e}))(null),a.Events.on("pgadmin-browser:tree:selected",this.showDependents),a.Events.on("pgadmin-browser:tree:refreshing",this.refreshDependents,this),this.__appendGridToPanel()}},__appendGridToPanel:function(){var t=this.dependentsPanel.layout().scene().find(".pg-panel-content"),n=t.find(".pg-panel-dependents-container"),o=new l.Grid({emptyText:"No data found",columns:[{name:"type",label:e("Type"),cell:l.Cell.extend({render:function(){return l.Cell.prototype.render.apply(this,arguments),this.$el.prepend(i("<i>",{class:"wcTabIcon "+this.model.get("icon")})),this}}),editable:!1},{name:"name",label:e("Name"),cell:"string",editable:!1},{name:"field",label:"",cell:"string",editable:!1}],collection:this.dependentCollection,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});return this.dependentGrid=o,n.append(o.render().el),!0},showDependents:function(t,o,l){var d=this,c=e("Please select an object in the tree view."),u=this.dependentsPanel,p=u.layout().scene().find(".pg-panel-content"),f=p.find(".pg-panel-depends-message"),m=p.find(".pg-panel-dependents-container"),h=l.getTreeNodeHierarchy(t),g=o._type,b=l.generate_url(t,"dependent",o,!0);if(l&&(c=e("No dependent information is available for the selected object."),l.hasDepends)){"tablespace"==l.type||"role"==l.type?this.dependentGrid.columns.models[2].set({label:e("Database")}):this.dependentGrid.columns.models[2].set({label:e("Restriction")}),f.addClass("d-none"),m.removeClass("d-none");var _="";i.ajax({url:b,type:"GET",beforeSend:function(){_=setTimeout(function(){f.text(e("Fetching dependent information from the server...")),f.removeClass("d-none"),c=""},1e3)}}).done(function(e){clearTimeout(_),e.length>0?(f.hasClass("d-none")||f.addClass("d-none"),m.removeClass("d-none"),d.dependentData=e,d.dependentCollection.reset(d.dependentData.splice(0,100),{parse:!0}),a.Events.on("pgadmin-browser:panel-dependents:"+s.EVENT.SCROLLED,d.__loadMoreRows)):(a.Events.off("pgadmin-browser:panel-dependents:"+s.EVENT.SCROLLED),d.dependentCollection.reset({silent:!0}),f.text(c),f.removeClass("d-none"),m.hasClass("d-none")||m.addClass("d-none"))}).fail(function(i,o,l){var s=h[g].label;a.Events.trigger("pgadmin:node:retrieval:error","depends",i,o,l),r.pgHandleItemError(i,o,l,{item:t,info:h})||r.pgNotifier(o,i,n(e("Error retrieving data from the server: %s")).sprintf(l||s).value(),function(){}),f.text(e("Failed to retrieve data from the server."))})}""!=c&&(f.text(c),f.removeClass("d-none"),m.hasClass("d-none")||m.addClass("d-none"))},__loadMoreRows:function(){if(!(this.dependentsPanel.length<1)){var e=this.dependentsPanel.$container.find(".pg-panel-dependents-container").closest(".wcFrameCenter")[0];e.scrollHeight-10<e.scrollTop+e.offsetHeight&&this.dependentData.length>0&&this.dependentCollection.add(this.dependentData.splice(0,100),{parse:!0})}}}),a.NodeDependents}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(1),n(8),n(0),n(3),n(5),n(11)],void 0!==(o=function(e,t,n,i,o,a,r){if(a.ShowNodeSQL=a.ShowNodeSQL||{},a.ShowNodeSQL.initialized)return a.ShowNodeSQL;var l=window.wcDocker;return t.extend(a.ShowNodeSQL,{init:function(){if(!this.initialized){this.initialized=!0,t.bindAll(this,"showSQL","sqlPanelVisibilityChanged");var e;this.sqlPanels=e=a.docker.findPanels("sql"),a.Events.on("pgadmin-browser:panel-sql:"+l.EVENT.VISIBILITY_CHANGED,this.sqlPanelVisibilityChanged),a.Events.on("pgadmin:browser:node:updated",function(){this.sqlPanels&&this.sqlPanels.length&&(i(this.sqlPanels[0]).data("node-prop",""),this.sqlPanelVisibilityChanged(this.sqlPanels[0]))},this),0==e.length?a.Events.on("pgadmin-browser:panel-sql:"+l.EVENT.INIT,function(){(e[0].isVisible()||1!=e.length)&&(a.Events.on("pgadmin-browser:tree:selected",this.showSQL),a.Events.on("pgadmin-browser:tree:refreshing",this.refreshSQL,this))}.bind(this)):(e[0].isVisible()||1!=e.length)&&(a.Events.on("pgadmin-browser:tree:selected",this.showSQL),a.Events.on("pgadmin-browser:tree:refreshing",this.refreshSQL,this))}},refreshSQL:function(e,n,o){var a=this,r={node_type:n._type,url:o.generate_url(e,"sql",n,!0)};t.isEqual(i(a.sqlPanels[0]).data("node-prop"),r)&&(i(a.sqlPanels[0]).data("node-prop",""),a.showSQL(e,n,o))},showSQL:function(l,s,d){this.timeout&&clearTimeout(this.timeout);var c=this;this.timeout=setTimeout(function(){var u="-- "+e("Please select an object in the tree view.");if(d){u="-- "+e("No SQL could be generated for the selected object.");var p=s._type,f=d.generate_url(l,"sql",s,!0),m=d.getTreeNodeHierarchy(l),h={node_type:p,url:f};if(t.isEqual(i(c.sqlPanels[0]).data("node-prop"),h))return;if(i(c.sqlPanels[0]).data("node-prop",h),d.hasSQL){u="";var g;i.ajax({url:f,type:"GET",beforeSend:function(){g=setTimeout(function(){o.Browser.editor.setValue(e("Retrieving data from the server..."))},1e3)}}).done(function(e){o.Browser.editor.getValue()!=e&&o.Browser.editor.setValue(e),clearTimeout(g)}).fail(function(t,i,o){var s=m[p].label;a.Events.trigger("pgadmin:node:retrieval:error","sql",t,i,o,l),r.pgHandleItemError(t,i,o,{item:l,info:m})||r.pgNotifier(i,t,n(e("Error retrieving the information - %s")).sprintf(o||s).value(),function(){})})}}""!=u&&o.Browser.editor.setValue(u)},400)},sqlPanelVisibilityChanged:function(e){if(e.isVisible()){var t=a.tree,n=t.selected(),i=n&&t.itemData(n),o=n&&i&&a.Nodes[i._type];a.ShowNodeSQL.showSQL.apply(a.ShowNodeSQL,[n,i,o]),a.Events.on("pgadmin-browser:tree:selected",a.ShowNodeSQL.showSQL),a.Events.on("pgadmin-browser:tree:refreshing",a.ShowNodeSQL.refreshSQL,this)}else a.Events.off("pgadmin-browser:tree:selected",a.ShowNodeSQL.showSQL),a.Events.off("pgadmin-browser:tree:refreshing",a.ShowNodeSQL.refreshSQL,this)}}),a.ShowNodeSQL}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(3),n(2),n(4),n(1),n(8),n(0),n(5),n(17)],void 0!==(o=function(e,t,n,i,o,a,r,l){if(r.BackgroundProcessObsorver=r.BackgroundProcessObsorver||{},r.BackgroundProcessObsorver.initialized)return r.BackgroundProcessObsorver;var s=window.wcDocker,d=function(e,t){var n=this;setTimeout(function(){n.initialize.apply(n,[e,t])},1)};return i.extend(d.prototype,{success_status_tpl:i.template('\n      <div class="d-flex px-2 py-1 bg-success-light border border-success rounded">\n        <div class="pr-2">\n          <i class="fa fa-check fa-lg text-success pg-bg-status-icon" aria-hidden="true"></i>\n        </div>\n        <div class="text-body mx-auto pg-bg-status-text"><%-status_text%></div>\n      </div>'),failed_status_tpl:i.template('\n      <div class="d-flex px-2 py-1 bg-danger-lighter border border-danger rounded">\n        <div class="pr-2">\n          <i class="fa fa-close fa-lg text-danger pg-bg-status-icon" aria-hidden="true"></i>\n        </div>\n        <div class="text-body mx-auto pg-bg-status-text"><%-status_text%></div>\n      </div>'),other_status_tpl:i.template('\n      <div class="d-flex px-2 py-1 bg-primary-light border border-primary rounded">\n        <div class="pr-2">\n          <i class="fa fa-info fa-lg text-primary pg-bg-status-icon" aria-hidden="true"></i>\n        </div>\n        <div class="text-body mx-auto pg-bg-status-text"><%-status_text%></div>\n      </div>'),initialize:function(e,t){i.extend(this,{details:!1,notify:i.isUndefined(t)||t,curr_status:null,state:0,completed:!1,id:e.id,type_desc:null,desc:null,detailed_desc:null,stime:null,exit_code:null,acknowledge:e.acknowledge,execution_time:null,out:-1,err:-1,lot_more:!1,notifier:null,container:null,panel:null,logs:a("<ol></ol>",{class:"pg-bg-process-logs"})}),this.notify&&(r.Events&&r.Events.on("pgadmin-bgprocess:started:"+this.id,function(e){e.notifier||e.show.apply(e)}),r.Events&&r.Events.on("pgadmin-bgprocess:finished:"+this.id,function(e){e.notifier||e.show.apply(e)}));var n=this;setTimeout(function(){n.update.apply(n,[e])},1)},bgprocess_url:function(e){switch(e){case"status":return this.details&&-1!=this.out&&-1!=this.err?n("bgprocess.detailed_status",{pid:this.id,out:this.out,err:this.err}):n("bgprocess.status",{pid:this.id});case"acknowledge":return n("bgprocess.acknowledge",{pid:this.id});case"stop_process":return n("bgprocess.stop_process",{pid:this.id});default:return n("bgprocess.list")}},update:function(n){var a=this,l=[],s=[];"stime"in n&&(a.stime=new Date(n.stime)),"execution_time"in n&&(a.execution_time=parseFloat(n.execution_time)),"type_desc"in n&&(a.type_desc=n.type_desc),"desc"in n&&(a.desc=n.desc),"details"in n&&(a.detailed_desc=n.details),"exit_code"in n&&(a.exit_code=n.exit_code),"process_state"in n&&(a.state=n.process_state),"out"in n&&(a.out=n.out&&n.out.pos,n.out&&n.out.lines&&(l=n.out.lines)),"err"in n&&(a.err=n.err&&n.err.pos,n.err&&n.err.lines&&(s=n.err.lines)),a.completed=a.completed||"err"in n&&"out"in n&&n.err.done&&n.out.done||!a.details&&!i.isNull(a.exit_code);for(var d=0,c=0,u=[],p=document.createElement("textarea"),f=function(e){return p.textContent=e,p.innerHTML};d<l.length&&c<s.length;)e.natural_sort(l[d][0],s[c][0])<=0?u.push('<li class="pg-bg-res-out">'+f(l[d++][1])+"</li>"):u.push('<li class="pg-bg-res-err">'+f(s[c++][1])+"</li>");for(;d<l.length;)u.push('<li class="pg-bg-res-out">'+f(l[d++][1])+"</li>");for(;c<s.length;)u.push('<li class="pg-bg-res-err">'+f(s[c++][1])+"</li>");u.length&&(a.logs.append(u.join("")),setTimeout(function(){a.logs[0].scrollTop=a.logs[0].scrollHeight})),a.stime&&(a.curr_status=a.other_status_tpl({status_text:t("Started")}),a.execution_time>=2&&(a.curr_status=a.other_status_tpl({status_text:t("Running...")})),i.isNull(a.exit_code)||(3===a.state?a.curr_status=a.failed_status_tpl({status_text:t("Terminated by user.")}):0==a.exit_code?a.curr_status=a.success_status_tpl({status_text:t("Successfully completed.")}):a.curr_status=a.failed_status_tpl({status_text:o(t("Failed (exit code: %s).")).sprintf(String(a.exit_code)).value()})),0==a.state&&a.stime&&(a.state=1,r.Events&&r.Events.trigger("pgadmin-bgprocess:started:"+a.id,a,a)),1!=a.state||i.isNull(a.exit_code)||(a.state=2,r.Events&&r.Events.trigger("pgadmin-bgprocess:finished:"+a.id,a,a)),setTimeout(function(){a.show.apply(a)},10)),a.completed||setTimeout(function(){a.status.apply(a)},1e3)},status:function(){var e=this;a.ajax({typs:"GET",timeout:3e4,url:e.bgprocess_url("status"),cache:!1,async:!0,contentType:"application/json"}).done(function(t){setTimeout(function(){e.update(t)},10)}).fail(function(t){410!=t.status&&setTimeout(function(){e.update(t)},1e4)})},show:function(){var e=this;if(e.notify&&!e.details){if(!e.notifier){var n=a('\n            <div class="card">\n              <div class="card-header bg-primary d-flex">\n                <div>'+e.type_desc+'</div>\n                <div class="ml-auto">\n                  <button class="btn btn-sm-sq btn-primary pg-bg-close"><i class="fa fa-lg fa-close"></i></button>\n                </div>\n              </div>\n              <div class="card-body px-2">\n                <div class="py-1">'+e.desc+'</div>\n                <div class="py-1">'+e.stime.toString()+'</div>\n                <div class="d-flex py-1">\n                  <div class="my-auto mr-2">\n                    <span class="fa fa-clock-o fa-2x"></span>\n                  </div>\n                  <div class="pg-bg-etime my-auto mr-2"></div>\n                  <div class="ml-auto">\n                    <button class="btn btn-secondary pg-bg-more-details"><span class="fa fa-info-circle"></span>&nbsp;'+t("More details...")+'</button>\n                    <button class="btn btn-danger bg-process-stop"><span class="fa fa-times-circle"></span>&nbsp;'+t("Stop Process")+'</button>\n                  </div>\n                </div>\n                <div class="pg-bg-status py-1">\n                </div>\n              </div>\n            </div>\n            '),i=n.find(".pg-bg-more-details"),o=n.find(".pg-bg-close");e.container=n,e.notifier=l.notify(n.get(0),"bg-bgprocess",0,null),i.on("click",function(e){e=e||window.event,e.cancelBubble=!0,e.stopPropagation(),this.notifier.dismiss(),this.notifier=null,this.completed=!1,this.show_detailed_view.apply(this)}.bind(e)),o.on("click",function(){this.notifier.dismiss(),this.notifier=null,this.acknowledge_server.apply(this)}.bind(this)),e.container.on("click",function(e){e=e||window.event,e.cancelBubble=!0,e.stopPropagation()}),n.find(".bg-process-stop").off("click").on("click",e.stop_process.bind(this))}e.container.find(".pg-bg-etime").empty().append(a("<span></span>").text(String(e.execution_time))).append(a("<span></span>").text(" "+t("seconds")));a(e.container.find(".pg-bg-status")).html(e.curr_status);var r=a(e.container.find(".bg-process-stop"));isNaN(parseInt(e.exit_code))?r.attr("disabled",!1):r.attr("disabled",!0)}else e.show_detailed_view.apply(e)},show_detailed_view:function(){var e=this,n=this.panel,i=!1;e.panel||(i=!0,n=this.panel=r.BackgroundProcessObsorver.create_panel(),n.title("Process Watcher - "+e.type_desc),n.focus());var o=n.$container,l=o.find(".bg-process-watcher"),d=o.find(".bg-process-details"),c=o.find(".bg-process-footer"),u=o.find(".bg-process-stop");if(isNaN(parseInt(e.exit_code))?u.attr("disabled",!1):u.attr("disabled",!0),u.off("click").on("click",e.stop_process.bind(this)),i&&(l.html(e.logs),setTimeout(function(){e.logs[0].scrollTop=e.logs[0].scrollHeight}),d.find(".bg-detailed-desc").html(e.detailed_desc)),d.find(".bg-process-stats .bgprocess-start-time").html(e.stime),c.find(".bg-process-status").html(e.curr_status),c.find(".bg-process-exec-time p").empty().append(a("<span></span>").text(String(e.execution_time))).append(a("<span></span>").text(" "+t("seconds"))),i){e.details=!0,e.err=0,e.out=0,setTimeout(function(){e.status.apply(e)},1e3);var p=function(e,t,n){var i=t.outerHeight()+n.outerHeight();e.css("padding-bottom",i)}.bind(n,l,d,c);n.on(s.EVENT.RESIZED,p),n.on(s.EVENT.ATTACHED,p),n.on(s.EVENT.DETACHED,p),p(),n.on(s.EVENT.CLOSED,function(e){e.panel=null,e.details=!1,null!=e.exit_code&&e.acknowledge_server.apply(e)}.bind(n,this))}},acknowledge_server:function(){var e=this;a.ajax({type:"PUT",timeout:3e4,url:e.bgprocess_url("acknowledge"),cache:!1,async:!0,contentType:"application/json"}).done(function(){}).fail(function(){})},stop_process:function(){var e=this;e.state=3,a.ajax({type:"PUT",timeout:3e4,url:e.bgprocess_url("stop_process"),cache:!1,async:!0,contentType:"application/json"}).done(function(){}).fail(function(){})}}),i.extend(r.BackgroundProcessObsorver,{bgprocesses:{},init:function(){var e=this;e.initialized||(e.initialized=!0,setTimeout(function(){e.update_process_list.apply(e)},1e3),r.Events.on("pgadmin-bgprocess:created",function(){setTimeout(function(){r.BackgroundProcessObsorver.update_process_list(!0)},1e3)}))},update_process_list:function(e){var t=this;a.ajax({typs:"GET",timeout:3e4,url:n("bgprocess.list"),cache:!1,async:!0,contentType:"application/json"}).done(function(n){if(n&&i.isArray(n)){for(var o in n){var a=n[o];"id"in a&&(a.id in t.bgprocesses||(t.bgprocesses[a.id]=new d(a)))}e&&0==n.length&&setTimeout(function(){t.update_process_list(!1)},3e3)}}).fail(function(){})},create_panel:function(){return this.register_panel(),r.docker.addPanel("bg_process_watcher",s.DOCK.FLOAT,null,{w:screen.width<700?.95*screen.width:.5*screen.width,h:screen.height<500?.95*screen.height:.5*screen.height,x:screen.width<700?"2%":"25%",y:screen.height<500?"2%":"25%"})},register_panel:function(){var e=r.docker,n=e.findPanels("bg_process_watcher");if(!(n&&n.length>=1)){new r.Panel({name:"bg_process_watcher",showTitle:!0,isCloseable:!0,isPrivate:!0,content:'<div class="bg-process-details"><div class="bg-detailed-desc"></div><div class="bg-process-stats d-flex py-1"><div class="my-auto mr-2"><span class="fa fa-clock-o fa-2x"></span></div><div class="pg-bg-etime my-auto mr-2"><span>'+t("Start time")+': <span class="bgprocess-start-time"></span></span></div><div class="ml-auto"><button type="button" class="btn btn-danger bg-process-stop"><span class="fa fa-times-circle"></span>&nbsp;'+t("Stop Process")+'</button></div></div></div><div class="bg-process-watcher"></div><div class="bg-process-footer p-2 d-flex"><div class="bg-process-status flex-grow-1"></div><div class="bg-process-exec-time ml-4 my-auto"><div class="exec-div"><span>'+t("Execution time")+":</span><p></p></div></div></div>",onCreate:function(e,t){t.addClass("pg-no-overflow p-2")}}).load(r.docker)}}}),r.BackgroundProcessObsorver}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(5),n(25)],void 0!==(o=function(e,t,n,i,o){return o.Browser.Nodes.server_group||(o.Browser.Nodes.server_group=o.Browser.Node.extend({parent_type:null,type:"server_group",dialogHelp:t("help.static",{filename:"server_group_dialog.html"}),label:e("Server Group"),width:"250px",height:"150px",is_collection:!0,Init:function(){this.initialized||(this.initialized=!0,o.Browser.add_menus([{name:"create_server_group",node:"server_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("Server Group..."),data:{action:"create"},icon:"wcTabIcon icon-server_group"}]))},model:o.Browser.Node.Model.extend({defaults:{id:void 0,name:null},schema:[{id:"id",label:e("ID"),type:"int",group:null,mode:["properties"]},{id:"name",label:e("Name"),type:"text",group:null,mode:["properties","edit","create"]}],validate:function(){var t=null;return this.errorModel.clear(),!this.isNew()&&"id"in this.changed?(t=e("The ID cannot be changed."),this.errorModel.set("id",t),t):i.isUndefined(this.get("name"))||i.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Name cannot be empty."),this.errorModel.set("name",t),t):null}}),canDrop:function(e){return e.can_delete},canDelete:function(e){var t=o.Browser.tree.siblings(e,!0);return!(!t||0==t.length)}})),o.Browser.Nodes.server_group}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(57),n(11),n(6),n(7),n(16),n(109)],void 0!==(o=function(e,t,n,i,o,a,r,l,s){if(r.Nodes["coll-database"]||(r.Nodes["coll-database"]=r.Collection.extend({node:"database",label:e("Databases"),type:"coll-database",columns:["name","datowner","comments"],hasStatistics:!0,canDrop:!0,canDropCascade:!1,statsPrettifyFields:[e("Size"),e("Size of temporary files")]})),!r.Nodes.database){r.Nodes.database=r.Node.extend({parent_type:"server",type:"database",sqlAlterHelp:"sql-alterdatabase.html",sqlCreateHelp:"sql-createdatabase.html",dialogHelp:t("help.static",{filename:"database_dialog.html"}),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[e("Size"),e("Size of temporary files")],canDrop:function(e){return e.canDrop},label:e("Database"),node_image:function(){return"pg-icon-database"},Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_database_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"create_database_on_coll",node:"coll-database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"create_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"connect_database",node:"database",module:this,applies:["object","context"],callback:"connect_database",category:"connect",priority:4,label:e("Connect Database..."),icon:"fa fa-link",enable:"is_not_connected"},{name:"disconnect_database",node:"database",module:this,applies:["object","context"],callback:"disconnect_database",category:"drop",priority:5,label:e("Disconnect Database..."),icon:"fa fa-chain-broken",enable:"is_connected"}]),i.bindAll(this,"connection_lost"),r.Events.on("pgadmin:database:connection:lost",this.connection_lost))},can_create_database:function(e,t){var n=this.getTreeNodeHierarchy(t),i=n.server;return i.connected&&i.user.can_create_db},is_not_connected:function(e){return e&&1!=e.connected&&1==e.allowConn},is_connected:function(e){return e&&1==e.connected&&1==e.canDisconn},is_conn_allow:function(e){return e&&1==e.allowConn},connection_lost:function(t,n,o){if(r.tree){for(var a=r.tree,s=t&&a.itemData(t),d=this;s&&"database"!=s._type;)t=a.parent(t),s=t&&a.itemData(t);if(t&&s){if(!s.allowConn)return!1;if(i.isUndefined(s.is_connecting)||!s.is_connecting){s.is_connecting=!0;var u=function e(t,n){n._id==this._id&&(s.is_connecting=!1,r.Events.off("pgadmin:database:connect:cancelled",e),t=t&&a.parent(t),n=t&&a.itemData(t),t&&n&&r.Events.trigger("pgadmin:server:disconnect",{item:t,data:n},!1))};if(r.Events.on("pgadmin:database:connect:cancelled",u),o)return void c(d,s,a,t,!0);l.confirm(e("Connection lost"),e("Would you like to reconnect to the database?"),function(){c(d,s,a,t,!0)},function(){s.is_connecting=!1,a.unload(t),a.setInode(t),a.addIcon(t,{icon:"icon-database-not-connected"}),r.Events.trigger("pgadmin:database:connect:cancelled",t,s,d)})}}}},callbacks:{connect_database:function(e){var t=e||{},n=this,i=r.tree,o=t.item||i.selected(),a=o&&1==o.length?i.itemData(o):void 0;return!(!a||"template0"==a.label)&&(d(n,a,i,o,!0),!1)},disconnect_database:function(t){var i=t||{},a=this,s=r.tree,d=i.item||s.selected(),c=d&&1==d.length?s.itemData(d):void 0;return!!c&&(l.confirm(e("Disconnect the database"),o(e("Are you sure you want to disconnect the database - %s?")).sprintf(c.label).value(),function(){var e=c;n.ajax({url:a.generate_url(d,"connect",c,!0),type:"DELETE"}).done(function(t){if(1==t.success){var n=s.parent(d);l.success(t.info),s.removeIcon(d),e.connected=!1,e.icon="icon-database-not-connected",s.addIcon(d,{icon:e.icon}),s.unload(d),s.setInode(d),setTimeout(function(){s.select(n)},10)}else{try{l.error(t.errormsg)}catch(e){}s.unload(d)}}).fail(function(e,t,n){l.pgRespErrorNotify(e,n),s.unload(d)})},function(){return!0}),!1)},beforeopen:function(e,t){return!(!t||"database"!=t._type||"template0"==t.label)&&(r.tree.addIcon(e,{icon:t.icon}),!(!t.connected&&t.allowConn)||(d(this,t,r.tree,e,!0),!1))},selected:function(e,t){return!(!t||"database"!=t._type)&&(r.tree.addIcon(e,{icon:t.icon}),!t.connected&&t.allowConn?(d(this,t,r.tree,e,!1),!1):r.Node.callbacks.selected.apply(this,arguments))},refresh:function(e,t){var n=r.tree,i=t||n.selected();n.itemData(i).allowConn&&r.Node.callbacks.refresh.apply(this,arguments)}},model:r.Node.Model.extend({idAttribute:"did",defaults:{name:void 0,owner:void 0,comment:void 0,encoding:"UTF8",template:void 0,tablespace:void 0,collation:void 0,char_type:void 0,datconnlimit:-1,datallowconn:void 0,variables:[],privileges:[],securities:[],datacl:[],deftblacl:[],deffuncacl:[],defseqacl:[],is_template:!1,deftypeacl:[]},initialize:function(e,t){if(0===i.size(e)){var n=r.serverInfo[t.node_info.server._id].user;this.set({datowner:n.name},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Database"),cell:"string",editable:!1,type:"text"},{id:"did",label:e("OID"),cell:"string",mode:["properties"],editable:!1,type:"text"},{id:"datowner",label:e("Owner"),editable:!1,type:"text",node:"role",control:s.NodeListByNameControl,select2:{allowClear:!1}},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"tblacl",label:e("Default TABLE privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"seqacl",label:e("Default SEQUENCE privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"funcacl",label:e("Default FUNCTION privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"typeacl",label:e("Default TYPE privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0,min_version:90200},{id:"comments",label:e("Comment"),editable:!1,type:"multiline"},{id:"encoding",label:e("Encoding"),editable:!1,type:"text",group:e("Definition"),disabled:function(e){return!e.isNew()},url:"get_encodings",control:"node-ajax-options",cache_level:"server"},{id:"template",label:e("Template"),editable:!1,type:"text",group:e("Definition"),disabled:function(e){return!e.isNew()},control:"node-list-by-name",url:"get_databases",cache_level:"server",select2:{allowClear:!1},mode:["create"],transform:function(e,t){var n=[],o=t||this,a=o.model.get("name");return o.model.isNew()?e&&i.isArray(e)&&i.each(e,function(e){n.push({label:e,value:e,image:"pg-icon-database"})}):n.push({label:a,value:a}),n}},{id:"spcname",label:e("Tablespace"),editable:!1,type:"text",group:e("Definition"),control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label}},{id:"datcollate",label:e("Collation"),editable:!1,type:"text",group:e("Definition"),disabled:function(e){return!e.isNew()},url:"get_ctypes",control:"node-ajax-options",cache_level:"server"},{id:"datctype",label:e("Character type"),editable:!1,type:"text",group:e("Definition"),disabled:function(e){return!e.isNew()},url:"get_ctypes",control:"node-ajax-options",cache_level:"server"},{id:"datconnlimit",label:e("Connection limit"),editable:!1,type:"int",group:e("Definition"),min:-1},{id:"is_template",label:e("Template?"),editable:!1,type:"switch",group:e("Definition"),disabled:!0,mode:["properties","edit"]},{id:"datallowconn",label:e("Allow connections?"),editable:!1,type:"switch",group:e("Definition"),mode:["properties"],disabled:!0},{id:"datacl",label:e("Privileges"),type:"collection",model:r.Node.PrivilegeRoleModel.extend({privileges:["C","T","c"]}),uniqueCol:["grantee","grantor"],editable:!1,group:e("Security"),mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"variables",label:e("Parameters"),type:"collection",model:r.Node.VariableModel.extend({keys:["name","role"]}),editable:!1,group:e("Parameters"),mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0,hasRole:!0,control:s.VariableCollectionControl,node:"role"},{id:"seclabels",label:e("Security Labels"),model:r.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:e("Security"),canDelete:!0,mode:["edit","create"],canAdd:!0,control:"unique-col-collection",uniqueCol:["provider"],min_version:90200},{type:"nested",control:"tab",group:e("Default Privileges"),mode:["edit"],schema:[{id:"deftblacl",model:r.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),label:e("Default Privileges: Tables"),editable:!1,type:"collection",group:e("Tables"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"defseqacl",model:r.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),label:e("Default Privileges: Sequences"),editable:!1,type:"collection",group:e("Sequences"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deffuncacl",model:r.Node.PrivilegeRoleModel.extend({privileges:["X"]}),label:e("Default Privileges: Functions"),editable:!1,type:"collection",group:e("Functions"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deftypeacl",model:r.Node.PrivilegeRoleModel.extend({privileges:["U"]}),label:e("Default Privileges: Types"),editable:!1,type:"collection",group:"deftypesacl_group",mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"],min_version:90200},{id:"deftypesacl_group",type:"group",label:e("Types"),mode:["edit","create"],min_version:90200}]}],validate:function(){var t=this.get("name");if(i.isUndefined(t)||i.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")){var n=e("Name cannot be empty.");return this.errorModel.set("name",n),n}return this.errorModel.unset("name"),null}})}),r.SecurityGroupSchema={id:"security",label:e("Security"),type:"group",visible:function(e){if(e&&"node_info"in e){return!("catalog"in(e.node_info||e.handler.node_info))}return!0}};var d=function(e,t,n,i){c(e,t,n,i)},c=function(t,i,o,a,s){var d=s||i.connected,c=function t(n,i,a,r,s,d,c,f){f||(o.setInode(c),o.addIcon(c,{icon:"icon-database-not-connected"})),l.pgNotifier("error",n,a,function(n){setTimeout(function(){l.dlgServerPass(e("Connect to database"),n,r,s,d,c,f,u,t,p).resizeTo()},100)})},u=function(e,n,i,o,a,s){i.is_connecting=!1,s||(o.deselect(a),o.setInode(a)),e&&e.data&&("boolean"==typeof e.data.connected&&(i.connected=e.data.connected),"string"==typeof e.data.icon&&(o.removeIcon(a),i.icon=e.data.icon,o.addIcon(a,{icon:i.icon})),l.success(e.info),t.trigger("connected",t,a,i),r.Events.trigger("pgadmin:database:connected",a,i),s||setTimeout(function(){o.select(a),o.open(a)},10))},p=function(e,n,i){i.is_connecting=!1;var o=e.parent(n);e.unload(n),e.setInode(n),e.removeIcon(n),e.addIcon(n,{icon:"icon-database-not-connected"}),t.trigger("connect:cancelled",t,n,i),r.Events.trigger("pgadmin:database:connect:cancelled",n,i,t),e.select(o)};n.post(t.generate_url(a,"connect",i,!0)).done(function(e){if(1==e.success)return u(e,t,i,o,a,d)}).fail(function(e,n,r){return c(e,0,r,t,i,o,a,d)})}}return r.Nodes["coll-database"]}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(17),n(6),n(90),n(7),n(40),n(109)],void 0!==(o=function(e,t,n,i,o,a,r,l,s){r.Nodes["coll-role"]||(a.Browser.Nodes["coll-role"]=a.Browser.Collection.extend({node:"role",type:"coll-role",columns:["rolname","rolvaliduntil","rolconnlimit","rolcanlogin","rolsuper","rolcreaterole","rolcreatedb","rolcatupdate","rolinherit","rolreplication"],canDrop:!0,canDropCascade:!1}));var d=a.Browser.SecurityModel=a.Browser.SecurityModel||a.Browser.Node.Model.extend({defaults:{provider:null,label:null},schema:[{id:"provider",label:e("Provider"),type:"text",disabled:!1,cellHeaderClasses:"width_percent_50"},{id:"label",label:e("Security Label"),type:"text",disabled:!1}],validate:function(){var t,n=this.toJSON();return i.isUndefined(n.provider)||i.isNull(n.provider)||""==String(n.provider).replace(/^\s+|\s+$/g,"")?(t=e("Please specify the value for all the security providers."),this.errorModel.set("provider",t),t):(this.errorModel.unset("provider"),i.isUndefined(n.label)||i.isNull(n.label)||""==String(n.label).replace(/^\s+|\s+$/g,"")?(t=e("Please specify the value for all the security providers."),this.errorModel.set("label",t),t):(this.errorModel.unset("label"),null))}}),c=s.Control.extend({defaults:i.defaults({extraClasses:["col-12 col-sm-12 col-md-12"]},s.NodeListByNameControl.prototype.defaults),initialize:function(){s.NodeListByNameControl.prototype.initialize.apply(this,arguments)},formatter:{fromRaw:function(e){var t=i.isObject(e)?e:JSON.parse(e);return i.pluck(t,"role")},toRaw:function(e){return e}},template:i.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <select multiple="multiple" style="width:100%;" class="pgadmin-controls <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-JSON.stringify(value)%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%>>',"    <% for (var i=0; i < options.length; i++) { %>","      <% var option = options[i]; %>",'      <option value=<%-option.value%> data-icon=<%-option.image%> <%=value != null && _.indexOf(value, option.value) != -1 ? "selected" : ""%> <%=option.disabled ? "disabled=\'disabled\'" : ""%>><%-option.label%></option>',"    <% } %>","  </select>","  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),selectionTemplate:i.template(["<span>",'  <span class="wcTabIcon <%= optimage %>"></span>',"  <span><%= opttext %><span>","  <% if (checkbox) { %>",'  <input type="checkbox" <%=disabled ? "disabled=\'disabled\'" : ""%>/>',"  <% } %>","</span>"].join("\n")),events:{"change select":"onChange"},getValueFromDOM:function(){var e=[];return this.$el.find("select").find(":selected").each(function(){e.push(n(this).attr("value"))}),e},render:function(){var t=i.defaults(this.field.toJSON(),this.defaults),o=this.model.toJSON(),a=t.name.split("."),r=a.shift(),l=a.join("."),d=this.keyPathAccessor(o[r],l),c=i.extend(t,{rawValue:d,value:this.formatter.fromRaw(d,this.model),attributes:o,formatter:this.formatter}),u=function(e,t,n){return i.isFunction(e)?!!e.apply(t,[n]):!!e};if(i.extend(c,{disabled:u(c.disabled,c,this.model),visible:u(c.visible,c,this.model),required:u(c.required,c,this.model),helpMessage:function(e,t,n){return i.isFunction(e)?e.apply(t,[n]):e}(c.helpMessage,c,this.model)}),i.isFunction(c.options))try{c.options=c.options.apply(this)}catch(e){c.options=[],this.model.trigger("pgadmin-view:transform:error",this.model,this.field,e)}this.$el.removeClass(s.hiddenClassName),c.visible||this.$el.addClass(s.hiddenClassName),this.$el.html(this.template(c)).addClass(t.name),this.updateInvalid();var p=this,f=this.model.get(this.field.get("name")),m=function(e){if(!e.id)return e.text;var t=n(e.element).data("icon");if(t){var o=i.extend({},c,{opttext:i.escape(e.text),optimage:t,checkbox:!1});return n(p.selectionTemplate(o))}return e.text},h=function(e){if(!e.id)return e.text;var t=n(e.element).data("icon"),o=function(t){return i.each(f.where({role:e.id}),function(e){e.set("admin",n(t.target).is(":checked"))}),!1};if(t){var a=i.extend({},c,{opttext:i.escape(e.text),optimage:t,checkbox:!0}),r=n(p.selectionTemplate(a));return setTimeout(function(){i.each(f.where({role:e.id}),function(e){r.find("input").prop("checked",e.get("admin"))})},200),r.find("input").on("change",o),r}return e.text};return this.$el.find("select").select2({templateResult:m,templateSelection:h,multiple:!0,tags:!0,allowClear:!c.disabled,placeholder:c.disabled?"":e("Select members"),width:"style"}).on("change",function(e){n(e.target).find(":selected").each(function(){})}),this},onChange:function(){var e=this.model,t=this.field.get("name").split("."),n=t.shift(),o=this.getValueFromDOM(),a=e.get(n),r=[];this.stopListening(this.model,"change:"+n,this.render),a.each(function(e){var t=e.get("role"),n=i.indexOf(o,t);n>-1?o.splice(n,1):r.push(t)}),i.each(o,function(e){a.add({role:e})}),i.each(r,function(e){a.remove(a.where({role:e}))}),this.listenTo(this.model,"change:"+n,this.render)}});return r.Nodes.role||(a.Browser.Nodes.role=a.Browser.Node.extend({parent_type:"server",type:"role",sqlAlterHelp:"sql-alterrole.html",sqlCreateHelp:"sql-createrole.html",dialogHelp:t("help.static",{filename:"role_dialog.html"}),label:e("Login/Group Role"),hasSQL:!0,width:"550px",canDrop:function(e,t){var n=this.getTreeNodeHierarchy(t),i=n.server;return e.is_superuser?i.connected&&i.user.is_superuser:i.connected&&i.user.can_create_role},hasDepends:!0,node_label:function(e){return e.label},node_image:function(e){return null==e||void 0==e?"icon-role":e.can_login?"icon-role":"icon-group"},title:function(t){return t?t.can_login?e("Login Role")+" - "+t.label:e("Group Role")+" - "+t.label:this.label},Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_role_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"},{name:"create_role_on_roles",node:"coll-role",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"},{name:"create_role",node:"role",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"}]))},can_create_role:function(e,t){var n=this.getTreeNodeHierarchy(t),i=n.server;return i.connected&&i.user.can_create_role},model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{oid:null,rolname:void 0,rolcanlogin:!1,rolpassword:null,rolconnlimit:-1,rolsuper:!1,rolcreaterole:!1,rolcreatedb:!1,rolinherit:!0,rolcatupdate:!1,rolreplication:!1,rolmembership:[],rolvaliduntil:null,seclabels:[],variables:[]},schema:[{id:"rolname",label:e("Name"),type:"text",disabled:"readonly"},{id:"oid",label:e("OID"),cell:"string",mode:["properties"],editable:!1,type:"text",visible:!0,disabled:!0},{id:"rolpassword",label:e("Password"),type:"password",group:e("Definition"),mode:["edit","create"],control:"input",deps:["rolcanlogin"],retype:!0,cell:"string",disabled:function(e){if(!e.isNew()){var t=this.node_info.server.user;return!(t.is_superuser||t.can_create_role)&&t.id!=e.get("oid")}return!1}},{id:"rolvaliduntil",disabled:"readonly",type:"text",group:e("Definition"),label:e("Account expires"),mode:["properties","edit","create"],control:"datetimepicker",deps:["rolcanlogin"],options:{format:"YYYY-MM-DD HH:mm:ss Z"}},{id:"rolconnlimit",type:"int",group:e("Definition"),label:e("Connection limit"),cell:"integer",min:-1,mode:["properties","edit","create"],disabled:"readonly"},{id:"rolcanlogin",label:e("Can login?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",group:e("Privileges"),disabled:"readonly"},{id:"rolsuper",label:e("Superuser"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",group:e("Privileges"),control:s.SwitchControl.extend({onChange:function(){s.SwitchControl.prototype.onChange.apply(this,arguments),this.model.set("rolcatupdate",this.model.get("rolsuper")),this.model.set("rolcreaterole",this.model.get("rolsuper")),this.model.set("rolcreatedb",this.model.get("rolsuper"))}}),disabled:"readonly"},{id:"rolcreaterole",label:e("Create roles?"),group:e("Privileges"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",disabled:"readonly"},{id:"description",label:e("Comments"),type:"multiline",group:null,mode:["properties","edit","create"],disabled:"readonly"},{id:"rolcreatedb",label:e("Create databases?"),group:e("Privileges"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",disabled:"readonly"},{id:"rolcatupdate",label:e("Update catalog?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",max_version:90400,group:e("Privileges"),disabled:function(e){return e.get("read_only")||!e.get("rolsuper")}},{id:"rolinherit",group:e("Privileges"),label:e("Inherit rights from the parent roles?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",disabled:"readonly"},{id:"rolreplication",group:e("Privileges"),label:e("Can initiate streaming replication and backups?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",min_version:90100,disabled:"readonly"},{id:"rolmembership",label:e("Roles"),group:e("Membership"),type:"collection",cell:"string",disabled:"readonly",mode:["properties","edit","create"],control:c,model:r.Node.Model.extend({keys:["role"],idAttribute:"role",defaults:{role:void 0,admin:!1},validate:function(){return null}}),filter:function(e){return this.model.isNew()||this.model.get("rolname")!=e.label},helpMessage:function(t){return e(t.has("read_only")&&0==t.get("read_only")?"Select the checkbox for roles to include WITH ADMIN OPTION.":"Roles shown with a check mark have the WITH ADMIN OPTION set.")}},{id:"variables",label:e("Parameters"),type:"collection",group:e("Parameters"),hasDatabase:!0,url:"variables",model:r.Node.VariableModel.extend({keys:["name","database"]}),control:"variable-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,disabled:"readonly"},{id:"seclabels",label:e("Security Labels"),model:d,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,disabled:"readonly",canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],readonly:function(e){if(!e.has("read_only")){var t=this.node_info.server.user;e.set("read_only",!(t.is_superuser||t.can_create_role))}return e.get("read_only")},validate:function(){var t,n={},o=this.get("seclabels");if((i.isUndefined(this.get("rolname"))||""==String(this.get("rolname")).replace(/^\s+|\s+$/g,""))&&(n.name=e("Name cannot be empty."),t=t||n.name),o)for(var a,r=0;r<o.models.length&&!a;r++)(a=o.models[r].validate.apply(o.models[r]))&&(n.seclabels=a,t=t||a);return this.errorModel.clear().set(n),i.size(n)?(this.trigger("on-status",{msg:t}),t):null}})})),r.Nodes.role}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(11),n(6),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s){return r.Nodes["coll-cast"]||(a.Browser.Nodes["coll-cast"]=a.Browser.Collection.extend({node:"cast",label:e("Casts"),type:"coll-cast",columns:["name","description"]})),r.Nodes.cast||(a.Browser.Nodes.cast=a.Browser.Node.extend({parent_type:"database",type:"cast",sqlAlterHelp:"sql-altercast.html",sqlCreateHelp:"sql-createcast.html",dialogHelp:t("help.static",{filename:"cast_dialog.html"}),canDrop:!0,canDropCascade:!0,label:e("Cast"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_cast_on_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"},enable:r.Nodes.database.is_conn_allow},{name:"create_cast_on_coll",node:"coll-cast",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"}},{name:"create_cast",node:"cast",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"}}]))},model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,encoding:"UTF8",srctyp:void 0,trgtyp:void 0,proname:void 0,castcontext:void 0,syscast:void 0,description:void 0},schema:[{id:"name",label:e("Name"),cell:"string",editable:!1,type:"text",disabled:!0,cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"srctyp",label:e("Source type"),url:"get_type",type:"text",group:e("Definition"),disabled:function(e){return!e.isNew()},mode:["create"],transform:function(e){return i.each(e,function(e){e.image="icon-cast"}),e},control:s.NodeAjaxOptionsControl.extend({onChange:function(){s.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this.model.get("srctyp"),t=this.model.get("trgtyp");void 0!=e&&""!=e&&void 0!=t&&""!=t?this.model.set("name",e+"->"+t):this.model.unset("name")}})},{id:"srctyp",label:e("Source type"),type:"text",group:e("Definition"),disabled:!0,mode:["properties","edit"]},{id:"trgtyp",label:e("Target type"),url:"get_type",type:"text",group:e("Definition"),disabled:function(e){return!e.isNew()},mode:["create"],transform:function(e){return i.each(e,function(e){e.image="icon-cast"}),e},control:s.NodeAjaxOptionsControl.extend({onChange:function(){s.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this.model.get("srctyp"),t=this.model.get("trgtyp");void 0!=e&&""!=e&&void 0!=t&&""!=t?this.model.set("name",e+"->"+t):this.model.unset("name")}})},{id:"trgtyp",label:e("Target type"),type:"text",group:e("Definition"),disabled:!0,mode:["properties","edit"]},{id:"proname",label:e("Function"),deps:["srctyp","trgtyp"],type:"text",disabled:function(e){return!e.isNew()},group:e("Definition"),mode:["create"],control:"node-ajax-options",options:function(e){var t=e.model.get("srctyp"),i=e.model.get("trgtyp"),o=[];if(void 0!=t&&""!=t&&void 0!=i&&""!=i){var a=e.field.get("schema_node"),r=a.generate_url.apply(a,[null,"get_functions",e.field.get("node_data"),!1,e.field.get("node_info")]);n.ajax({type:"POST",timeout:3e4,url:r,cache:!1,async:!1,data:{srctyp:t,trgtyp:i}}).done(function(e){return o=e.data}).fail(function(e,t,n){l.pgRespErrorNotify(e,n)})}return o}},{id:"proname",label:e("Function"),type:"text",group:e("Definition"),disabled:!0,mode:["properties","edit"]},{id:"castcontext",label:e("Context"),options:{onText:"IMPLICIT",offText:"EXPLICIT",width:"90"},editable:!1,type:"string",group:e("Definition"),mode:["create"],control:s.SwitchControl.extend({getValueFromDOM:function(){return this.$input.prop("checked")?"IMPLICIT":"EXPLICIT"}})},{id:"castcontext",label:e("Context"),disabled:!0,options:[{label:"IMPLICIT",value:"IMPLICIT"},{label:"EXPLICIT",value:"EXPLICIT"},{label:"ASSIGNMENT",value:"ASSIGNMENT"}],editable:!1,type:"select2",group:e("Definition"),mode:["properties","edit"]},{id:"syscast",label:e("System cast?"),cell:"switch",type:"switch",mode:["properties"],disabled:!0},{id:"description",label:e("Comment"),type:"multiline",cellHeaderClasses:"width_percent_50"}],validate:function(){var t,n=this.get("srctyp"),o=this.get("trgtyp");return i.isUndefined(n)||i.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(t=e("Source type must be selected."),this.errorModel.set("srctyp",t),t):(this.errorModel.unset("srctyp"),i.isUndefined(o)||i.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(t=e("Target type must be selected."),this.errorModel.set("trgtyp",t),t):(this.errorModel.unset("trgtyp"),this.trigger("on-status-clear"),null))}})})),r.Nodes["coll-cast"]}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(10),n(3),n(5),n(11),n(6),n(7),n(40),n(16)],void 0!==(o=function(e,t,n,i,o,a,r,l,s){return r.Nodes["coll-tablespace"]||(r.Nodes["coll-tablespace"]=r.Collection.extend({node:"tablespace",label:e("Tablespaces"),type:"coll-tablespace",columns:["name","spcuser","description"],hasStatistics:!0,statsPrettifyFields:[e("Size")],canDrop:!0,canDropCascade:!1})),r.Nodes.tablespace||(r.Nodes.tablespace=r.Node.extend({parent_type:"server",type:"tablespace",sqlAlterHelp:"sql-altertablespace.html",sqlCreateHelp:"sql-createtablespace.html",dialogHelp:t("help.static",{filename:"tablespace_dialog.html"}),label:e("Tablespace"),hasSQL:!0,canDrop:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[e("Size")],Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_tablespace_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"create_tablespace_on_coll",node:"coll-tablespace",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"create_tablespace",node:"tablespace",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"move_tablespace",node:"tablespace",module:this,applies:["object","context"],callback:"move_objects",category:"move_tablespace",priority:5,label:e("Move objects to..."),icon:"fa fa-exchange",data:{action:"create"},enable:"can_move_objects"}]))},can_create_tablespace:function(e,t){var n=this.getTreeNodeHierarchy(t),i=n.server;return i.connected&&i.user.is_superuser},can_move_objects:function(e,t){var n=this.getTreeNodeHierarchy(t),i=n.server;return i.connected&&i.user.is_superuser&&i.version>=90400},callbacks:{move_objects:function(a){var d=a||{},c=this,u=r.tree,p=d.item||u.selected(),f=p&&1==p.length?u.itemData(p):void 0,m=c.generate_url(p,"move_objects",f,!0),h=c.generate_url(p,"move_objects_sql",f,!0);if(!f)return!1;var g=o.Model.extend({idAttribute:"id",defaults:{new_tblspc:void 0,obj_type:"all",user:void 0},schema:[{id:"tblspc",label:e("New tablespace"),type:"text",disabled:!1,control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return e&&e.label!=f.label}},{id:"obj_type",label:e("Object type"),type:"text",disabled:!1,control:"select2",select2:{allowClear:!1,width:"100%"},options:[{label:e("All"),value:"all"},{label:e("Tables"),value:"tables"},{label:e("Indexes"),value:"indexes"},{label:e("Materialized views"),value:"materialized_views"}]},{id:"user",label:e("Object owner"),type:"text",disabled:!1,control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{id:"sqltab",label:e("SQL"),group:e("SQL"),type:"text",disabled:!1,control:s.SqlTabControl.extend({initialize:function(){s.SqlTabControl.prototype.initialize.apply(this,arguments)},onTabChange:function(e){if(this.dialog&&e.shown==this.tabIndex){var t=this,i=t.model.toJSON();i.old_tblspc=f.label,n.ajax({url:h,type:"GET",cache:!1,data:i,dataType:"json",contentType:"application/json"}).done(function(e){t.sqlCtrl.clearHistory(),t.sqlCtrl.setValue(e.data),t.sqlCtrl.refresh()}).fail(function(){t.model.trigger("pgadmin-view:msql:error")}).always(function(){t.model.trigger("pgadmin-view:msql:fetched")})}}})}],validate:function(){return null}});l.move_objects_dlg||l.dialog("move_objects_dlg",function(){return{main:function(){var t=e("Move objects to another tablespace");this.set("title",t)},build:function(){l.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:e("Users"),url:t("help.static",{filename:"move_objects.html"})}},{text:e("Cancel"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button"},{text:e("OK"),key:13,className:"btn btn-primary fa fa-lg fa-save pg-alertify-button"}],options:{padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1}}},hooks:{onclose:function(){this.view&&this.view.remove({data:!0,internal:!0,silent:!0})}},prepare:function(){var t=this,o=n("<div class='move_objects'></div>");this.__internal.buttons[2].element.disabled=!0;var a=r.tree,l=a.selected(),d=l&&1==l.length?a.itemData(l):void 0,c=d&&r.Nodes[d._type];if(d){var u=c.getTreeNodeHierarchy.apply(c,[l]),p=new g({},{node_info:u}),f=s.generateViewSchema(u,p,"create",c,u.server,!0),m=this.view=new s.Dialog({el:o,model:p,schema:f});n(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),m.render(),this.elements.content.appendChild(o.get(0)),this.view.model.on("change",function(){i.isUndefined(this.get("tblspc"))||""===this.get("tblspc")?(t.__internal.buttons[2].element.disabled=!0,this.errorModel.set("tblspc",e("Please select tablespace"))):(this.errorModel.clear(),t.__internal.buttons[2].element.disabled=!1)})}},callback:function(t){if("dialog_help"==t.button.element.name)return t.cancel=!0,void r.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null);if(t.button.text===e("OK")){var i=this,o=this.view.model.toJSON();o.old_tblspc=f.label,t.cancel=!0,l.confirm(e("Move objects..."),e("Are you sure you wish to move the objects from %(old_tablespace)s to %(new_tablespace)s?",{old_tablespace:o.old_tblspc,new_tablespace:o.tblspc}),function(){n.ajax({url:m,method:"PUT",data:{data:JSON.stringify(o)}}).done(function(e){e.success?(l.success(e.info),i.close()):l.error(e.errormsg)}).fail(function(e,t,n){l.pgRespErrorNotify(e,n)})},function(){})}}}}),l.move_objects_dlg(!0).resizeTo(r.stdW.md,r.stdH.md)}},model:r.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,owner:void 0,comment:void 0,spclocation:void 0,spcoptions:[],spcacl:[],seclabels:[]},initialize:function(e,t){if(0===i.size(e)){var n=r.serverInfo[t.node_info.server._id].user;this.set({spcuser:n.name},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text"},{id:"oid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"spclocation",label:e("Location"),cell:"string",group:e("Definition"),type:"text",mode:["properties","edit","create"],disabled:function(e){return!e.isNew()}},{id:"spcuser",label:e("Owner"),cell:"string",type:"text",control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"spcoptions",label:e("Parameters"),type:"collection",group:e("Parameters"),control:"variable-collection",model:r.Node.VariableModel,mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0},{id:"spcacl",label:e("Privileges"),type:"collection",group:e("Security"),control:"unique-col-collection",model:r.Node.PrivilegeRoleModel.extend({privileges:["C"]}),mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"],columns:["grantee","grantor","privileges"]},{id:"seclabels",label:e("Security Labels"),model:r.SecLabelModel,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){var t;return i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Name cannot be empty."),this.errorModel.set("name",t)):i.isUndefined(this.get("spclocation"))||""==String(this.get("spclocation")).replace(/^\s+|\s+$/g,"")?(t=e("Location cannot be empty."),this.errorModel.set("spclocation",t),this.errorModel.unset("name")):(this.errorModel.unset("name"),this.errorModel.unset("spclocation")),null}})})),r.Nodes["coll-tablespace"]}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(1),n(5),n(7)],void 0!==(o=function(e,t,n,i){return i.Nodes["coll-resource_group"]||(i.Nodes["coll-resource_group"]=i.Collection.extend({node:"resource_group",label:e("Resource Groups"),type:"coll-resource_group",columns:["name","cpu_rate_limit","dirty_rate_limit"],canDrop:!0,canDropCascade:!1})),i.Nodes.resource_group||(i.Nodes.resource_group=i.Node.extend({parent_type:"server",type:"resource_group",dialogHelp:t("help.static",{ilename:"resource_group_dialog.html"}),label:e("Resource Group"),hasSQL:!0,canDrop:!0,Init:function(){this.initialized||(this.initialized=!0,i.add_menus([{name:"create_resourcegroup_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"},enable:function(e,t){return this.getTreeNodeHierarchy(t).server.connected&&"ppas"===e.server_type&&e.version>=90400}},{name:"create_resource_group_on_coll",node:"coll-resource_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"}},{name:"create_resource_group",node:"resource_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"}}]))},model:i.Node.Model.extend({idAttribute:"oid",defaults:{oid:void 0,name:void 0,cpu_rate_limit:0,dirty_rate_limit:0},schema:[{id:"oid",label:e("OID"),type:"text",editable:!1,disabled:!0,mode:["properties"]},{id:"name",label:e("Name"),cell:"string",type:"text"},{id:"cpu_rate_limit",label:e("CPU rate limit (%%)"),cell:"string",type:"numeric",min:0,max:16777216},{id:"dirty_rate_limit",label:e("Dirty rate limit (KB)"),cell:"string",type:"numeric",min:0,max:16777216}],validate:function(){var t,i=this.get("name");if(n.isUndefined(i)||n.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,""))return t=e("Name cannot be empty."),this.errorModel.set("name",t),t;this.errorModel.unset("name");var o=this.get("cpu_rate_limit");if(n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,""))return t=e("CPU rate limit cannot be empty."),this.errorModel.set("cpu_rate_limit",t),t;this.errorModel.unset("cpu_rate_limit");var a=this.get("dirty_rate_limit");return n.isUndefined(a)||n.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(t=e("Dirty rate limit cannot be empty."),this.errorModel.set("dirty_rate_limit",t),t):(this.errorModel.unset("dirty_rate_limit"),null)}})})),i.Nodes["coll-resource_group"]}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(6),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l){return r.Nodes["coll-event_trigger"]||(a.Browser.Nodes["coll-event_trigger"]=a.Browser.Collection.extend({node:"event_trigger",label:e("Event Trigger"),type:"coll-event_trigger",columns:["name","eventowner","comment"],canDrop:!0,canDropCascade:!1})),r.Nodes.event_trigger||(a.Browser.Nodes.event_trigger=a.Browser.Node.extend({parent_type:"database",type:"event_trigger",sqlAlterHelp:"sql-altereventtrigger.html",sqlCreateHelp:"sql-createeventtrigger.html",dialogHelp:t("help.static",{filename:"event_trigger_dialog.html"}),label:e("Event Trigger"),hasSQL:!0,hasDepends:!0,canDrop:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_event_trigger_on_coll",node:"coll-event_trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"}},{name:"create_event_trigger",node:"event_trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"}},{name:"create_event_trigger",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"},enable:r.Nodes.database.is_conn_allow}]))},model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{oid:void 0,name:void 0,eventowner:void 0,comment:void 0,enabled:"O",eventfuncoid:void 0,eventfunname:void 0,eventname:"DDL_COMMAND_START",when:void 0,xmin:void 0,source:void 0,language:void 0},initialize:function(e,t){if(0===i.size(e)){var n=r.serverInfo[t.node_info.server._id].user;this.set({eventowner:n.name},{silent:!0})}a.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"eventowner",label:e("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:l.NodeListByNameControl},{id:"comment",label:e("Comment"),type:"multiline"},{id:"enabled",label:e("Enabled status"),type:"radio",group:e("Definition"),mode:["properties","edit","create"],options:[{label:"Enable",value:"O"},{label:"Disable",value:"D"},{label:"Replica",value:"R"},{label:"Always",value:"A"}]},{id:"eventfunname",label:e("Trigger function"),type:"text",control:"node-ajax-options",group:e("Definition"),url:"fopts",cache_node:"trigger_function"},{id:"eventname",label:e("Events"),type:"radio",group:e("Definition"),cell:"string",options:[{label:"DDL COMMAND START",value:"DDL_COMMAND_START"},{label:"DDL COMMAND END",value:"DDL_COMMAND_END"},{label:"SQL DROP",value:"SQL_DROP"}]},{id:"when",label:e("When"),type:"multiline",group:e("Definition")},{id:"seclabels",label:e("Security Labels"),model:r.SecLabelModel,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){var t=void 0;return this.errorModel.clear(),i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Event trigger name cannot be empty."),this.errorModel.set("name",t),t):i.isUndefined(this.get("eventowner"))||""==String(this.get("eventowner")).replace(/^\s+|\s+$/g,"")?(t=e("Event trigger owner cannot be empty."),this.errorModel.set("eventowner",t),t):i.isUndefined(this.get("enabled"))?(t=e("Event trigger enabled status cannot be empty."),this.errorModel.set("enabled",t),t):i.isUndefined(this.get("eventfunname"))||""==String(this.get("eventfunname")).replace(/^\s+|\s+$/g,"")?(t=e("Event trigger function cannot be empty."),this.errorModel.set("eventfunname",t),t):i.isUndefined(this.get("eventname"))?(t=e("Event trigger event cannot be empty."),this.errorModel.set("eventname",t),t):null}})})),r.Nodes["coll-event_trigger"]}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(6),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l){return r.Nodes["coll-extension"]||(a.Browser.Nodes["coll-extension"]=a.Browser.Collection.extend({node:"extension",label:e("Extension"),type:"coll-extension",columns:["name","owner","comment"]})),r.Nodes.extension||(a.Browser.Nodes.extension=a.Browser.Node.extend({parent_type:"database",type:"extension",sqlAlterHelp:"sql-alterextension.html",sqlCreateHelp:"sql-createextension.html",dialogHelp:t("help.static",{filename:"extension_dialog.html"}),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,label:e("Extension"),Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_extension_on_coll",node:"coll-extension",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"}},{name:"create_extension",node:"extension",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"}},{name:"create_extension",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"},enable:r.Nodes.database.is_conn_allow}]))},model:a.Browser.Node.Model.extend({idAttribute:"eid",schema:[{id:"name",label:e("Name"),first_empty:!0,type:"text",mode:["properties","create","edit"],visible:!0,url:"avails",disabled:function(e){return!e.isNew()},transform:function(e,t){var n=[],o=t||this,a=o.model.get("name");return o.model.isNew()?e&&i.isArray(e)&&i.each(e,function(e){null===e.installed_version&&n.push({label:e.name,value:JSON.stringify(e)})}):n.push({label:a,value:a}),n},control:l.NodeAjaxOptionsControl.extend({getValueFromDOM:function(){var e=this.formatter.toRaw(i.unescape(this.$el.find("select").val()),this.model);return""===e?null:("string"==typeof e&&(e=JSON.parse(e)),e.name)},onChange:function(){l.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this.$el.find("select").val();if(""!=e.trim()){var t=this.formatter.toRaw(e,this.model);"string"==typeof t&&(t=JSON.parse(t)),this.model.set({version:"",relocatable:i.isNull(t.relocatable[0])||i.isUndefined(t.relocatable[0])?"":t.relocatable[0]})}else this.model.set({version:"",relocatable:!0,schema:""})}})},{id:"eid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:e("Owner"),control:"node-list-by-name",mode:["properties"],node:"role",cell:"string",cache_level:"server"},{id:"schema",label:e("Schema"),type:"text",control:"node-list-by-name",group:e("Definition"),mode:["properties","create","edit"],deps:["relocatable"],node:"schema",first_empty:!0,disabled:function(e){return!!e.has("relocatable")&&!e.get("relocatable")}},{id:"relocatable",label:e("Relocatable?"),cell:"switch",group:e("Definition"),type:"switch",mode:["properties"]},{id:"version",label:e("Version"),cell:"string",mode:["properties","create","edit"],group:e("Definition"),control:"node-ajax-options",url:"avails",first_empty:!0,transform:function(e,t){var n=[],o=t||this,a=o.model.get("name");return i.each(e,function(e){e.name==a&&e.version&&i.isArray(e.version)&&i.each(e.version,function(e){n.push({label:e,value:e})})}),n}},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",disabled:!0}],validate:function(){var t,n={},o=this.get("name");return i.isUndefined(o)||i.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(n.name=e("Name cannot be empty."),t=t||n.name,this.errorModel.set("name",t),t):(this.errorModel.unset("name"),null)}})})),r.Nodes["coll-extension"]}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(6),n(7),n(16)],void 0!==(o=function(e,t,n,i,o,a,r,l){return r.Nodes["coll-language"]||(r.Nodes["coll-language"]=r.Collection.extend({node:"language",label:e("Languages"),type:"coll-language",columns:["name","lanowner","description"]})),r.Nodes.language||(r.Nodes.language=r.Node.extend({parent_type:"database",type:"language",sqlAlterHelp:"sql-alterlanguage.html",sqlCreateHelp:"sql-createlanguage.html",dialogHelp:t("help.static",{filename:"language_dialog.html"}),label:e("Language"),hasSQL:!0,canDrop:!0,canDropCascade:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_language_on_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"},enable:r.Nodes.database.is_conn_allow},{name:"create_language_on_coll",node:"coll-language",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"}},{name:"create_language",node:"language",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"}}]))},model:r.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,lanowner:void 0,comment:void 0,lanacl:[],seclabels:[],trusted:!0,lanproc:void 0,laninl:void 0,lanval:void 0,is_template:!1,template_list:[]},initialize:function(e,t){if(0===i.size(e)){var n=r.serverInfo[t.node_info.server._id].user;this.set({lanowner:n.name},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),type:"text",control:"node-ajax-options",mode:["properties","create","edit"],url:"get_templates",select2:{allowClear:!1,tags:!0,multiple:!1},transform:function(e,t){var n=[],o=t||this,a=o.model.get("name");if(o.model.isNew()){var r=[];e&&i.isArray(e)&&i.each(e,function(e){n.push({label:e.tmplname,value:e.tmplname}),r.push(e.tmplname)}),this.model.set({template_list:r})}else n.push({label:a,value:a});return n}},{id:"oid",label:e("OID"),cell:"string",mode:["properties"],type:"text",disabled:!0},{id:"lanowner",label:e("Owner"),type:"text",control:l.NodeListByNameControl,node:"role",mode:["edit","properties","create"],select2:{allowClear:!1}},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"trusted",label:e("Trusted?"),type:"switch",group:e("Definition"),mode:["edit","properties","create"],deps:["name"],disabled:function(e){if(e.isNew()){if(-1==e.get("template_list").indexOf(e.get("name")))return e.set({is_template:!1}),!1;e.set({is_template:!0})}return!0}},{id:"lanproc",label:e("Handler Function"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],first_empty:!1,transform:function(e){var t=[];return e&&i.isArray(e)&&i.each(e,function(e){"handler"==e.prop_type&&t.push({label:e.label,value:e.label})}),t},disabled:function(e){return!e.isNew()||-1!=e.get("template_list").indexOf(e.get("name"))}},{id:"laninl",label:e("Inline Function"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],first_empty:!1,transform:function(e){var t=[];return e&&i.isArray(e)&&i.each(e,function(e){"inline"==e.prop_type&&t.push({label:e.label,value:e.label})}),t},disabled:function(e){return!e.isNew()||-1!=e.get("template_list").indexOf(e.get("name"))}},{id:"lanval",label:e("Validator Function"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],transform:function(e){var t=[];return e&&i.isArray(e)&&i.each(e,function(e){"validator"==e.prop_type&&t.push({label:e.label,value:e.label})}),t},disabled:function(e){return!e.isNew()||-1!=e.get("template_list").indexOf(e.get("name"))}},{id:"lanacl",label:e("Privileges"),type:"collection",group:e("Security"),control:"unique-col-collection",mode:["edit","create"],model:r.Node.PrivilegeRoleModel.extend({privileges:["U"]}),canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:e("Security Labels"),mode:["edit","create"],model:r.SecLabelModel,editable:!1,type:"collection",group:e("Security"),min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){var t,n=this.get("name");if(i.isUndefined(n)||i.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,""))return t=e("Name cannot be empty."),this.errorModel.set("name",t),t;if(this.errorModel.unset("name"),!this.get("is_template")){var o=this.get("lanproc");if(i.isUndefined(o)||i.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,""))return t=e("Handler Function cannot be empty."),this.errorModel.set("lanproc",t),t;this.errorModel.unset("lanproc")}return null}})})),r.Nodes["coll-language"]}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(6),n(7),n(16)],void 0!==(o=function(e,t,n,i,o,a,r,l){var s=r.Node.Model.extend({idAttribute:"fdwoption",defaults:{fdwoption:void 0,fdwvalue:void 0},schema:[{id:"fdwoption",label:e("Option"),type:"text",cellHeaderClasses:"width_percent_50",editable:!0},{id:"fdwvalue",label:e("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0}],validate:function(){if(i.isUndefined(this.get("fdwoption"))||i.isNull(this.get("fdwoption"))||""==String(this.get("fdwoption")).replace(/^\s+|\s+$/g,"")){var e="Please enter an option name";return this.errorModel.set("fdwoption",e),e}return this.errorModel.unset("fdwoption"),null}});return r.Nodes["coll-foreign_data_wrapper"]||(r.Nodes["coll-foreign_data_wrapper"]=r.Collection.extend({node:"foreign_data_wrapper",label:e("Foreign Data Wrappers"),type:"coll-foreign_data_wrapper",columns:["name","fdwowner","description"]})),r.Nodes.foreign_data_wrapper||(r.Nodes.foreign_data_wrapper=r.Node.extend({parent_type:"database",type:"foreign_data_wrapper",sqlAlterHelp:"sql-alterforeigndatawrapper.html",sqlCreateHelp:"sql-createforeigndatawrapper.html",dialogHelp:t("help.static",{filename:"foreign_data_wrapper_dialog.html"}),label:e("Foreign Data Wrapper"),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_foreign_data_wrapper_on_coll",node:"coll-foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"}},{name:"create_foreign_data_wrapper",node:"foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"}},{name:"create_foreign_data_wrapper",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"},enable:r.Nodes.database.is_conn_allow}]))},model:r.Node.Model.extend({idAttribute:"fdwoid",defaults:{name:void 0,fdwowner:void 0,comment:void 0,fdwvalue:void 0,fdwhan:void 0,fdwoption:void 0,fdwacl:[]},initialize:function(e,t){if(0===i.size(e)){var n=r.serverInfo[t.node_info.server._id].user;this.set({fdwowner:n.name},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:function(){return"edit"==this.mode&&this.node_info.server.version<90200}},{id:"fdwoid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"fdwowner",label:e("Owner"),type:"text",control:l.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:!1}},{id:"fdwhan",label:e("Handler"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","create","properties"],url:"get_handlers"},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"fdwoptions",label:e("Options"),type:"collection",group:e("Options"),model:s,control:"unique-col-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["fdwoption"],columns:["fdwoption","fdwvalue"]},{id:"fdwvalue",label:e("Validator"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","create","properties"],url:"get_validators"},{id:"security",label:e("Security"),type:"group"},{id:"fdwacl",label:e("Privileges"),type:"collection",group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"],model:r.Node.PrivilegeRoleModel.extend({privileges:["U"]}),control:"unique-col-collection"},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0}],validate:function(){var t=this.get("name");if(i.isUndefined(t)||i.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")){var n=e("Name cannot be empty.");return this.errorModel.set("name",n),n}return this.errorModel.unset("name"),null}})})),r.Nodes.foreign_data_wrapper}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(0),n(1),n(8),n(3),n(5),n(6),n(7),n(16)],void 0!==(o=function(e,t,n,i,o,a,r){var l=o.Browser.Node.Model.extend({idAttribute:"fsrvoption",defaults:{fsrvoption:void 0,fsrvvalue:void 0},schema:[{id:"fsrvoption",label:e("Options"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0},{id:"fsrvvalue",label:e("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0}],validate:function(){if(n.isUndefined(this.get("fsrvoption"))||n.isNull(this.get("fsrvoption"))||""==String(this.get("fsrvoption")).replace(/^\s+|\s+$/g,"")){var e="Please enter an option name";return this.errorModel.set("fsrvoption",e),e}return this.errorModel.unset("fsrvoption"),null}});return a.Nodes["coll-foreign_server"]||(o.Browser.Nodes["coll-foreign_server"]=o.Browser.Collection.extend({node:"foreign_server",label:e("Foreign Servers"),type:"coll-foreign_server",columns:["name","fsrvowner","description"]})),a.Nodes.foreign_server||(o.Browser.Nodes.foreign_server=o.Browser.Node.extend({parent_type:"foreign_data_wrapper",type:"foreign_server",sqlAlterHelp:"sql-alterforeignserver.html",sqlCreateHelp:"sql-createforeignserver.html",label:e("Foreign Server"),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_foreign_server_on_coll",node:"coll-foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}},{name:"create_foreign_server",node:"foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}},{name:"create_foreign_server",node:"foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}}]))},model:o.Browser.Node.Model.extend({idAttribute:"fsrvid",defaults:{name:void 0,fsrvtype:void 0,fsrvversion:void 0,fsrvvalue:void 0,fsrvoptions:[],fsrvowner:void 0,description:void 0,fsrvacl:[]},initialize:function(e,t){if(0===n.size(e)){var i=a.serverInfo[t.node_info.server._id].user;this.set({fsrvowner:i.name},{silent:!0})}o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:function(){return"edit"==this.mode&&this.node_info.server.version<90200}},{id:"fsrvid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"fsrvowner",label:e("Owner"),type:"text",control:r.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:!1}},{id:"fsrvtype",label:e("Type"),cell:"string",group:e("Definition"),type:"text",mode:["edit","create","properties"],disabled:function(e){return!e.isNew()}},{id:"fsrvversion",label:e("Version"),cell:"string",group:e("Definition"),type:"text"},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"fsrvoptions",label:e("Options"),type:"collection",group:e("Options"),model:l,control:"unique-col-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["fsrvoption"],columns:["fsrvoption","fsrvvalue"]},a.SecurityGroupSchema,{id:"fsrvacl",label:e("Privileges"),type:"collection",group:"security",model:o.Browser.Node.PrivilegeRoleModel.extend({privileges:["U"]}),control:"unique-col-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0}],validate:function(){var t=this.get("name");if(n.isUndefined(t)||n.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")){var i=e("Name cannot be empty.");return this.errorModel.set("name",i),i}return this.errorModel.unset("name"),null}})})),a.Nodes["coll-foreign_server"]}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(6),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l){var s=a.Browser.Node.Model.extend({idAttribute:"umoption",defaults:{umoption:void 0,umvalue:void 0},schema:[{id:"umoption",label:e("Options"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0},{id:"umvalue",label:e("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0}],validate:function(){if(i.isUndefined(this.get("umoption"))||i.isNull(this.get("umoption"))||""==String(this.get("umoption")).replace(/^\s+|\s+$/g,"")){var e="Please enter an option name";return this.errorModel.set("umoption",e),e}return this.errorModel.unset("umoption"),null}});return r.Nodes["coll-user_mapping"]||(a.Browser.Nodes["coll-user_mapping"]=a.Browser.Collection.extend({node:"user_mapping",label:e("User Mappings"),type:"coll-user_mapping",columns:["name"]})),r.Nodes.user_mapping||(a.Browser.Nodes.user_mapping=a.Browser.Node.extend({parent_type:"foreign_server",type:"user_mapping",sqlAlterHelp:"sql-alterusermapping.html",sqlCreateHelp:"sql-createusermapping.html",dialogHelp:t("help.static",{filename:"user_mapping_dialog.html"}),label:e("User Mapping"),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_user_mapping_on_coll",node:"coll-user_mapping",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}},{name:"create_user_mapping",node:"user_mapping",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}},{name:"create_user_mapping",node:"foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}}]))},model:a.Browser.Node.Model.extend({idAttribute:"um_oid",defaults:{name:void 0,um_options:[]},initialize:function(e,t){if(0===i.size(e)){var n=r.serverInfo[t.node_info.server._id].user;this.set({name:n.name},{silent:!0})}a.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("User"),type:"text",control:l.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:!1},disabled:function(e){return!e.isNew()},transform:function(){var e=this,t=e.field.get("schema_node"),n=l.NodeListByNameControl.prototype.defaults.transform.apply(this,arguments);return n.unshift({label:"CURRENT_USER",value:"CURRENT_USER",image:"icon-"+t.type},{label:"PUBLIC",value:"PUBLIC",image:"icon-"+t.type}),n}},{id:"um_oid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"umoptions",label:e("Options"),type:"collection",group:e("Options"),model:s,control:"unique-col-collection",mode:["create","edit"],canAdd:!0,canDelete:!0,uniqueCol:["umoption"]}],validate:function(){var t=this.get("name");if(i.isUndefined(t)||i.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")){var n=e("Name cannot be empty.");return this.errorModel.set("name",n),n}return this.errorModel.unset("name"),null}})})),r.Nodes["coll-user_mapping"]}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(5),n(6),n(13),n(7),n(16)],void 0!==(o=function(e,t,n,i,o,a,r,l){return r.VacuumCollectionControl=r.Control.extend({grid_columns:void 0,initialize:function(){r.Control.prototype.initialize.apply(this,arguments);var e=this,t=this.model,o=e.field.get("url");if(o&&t.isNew()){var a,l=e.field.get("node"),s=e.field.get("node_data"),d=e.field.get("node_info"),c=l.generate_url.apply(l,[null,o,s,!1,d]);t.trigger("pgadmin-view:fetching",t,e.field),n.ajax({async:!1,url:c}).done(function(e){a=e}).fail(function(){t.trigger("pgadmin-view:fetch:error",t,e.field)}),t.trigger("pgadmin-view:fetched",t,e.field),a&&i.isArray(a)&&t.get(e.field.get("name")).reset(a,{silent:!0})}},render:function(){var e=this,t=e.field.attributes;e.grid&&(e.grid.remove(),delete e.grid,e.grid=void 0),e.$el.empty();var o=i.template(['<div class="subnode-header">','  <label class="control-label col-sm-4"><%-label%></label>',"</div>"].join("\n")),a=n('<div class="pgadmin-control-group backgrid form-group col-12 object subnode"></div>').append(o(t)),r=e.grid=new l.Grid({columns:e.grid_columns,collection:e.model.get(e.field.get("name")),className:"backgrid table-bordered table-noouter-border table-hover"});return e.$el.append(n(a).append(r.render().$el)),e}}),r.cellFunction=function(e){switch(e.get("column_type")){case"integer":return l.IntegerCell;case"number":return l.NumberCell;case"string":return l.StringCell;default:return l.Cell}},r.VacuumTableModel=a.Node.Model.extend({defaults:{name:void 0,setting:void 0,label:void 0,value:void 0,column_type:void 0},toJSON:function(){var e=a.Node.Model.prototype.toJSON.apply(this);return delete e.label,delete e.setting,delete e.column_type,e}}),r.VacuumSettingsSchema=[{id:"spacer_ctrl",group:e("Table"),mode:["edit","create"],type:"spacer"},{id:"autovacuum_custom",label:e("Custom auto-vacuum?"),group:e("Table"),mode:["edit","create"],type:"switch",disabled:function(e){return e.top&&e.top.get("is_partitioned")?(setTimeout(function(){e.set("autovacuum_custom",!1)},10),!0):!!e.top.inSchema.apply(this,[e])}},{id:"autovacuum_enabled",label:e("Enabled?"),group:e("Table"),mode:["edit","create"],type:"switch",deps:["autovacuum_custom"],disabled:function(e){return!(!e.top.inSchema.apply(this,[e])&&1==e.get("autovacuum_custom"))&&(setTimeout(function(){e.set("autovacuum_enabled",!1)},10),!0)}},{id:"vacuum_table",label:e("Vacuum Table"),model:r.VacuumTableModel,editable:!1,type:"collection",canEdit:!0,group:e("Table"),mode:["edit","create"],url:"get_table_vacuum",control:r.VacuumCollectionControl.extend({grid_columns:[{name:"label",label:e("Label"),headerCell:l.Extension.CustomHeaderCell,cell:"string",editable:!1,cellHeaderClasses:"width_percent_40"},{name:"value",label:e("Value"),cellHeaderClasses:"width_percent_30",cellFunction:r.cellFunction,editable:function(e){return e.handler.get("autovacuum_enabled")},headerCell:l.Extension.CustomHeaderCell},{name:"setting",label:e("Default value"),cellHeaderClasses:"width_percent_30",headerCell:l.Extension.CustomHeaderCell,cellFunction:r.cellFunction,editable:!1}]}),deps:["autovacuum_enabled"]},{id:"spacer_ctrl",group:e("Toast Table"),mode:["edit","create"],type:"spacer"},{id:"toast_autovacuum",label:e("Custom auto-vacuum?"),group:e("Toast Table"),mode:["edit","create"],type:"switch",disabled:function(e){return!(!e.top.inSchema.apply(this,[e])&&e.isNew())&&!!(e.top.inSchema.apply(this,[e])||!0!==e.get("toast_autovacuum_enabled")&&!0!==e.top.get("hastoasttable"))}},{id:"toast_autovacuum_enabled",label:e("Enabled?"),group:e("Toast Table"),mode:["edit","create"],type:"switch",deps:["toast_autovacuum"],disabled:function(e){return!(!e.top.inSchema.apply(this,[e])&&!0===e.get("toast_autovacuum"))&&((e.isNew()||e.get("hastoasttable"))&&setTimeout(function(){e.set("toast_autovacuum_enabled",!1)},10),!0)}},{id:"vacuum_toast",label:e("Vacuum Toast Table"),model:r.VacuumTableModel,type:"collection",editable:function(e){return e.isNew()},canEdit:!0,group:e("Toast Table"),mode:["properties","edit","create"],url:"get_toast_table_vacuum",control:r.VacuumCollectionControl.extend({grid_columns:[{name:"label",label:e("Label"),headerCell:l.Extension.CustomHeaderCell,cell:"string",editable:!1,cellHeaderClasses:"width_percent_40"},{name:"value",label:e("Value"),cellHeaderClasses:"width_percent_30",headerCell:l.Extension.CustomHeaderCell,cellFunction:r.cellFunction,editable:function(e){return e.handler.get("toast_autovacuum_enabled")}},{name:"setting",label:e("Default value"),cellHeaderClasses:"width_percent_30",headerCell:l.Extension.CustomHeaderCell,cellFunction:r.cellFunction,editable:!1}]}),deps:["toast_autovacuum_enabled"]}],a.Nodes["coll-schema"]||(a.Nodes["coll-schema"]=a.Collection.extend({node:"schema",label:e("Schemas"),type:"coll-schema",columns:["name","namespaceowner","description"]})),a.Nodes.schema||(a.Nodes.schema=a.Node.extend({parent_type:"database",type:"schema",sqlAlterHelp:"sql-alterschema.html",sqlCreateHelp:"sql-createschema.html",dialogHelp:t("help.static",{filename:"schema_dialog.html"}),label:e("Schema"),hasSQL:!0,canDrop:!0,canDropCascade:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_schema_on_coll",node:"coll-schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"}},{name:"create_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"}},{name:"create_schema",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"},enable:"can_create_schema"}]))},can_create_schema:function(e){return a.Nodes.database.is_conn_allow.call(this,e)},model:a.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,namespaceowner:void 0,description:void 0,is_system_obj:void 0},initialize:function(e,t){if(0===i.size(e)){var n=a.serverInfo[t.node_info.server._id].user;this.set({namespaceowner:n.name},{silent:!0})}a.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text"},{id:"oid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"namespaceowner",label:e("Owner"),cell:"string",type:"text",control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{id:"is_sys_object",label:e("System schema?"),cell:"switch",type:"switch",mode:["properties"],disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"tblacl",label:e("Default TABLE privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"seqacl",label:e("Default SEQUENCE privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"funcacl",label:e("Default FUNCTION privileges"),group:e("Security"),type:"text",mode:["properties"],disabled:!0},{id:"typeacl",label:e("Default TYPE privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0,min_version:90200,visible:function(){return this.version_compatible}},{id:"nspacl",label:e("Privileges"),model:a.Node.PrivilegeRoleModel.extend({privileges:["C","U"]}),uniqueCol:["grantee","grantor"],editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"seclabels",label:e("Security Labels"),model:a.SecLabelModel,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"},{type:"nested",control:"tab",group:e("Default Privileges"),mode:["create","edit"],schema:[{id:"deftblacl",model:a.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),label:e("Default Privileges: Tables"),editable:!1,type:"collection",group:e("Tables"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"defseqacl",model:a.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),label:e("Default Privileges: Sequences"),editable:!1,type:"collection",group:e("Sequences"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deffuncacl",model:a.Node.PrivilegeRoleModel.extend({privileges:["X"]}),label:e("Default Privileges: Functions"),editable:!1,type:"collection",group:e("Functions"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deftypeacl",model:a.Node.PrivilegeRoleModel.extend({privileges:["U"]}),label:e("Default Privileges: Types"),editable:!1,type:"collection",group:e("Types"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"],min_version:90200}]}],validate:function(){var t=null;return this.errorModel.clear(),i.isUndefined(this.get("name"))||i.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Name cannot be empty."),this.errorModel.set("name",t),t):i.isUndefined(this.get("namespaceowner"))||i.isNull(this.get("namespaceowner"))||""==String(this.get("namespaceowner")).replace(/^\s+|\s+$/g,"")?(t=e("Owner cannot be empty."),this.errorModel.set("namespaceowner",t),t):null}})}),a.tableChildTreeNodeHierarchy=function(e){return this.getTreeNodeHierarchy(e)}),l.Extension.TableChildSwitchCell=l.Extension.SwitchCell.extend({initialize:function(){l.Extension.SwitchCell.prototype.initialize.apply(this,arguments),l.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e,t=this.model,n=this.column,o=this.column.get("editable"),a=this.$el.find("input[type=checkbox]").first(),r=n.get("name");return e=i.isFunction(o)?!!o.apply(n,[t]):!!o,e?(this.$el.addClass("editable"),a.bootstrapToggle("disabled",!1)):(this.$el.removeClass("editable"),a.bootstrapToggle("disabled",!0),setTimeout(function(){t.set(r,!1)},10)),this.delegateEvents(),this},remove:l.Extension.DependentCell.prototype.remove}),a.Nodes.schema}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(0),n(1),n(3),n(5),n(7)],void 0!==(o=function(e,t,n,i,o){return o.Nodes["coll-catalog"]||(o.Nodes["coll-catalog"]=o.Collection.extend({node:"catalog",label:e("Catalogs"),type:"coll-catalog",columns:["name","namespaceowner","description"],canDrop:!1,canDropCascade:!1})),o.Nodes.catalog||(o.Nodes.catalog=o.Node.extend({parent_type:"database",type:"catalog",label:e("Catalog"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0)},model:o.Node.Model.extend({defaults:{name:void 0,namespaceowner:void 0,nspacl:void 0,description:void 0,securitylabel:[]},initialize:function(e,t){if(0===n.size(e)){var i=o.serverInfo[t.node_info.server._id].user;this.set({namespaceowner:i.name},{silent:!0})}o.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:!0},{id:"oid",label:e("OID"),cell:"string",mode:["properties"],type:"text",disabled:!0},{id:"namespaceowner",label:e("Owner"),cell:"string",type:"text",disabled:!0},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"seclabels",label:e("Security Labels"),model:o.SecLabelModel,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){return null}})})),o.Nodes.catalog}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(0),n(1),n(8),n(3),n(5),n(7)],void 0!==(o=function(e,t,n,i,o,a){return a.Nodes["coll-catalog_object"]||(o.Browser.Nodes["coll-catalog_object"]=o.Browser.Collection.extend({node:"catalog_object",label:e("Catalog Objects"),type:"coll-catalog_object",columns:["name","owner","description"],canDrop:!1,canDropCascade:!1})),a.Nodes.catalog_object||(o.Browser.Nodes.catalog_object=o.Browser.Node.extend({parent_type:"catalog",type:"catalog_object",label:e("Catalog Object"),hasSQL:!1,hasScriptTypes:[],hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0)},model:o.Browser.Node.Model.extend({defaults:{name:void 0,namespaceowner:void 0,nspacl:void 0,description:void 0},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:!0},{id:"oid",label:e("OID"),cell:"string",type:"text",disabled:!0},{id:"owner",label:e("Owner"),cell:"string",type:"text",disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline",disabled:!0}]})})),a.Nodes.catalog_object}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(14),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s){return r.Nodes["coll-collation"]||(a.Browser.Nodes["coll-collation"]=a.Browser.Collection.extend({node:"collation",label:e("Collations"),type:"coll-collation",columns:["name","owner","description"],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),r.Nodes.collation||(a.Browser.Nodes.collation=l.SchemaChildNode.extend({type:"collation",sqlAlterHelp:"sql-altercollation.html",sqlCreateHelp:"sql-createcollation.html",dialogHelp:t("help.static",{filename:"collation_dialog.html"}),label:e("Collation"),collection_type:"coll-collation",hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_collation_on_coll",node:"coll-collation",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_collation",node:"collation",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_collation",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:!1},enable:"canCreate"}]))},model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,owner:void 0,lc_type:void 0,lc_collate:void 0,description:void 0},initialize:function(e,t){if(0===i.size(e)){var n=r.serverInfo[t.node_info.server._id].user,o=t.node_info.schema;this.set({owner:n.name},{silent:!0}),this.set({schema:o._label},{silent:!0})}a.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchema",control:"node-list-by-name",node:"role"},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",disabled:"inSchema",filter:function(e){return!e||!e.label.match(/^pg_/)},control:"node-list-by-name",cache_node:"database",cached_level:"database"},{id:"copy_collation",label:e("Copy collation"),cell:"string",control:"node-ajax-options",type:"text",mode:["create","edit"],group:e("Definition"),url:"get_collations",disabled:"inSchemaWithModelCheck",deps:["locale","lc_collate","lc_type"]},{id:"locale",label:e("Locale"),cell:"string",type:"text",mode:["create","edit"],group:e("Definition"),disabled:"inSchemaWithModelCheck",deps:["lc_collate","lc_type","copy_collation"]},{id:"lc_collate",label:e("LC_COLLATE"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Definition"),deps:["locale","copy_collation"],disabled:"inSchemaWithModelCheck"},{id:"lc_type",label:e("LC_TYPE"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Definition"),disabled:"inSchemaWithModelCheck",deps:["locale","copy_collation"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function(){var t={},n=void 0,o=this.changed,a=!1,r=!1,l=!1,s=!1,d=this.toJSON();return this.errorModel.clear(),(i.has(o,d.name)&&i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(n=e("Name cannot be empty."),this.errorModel.set("name",n)),i.has(o,d.locale)&&(i.isUndefined(this.get("locale"))||""==String(this.get("locale")).replace(/^\s+|\s+$/g,""))&&(a=!0),i.has(o,d.lc_collate)&&(i.isUndefined(this.get("lc_collate"))||""==String(this.get("lc_collate")).replace(/^\s+|\s+$/g,""))&&(l=!0),i.has(o,d.lc_type)&&(i.isUndefined(this.get("lc_type"))||""==String(this.get("lc_type")).replace(/^\s+|\s+$/g,""))&&(r=!0),i.has(o,d.copy_collation)&&(i.isUndefined(this.get("copy_collation"))||""==String(this.get("copy_collation")).replace(/^\s+|\s+$/g,""))&&(s=!0),a&&(l||r)&&s&&(n=e("Definition incomplete. Please provide Locale OR Copy Collation OR LC_TYPE/LC_COLLATE."),t.locale=n),null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||(e.isNew()&&"copy_collation"==this.name?!!e.get("locale")||!(!e.get("lc_collate")&&!e.get("lc_type")):!e.isNew()||"lc_collate"!=this.name&&"lc_type"!=this.name?e.isNew()&&"locale"==this.name?!(!e.get("lc_collate")&&!e.get("lc_type"))||!!e.get("copy_collation"):!e.isNew():!!e.get("locale")||!!e.get("copy_collation"))}})})),r.Nodes.collation}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(10),n(3),n(5),n(6),n(13),n(14),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d,c){r.Nodes["coll-domain"]||(r.Nodes["coll-domain"]=r.Collection.extend({node:"domain",label:e("Domains"),type:"coll-domain",columns:["name","owner","description"],canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema}));var u=r.Node.Model.extend({idAttribute:"conoid",initialize:function(e){0===!i.size(e)&&(this.convalidated_default=this.get("convalidated")),r.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{conoid:void 0,conname:void 0,consrc:void 0,convalidated:!0},convalidated_default:!0,schema:[{id:"conoid",type:"text",cell:"string",visible:!1},{id:"conname",label:e("Name"),type:"text",cell:"string",cellHeaderClasses:"width_percent_40",editable:function(e){if(i.isUndefined(e.isNew))return!0;if(!e.isNew()){if(this.get("node_info").server.version<90200)return!1}return!0}},{id:"consrc",label:e("Check"),type:"multiline",cell:s.Extension.TextareaCell,group:e("Definition"),cellHeaderClasses:"width_percent_60",editable:function(e){return!!i.isUndefined(e.isNew)||e.isNew()}},{id:"convalidated",label:e("Validate?"),type:"switch",cell:"boolean",group:e("Definition"),editable:function(e){return!(this.get("node_info").server.version<90200||!i.isUndefined(e.isNew)&&!e.isNew()&&e.get("convalidated")&&e.convalidated_default)}}],toJSON:o.Model.prototype.toJSON,validate:function(){return null}});return r.Nodes.domain||(r.Nodes.domain=d.SchemaChildNode.extend({type:"domain",sqlAlterHelp:"sql-alterdomain.html",sqlCreateHelp:"sql-createdomain.html",dialogHelp:t("help.static",{filename:"domain_dialog.html"}),label:e("Domain"),collection_type:"coll-domain",hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_domain_on_coll",node:"coll-domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain",node:"domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:!1},enable:"canCreate"}]))},model:r.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){if(0===i.size(e)){var n=t.node_info.schema.label;this.set({basensp:n},{silent:!0});var o=r.serverInfo[t.node_info.server._id].user;this.set({owner:o.name},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,owner:void 0,basensp:void 0,description:void 0,basetype:void 0,typlen:void 0,precision:void 0,typdefault:void 0,typnotnull:void 0,sysdomain:void 0,collname:void 0,constraints:[],seclabels:[]},type_options:void 0,schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",control:l.NodeListByNameControl,node:"role",type:"text",mode:["edit","create","properties"]},{id:"basensp",label:e("Schema"),cell:"node-list-by-name",control:"node-list-by-name",cache_level:"database",type:"text",node:"schema",mode:["create","edit"]},{id:"sysdomain",label:e("System domain?"),cell:"boolean",type:"switch",mode:["properties"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"basetype",label:e("Base type"),cell:"string",control:"node-ajax-options",type:"text",url:"get_types",mode:["properties","create","edit"],group:e("Definition"),first_empty:!0,cache_node:"type",disabled:function(e){return!e.isNew()},transform:function(e){return this.model.type_options=e,e}},{id:"typlen",label:e("Length"),cell:"string",type:"text",group:e("Definition"),deps:["basetype"],disabled:function(e){if(!e.isNew())return!0;var t=e.get("basetype");return e.type_options&&i.each(e.type_options,function(n){t==n.value&&n.length&&(e.set("is_tlength",!0,{silent:!0}),e.set("min_val",n.min_val,{silent:!0}),e.set("max_val",n.max_val,{silent:!0}))}),!e.get("is_tlength")}},{id:"precision",label:e("Precision"),cell:"string",type:"text",group:e("Definition"),deps:["basetype"],disabled:function(e){if(!e.isNew())return!0;var t=e.get("basetype");return e.type_options&&i.each(e.type_options,function(n){t==n.value&&n.precision&&(e.set("is_precision",!0,{silent:!0}),e.set("min_val",n.min_val,{silent:!0}),e.set("max_val",n.max_val,{silent:!0}))}),!e.get("is_precision")}},{id:"typdefault",label:e("Default"),cell:"string",type:"text",group:e("Definition"),placeholder:"Enter an expression or a value."},{id:"typnotnull",label:e("Not Null?"),cell:"boolean",type:"switch",group:e("Definition")},{id:"collname",label:e("Collation"),cell:"string",control:"node-ajax-options",type:"text",url:"get_collations",group:e("Definition"),cache_level:"database",cache_node:"schema",disabled:function(e){return!e.isNew()}},{id:"constraints",label:e("Constraints"),cell:"string",type:"collection",group:e("Constraints"),mode:["edit","create"],model:u,canAdd:!0,canDelete:!0,canEdit:!1,columns:["conname","consrc","convalidated"]},r.SecurityGroupSchema,{id:"seclabels",label:e("Security Labels"),model:r.SecLabelModel,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(){var t,n={};return(i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(n.name=e("Name cannot be empty."),t=t||n.name),(i.isUndefined(this.get("basetype"))||""==String(this.get("basetype")).replace(/^\s+|\s+$/g,""))&&(n.basetype=e("Base Type cannot be empty."),t=t||n.basetype),this.errorModel.clear().set(n),t}}),isDisabled:function(e){if(!e.isNew()){if(this.node_info.server.version<90200)return!1}return!0}})),r.Nodes.domain}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l){return r.Nodes["coll-domain_constraints"]||(a.Browser.Nodes["coll-domain_constraints"]=a.Browser.Collection.extend({node:"domain_constraints",label:e("Domain Constraints"),type:"coll-domain_constraints",columns:["name","description"],canDrop:l.isTreeItemOfChildOfSchema,canDropCascade:!1})),r.Nodes.domain_constraints||(a.Browser.Nodes.domain_constraints=r.Node.extend({type:"domain_constraints",sqlAlterHelp:"sql-alterdomain.html",sqlCreateHelp:"sql-alterdomain.html",dialogHelp:t("help.static",{filename:"domain_constraint_dialog.html"}),label:e("Domain Constraints"),collection_type:"coll-domain_constraints",hasSQL:!0,hasDepends:!0,parent_type:["domain"],Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_domain_on_coll",node:"coll-domain_constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain_constraints",node:"domain_constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain_constraints",node:"domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:!1},enable:"canCreate"}]))},canDrop:l.isTreeItemOfChildOfSchema,model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,description:void 0,consrc:void 0,connoinherit:void 0,convalidated:!0},schema:[{id:"name",label:e("Name"),type:"text",cell:"string",disabled:"isDisabled"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"description",label:e("Comment"),type:"multiline",cell:"string",mode:["properties","create","edit"],min_version:90500},{id:"consrc",label:e("Check"),type:"multiline",cel:"string",group:e("Definition"),mode:["properties","create","edit"],disabled:function(e){return!e.isNew()}},{id:"connoinherit",label:e("No inherit"),type:"switch",cell:"boolean",group:e("Definition"),mode:["properties","create","edit"],disabled:"isDisabled",visible:!1},{id:"convalidated",label:e("Validate?"),type:"switch",cell:"boolean",group:e("Definition"),min_version:90200,disabled:function(e){if(!e.isNew()){return this.node_info.server.version<90200||!!e.get("convalidated")}return!1},mode:["properties","create","edit"]}],validate:function(){var t,n={};return(i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(n.name=e("Name cannot be empty."),t=t||n.name),(i.isUndefined(this.get("consrc"))||""==String(this.get("consrc")).replace(/^\s+|\s+$/g,""))&&(n.consrc=e("Check cannot be empty."),t=t||n.consrc),this.errorModel.clear().set(n),i.size(n)?(this.trigger("on-status",{msg:t}),t):null},isDisabled:function(e){if(!e.isNew()){if(this.node_info.server.version<90200)return!0}return!1}})})),r.Nodes.domain}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(10),n(3),n(5),n(6),n(13),n(14),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d,c){r.Nodes["coll-foreign_table"]||(r.Nodes["coll-foreign_table"]=r.Collection.extend({node:"foreign_table",label:e("Foreign Tables"),type:"coll-foreign_table",columns:["name","owner","description"],canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema}));var u=r.Node.Model.extend({idAttribute:"option",defaults:{option:void 0,value:void 0},schema:[{id:"option",label:e("Option"),type:"text",editable:!0,cellHeaderClasses:"width_percent_30"},{id:"value",label:e("Value"),type:"text",editable:!0,cellHeaderClasses:"width_percent_50"}],validate:function(){if(i.isUndefined(this.get("value"))||i.isNull(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")){var e="Please enter a value.";return this.errorModel.set("value",e),e}return this.errorModel.unset("value"),null}}),p=r.Node.Model.extend({idAttribute:"attnum",defaults:{attname:void 0,datatype:void 0,typlen:void 0,precision:void 0,typdefault:void 0,attnotnull:void 0,collname:void 0,attnum:void 0,inheritedfrom:void 0,inheritedid:void 0,attstattarget:void 0,coloptions:[]},type_options:void 0,schema:[{id:"attname",label:e("Name"),cell:"string",type:"text",editable:"is_editable_column",cellHeaderClasses:"width_percent_40"},{id:"datatype",label:e("Data Type"),cell:"node-ajax-options",control:"node-ajax-options",type:"text",url:"get_types",editable:"is_editable_column",cellHeaderClasses:"width_percent_0",group:e("Definition"),transform:function(e,t){return t.model.type_options=e,e}},{id:"typlen",label:e("Length"),cell:"string",group:e("Definition"),type:"int",deps:["datatype"],disabled:function(e){var t=e.get("typlen");if(!(i.isUndefined(e.get("inheritedid"))||i.isNull(e.get("inheritedid"))||i.isUndefined(e.get("inheritedfrom"))||i.isNull(e.get("inheritedfrom"))))return i.isUndefined(t)||setTimeout(function(){e.set("typlen",void 0)},10),!0;var n=e.get("datatype"),o=!1;return e.type_options?(e.set("is_tlength",!1,{silent:!0}),i.each(e.type_options,function(t){n==t.value&&t.length&&(o=!0,e.set("is_tlength",!0,{silent:!0}),e.set("min_val",t.min_val,{silent:!0}),e.set("max_val",t.max_val,{silent:!0}))}),o||i.isUndefined(t)||setTimeout(function(){e.set("typlen",void 0)},10),!e.get("is_tlength")):(o||i.isUndefined(t)||setTimeout(function(){e.set("typlen",void 0)},10),!0)},cellHeaderClasses:"width_percent_10"},{id:"precision",label:e("Precision"),type:"int",deps:["datatype"],cell:"string",group:e("Definition"),disabled:function(e){var t=e.get("precision");if(!(i.isUndefined(e.get("inheritedid"))||i.isNull(e.get("inheritedid"))||i.isUndefined(e.get("inheritedfrom"))||i.isNull(e.get("inheritedfrom"))))return i.isUndefined(t)||setTimeout(function(){e.set("precision",void 0)},10),!0;var n=e.get("datatype"),o=!1;return e.type_options?(e.set("is_precision",!1,{silent:!0}),i.each(e.type_options,function(t){n==t.value&&t.precision&&(o=!0,e.set("is_precision",!0,{silent:!0}),e.set("min_val",t.min_val,{silent:!0}),e.set("max_val",t.max_val,{silent:!0}))}),o||i.isUndefined(t)||setTimeout(function(){e.set("precision",void 0)},10),!e.get("is_precision")):(o||i.isUndefined(t)||setTimeout(function(){e.set("precision",void 0)},10),!0)},cellHeaderClasses:"width_percent_10"},{id:"typdefault",label:e("Default"),type:"text",cell:"string",min_version:90300,group:e("Definition"),placeholder:"Enter an expression or a value.",cellHeaderClasses:"width_percent_10",editable:function(e){return!!(i.isUndefined(e.get("inheritedid"))||i.isNull(e.get("inheritedid"))||i.isUndefined(e.get("inheritedfrom"))||i.isNull(e.get("inheritedfrom")))&&!(this.get("node_info").server.version<90300)}},{id:"attnotnull",label:e("Not Null"),cell:"boolean",type:"switch",editable:"is_editable_column",cellHeaderClasses:"width_percent_10",group:e("Definition")},{id:"attstattarget",label:e("Statistics"),min_version:90200,cell:"integer",type:"int",group:e("Definition"),editable:function(e){return!i.isUndefined(e.isNew)&&!e.isNew()&&(!(this.get("node_info").server.version<90200)&&!!(i.isUndefined(e.get("inheritedid"))||i.isNull(e.get("inheritedid"))||i.isUndefined(e.get("inheritedfrom"))||i.isNull(e.get("inheritedfrom"))))},cellHeaderClasses:"width_percent_10"},{id:"collname",label:e("Collation"),cell:"node-ajax-options",control:"node-ajax-options",type:"text",url:"get_collations",min_version:90300,editable:function(e){return!(!i.isUndefined(e.isNew)&&!e.isNew())&&!!(i.isUndefined(e.get("inheritedid"))||i.isNull(e.get("inheritedid"))||i.isUndefined(e.get("inheritedfrom"))||i.isNull(e.get("inheritedfrom")))},cellHeaderClasses:"width_percent_20",group:e("Definition")},{id:"attnum",cell:"string",type:"text",visible:!1},{id:"inheritedfrom",label:e("Inherited From"),cell:"string",type:"text",visible:!1,mode:["properties","edit"],cellHeaderClasses:"width_percent_10"},{id:"coloptions",label:e("Options"),cell:"string",type:"collection",group:e("Options"),mode:["edit","create"],model:u,canAdd:!0,canDelete:!0,canEdit:!1,control:l.UniqueColCollectionControl,uniqueCol:["option"],min_version:90200}],validate:function(){var t=null;return i.isUndefined(this.get("attname"))||""==String(this.get("attname")).replace(/^\s+|\s+$/g,"")?(t=e("Column Name cannot be empty."),this.errorModel.set("attname",t)):this.errorModel.unset("attname"),i.isUndefined(this.get("datatype"))||""==String(this.get("datatype")).replace(/^\s+|\s+$/g,"")?(t=e("Column Datatype cannot be empty."),this.errorModel.set("datatype",t)):this.errorModel.unset("datatype"),t},is_editable_column:function(e){return!!(i.isUndefined(e.get("inheritedid"))||i.isNull(e.get("inheritedid"))||i.isUndefined(e.get("inheritedfrom"))||i.isNull(e.get("inheritedfrom")))},toJSON:o.Model.prototype.toJSON}),f=l.NodeAjaxOptionsControl.extend({onChange:function(){var e=this.model,t=this.field.get("name").split("."),n=t.shift(),a=t.join("."),r=this.getValueFromDOM(),l={},s=e.get("columns"),d=e.get(n);if(this.model.errorModel instanceof o.Model)if(i.isEmpty(a))this.model.errorModel.unset(n);else{var c=this.model.errorModel.get(n);c&&(this.keyPathSetter(c,a,null),this.model.errorModel.set(n,c))}var u=this;if("string"==typeof d&&(d=JSON.parse(d)),i.size(r)<i.size(d)){var p=i.difference(d,r),f=s.where({inheritedid:parseInt(p[0])});s.remove(f)}else i.each(r,function(e){var t=s.where({inheritedid:parseInt(e)});if(t&&t.length<=0){var n=u.fetchColumns(e);s.add(n)}});l[n]=i.isEmpty(a)?r:i.clone(e.get(n))||{},this.stopListening(this.model,"change:"+n,this.render),e.set(l),this.listenTo(this.model,"change:"+n,this.render)},fetchColumns:function(e){var t=this,i="get_columns",o=t.model.top||t.model,a=this.field.get("schema_node"),l=this.field.get("node_info"),s=a.generate_url.apply(a,[null,i,this.field.get("node_data"),this.field.get("url_with_id")||!1,l]),d=this.field.get("cache_level")||a.type,c=this.field.get("cache_node");c=c&&r.Nodes.cache_node||a,o.trigger("pgadmin:view:fetching",o,t.field);var u={attrelid:e};return n.ajax({async:!1,url:s,data:u}).done(function(e){u=c.cache(i,l,d,e.data)}).fail(function(){o.trigger("pgadmin:view:fetch:error",o,t.field)}),o.trigger("pgadmin:view:fetched",o,t.field),u=u&&u.data||[]}}),m=r.Node.Model.extend({idAttribute:"conoid",initialize:function(e){0===i.size(e)||(this.convalidated_default=this.get("convalidated")),r.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{conoid:void 0,conname:void 0,consrc:void 0,connoinherit:void 0,convalidated:!0,conislocal:void 0},convalidated_default:!0,schema:[{id:"conoid",type:"text",cell:"string",visible:!1},{id:"conname",label:e("Name"),type:"text",cell:"string",editable:"is_editable",cellHeaderClasses:"width_percent_30"},{id:"consrc",label:e("Check"),type:"multiline",editable:"is_editable",cell:s.Extension.TextareaCell,cellHeaderClasses:"width_percent_30"},{id:"connoinherit",label:e("No Inherit"),type:"switch",cell:"boolean",editable:"is_editable",cellHeaderClasses:"width_percent_20"},{id:"convalidated",label:e("Validate?"),type:"switch",cell:"boolean",cellHeaderClasses:"width_percent_20",editable:function(e){return!!i.isUndefined(e.isNew)||(!!e.isNew()||(!e.get("convalidated")||!e.convalidated_default))}}],validate:function(){var t,n={};return(i.isUndefined(this.get("conname"))||""==String(this.get("conname")).replace(/^\s+|\s+$/g,""))&&(n.conname=e("Constraint Name cannot be empty."),t=t||n.conname),(i.isUndefined(this.get("consrc"))||""==String(this.get("consrc")).replace(/^\s+|\s+$/g,""))&&(n.consrc=e("Constraint Check cannot be empty."),t=t||n.consrc),this.errorModel.clear().set(n),t},is_editable:function(e){return!!i.isUndefined(e.isNew)||e.isNew()},toJSON:o.Model.prototype.toJSON}),h=r.Node.Model.extend({defaults:{option:void 0,value:void 0},schema:[{id:"option",label:e("Option"),cell:"string",type:"text",editable:!0,cellHeaderClasses:"width_percent_50"},{id:"value",label:e("Value"),cell:"string",type:"text",editable:!0,cellHeaderClasses:"width_percent_50"}],validate:function(){},toJSON:o.Model.prototype.toJSON});return r.Nodes.foreign_table||(r.Nodes.foreign_table=d.SchemaChildNode.extend({type:"foreign_table",sqlAlterHelp:"sql-alterforeigntable.html",sqlCreateHelp:"sql-createforeigntable.html",dialogHelp:t("help.static",{filename:"foreign_table_dialog.html"}),label:e("Foreign Table"),collection_type:"coll-foreign_table",hasSQL:!0,hasDepends:!0,hasScriptTypes:["create","select","insert","update","delete"],parent_type:["schema"],Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_foreign_table_on_coll",node:"coll-foreign_table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_foreign_table",node:"foreign_table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_foreign_table",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:!1},enable:"canCreate"}]))},model:r.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){if(0===i.size(e)){var n=t.node_info.schema._label,o=r.serverInfo[t.node_info.server._id].user;this.set({basensp:n,owner:o.name},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,owner:void 0,basensp:void 0,description:void 0,ftsrvname:void 0,strftoptions:void 0,inherits:[],columns:[],constraints:[],ftoptions:[],relacl:[],stracl:[],seclabels:[]},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",control:l.NodeListByNameControl,node:"role",type:"text",select2:{allowClear:!1}},{id:"basensp",label:e("Schema"),cell:"node-list-by-name",control:"node-list-by-name",cache_level:"database",type:"text",node:"schema",mode:["create","edit"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"ftsrvname",label:e("Foreign server"),cell:"string",control:"node-ajax-options",type:"text",group:e("Definition"),url:"get_foreign_servers",disabled:function(e){return!e.isNew()},cache_node:"database"},{id:"inherits",label:e("Inherits"),group:e("Definition"),type:"array",min_version:90500,control:f,url:"get_tables",select2:{multiple:!0},cache_level:"database",transform:function(e){if("edit"==this.field.get("mode")){var t=this.model.get("oid"),n=i.findWhere(e,{id:t});n&&(e=i.reject(e,n))}return e}},{id:"columns",label:e("Columns"),cell:"string",type:"collection",group:e("Columns"),mode:["edit","create"],model:p,canAdd:!0,canDelete:!0,canEdit:!0,columns:["attname","datatype","inheritedfrom"],canDeleteRow:function(e){return!!(i.isUndefined(e.get("inheritedid"))||i.isNull(e.get("inheritedid"))||i.isUndefined(e.get("inheritedfrom"))||i.isNull(e.get("inheritedfrom")))},canEditRow:function(e){return!!(i.isUndefined(e.get("inheritedid"))||i.isNull(e.get("inheritedid"))||i.isUndefined(e.get("inheritedfrom"))||i.isNull(e.get("inheritedfrom")))}},{id:"constraints",label:e("Constraints"),cell:"string",type:"collection",group:e("Constraints"),mode:["edit","create"],model:m,canAdd:!0,canDelete:!0,columns:["conname","consrc","connoinherit","convalidated"],canEdit:function(e){return!(e instanceof o.Model&&e instanceof m)||e.isNew()},min_version:90500,canDeleteRow:function(e){return!(1!=e.get("conislocal")&&!i.isUndefined(e.get("conislocal")))}},{id:"strftoptions",label:e("Options"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"ftoptions",label:e("Options"),cell:"string",type:"collection",group:e("Options"),mode:["edit","create"],model:h,canAdd:!0,canDelete:!0,canEdit:!1,control:"unique-col-collection",uniqueCol:["option"]},{id:"relacl",label:e("Privileges"),cell:"string",type:"text",group:e("Security"),mode:["properties"],min_version:90200},r.SecurityGroupSchema,{id:"acl",label:e("Privileges"),model:a.Browser.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","x"]}),uniqueCol:["grantee","grantor"],editable:!1,type:"collection",group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection",min_version:90200},{id:"seclabels",label:e("Security Labels"),model:r.SecLabelModel,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(){var t={},n=null;return(i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(t.name=e("Name cannot be empty."),n=n||t.name),(i.isUndefined(this.get("basensp"))||""==String(this.get("basensp")).replace(/^\s+|\s+$/g,""))&&(t.basensp=e("Schema cannot be empty."),n=n||t.basensp),(i.isUndefined(this.get("ftsrvname"))||""==String(this.get("ftsrvname")).replace(/^\s+|\s+$/g,""))&&(t.ftsrvname=e("Foreign server cannot be empty."),n=n||t.ftsrvname),this.errorModel.clear().set(t),n}})})),r.Nodes.foreign_table}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(10),n(3),n(5),n(6),n(13),n(14),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d,c){var u=a.Browser.Node.Model.extend({defaults:{token:void 0,dictname:void 0},keys:["token"],schema:[{id:"token",label:e("Token"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!1,cell:"string",url:"tokens"},{id:"dictname",label:e("Dictionaries"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!0,cell:s.Extension.MultiSelectAjaxCell,url:"dictionaries"}],validate:function(){var t;this.errorModel.clear();var n=this.get("token"),o=this.get("dictname");return i.isNull(n)||i.isUndefined(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(t=e("Token cannot be empty."),this.errorModel.set("token",t),t):i.isNull(o)||i.isUndefined(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(t=e("Dictionary name cannot be empty."),this.errorModel.set("dictname",t),t):null}}),p=l.TokenControl=l.UniqueColCollectionControl.extend({initialize:function(){l.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var t=this,r=[{id:"token",label:"",type:"text",url:"tokens",node:"fts_configuration",canAdd:!0,url_with_id:!0,control:l.NodeAjaxOptionsControl.extend({formatter:l.NodeAjaxOptionsControl.prototype.formatter,initialize:function(){l.NodeAjaxOptionsControl.prototype.initialize.apply(this,arguments);var e=this,t=e.field.get("url")||e.defaults.url,o=e.model.top||e.model;if(t){var r=this.field.get("schema_node"),s=this.field.get("node_info"),d=r.generate_url.apply(r,[null,t,this.field.get("node_data"),this.field.get("url_with_id")||!1,s]),c=this.field.get("cache_level")||r.type,u=this.field.get("cache_node");u=u&&a.Browser.Nodes[u]||r;var p=u.cache(t,s,c);this.field.get("version_compatible")&&(i.isUndefined(p)||i.isNull(p))&&(o.trigger("pgadmin:view:fetching",o,e.field),n.ajax({async:!1,url:d}).done(function(e){p=u.cache(t,s,c,e.data)}).fail(function(){o.trigger("pgadmin:view:fetch:error",o,e.field)}),o.trigger("pgadmin:view:fetched",o,e.field)),p=p&&p.data||[];var f=this.field.get("transform")||e.defaults.transform;f&&i.isFunction(f)?e.field.set("options",f.bind(e,p)):e.field.set("options",p)}}}),select2:{allowClear:!0,width:"style",placeholder:e("Select token")},first_empty:!0,disabled:function(){return i.isUndefined(t.model.get("oid"))}}],s={token:null},d=["token","dictname"];t.headerData=new(o.Model.extend({defaults:s,schema:r}))({});var c=l.generateViewSchema(t.field.get("node_info"),t.headerData,"create",t.field.get("schema_node"),t.field.get("node_data")),u=[];i.each(c,function(e){u=u.concat(e.fields)}),t.headerFields=new l.Fields(u),t.gridSchema=l.generateGridColumnsFromModel(t.field.get("node_info"),t.field.get("model"),"edit",d,t.field.get("schema_node")),t.controls=[],t.listenTo(t.headerData,"change",t.headerDataChanged),t.listenTo(t.headerData,"select2",t.headerDataChanged),t.listenTo(t.collection,"add",t.onAddorRemoveTokens),t.listenTo(t.collection,"remove",t.onAddorRemoveTokens)},generateHeader:function(t){var o=['<div class="subnode-header-form">',' <div class="container-fluid">','  <div class="row">','   <div class="col-3">','    <label class="control-label"><%-token_label%></label>',"   </div>",'   <div class="col-6" header="token"></div>','   <div class="col-2">','     <button class="btn btn-sm-sq btn-secondary add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> ></button>',"   </div>","  </div>"," </div>","</div>"].join("\n");i.extend(t,{token_label:e("Tokens")});var a=this,r=i.template(o),l=n(r(t)),s=this.controls;return a.headerFields.each(function(e){var t=new(e.get("control"))({field:e,model:a.headerData});l.find('div[header="'+e.get("name")+'"]').append(t.render().$el),t.$el.find(".control-label").remove(),s.push(t)}),"properties"==t.mode&&l.find("button.add").remove(),"create"==t.mode&&l.find("button.add").attr("disabled",!0),a.$header=l,l},events:i.extend({},l.UniqueColCollectionControl.prototype.events,{"click button.add":"addTokens"}),showGridControl:function(e){var t=this,o=i.template("<div class='subnode-header'></div>"),a=n("<div></div>",{class:"pgadmin-control-group backgrid form-group col-12 object subnode"}).append(o({label:e.label}));a.append(t.generateHeader(e));var r=i.clone(this.gridSchema.columns);0==e.disabled&&e.canDelete&&r.unshift({name:"pg-backform-delete",label:"",cell:s.Extension.DeleteCell,editable:!1,cell_priority:-1}),t.grid&&(t.grid.remove(),t.grid.null);var l=t.grid=new s.Grid({columns:r,collection:t.collection,className:"backgrid table-bordered"});return t.$grid=l.render().$el,a.append(t.$grid),setTimeout(function(){t.headerData.set({token:t.$header.find('div[header="token"] select').val()},{silent:!0})},10),a},headerDataChanged:function(){var e=this,t=this.headerData.toJSON(),n=i.isEmpty(t)||i.isUndefined(t);e.$header&&e.$header.find("button.add").prop("disabled",n)},addTokens:function(e){e.preventDefault();var t=this,o=t.headerData.get("token");if(!o||""==o)return!1;var a=t.model.get(t.field.get("name")),r=new(t.field.get("model"))(t.headerData.toJSON(),{silent:!0,top:t.model.top,collection:a,handler:a}),l=["token"],s=-1;t.collection.each(function(e){i.each(l,function(t){e.get(t)==o&&(s=a.indexOf(e))})}),-1==s&&(a.add(r),s=a.indexOf(r)),t.$grid.find(".new").removeClass("new");var d=t.grid.body.rows[s].$el;return d.addClass("new"),n(d).pgMakeVisible("backform-tab"),!1},onAddorRemoveTokens:function(){var e=this;setTimeout(function(){e.collection.trigger("pgadmin:tokens:updated",e.collection),e.headerDataChanged()},10)},remove:function(){this.stopListening(this.headerData,"change",this.headerDataChanged),this.listenTo(this.headerData,"select2",this.headerDataChanged),this.listenTo(this.collection,"remove",this.onAddorRemoveTokens),i.each(this.controls,function(e){e.remove()}),p.__super__.remove.apply(this,arguments),delete this.headerData}});return r.Nodes["coll-fts_configuration"]||(a.Browser.Nodes["coll-fts_configuration"]=a.Browser.Collection.extend({node:"fts_configuration",label:e("FTS Configurations"),type:"coll-fts_configuration",columns:["name","description"],canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema})),r.Nodes.fts_configuration||(a.Browser.Nodes.fts_configuration=d.SchemaChildNode.extend({type:"fts_configuration",sqlAlterHelp:"sql-altertsconfig.html",sqlCreateHelp:"sql-createtsconfig.html",dialogHelp:t("help.static",{filename:"fts_configuration_dialog.html"}),label:e("FTS Configuration"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_fts_configuration_on_schema",node:"schema",module:this,category:"create",priority:4,applies:["object","context"],callback:"show_obj_properties",label:e("FTS Configuration..."),icon:"wcTabIcon icon-fts_configuration",data:{action:"create"},enable:"canCreate"},{name:"create_fts_configuration_on_coll",module:this,priority:4,node:"coll-fts_configuration",applies:["object","context"],callback:"show_obj_properties",category:"create",label:e("FTS Configuration..."),data:{action:"create"},icon:"wcTabIcon icon-fts_configuration",enable:"canCreate"},{name:"create_fts_configuration",node:"fts_configuration",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Configuration..."),data:{action:"create"},icon:"wcTabIcon icon-fts_configuration",enable:"canCreate"}]))},model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,owner:void 0,description:void 0,schema:void 0,prsname:void 0,copy_config:void 0,tokens:void 0},initialize:function(e,t){var n=0===i.size(e);if(a.Browser.Node.Model.prototype.initialize.apply(this,arguments),n){var o=r.serverInfo[t.node_info.server._id].user;this.set({owner:o.name,schema:t.node_info.schema._id},{silent:!0})}},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:l.NodeListByNameControl,select2:{allowClear:!1}},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"prsname",label:e("Parser"),type:"text",url:"parsers",first_empty:!0,group:e("Definition"),control:"node-ajax-options",deps:["copy_config"],disabled:function(e){var t=e.get("copy_config");return!e.isNew()||!i.isNull(t)&&!i.isUndefined(t)&&""!==t}},{id:"copy_config",label:e("Copy Config"),type:"text",mode:["create"],group:e("Definition"),control:"node-ajax-options",url:"copyConfig",deps:["prsname"],disabled:function(e){var t=e.get("prsname");return!e.isNew()||!i.isNull(t)&&!i.isUndefined(t)&&""!==t}},{id:"tokens",label:e("Tokens"),type:"collection",group:e("Tokens"),control:p,model:u,columns:["token","dictionary"],uniqueCol:["token"],mode:["create","edit"],canAdd:!0,canEdit:!1,canDelete:!0}],validate:function(){var t,n=this.get("name"),o=this.get("prsname"),a=""===o||i.isUndefined(o)||i.isNull(o)?this.get("copy_config"):this.get("prsname"),r=this.get("schema");return this.errorModel.clear(),this.trigger("on-status-clear"),i.isUndefined(n)||i.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(t=e("Name must be specified."),this.errorModel.set("name",t),t):i.isUndefined(a)||i.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(t=e("Select parser or configuration to copy."),this.errorModel.set("parser",t),t):i.isUndefined(r)||i.isNull(r)||""==String(r).replace(/^\s+|\s+$/g,"")?(t=e("Schema must be selected."),this.errorModel.set("schema",t),t):null}})})),r.Nodes["coll-fts_configuration"]}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(6),n(14),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d){var c=a.Browser.Node.Model.extend({defaults:{options:void 0,value:void 0},schema:[{id:"option",label:e("Option"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!0},{id:"value",label:e("Value"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!0}],validate:function(){this.errorModel.clear();var t;return i.isUndefined(this.get("option"))||""==String(this.get("option")).replace(/^\s+|\s+$/g,"")?(t=e("Option cannot be empty."),this.errorModel.set("option",t),t):i.isUndefined(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")?(t=e("Value cannot be empty."),this.errorModel.set("value",t),t):t}});return r.Nodes["coll-fts_dictionary"]||(a.Browser.Nodes["coll-fts_dictionary"]=a.Browser.Collection.extend({node:"fts_dictionary",label:e("FTS Dictionaries"),type:"coll-fts_dictionary",columns:["name","description"],canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema})),r.Nodes.fts_dictionary||(a.Browser.Nodes.fts_dictionary=s.SchemaChildNode.extend({type:"fts_dictionary",sqlAlterHelp:"sql-altertsdictionary.html",sqlCreateHelp:"sql-createtsdictionary.html",dialogHelp:t("help.static",{filename:"fts_dictionary_dialog.html"}),label:e("FTS Dictionary"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_fts_dictionary_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Dictionary..."),icon:"wcTabIcon icon-fts_dictionary",data:{action:"create"},enable:"canCreate"},{name:"create_fts_dictionary_on_coll",node:"coll-fts_dictionary",module:this,applies:["object","context"],priority:4,callback:"show_obj_properties",category:"create",label:e("FTS Dictionary..."),data:{action:"create"},icon:"wcTabIcon icon-fts_dictionary",enable:"canCreate"},{name:"create_fts_dictionary",node:"fts_dictionary",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Dictionary..."),icon:"wcTabIcon icon-fts_dictionary",data:{action:"create"},enable:"canCreate"}]))},model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,owner:void 0,description:void 0,schema:void 0,template:void 0,options:void 0},initialize:function(e,t){var n=0===i.size(e);if(a.Browser.Node.Model.prototype.initialize.apply(this,arguments),n){var o=r.serverInfo[t.node_info.server._id].user;this.set({owner:o.name,schema:t.node_info.schema._id},{silent:!0})}},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:l.NodeListByNameControl},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",cache_node:"database",control:"node-list-by-id"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"template",label:e("Template"),type:"text",disabled:function(e){return!e.isNew()},url:"fetch_templates",group:e("Definition"),control:"node-ajax-options",cache_node:"fts_template"},{id:"options",label:e("Option"),type:"collection",group:e("Options"),control:"unique-col-collection",model:c,columns:["option","value"],uniqueCol:["option"],mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0}],validate:function(){var t,n=this.get("name"),o=this.get("template"),a=this.get("schema");return i.isUndefined(n)||i.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(t=e("Name must be specified."),this.errorModel.set("name",t),t):i.isUndefined(o)||i.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(t=e("Template must be selected."),this.errorModel.set("template",t),t):i.isUndefined(a)||i.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(t=e("Schema must be selected."),this.errorModel.set("schema",t),t):(this.errorModel.clear(),this.trigger("on-status-clear"),null)}})})),r.Nodes.fts_dictionary}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(5),n(14),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l){return a.Nodes["coll-fts_parser"]||(o.Browser.Nodes["coll-fts_parser"]=o.Browser.Collection.extend({node:"fts_parser",label:e("FTS Parsers"),type:"coll-fts_parser",columns:["name","description"],canDrop:l.isTreeItemOfChildOfSchema,canDropCascade:l.isTreeItemOfChildOfSchema})),a.Nodes.fts_parser||(o.Browser.Nodes.fts_parser=r.SchemaChildNode.extend({type:"fts_parser",sqlAlterHelp:"sql-altertsparser.html",sqlCreateHelp:"sql-createtsparser.html",dialogHelp:t("help.static",{filename:"fts_parser_dialog.html"}),label:e("FTS Parser"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_fts_parser_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},enable:"canCreate"},{name:"create_fts_parser_on_coll",node:"coll-fts_parser",applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},module:this,enable:"canCreate"},{name:"create_fts_parser",node:"fts_parser",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},enable:"canCreate"}]))},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,description:void 0,schema:void 0,prsstart:void 0,prstoken:void 0,prsend:void 0,prslextype:void 0,prsheadline:void 0},initialize:function(e,t){var n=0===i.size(e);o.Browser.Node.Model.prototype.initialize.apply(this,arguments),n&&this.set("schema",t.node_info.schema._id)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"prsstart",label:e("Start function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"start_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"},{id:"prstoken",label:e("Get next token function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"token_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"},{id:"prsend",label:e("End function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"end_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"},{id:"prslextype",label:e("Lextypes function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"lextype_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"},{id:"prsheadline",label:e("Headline function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"headline_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"}],validate:function(){var t,n=this.get("name"),o=this.get("prsstart"),a=this.get("prstoken"),r=this.get("prsend"),l=this.get("prslextype"),s=this.get("schema");return i.isUndefined(n)||i.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(t=e("Name must be specified."),this.errorModel.set("name",t),t):i.isUndefined(o)||i.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(t=e("Start function must be selected."),this.errorModel.set("prsstart",t),t):i.isUndefined(a)||i.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(t=e("Get next token function must be selected."),this.errorModel.set("prstoken",t),t):i.isUndefined(r)||i.isNull(r)||""==String(r).replace(/^\s+|\s+$/g,"")?(t=e("End function must be selected."),this.errorModel.set("prsend",t),t):i.isUndefined(l)||i.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(t=e("Lextype function must be selected."),this.errorModel.set("prslextype",t),t):i.isUndefined(s)||i.isNull(s)||""==String(s).replace(/^\s+|\s+$/g,"")?(t=e("Schema must be selected."),this.errorModel.set("schema",t),t):(this.errorModel.clear(),this.trigger("on-status-clear"),null)}})})),a.Nodes["coll-fts_parser"]}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(5),n(14),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l){return a.Nodes["coll-fts_template"]||(o.Browser.Nodes["coll-fts_template"]=o.Browser.Collection.extend({node:"fts_template",label:e("FTS Templates"),type:"coll-fts_template",columns:["name","description"],canDrop:l.isTreeItemOfChildOfSchema,canDropCascade:l.isTreeItemOfChildOfSchema})),a.Nodes.fts_template||(o.Browser.Nodes.fts_template=r.SchemaChildNode.extend({type:"fts_template",sqlAlterHelp:"sql-altertstemplate.html",sqlCreateHelp:"sql-createtstemplate.html",dialogHelp:t("help.static",{filename:"fts_template_dialog.html"}),label:e("FTS Template"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_fts_template_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"},{name:"create_fts_template_on_coll",node:"coll-fts_template",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"},{name:"create_fts_template",node:"fts_template",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"}]))},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,description:void 0,schema:void 0,tmplinit:void 0,tmpllexize:void 0},initialize:function(e,t){var n=0===i.size(e);o.Browser.Node.Model.prototype.initialize.apply(this,arguments),n&&this.set("schema",t.node_info.schema._id)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"tmplinit",label:e("Init function"),group:e("Definition"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"get_init",cache_level:"database",cache_node:"schema"},{id:"tmpllexize",label:e("Lexize function"),group:e("Definition"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"get_lexize",cache_level:"database",cache_node:"schema"}],validate:function(){var t,n=this.get("name"),o=this.get("tmpllexize"),a=this.get("schema");return i.isUndefined(n)||i.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(t=e("Name must be specified."),this.errorModel.set("name",t),t):i.isUndefined(o)||i.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(t=e("Lexize function must be selected."),this.errorModel.set("tmpllexize",t),t):i.isUndefined(a)||i.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(t=e("Schema must be selected."),this.errorModel.set("schema",t),t):(this.errorModel.clear(),this.trigger("on-status-clear"),null)}})})),a.Nodes.fts_template}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(17),n(83),n(14),n(12),n(7),n(16)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d,c){return r.Nodes["coll-procedure"]||(a.Browser.Nodes["coll-procedure"]=a.Browser.Collection.extend({node:"procedure",label:e("Procedures"),type:"coll-procedure",columns:["name","funcowner","description"],hasStatistics:!0,canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema})),r.Nodes.procedure||(a.Browser.Nodes.procedure=d.SchemaChildNode.extend({type:"procedure",sqlAlterHelp:"sql-alterprocedure.html",sqlCreateHelp:"sql-createprocedure.html",dialogHelp:t("help.static",{filename:"procedure_dialog.html"}),label:e("Procedure"),collection_type:"coll-procedure",hasSQL:!0,hasDepends:!0,hasStatistics:!0,hasScriptTypes:["create","exec"],width:r.stdW.md+"px",Init:function(){this.proc_initialized||(this.proc_initialized=!0,r.add_menus([{name:"create_procedure_on_coll",node:"coll-procedure",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:!1},enable:"canCreateProc"},{name:"create_procedure",node:"procedure",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:!0},enable:"canCreateProc"},{name:"create_procedure",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:!0},enable:"canCreateProc"}]))},canCreateProc:function(e,t){var n=this.getTreeNodeHierarchy.apply(this,[t]);return!("catalog"in n)&&("server"in n&&("ppas"==n.server.server_type||"pg"==n.server.server_type&&n.server.version>=11e4))},model:s.model.extend({defaults:i.extend({},s.model.prototype.defaults,{lanname:"edbspl"}),canVarAdd:function(){return!(this.node_info.server.version<90500)},isVisible:function(){return"sysfunc"!=this.name&&"sysproc"==this.name},isDisabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;switch(this.name){case"provolatile":case"proisstrict":case"procost":case"proleakproof":return(this.node_info.server.version<90500||"ppas"!=this.node_info.server.server_type||"edbspl"!=e.get("lanname"))&&(setTimeout(function(){e.set("provolatile",void 0),e.set("proisstrict",void 0),e.set("procost",void 0),e.set("proleakproof",void 0)},10),!0);case"variables":case"prosecdef":return this.node_info.server.version<90500;case"prorows":return!(this.node_info.server.version>=90500&&1==e.get("proretset"));case"funcowner":case"proargs":return!0;case"proparallel":return(this.node_info.server.version<90600||"ppas"!=this.node_info.server.server_type||"edbspl"!=e.get("lanname"))&&(setTimeout(function(){e.set("proparallel",void 0)},10),!0);case"lanname":return this.node_info.server.version<11e4;default:return!1}},validate:function(){var t,n={},o=this.get("seclabels");if((i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(n.name=e("Name cannot be empty."),t=t||n.name),(i.isUndefined(this.get("pronamespace"))||""==String(this.get("pronamespace")).replace(/^\s+|\s+$/g,""))&&(n.pronamespace=e("Schema cannot be empty."),t=t||n.pronamespace),(i.isUndefined(this.get("lanname"))||""==String(this.get("lanname")).replace(/^\s+|\s+$/g,""))&&(n.lanname=e("Language cannot be empty."),t=t||n.lanname),"c"==String(this.get("lanname"))?((i.isUndefined(this.get("probin"))||""==String(this.get("probin")).replace(/^\s+|\s+$/g,""))&&(n.probin=e("Object File cannot be empty."),t=t||n.probin),(i.isUndefined(this.get("prosrc_c"))||""==String(this.get("prosrc_c")).replace(/^\s+|\s+$/g,""))&&(n.prosrc_c=e("Link Symbol cannot be empty."),t=t||n.prosrc_c)):(i.isUndefined(this.get("prosrc"))||""==String(this.get("prosrc")).replace(/^\s+|\s+$/g,""))&&(n.prosrc=e("Code cannot be empty."),t=t||n.prosrc),o)for(var a,r=0;r<o.models.length&&!a;r++)(a=o.models[r].validate.apply(o.models[r]))&&(n.seclabels=a,t=t||a);return this.errorModel.clear().set(n),null}})})),r.Nodes.procedure}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(5),n(84),n(7),n(16)],void 0!==(o=function(e,t,n,i,o,a,r){return a.Nodes["coll-edbproc"]||(o.Browser.Nodes["coll-edbproc"]=o.Browser.Collection.extend({node:"edbproc",label:e("Procedures"),type:"coll-edbproc",columns:["name","funcowner","description"],hasStatistics:!0,canDrop:!1,canDropCascade:!1})),a.Nodes.edbproc||(o.Browser.Nodes.edbproc=a.Node.extend({type:"edbproc",dialogHelp:t("help.static",{filename:"edbproc_dialog.html"}),label:e("Procedure"),collection_type:"coll-edbproc",hasDepends:!0,canEdit:!1,hasSQL:!0,hasScriptTypes:[],parent_type:["package"],Init:function(){this.proc_initialized||(this.proc_initialized=!0)},canDrop:!1,canDropCascade:!1,model:r.model.extend({defaults:i.extend({},r.model.prototype.defaults,{lanname:"edbspl"}),isVisible:function(){return"sysfunc"!=this.name&&"sysproc"==this.name},validate:function(){return null}})})),a.Nodes.edbproc}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(5),n(7),n(16)],void 0!==(o=function(e,t,n,i,o,a){return a.Nodes["coll-edbvar"]||(a.Nodes["coll-edbvar"]=a.Collection.extend({node:"edbvar",label:e("Variables"),type:"coll-edbvar",columns:["name","funcowner","description"],canDrop:!1,canDropCascade:!1})),a.Nodes.edbvar||(a.Nodes.edbvar=a.Node.extend({type:"edbvar",dialogHelp:t("help.static",{filename:"edbvar_dialog.html"}),label:e("Function"),collection_type:"coll-edbvar",canEdit:!1,hasSQL:!0,hasScriptTypes:[],parent_type:["package"],Init:function(){this.initialized||(this.initialized=!0)},canDrop:!1,canDropCascade:!1,model:a.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,datatype:void 0,visibility:"Unknown"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties"],disabled:!0},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"datatype",label:e("Data type"),cell:"string",type:"text",disabled:!0},{id:"visibility",label:e("Visibility"),cell:"string",type:"text",mode:["properties"],disabled:!0}],validate:function(){return null}})})),a.Nodes.edbvar}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(5),n(6),n(14),n(12),n(7),n(16)],void 0!==(o=function(e,t,n,i,o,a,r,l,s){return a.Nodes["coll-trigger_function"]||(a.Nodes["coll-trigger_function"]=a.Collection.extend({node:"trigger_function",label:e("Trigger functions"),type:"coll-trigger_function",columns:["name","funcowner","description"],hasStatistics:!0,canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),a.Nodes.trigger_function||(a.Nodes.trigger_function=l.SchemaChildNode.extend({type:"trigger_function",sqlAlterHelp:"plpgsql-trigger.html",sqlCreateHelp:"plpgsql-trigger.html",dialogHelp:t("help.static",{filename:"trigger_function_dialog.html"}),label:e("Trigger function"),collection_type:"coll-trigger_function",hasSQL:!0,hasDepends:!0,hasStatistics:!0,Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_trigger_function_on_coll",node:"coll-trigger_function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_function",node:"trigger_function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_function",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:!1},enable:"canCreate"}]))},model:a.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){if(0===i.size(e)){var n=t.node_info.schema._id;this.set({pronamespace:n},{silent:!0});var o=a.serverInfo[t.node_info.server._id].user;this.set({funcowner:o.name},{silent:!0})}a.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,xmin:void 0,funcowner:void 0,pronamespace:void 0,description:void 0,pronargs:void 0,proargs:void 0,proargtypenames:void 0,prorettypename:"trigger",lanname:"plpgsql",provolatile:void 0,proretset:void 0,proisstrict:void 0,prosecdef:void 0,proiswindow:void 0,procost:void 0,prorows:void 0,proleakproof:void 0,args:[],prosrc:void 0,prosrc_c:void 0,probin:"$libdir/",options:[],variables:[],proacl:void 0,seclabels:[],acl:[],sysfunc:void 0,sysproc:void 0},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"isDisabled"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:e("Owner"),cell:"string",control:r.NodeListByNameControl,node:"role",type:"text",disabled:"isDisabled"},{id:"pronamespace",label:e("Schema"),cell:"string",control:"node-list-by-id",type:"text",cache_level:"database",node:"schema",disabled:"isDisabled",mode:["create","edit"]},{id:"sysfunc",label:e("System function?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"sysproc",label:e("System procedure?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",disabled:"isDisabled"},{id:"pronargs",label:e("Argument count"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"proargs",label:e("Arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties","edit"],disabled:"isDisabled"},{id:"proargtypenames",label:e("Signature arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"],disabled:"isDisabled"},{id:"prorettypename",label:e("Return type"),cell:"string",control:"select2",type:"text",group:e("Definition"),disabled:"isDisabled",first_empty:!0,select2:{width:"100%",allowClear:!1},mode:["create"],visible:"isVisible",options:[{label:e("trigger"),value:"trigger"},{label:e("event_trigger"),value:"event_trigger"}]},{id:"prorettypename",label:e("Return type"),cell:"string",type:"text",group:e("Definition"),mode:["properties","edit"],disabled:"isDisabled",visible:"isVisible"},{id:"lanname",label:e("Language"),cell:"string",control:"node-ajax-options",type:"text",group:e("Definition"),url:"get_languages",disabled:"isDisabled",transform:function(e){return i.reject(e,function(e){return"sql"==e.label||"edbspl"==e.label})},select2:{allowClear:!1}},{id:"prosrc",label:e("Code"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Definition"),deps:["lanname"],control:r.SqlFieldControl,extraClasses:["custom_height_css_class"],visible:function(e){return"c"!=e.get("lanname")},disabled:"isDisabled"},{id:"probin",label:e("Object file"),cell:"string",type:"text",group:e("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled"},{id:"prosrc_c",label:e("Link symbol"),cell:"string",type:"text",group:e("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled"},{id:"provolatile",label:e("Volatility"),cell:"string",control:"node-ajax-options",type:"text",group:e("Options"),options:[{label:"VOLATILE",value:"v"},{label:"STABLE",value:"s"},{label:"IMMUTABLE",value:"i"}],disabled:"isDisabled",select2:{allowClear:!1}},{id:"proretset",label:e("Returns a set?"),type:"switch",group:e("Options"),disabled:"isDisabled",visible:"isVisible"},{id:"proisstrict",label:e("Strict?"),type:"switch",disabled:"isDisabled",group:e("Options")},{id:"prosecdef",label:e("Security of definer?"),group:e("Options"),cell:"boolean",type:"switch",disabled:"isDisabled"},{id:"proiswindow",label:e("Window?"),group:e("Options"),cell:"boolean",type:"switch",disabled:"isDisabled",visible:"isVisible"},{id:"procost",label:e("Estimated cost"),type:"text",group:e("Options"),disabled:"isDisabled"},{id:"prorows",label:e("Estimated rows"),type:"text",group:e("Options"),disabled:"isDisabled",deps:["proretset"],visible:"isVisible"},{id:"proleakproof",label:e("Leak proof?"),group:e("Options"),cell:"boolean",type:"switch",min_version:90200,disabled:"isDisabled"},a.SecurityGroupSchema,{id:"proacl",label:e("Privileges"),mode:["properties"],group:e("Security"),type:"text"},{id:"variables",label:e("Parameters"),type:"collection",group:e("Parameters"),control:"variable-collection",model:a.Node.VariableModel,mode:["edit","create"],canAdd:"canVarAdd",canEdit:!1,canDelete:!0,disabled:"isDisabled"},{id:"acl",label:e("Privileges"),editable:!1,type:"collection",group:"security",mode:["edit","create"],model:a.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],disabled:"isDisabled",canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"seclabels",label:e("Security Labels"),canEdit:!0,model:a.SecLabelModel,type:"collection",min_version:90100,group:"security",mode:["edit","create"],canDelete:!0,control:"unique-col-collection",canAdd:!0,uniqueCol:["provider"],disabled:"isDisabled"}],validate:function(t){var n,o={},a=this.get("seclabels");if(t&&0==t.length)return this.errorModel.clear(),null;if((i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(o.name=e("Name cannot be empty."),n=n||o.name),(i.isUndefined(this.get("funcowner"))||""==String(this.get("funcowner")).replace(/^\s+|\s+$/g,""))&&(o.funcowner=e("Owner cannot be empty."),n=n||o.funcowner),(i.isUndefined(this.get("pronamespace"))||""==String(this.get("pronamespace")).replace(/^\s+|\s+$/g,""))&&(o.pronamespace=e("Schema cannot be empty."),n=n||o.pronamespace),(i.isUndefined(this.get("prorettypename"))||""==String(this.get("prorettypename")).replace(/^\s+|\s+$/g,""))&&(o.prorettypename=e("Return type cannot be empty."),n=n||o.prorettypename),(i.isUndefined(this.get("lanname"))||""==String(this.get("lanname")).replace(/^\s+|\s+$/g,""))&&(o.lanname=e("Language cannot be empty."),n=n||o.lanname),"c"==String(this.get("lanname"))?((i.isUndefined(this.get("probin"))||""==String(this.get("probin")).replace(/^\s+|\s+$/g,""))&&(o.probin=e("Object File cannot be empty."),n=n||o.probin),(i.isUndefined(this.get("prosrc_c"))||""==String(this.get("prosrc_c")).replace(/^\s+|\s+$/g,""))&&(o.prosrc_c=e("Link Symbol cannot be empty."),n=n||o.prosrc_c)):(i.isUndefined(this.get("prosrc"))||""==String(this.get("prosrc")).replace(/^\s+|\s+$/g,""))&&(o.prosrc=e("Code cannot be empty."),n=n||o.prosrc),a)for(var r,l=0;l<a.models.length&&!r;l++)(r=a.models[l].validate.apply(a.models[l]))&&(o.seclabels=r,n=n||r);return this.errorModel.clear().set(o),i.size(o)?(this.trigger("on-status",{msg:n}),n):null},isVisible:function(){return"sysproc"!=this.name},isDisabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;switch(this.name){case"proargs":case"proargtypenames":case"prorettypename":case"proretset":case"proiswindow":return!e.isNew();case"prorows":return 1!=e.get("proretset");default:return!1}},canVarAdd:function(){return!(this.node_info&&"catalog"in this.node_info)}})})),a.Nodes.trigger_function}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(5),n(6),n(14),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s){return a.Nodes["coll-package"]||(a.Nodes["coll-package"]=a.Collection.extend({node:"package",label:e("Packages"),type:"coll-package",columns:["name","owner","description"],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),a.Nodes.package||(a.Nodes.package=l.SchemaChildNode.extend({type:"package",dialogHelp:t("help.static",{filename:"package_dialog.html"}),label:e("Package"),collection_type:"coll-package",hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_package_on_coll",node:"coll-package",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_package",node:"package",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_package",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:!0},enable:"canCreate"}]))},canCreate:function(e,t,n){if(n&&0==n.check)return!0;var i=this.getTreeNodeHierarchy(t),o=i.server;return(!o||"pg"!==o.server_type)&&void 0==i.catalog},model:a.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,owner:void 0,is_sys_object:void 0,description:void 0,pkgheadsrc:void 0,pkgbodysrc:void 0,acl:void 0,pkgacl:[]},initialize:function(e,t){if(0===i.size(e)){var n=a.serverInfo[t.node_info.server._id].user,r=t.node_info.schema;this.set({owner:n.name,schema:r._label},{silent:!0})}o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:function(e){return!e.isNew()}},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:!0,editable:!1,visible:function(e){return!e.isNew()}},{id:"schema",label:e("Schema"),type:"text",node:"schema",control:"node-list-by-name",disabled:function(e){return!e.isNew()},filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"is_sys_object",label:e("System package?"),cell:"boolean",type:"switch",mode:["properties"]},{id:"description",label:e("Comment"),type:"multiline",mode:["properties","create","edit"]},{id:"pkgheadsrc",label:e("Header"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Code"),control:r.SqlFieldControl},{id:"pkgbodysrc",label:e("Body"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Code"),control:r.SqlFieldControl},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"]},{id:"pkgacl",label:e("Privileges"),type:"collection",model:a.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],editable:!1,group:e("Security"),mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection"}],validate:function(){var t=void 0;return this.errorModel.clear(),i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Name cannot be empty."),this.errorModel.set("name",t),t):i.isUndefined(this.get("pkgheadsrc"))||""==String(this.get("pkgheadsrc")).replace(/^\s+|\s+$/g,"")?(t=e("Header cannot be empty."),this.errorModel.set("pkgheadsrc",t),t):null}})})),a.Nodes.package}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(6),n(14),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d){return r.Nodes["coll-sequence"]||(r.Nodes["coll-sequence"]=r.Collection.extend({node:"sequence",label:e("Sequences"),type:"coll-sequence",columns:["name","seqowner","comment"],hasStatistics:!0,canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema})),r.Nodes.sequence||(r.Nodes.sequence=s.SchemaChildNode.extend({type:"sequence",sqlAlterHelp:"sql-altersequence.html",sqlCreateHelp:"sql-createsequence.html",dialogHelp:t("help.static",{filename:"sequence_dialog.html"}),label:e("Sequence"),collection_type:"coll-sequence",hasSQL:!0,hasDepends:!0,hasStatistics:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_sequence_on_coll",node:"coll-sequence",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_sequence",node:"sequence",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_sequence",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:!1},enable:"canCreate"}]))},model:r.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,seqowner:void 0,schema:void 0,comment:void 0,increment:void 0,start:void 0,current_value:void 0,minimum:void 0,maximum:void 0,cache:void 0,cycled:void 0,relacl:[],securities:[]},initialize:function(e,t){if(0===i.size(e)){var n=r.serverInfo[t.node_info.server._id].user,o=t.node_info.schema;this.set({seqowner:n.name},{silent:!0}),this.set({schema:o._label},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"seqowner",label:e("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],node:"role",control:l.NodeListByNameControl},{id:"schema",label:e("Schema"),cell:"string",control:"node-list-by-name",node:"schema",type:"text",mode:["create","edit"],filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"comment",label:e("Comment"),type:"multiline",mode:["properties","create","edit"]},{id:"current_value",label:e("Current value"),type:"int",mode:["properties","edit"],group:e("Definition")},{id:"increment",label:e("Increment"),type:"int",mode:["properties","create","edit"],group:e("Definition"),min:1},{id:"start",label:e("Start"),type:"int",mode:["properties","create"],group:e("Definition"),disabled:function(e){return!e.isNew()}},{id:"minimum",label:e("Minimum"),type:"int",mode:["properties","create","edit"],group:e("Definition")},{id:"maximum",label:e("Maximum"),type:"int",mode:["properties","create","edit"],group:e("Definition")},{id:"cache",label:e("Cache"),type:"int",mode:["properties","create","edit"],group:e("Definition"),min:1},{id:"cycled",label:e("Cycled"),type:"switch",mode:["properties","create","edit"],group:e("Definition")},r.SecurityGroupSchema,{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"relacl",label:e("Privileges"),group:"security",model:r.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),uniqueCol:["grantee","grantor"],mode:["edit","create"],editable:!1,type:"collection",canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"securities",label:e("Security Labels"),canAdd:!0,model:r.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:"security",mode:["edit","create"],canDelete:!0,control:"unique-col-collection",min_version:90200,uniqueCol:["provider"]}],validate:function(){var t=void 0,n=this.get("minimum"),o=this.get("maximum"),a=this.get("start");if(i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))return t=e("Name cannot be empty."),this.errorModel.set("name",t),t;if(this.errorModel.unset("name"),i.isUndefined(this.get("seqowner"))||""==String(this.get("seqowner")).replace(/^\s+|\s+$/g,""))return t=e("Owner cannot be empty."),this.errorModel.set("seqowner",t),t;if(this.errorModel.unset("seqowner"),i.isUndefined(this.get("schema"))||""==String(this.get("schema")).replace(/^\s+|\s+$/g,""))return t=e("Schema cannot be empty."),this.errorModel.set("schema",t),t;if(this.errorModel.unset("schema"),!this.isNew()){if(i.isUndefined(this.get("current_value"))||""==String(this.get("current_value")).replace(/^\s+|\s+$/g,""))return t=e("Current value cannot be empty."),this.errorModel.set("current_value",t),t;if(this.errorModel.unset("current_value"),i.isUndefined(this.get("increment"))||""==String(this.get("increment")).replace(/^\s+|\s+$/g,""))return t=e("Increment value cannot be empty."),this.errorModel.set("increment",t),t;if(this.errorModel.unset("increment"),i.isUndefined(this.get("minimum"))||""==String(this.get("minimum")).replace(/^\s+|\s+$/g,""))return t=e("Minimum value cannot be empty."),this.errorModel.set("minimum",t),t;if(this.errorModel.unset("minimum"),i.isUndefined(this.get("maximum"))||""==String(this.get("maximum")).replace(/^\s+|\s+$/g,""))return t=e("Maximum value cannot be empty."),this.errorModel.set("maximum",t),t;if(this.errorModel.unset("maximum"),i.isUndefined(this.get("cache"))||""==String(this.get("cache")).replace(/^\s+|\s+$/g,""))return t=e("Cache value cannot be empty."),this.errorModel.set("cache",t),t;this.errorModel.unset("cache")}var r=e("Minimum value must be less than maximum value."),l=e("Start value cannot be less than minimum value."),s=e("Start value cannot be greater than maximum value.");return 0==n&&0==o||parseInt(n,10)>=parseInt(o,10)?(this.errorModel.set("minimum",r),r):(this.errorModel.unset("minimum"),a&&n&&parseInt(a)<parseInt(n)?(this.errorModel.set("start",l),l):(this.errorModel.unset("start"),a&&o&&parseInt(a)>parseInt(o)?(this.errorModel.set("start",s),s):(this.errorModel.unset("start"),null)))}})})),r.Nodes.sequence}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(11),n(14),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d){return r.Nodes["coll-synonym"]||(a.Browser.Nodes["coll-synonym"]=a.Browser.Collection.extend({node:"synonym",label:e("Synonyms"),type:"coll-synonym",columns:["name","owner","is_public_synonym"],canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema})),r.Nodes.synonym||(a.Browser.Nodes.synonym=s.SchemaChildNode.extend({type:"synonym",dialogHelp:t("help.static",{filename:"synonym_dialog.html"}),label:e("Synonym"),collection_type:"coll-synonym",hasSQL:!0,hasDepends:!0,parent_type:["schema","catalog"],Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_synonym_on_coll",node:"coll-synonym",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_synonym",node:"synonym",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_synonym",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:!0},enable:"canCreate"}]))},model:a.Browser.Node.Model.extend({isNew:function(){return!this.fetchFromServer},idAttribute:"name",initialize:function(e,t){if(0===i.size(e)){var n=r.serverInfo[t.node_info.server._id].user,o=t.node_info.schema;this.set({owner:n.name,synobjschema:o._label,schema:o._label,targettype:"r"},{silent:!0})}else this.fetchFromServer=!0;a.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:!0,control:"node-list-by-name",node:"role",visible:!1},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:function(e){return!e.isNew()},node:"schema",control:"node-list-by-name",cache_node:"database",cache_level:"database"},{id:"targettype",label:e("Target type"),cell:"string",disabled:"inSchema",group:e("Definition"),select2:{width:"50%",allowClear:!1},options:function(){return[{label:e("Function"),value:"f"},{label:e("Package"),value:"P"},{label:e("Procedure"),value:"p"},{label:e("Public Synonym"),value:"s"},{label:e("Sequence"),value:"S"},{label:e("Table"),value:"r"},{label:e("View"),value:"v"}]},control:"select2"},{id:"synobjschema",label:e("Target schema"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Definition"),deps:["targettype"],select2:{allowClear:!1},control:"node-list-by-name",node:"schema",filter:function(e){var t=["pg_catalog","sys","dbo","pgagent","information_schema","dbms_job_procedure"];return e&&-1==i.indexOf(t,e.label)},disabled:function(e){if(!e.inSchema.apply(this,[e])){return!!("s"==e.get("targettype"))&&(e.set("synobjschema","public",{silent:!0}),!0)}return!0}},{id:"synobjname",label:e("Target object"),cell:"string",type:"text",disabled:"inSchema",group:e("Definition"),deps:["targettype","synobjschema"],control:"node-ajax-options",options:function(e){var t=e.model.get("targettype"),i=e.model.get("synobjschema"),o=[],a=e.field.get("schema_node"),r=a.generate_url.apply(a,[null,"get_target_objects",e.field.get("node_data"),!1,e.field.get("node_info")]);return n.ajax({type:"GET",timeout:3e4,url:r,cache:!1,async:!1,data:{trgTyp:t,trgSchema:i}}).done(function(e){return o=e.data}).fail(function(e,t,n){l.pgRespErrorNotify(e,n)}),o}},{id:"is_public_synonym",label:e("Public synonym?"),disabled:!0,type:"switch",mode:["properties"],cell:"switch",options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary",size:"mini"}}],validate:function(){var t=void 0;return this.errorModel.clear(),i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Name cannot be empty."),this.errorModel.set("name",t)):i.isUndefined(this.get("synobjschema"))||""==String(this.get("synobjschema")).replace(/^\s+|\s+$/g,"")?(t=e("Target schema cannot be empty."),this.errorModel.set("synobjschema",t)):(i.isUndefined(this.get("synobjname"))||""==String(this.get("synobjname")).replace(/^\s+|\s+$/g,""))&&(t=e("Target object cannot be empty."),this.errorModel.set("synobjname",t)),null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()}}),canCreate:function(e,t,n){if(n&&0==n.check)return!0;var i=this.getTreeNodeHierarchy(t),o=i.server;return(!o||"pg"!==o.server_type)&&void 0==i.catalog}})),r.Nodes.synonym}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(5),n(6),n(13),n(14),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d){a.Nodes["coll-type"]||(a.Nodes["coll-type"]=a.Collection.extend({node:"type",label:e("Types"),type:"coll-type",columns:["name","typeowner","description"],canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema}));var c=l.IntegerCell.extend({initialize:function(){l.NumberCell.prototype.initialize.apply(this,arguments),l.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){this.$el.empty();var e=this.model,t=this.column,n=this.column.get("editable");return(i.isFunction(n)?!n.apply(t,[e]):!n)?this.$el.removeClass("editable"):this.$el.addClass("editable"),this.delegateEvents(),this},remove:l.Extension.DependentCell.prototype.remove}),u=l.Extension.NodeAjaxOptionsCell.extend({initialize:function(){l.Extension.NodeAjaxOptionsCell.prototype.initialize.apply(this,arguments),l.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e=this.model,t=this.column,n=this.column.get("editable"),o=this.$el.find("select").first();return(i.isFunction(n)?!n.apply(t,[e]):!n)?(this.$el.removeClass("editable"),o.prop("disabled",!0)):(this.$el.addClass("editable"),o.prop("disabled",!1)),this.delegateEvents(),this},remove:l.Extension.DependentCell.prototype.remove}),p=r.CompositeModel=a.Node.Model.extend({idAttribute:"attnum",defaults:{attnum:void 0,member_name:void 0,type:void 0,tlength:void 0,is_tlength:!1,precision:void 0,is_precision:!1,collation:void 0,min_val:void 0,max_val:void 0},type_options:void 0,subtypes:void 0,schema:[{id:"member_name",label:e("Member Name"),type:"text",disabled:!1,editable:!0},{id:"type",label:e("Type"),control:"node-ajax-options",type:"text",url:"get_types",disabled:!1,node:"type",cache_node:"domain",editable:!0,cell:"node-ajax-options",select2:{allowClear:!1},transform:function(e,t){return t.model.type_options=e,e}},{id:"tlength",label:e("Length/precision"),deps:["type"],type:"text",disabled:!1,cell:c,editable:function(e){var t=e.get("type");return e.type_options&&i.each(e.type_options,function(n){t==n.value&&(n.length?(e.set("is_tlength",!0,{silent:!0}),e.set("min_val",n.min_val,{silent:!0}),e.set("max_val",n.max_val,{silent:!0})):e.set("is_tlength",!1,{silent:!0}))}),e.get("is_tlength")}},{id:"precision",label:e("Scale"),deps:["type"],type:"text",disabled:!1,cell:c,editable:function(e){var t=e.get("type");return e.type_options&&i.each(e.type_options,function(n){t==n.value&&(n.precision?(e.set("is_precision",!0,{silent:!0}),e.set("min_val",n.min_val,{silent:!0}),e.set("max_val",n.max_val,{silent:!0})):e.set("is_precision",!1,{silent:!0}))}),e.get("is_precision")}},{id:"collation",label:e("Collation"),cell:u,deps:["type"],select2:{allowClear:!1},control:"node-ajax-options",editable:function(e){var t=e.get("type"),n=!1;return e.type_options&&i.each(e.type_options,function(e){t==e.value&&e.is_collatable&&(n=!0)}),n&&setTimeout(function(){e.set("collspcname","",{silent:!0})},10),n},type:"text",disabled:!1,url:"get_collations",node:"type"}],validate:function(){var t=null;if(this.errorModel.clear(),i.isUndefined(this.get("member_name"))||i.isNull(this.get("member_name"))||""==String(this.get("member_name")).replace(/^\s+|\s+$/g,""))return t=e("Please specify the value for member name."),this.errorModel.set("member_name",t),t;if(i.isUndefined(this.get("type"))||i.isNull(this.get("type"))||""==String(this.get("type")).replace(/^\s+|\s+$/g,""))return t=e("Please specify the type."),this.errorModel.set("type",t),t;if(this.get("is_tlength")&&!i.isUndefined(this.get("tlength"))){if(this.get("tlength")<this.get("min_val")&&(t=e("Length/precision should not be less than %(value)s",{value:this.get("min_val")})),this.get("tlength")>this.get("max_val")&&(t=e("Length/precision should not be greater than %(value)s",{value:this.get("max_val")})),t)return this.errorModel.set("tlength",t),t}else if(this.get("is_precision")&&!i.isUndefined(this.get("precision"))&&(this.get("precision")<this.get("min_val")&&(t=e("Scale should not be less than %(value)s",{value:this.get("min_val")})),this.get("precision")>this.get("max_val")&&(t=e("Scale should not be greater than %(value)s",{value:this.get("max_val")})),t))return this.errorModel.set("precision",t),t;return null}}),f=r.EnumModel=a.Node.Model.extend({defaults:{label:void 0},schema:[{id:"label",label:e("Label"),type:"text",disabled:!1,cellHeaderClasses:"width_percent_99",editable:function(e){return i.isUndefined(e.get("label"))}}],validate:function(){return null}});return a.Nodes.type||(a.Nodes.type=s.SchemaChildNode.extend({type:"type",sqlAlterHelp:"sql-altertype.html",sqlCreateHelp:"sql-createtype.html",dialogHelp:t("help.static",{filename:"type_dialog.html"}),label:e("Type"),collection_type:"coll-type",hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_type_on_coll",node:"coll-type",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_type",node:"type",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_type",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:!1},enable:"canCreate"}]))},ext_funcs:void 0,model:a.Node.Model.extend({defaults:{name:void 0,oid:void 0,is_sys_type:!1,typtype:void 0},initialize:function(e,t){if(0===i.size(e)){var n=a.serverInfo[t.node_info.server._id].user,o=t.node_info.schema;this.set({typeowner:n.name,schema:o._label},{silent:!0})}a.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"schemaCheck"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"],disabled:!0},{id:"typeowner",label:e("Owner"),cell:"string",control:"node-list-by-name",type:"text",mode:["properties","create","edit"],node:"role",disabled:"inSchema",select2:{allowClear:!1}},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",disabled:"schemaCheck",filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database",control:"node-list-by-name",select2:{allowClear:!1}},{id:"typtype",label:e("Type"),mode:["create","edit"],disabled:"inSchemaWithModelCheck",group:e("Definition"),select2:{allowClear:!1},options:function(){return[{label:"Composite",value:"c"},{label:"Enumeration",value:"e"},{label:"External",value:"b"},{label:"Range",value:"r"},{label:"Shell",value:"p"}]},control:r.Select2Control.extend({render:function(){return r.Select2Control.prototype.render.apply(this,arguments),this.model.isNew()&&this.model.set({typtype:"c"}),this}})},{id:"composite",label:e("Composite Type"),model:p,editable:!0,type:"collection",group:e("Definition"),mode:["edit","create"],control:"unique-col-collection",uniqueCol:["member_name"],canAdd:!0,canEdit:!1,canDelete:!0,disabled:"inSchema",deps:["typtype"],visible:function(e){return"c"===e.get("typtype")}},{id:"enum",label:e("Enumeration Type"),model:f,editable:!0,type:"collection",group:e("Definition"),mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:function(e){return!!e.isNew()},disabled:"inSchema",deps:["typtype"],control:"unique-col-collection",uniqueCol:["label"],visible:function(e){return"e"===e.get("typtype")}},{type:"nested",control:"plain-fieldset",group:e("Definition"),mode:["edit","create"],visible:function(e){return"r"===e.get("typtype")},deps:["typtype"],label:"",schema:[{id:"typname",label:e("Subtype"),cell:"string",control:"node-ajax-options",select2:{allowClear:!0,placeholder:"",width:"100%"},url:"get_stypes",type:"text",mode:["properties","create","edit"],group:e("Range Type"),disabled:"inSchemaWithModelCheck",transform:function(e,t){return t.model.subtypes=e,e}},{id:"opcname",label:e("Subtype operator class"),cell:"string",mode:["properties","create","edit"],group:e("Range Type"),disabled:"inSchemaWithModelCheck",deps:["typname"],control:"select",options:function(){var e=this.model.get("typname"),t=this,o=[];if(!i.isUndefined(e)&&""!=e){var a=this.field.get("schema_node"),r=a.generate_url.apply(a,[null,"get_subopclass",this.field.get("node_data"),!1,this.field.get("node_info")]);n.ajax({async:!1,url:r,cache:!1,data:{typname:e}}).done(function(e){o=e.data}).fail(function(){t.model.trigger("pgadmin:view:fetch:error",t.model,t.field)})}return o}},{id:"collname",label:e("Collation"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Range Type"),deps:["typname"],control:"node-ajax-options",url:"get_collations",select2:{allowClear:!0,placeholder:"",width:"100%"},disabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;if(!e.isNew())return!0;var t=e.get("typname"),n=void 0;return i.isUndefined(t)||i.each(e.subtypes,function(e){t===e.label&&(n=e.is_collate)}),!n}},{id:"rngcanonical",label:e("Canonical function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Range Type"),disabled:"inSchemaWithModelCheck",deps:["name","typname"],control:"select",options:function(){var e=this.model.get("name"),t=this,o=[];if(!i.isUndefined(e)&&""!=e){var a=this.field.get("schema_node"),r=a.generate_url.apply(a,[null,"get_canonical",this.field.get("node_data"),!1,this.field.get("node_info")]);n.ajax({async:!1,url:r,cache:!1,data:{name:e}}).done(function(e){o=e.data}).fail(function(){t.model.trigger("pgadmin:view:fetch:error",t.model,t.field)})}return o}},{id:"rngsubdiff",label:e("Subtype diff function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Range Type"),disabled:"inSchemaWithModelCheck",deps:["opcname"],control:"select",options:function(){var e=this.model.get("typname"),t=this.model.get("opcname"),o=this,a=[];if(!i.isUndefined(e)&&""!=e&&!i.isUndefined(t)&&""!=t){var r=this.field.get("schema_node"),l=r.generate_url.apply(r,[null,"get_stypediff",this.field.get("node_data"),!1,this.field.get("node_info")]);n.ajax({async:!1,url:l,cache:!1,data:{typname:e,opcname:t}}).done(function(e){a=e.data}).fail(function(){o.model.trigger("pgadmin:view:fetch:error",o.model,o.field)})}return a}}]},{type:"nested",control:"tab",group:e("Definition"),label:e("External Type"),deps:["typtype"],mode:["create","edit"],tabPanelExtraClasses:"inline-tab-panel-padded",visible:function(e){return"b"===e.get("typtype")},schema:[{id:"spacer_ctrl",group:e("Required"),mode:["edit","create"],type:"spacer"},{id:"typinput",label:e("Input function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Required"),disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typoutput",label:e("Output function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Required"),disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"spacer_ctrl_optional_1",group:e("Optional-1"),mode:["edit","create"],type:"spacer"},{id:"typreceive",label:e("Receive function"),cell:"string",type:"text",group:e("Optional-1"),mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typsend",label:e("Send function"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typmodin",label:e("Typmod in function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Optional-1"),disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",select2:{allowClear:!0,placeholder:"",width:"100%"},transform:function(e){var t=[{label:"",value:""}];return i.each(e,function(e){"typmodin"!==e.cbtype&&"all"!==e.cbtype||t.push(e)}),t}},{id:"typmodout",label:e("Typmod out function"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",select2:{allowClear:!0,placeholder:"",width:"100%"},transform:function(e){var t=[{label:"",value:""}];return i.each(e,function(e){"typmodout"!==e.cbtype&&"all"!==e.cbtype||t.push(e)}),t}},{id:"typlen",label:e("Internal length"),cell:"integer",group:e("Optional-1"),type:"int",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"},{id:"variable",label:e("Variable?"),cell:"switch",group:e("Optional-1"),type:"switch",mode:["create","edit"],disabled:"inSchemaWithModelCheck"},{id:"typdefault",label:e("Default?"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"},{id:"typanalyze",label:e("Analyze function"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typcategory",label:e("Category type"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"select2",select2:{allowClear:!0,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"Array types",value:"A"},{label:"Boolean types",value:"B"},{label:"Composite types",value:"C"},{label:"Date/time types",value:"D"},{label:"Enum types",value:"E"},{label:"Geometric types",value:"G"},{label:"Network address types",value:"I"},{label:"Numeric types",value:"N"},{label:"Pseudo-types",value:"P"},{label:"String types",value:"S"},{label:"Timespan types",value:"T"},{label:"User-defined types",value:"U"},{label:"Bit-string types",value:"V"},{label:"unknown type",value:"X"}]},{id:"typispreferred",label:e("Preferred?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:e("Optional-1")},{id:"spacer_ctrl_optional_2",group:e("Optional-2"),mode:["edit","create"],type:"spacer"},{id:"element",label:e("Element type"),cell:"string",control:"node-ajax-options",group:e("Optional-2"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",url:"get_types"},{id:"typdelim",label:e("Delimiter"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Optional-2"),disabled:"inSchemaWithModelCheck"},{id:"typalign",label:e("Alignment type"),cell:"string",group:e("Optional-2"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"select2",select2:{allowClear:!0,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"char",value:"c"},{label:"int2",value:"s"},{label:"int4",value:"i"},{label:"double",value:"d"}]},{id:"typstorage",label:e("Storage type"),type:"text",mode:["properties","create","edit"],group:e("Optional-2"),cell:"string",disabled:"inSchemaWithModelCheck",control:"select2",select2:{allowClear:!0,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"PLAIN",value:"p"},{label:"EXTERNAL",value:"e"},{label:"MAIN",value:"m"},{label:"EXTENDED",value:"x"}]},{id:"typbyval",label:e("Passed by value?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:e("Optional-2")},{id:"is_collatable",label:e("Collatable?"),cell:"switch",min_version:90100,group:e("Optional-2"),type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"}]},{id:"alias",label:e("Alias"),cell:"string",type:"text",mode:["properties"],disabled:"inSchema"},a.SecurityGroupSchema,{id:"type_acl",label:e("Privileges"),cell:"string",type:"text",mode:["properties"],group:"security",disabled:"inSchema"},{id:"member_list",label:e("Members"),cell:"string",type:"text",mode:["properties"],group:e("Definition"),disabled:"inSchema",visible:function(e){return"c"===e.get("typtype")}},{id:"enum_list",label:e("Labels"),cell:"string",type:"text",mode:["properties"],group:e("Definition"),disabled:"inSchema",visible:function(e){return"e"===e.get("typtype")}},{id:"is_sys_type",label:e("System type?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"typacl",label:e("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:a.Node.PrivilegeRoleModel.extend({privileges:["U"]}),mode:["edit","create"],canDelete:!0,uniqueCol:["grantee"],deps:["typtype"],canAdd:function(e){if("p"===e.get("typtype")){var t=e.get("typacl");t.length>0&&t.reset()}return!("p"===e.get("typtype"))}},{id:"seclabels",label:e("Security Labels"),model:a.SecLabelModel,editable:!1,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canEdit:!1,canDelete:!0,control:"unique-col-collection",deps:["typtype"],canAdd:function(e){if("p"===e.get("typtype")){var t=e.get("seclabels");t.length>0&&t.reset()}return!("p"===e.get("typtype"))}}],validate:function(){var t;if(this.errorModel.clear(),i.isUndefined(this.get("name"))||i.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))return t=e("Name cannot be empty."),this.errorModel.set("name",t),t;if(i.isUndefined(this.get("schema"))||i.isNull(this.get("schema"))||""==String(this.get("schema")).replace(/^\s+|\s+$/g,""))return t=e("Schema cannot be empty."),this.errorModel.set("schema",t),t;if(i.isUndefined(this.get("typtype"))||i.isNull(this.get("typtype"))||""==String(this.get("typtype")).replace(/^\s+|\s+$/g,""))return t=e("Type cannot be empty."),this.errorModel.set("typtype",t),t;if("r"==this.get("typtype")&&(i.isUndefined(this.get("typname"))||i.isNull(this.get("typname"))||""==String(this.get("typname")).replace(/^\s+|\s+$/g,"")))return t=e("Subtype name cannot be empty."),this.errorModel.set("typname",t),t;if("b"==this.get("typtype")){if(i.isUndefined(this.get("typinput"))||i.isNull(this.get("typinput"))||""==String(this.get("typinput")).replace(/^\s+|\s+$/g,""))return t=e("Input function cannot be empty."),this.errorModel.set("typinput",t),t;if(i.isUndefined(this.get("typoutput"))||i.isNull(this.get("typoutput"))||""==String(this.get("typoutput")).replace(/^\s+|\s+$/g,""))return t=e("Output function cannot be empty."),this.errorModel.set("typoutput",t),t}return null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},schemaCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()&&"p"===e.get("typtype")},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithEditMode:function(e){return!(this.node_info&&"schema"in this.node_info)||!!e.isNew()},external_func_combo:function(e){var t=[];return i.each(e,function(e){"all"==e.cbtype&&t.push(e)}),t}})})),a.Nodes.type}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(10),n(3),n(5),n(11),n(6),n(13),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d,c){r.Nodes["coll-index"]||(a.Browser.Nodes["coll-index"]=a.Browser.Collection.extend({node:"index",label:e("Indexes"),type:"coll-index",sqlAlterHelp:"sql-alterindex.html",sqlCreateHelp:"sql-createindex.html",dialogHelp:t("help.static",{filename:"index_dialog.html"}),columns:["name","description"],hasStatistics:!0,statsPrettifyFields:[e("Size"),e("Index size")],canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema}));var u=d.Extension.NodeAjaxOptionsCell.extend({initialize:function(){d.Extension.NodeAjaxOptionsCell.prototype.initialize.apply(this,arguments),d.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e=this.model,t=this.column,n=this.column.get("editable"),o=this.$el.find("select").first();return(i.isFunction(n)?!n.apply(t,[e]):!n)?(this.$el.removeClass("editable"),o.prop("disabled",!0)):(this.$el.addClass("editable"),o.prop("disabled",!1)),this.delegateEvents(),this},remove:d.Extension.DependentCell.prototype.remove}),p=a.Browser.Node.Model.extend({defaults:{colname:void 0,collspcname:void 0,op_class:void 0,sort_order:!1,nulls:!1,is_sort_nulls_applicable:!0},schema:[{id:"colname",label:e("Column"),cell:"node-list-by-name",type:"text",disabled:"inSchemaWithModelCheck",editable:function(e){return!(e instanceof o.Collection)&&!e.inSchemaWithModelCheck.apply(this,arguments)},control:"node-list-by-name",node:"column"},{id:"collspcname",label:e("Collation"),cell:u,type:"text",disabled:"inSchemaWithModelCheck",editable:function(e){return!(e instanceof o.Collection)&&!e.inSchemaWithModelCheck.apply(this,arguments)},control:"node-ajax-options",url:"get_collations",node:"index"},{id:"op_class",label:e("Operator class"),cell:u,tags:!0,type:"text",disabled:"checkAccessMethod",editable:function(e){return!(e instanceof o.Collection)&&(!e.inSchemaWithModelCheck.apply(this,arguments)&&!e.checkAccessMethod.apply(this,arguments))},control:"node-ajax-options",url:"get_op_class",node:"index",deps:["amname"],transform:function(e,t){var n=t.model.top.get("amname"),o=e.btree;return i.isUndefined(n)?o:(i.each(e,function(e,t){n===t&&(o=e)}),o)}},{id:"sort_order",label:e("Sort order"),cell:d.Extension.TableChildSwitchCell,type:"switch",editable:function(e){return!(e instanceof o.Collection)&&(!e.inSchemaWithModelCheck.apply(this,arguments)&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1)))},deps:["amname"],options:{onText:"DESC",offText:"ASC"}},{id:"nulls",label:e("NULLs"),cell:d.Extension.TableChildSwitchCell,type:"switch",editable:function(e){return!(e instanceof o.Collection)&&(!e.inSchemaWithModelCheck.apply(this,arguments)&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1)))},deps:["amname","sort_order"],options:{onText:"FIRST",offText:"LAST"}}],validate:function(){if(this.errorModel.clear(),i.isUndefined(this.get("colname"))||""==String(this.get("colname")).replace(/^\s+|\s+$/g,"")){var t=e("Column Name cannot be empty.");return this.errorModel.set("colname",t),t}},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(e.top.node_info&&"schema"in e.top.node_info)||!e.top.isNew()},checkAccessMethod:function(e){var t=e.top;return i.isUndefined(t.get("amname"))||i.isNull(t.get("amname"))||""==String(t.get("amname")).replace(/^\s+|\s+$/g,"")||"btree"===t.get("amname")?1==e.get("sort_order")&&0==e.previous("sort_order")&&setTimeout(function(){e.set("nulls",!0)},10):e.set("is_sort_nulls_applicable",!1),!1}});return r.Nodes.index||(a.Browser.Nodes.index=r.Node.extend({parent_type:["table","view","mview","partition"],collection_type:["coll-table","coll-view"],sqlAlterHelp:"sql-alterindex.html",sqlCreateHelp:"sql-createindex.html",type:"index",label:e("Index"),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[e("Size"),e("Index size")],Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_index_on_coll",node:"coll-index",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index",node:"index",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index_onPartition",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index_onMatView",node:"mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"}]))},canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema,model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,nspname:void 0,tabname:void 0,spcname:void 0,amname:"btree"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:e("OID"),cell:"string",type:"int",disabled:!0,mode:["edit","properties"]},{id:"spcname",label:e("Tablespace"),cell:"string",control:"node-list-by-name",node:"tablespace",select2:{allowClear:!0},type:"text",mode:["properties","create","edit"],disabled:"inSchema",filter:function(e){return!e||!e.label.match(/pg_global/)}},{id:"amname",label:e("Access Method"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",url:"get_access_methods",group:e("Definition"),select2:{allowClear:!0},control:s.NodeAjaxOptionsControl.extend({onChange:function(){s.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this,n=t.model.get("amname"),i=t.model.previous("amname");if(n!=i&&0!==t.model.get("columns").length){var o=e("Changing access method will clear columns collection");l.confirm(o,function(){for(var e=t.model.get("columns"),n=e.length,i=n-1;i>=0;i--)e.remove(e.models[i])},function(){setTimeout(function(){t.model.set("amname",i)},10)})}}})},{id:"columns_csv",label:e("Columns"),cell:"string",type:"text",disabled:"inSchema",mode:["properties"],group:e("Definition")},{id:"include",label:e("Include columns"),type:"array",group:e("Definition"),editable:!1,canDelete:!0,canAdd:!0,mode:["properties"],disabled:"inSchemaWithModelCheck",visible:function(e){return!i.isUndefined(e.node_info)&&!i.isUndefined(e.node_info.server)&&!i.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=11e4},control:s.MultiSelectAjaxControl.extend({defaults:i.extend({},s.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:e("Select the column(s)")}})}),transform:function(e){var t=[];return e&&i.isArray(e)&&i.each(e,function(e){t.push({label:e.label,value:e.label,image:"icon-column"})}),t},node:"column"},{id:"fillfactor",label:e("Fill factor"),cell:"string",type:"int",disabled:"inSchema",mode:["create","edit","properties"],min:10,max:100,group:e("Definition")},{id:"indisunique",label:e("Unique?"),cell:"string",type:"switch",disabled:"inSchemaWithModelCheck",group:e("Definition")},{id:"indisclustered",label:e("Clustered?"),cell:"string",type:"switch",disabled:"inSchema",group:e("Definition")},{id:"indisvalid",label:e("Valid?"),cell:"string",type:"switch",disabled:!0,mode:["properties"],group:e("Definition")},{id:"indisprimary",label:e("Primary?"),cell:"string",type:"switch",disabled:!0,mode:["properties"],group:e("Definition")},{id:"is_sys_idx",label:e("System index?"),cell:"string",type:"switch",disabled:!0,mode:["properties"]},{id:"isconcurrent",label:e("Concurrent build?"),cell:"string",type:"switch",disabled:"inSchemaWithModelCheck",mode:["create","edit"],group:e("Definition")},{id:"indconstraint",label:e("Constraint"),cell:"string",type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit"],control:"sql-field",visible:!0,group:e("Definition")},{id:"columns",label:e("Columns"),type:"collection",deps:["amname"],group:e("Definition"),model:p,mode:["edit","create"],canAdd:function(e){return!!e.isNew()},canEdit:!1,canDelete:function(e){return!!e.isNew()},control:"unique-col-collection",uniqueCol:["colname"],columns:["colname","op_class","sort_order","nulls","collspcname"]},{id:"include",label:e("Include columns"),type:"array",group:e("Definition"),editable:!1,canDelete:!0,canAdd:!0,mode:["edit","create"],disabled:"inSchemaWithModelCheck",visible:function(e){return!i.isUndefined(e.node_info)&&!i.isUndefined(e.node_info.server)&&!i.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=11e4},control:s.MultiSelectAjaxControl.extend({defaults:i.extend({},s.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:e("Select the column(s)")}})}),transform:function(e){var t=[];return e&&i.isArray(e)&&i.each(e,function(e){t.push({label:e.label,value:e.label,image:"icon-column"})}),t},node:"column"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function(t){var n;if(t&&0==t.length)return this.errorModel.clear(),null;if(this.errorModel.clear(),i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))return n=e("Name cannot be empty."),this.errorModel.set("name",n),n;if(i.isUndefined(this.get("spcname"))||""==String(this.get("spcname")).replace(/^\s+|\s+$/g,""))return n=e("Tablespace cannot be empty."),this.errorModel.set("spcname",n),n;if(i.isUndefined(this.get("amname"))||""==String(this.get("amname")).replace(/^\s+|\s+$/g,""))return n=e("Access method cannot be empty."),this.errorModel.set("amname",n),n;var o=this.get("columns");if(o&&o.length>0){if(!i.every(o.pluck("colname")))return n=e("You must specify column name."),this.errorModel.set("columns",n),n}else if(o)return n=e("You must specify at least one column."),this.errorModel.set("columns",n),n;return null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithColumnCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()&&!(!i.isUndefined(e.get("attnum"))&&e.get("attnum")>=1)}}),canCreate:function(e,t,n){if(n&&0==n.check)return!0;for(var o=r.tree,a=t,l=e,s=[],d=!1,c=!1,u=this.getTreeNodeHierarchy(a).server.version;a;){if(!d&&i.indexOf(["table","partition"],l._type)>-1&&(d=!0,"is_partitioned"in l&&l.is_partitioned&&u<11e4&&(c=!0)),i.indexOf(["schema"],l._type)>-1)return!c;s.push(l._type),a=o.hasParent(a)?o.parent(a):null,l=a?o.itemData(a):null}return!(i.indexOf(s,"catalog")>-1)&&!c}})),r.Nodes.index}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(6),n(11),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d){return r.Nodes["coll-trigger"]||(a.Browser.Nodes["coll-trigger"]=a.Browser.Collection.extend({node:"trigger",label:e("Triggers"),type:"coll-trigger",columns:["name","description"],canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema})),r.Nodes.trigger||(a.Browser.Nodes.trigger=r.Node.extend({parent_type:["table","view","partition"],collection_type:["coll-table","coll-view"],type:"trigger",label:e("Trigger"),hasSQL:!0,hasDepends:!0,width:r.stdW.sm+"px",sqlAlterHelp:"sql-altertrigger.html",sqlCreateHelp:"sql-createtrigger.html",dialogHelp:t("help.static",{filename:"trigger_dialog.html"}),Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_trigger_on_coll",node:"coll-trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger",node:"trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_onPartition",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"enable_trigger",node:"trigger",module:this,applies:["object","context"],callback:"enable_trigger",category:"connect",priority:3,label:e("Enable trigger"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_trigger",node:"trigger",module:this,applies:["object","context"],callback:"disable_trigger",category:"drop",priority:3,label:e("Disable trigger"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"create_trigger_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"}]))},callbacks:{enable_trigger:function(e){var t=e||{},i=this,o=r.tree,a=t.item||o.selected(),l=a&&1==a.length?o.itemData(a):void 0;if(!l)return!1;var d=l;n.ajax({url:i.generate_url(a,"enable",l,!0),type:"PUT",data:{enable:!0},dataType:"json"}).done(function(e){1==e.success&&(s.success(e.info),o.removeIcon(a),d.icon="icon-trigger",o.addIcon(a,{icon:d.icon}),o.unload(a),o.setInode(!1),o.deselect(a),setTimeout(function(){o.select(a)},10))}).fail(function(e,t,n){s.pgRespErrorNotify(e,n),o.unload(a)})},disable_trigger:function(t){var i=t||{},o=this,a=r.tree,l=i.item||a.selected(),d=l&&1==l.length?a.itemData(l):void 0;if(!d)return!1;var c=d;n.ajax({url:o.generate_url(l,"enable",d,!0),type:"PUT",data:{enable:!1},dataType:"json"}).done(function(e){1==e.success&&(s.success(e.info),a.removeIcon(l),c.icon="icon-trigger-bad",a.addIcon(l,{icon:c.icon}),a.unload(l),a.setInode(!1),a.deselect(l),setTimeout(function(){a.select(l)},10))}).fail(function(t,n,i){s.pgRespErrorNotify(t,i,e("Disable trigger failed")),a.unload(l)})}},canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema,model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,is_row_trigger:!0,fires:"BEFORE"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:e("OID"),cell:"string",type:"int",disabled:!0,mode:["properties"]},{id:"is_enable_trigger",label:e("Trigger enabled?"),type:"switch",disabled:"inSchema",mode:["edit","properties"],group:e("Definition")},{id:"is_row_trigger",label:e("Row trigger?"),type:"switch",group:e("Definition"),mode:["create","edit","properties"],deps:["is_constraint_trigger"],disabled:function(e){if(i.has(e,"node_info")&&i.has(e.node_info,"table")&&i.has(e.node_info.table,"is_partitioned")&&e.node_info.table.is_partitioned&&e.node_info.server.version<11e4)return setTimeout(function(){e.set("is_row_trigger",!1)},10),!0;var t=e.get("is_constraint_trigger");if(e.inSchemaWithModelCheck.apply(this,[e])){var n=e.get("is_row_trigger");return!(!i.isUndefined(n)&&"ppas"==e.node_info.server.server_type)}return!i.isUndefined(t)&&!0===t&&(setTimeout(function(){e.set("is_row_trigger",!0)},10),!0)}},{id:"is_constraint_trigger",label:e("Constraint trigger?"),type:"switch",mode:["create","edit","properties"],group:e("Definition"),disabled:function(e){return i.has(e,"node_info")&&i.has(e.node_info,"table")&&i.has(e.node_info.table,"is_partitioned")&&e.node_info.table.is_partitioned||-1!=i.indexOf(Object.keys(e.node_info),"view")?(setTimeout(function(){e.set("is_constraint_trigger",!1)},10),!0):e.inSchemaWithModelCheck.apply(this,[e])}},{id:"tgdeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),mode:["create","edit","properties"],deps:["is_constraint_trigger"],disabled:function(e){var t=e.get("is_constraint_trigger");return!!e.inSchemaWithModelCheck.apply(this,[e])||!(!i.isUndefined(t)&&!0===t)&&(e.get("tgdeferrable")&&setTimeout(function(){e.set("tgdeferrable",!1)},10),!0)}},{id:"tginitdeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),mode:["create","edit","properties"],deps:["tgdeferrable","is_constraint_trigger"],disabled:function(e){var t=e.get("tgdeferrable");return!!e.inSchemaWithModelCheck.apply(this,[e])||!(!i.isUndefined(t)&&t)&&(e.get("tginitdeferred")&&setTimeout(function(){e.set("tginitdeferred",!1)},10),!e.get("is_constraint_trigger"))}},{id:"tfunction",label:e("Trigger Function"),type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit","properties"],group:e("Definition"),control:"node-ajax-options",url:"get_triggerfunctions",cache_node:"trigger_function"},{id:"tgargs",label:e("Arguments"),cell:"string",group:e("Definition"),type:"text",mode:["create","edit","properties"],deps:["tfunction"],disabled:function(e){var t=e.get("tfunction"),n=e.node_info.server.server_type;return!!e.inSchemaWithModelCheck.apply(this,[e])||"ppas"===n&&!i.isUndefined(t)&&"Inline EDB-SPL"===t&&(e.set("tgargs",void 0),!0)}},{id:"fires",label:e("Fires"),deps:["is_constraint_trigger"],mode:["create","edit","properties"],group:e("Events"),options:function(e){var t=[{label:"BEFORE",value:"BEFORE"},{label:"AFTER",value:"AFTER"}],n=[{label:"BEFORE",value:"BEFORE"},{label:"AFTER",value:"AFTER"},{label:"INSTEAD OF",value:"INSTEAD OF"}];return-1!=i.indexOf(Object.keys(e.model.node_info),"table")?t:n},control:"select2",select2:{allowClear:!1,width:"100%"},disabled:function(e){var t=e.get("is_constraint_trigger");if(e.inSchemaWithModelCheck.apply(this,[e])){var n=e.get("fires");return!(!i.isUndefined(n)&&"ppas"==e.node_info.server.server_type)}return!i.isUndefined(t)&&!0===t&&(setTimeout(function(){e.set("fires","AFTER")},10),!0)}},{type:"nested",control:"fieldset",mode:["create","edit","properties"],label:e("Events"),group:e("Events"),contentClass:"row",schema:[{id:"evnt_insert",label:e("INSERT"),type:"switch",mode:["create","edit","properties"],group:e("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_insert");return!(!i.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_update",label:e("UPDATE"),type:"switch",mode:["create","edit","properties"],group:e("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_update");return!(!i.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_delete",label:e("DELETE"),type:"switch",mode:["create","edit","properties"],group:e("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_delete");return!(!i.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_truncate",label:e("TRUNCATE"),type:"switch",group:e("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("is_constraint_trigger"),n=e.get("is_row_trigger"),o=e.node_info.server.server_type;return!!e.inSchemaWithModelCheck.apply(this,[e])||!("ppas"===o&&!i.isUndefined(t)&&!i.isUndefined(n)&&!1===t&&!1===n)}}]},{id:"whenclause",label:e("When"),type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit","properties"],control:"sql-field",visible:!0,group:e("Events")},{id:"columns",label:e("Columns"),url:"nodes",control:"node-list-by-name",cache_node:"column",type:"array",select2:{multiple:!0},deps:["evnt_update"],node:"column",group:e("Events"),disabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;if(!e.isNew())return!0;var t=e.get("evnt_update");return!(!i.isUndefined(t)&&t)}},{id:"tgoldtable",label:e("Old table"),type:"text",group:e("Transition"),cell:"string",mode:["create","edit","properties"],deps:["fires","is_constraint_trigger","evnt_insert","evnt_update","evnt_delete","columns"],disabled:"disableTransition"},{id:"tgnewtable",label:e("New table"),type:"text",group:e("Transition"),cell:"string",mode:["create","edit","properties"],deps:["fires","is_constraint_trigger","evnt_insert","evnt_update","evnt_delete","columns"],disabled:"disableTransition"},{id:"prosrc",label:e("Code"),group:e("Code"),type:"text",mode:["create","edit"],deps:["tfunction"],control:"sql-field",visible:!0,disabled:function(e){var t=e.get("tfunction");return!("ppas"===e.node_info.server.server_type&&!i.isUndefined(t)&&"Inline EDB-SPL"===t)}},{id:"is_sys_trigger",label:e("System trigger?"),cell:"string",type:"switch",disabled:"inSchemaWithModelCheck",mode:["properties"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function(t){var n;return this.errorModel.clear(),t&&0==t.length?null:i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(n=e("Name cannot be empty."),this.errorModel.set("name",n),n):i.isUndefined(this.get("tfunction"))||""==String(this.get("tfunction")).replace(/^\s+|\s+$/g,"")?(n=e("Trigger function cannot be empty."),this.errorModel.set("tfunction",n),n):this.get("evnt_truncate")||this.get("evnt_delete")||this.get("evnt_update")||this.get("evnt_insert")?i.isUndefined(this.get("tfunction"))||"Inline EDB-SPL"!==this.get("tfunction")||!i.isUndefined(this.get("prosrc"))&&""!=String(this.get("prosrc")).replace(/^\s+|\s+$/g,"")?null:(n=e("Trigger code cannot be empty."),this.errorModel.set("prosrc",n),n):(n=e("Specify at least one event."),this.errorModel.set("evnt_truncate"," "),this.errorModel.set("evnt_delete"," "),this.errorModel.set("evnt_update"," "),this.errorModel.set("evnt_insert",n),n)},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithColumnCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()&&!(!i.isUndefined(e.get("attnum"))&&e.get("attnum")>=1)},disableTransition:function(e){var t=!0,n=null,o=this.name,a=0;return-1==i.indexOf(Object.keys(e.node_info),"table")||e.node_info.server.version<1e5||("tgoldtable"==o?n="evnt_delete":"tgnewtable"==o&&(n="evnt_insert"),e.get("evnt_insert")&&a++,e.get("evnt_update")&&a++,e.get("evnt_delete")&&a++,e.get("is_constraint_trigger")||"AFTER"!=e.get("fires")||!e.get("evnt_update")&&!e.get(n)||1!=a||(t=!!(e.get("evnt_update")&&i.size(e.get("columns"))>=1&&""!=e.get("columns")[0])),t&&setTimeout(function(){e.get(o)&&e.set(o,null)},10),t)}}),canCreate:d.isTreeItemOfChildOfSchema,canCreate_with_trigger_enable:function(e,t,n){return"icon-trigger-bad"===e.icon&&this.canCreate.apply(this,[e,t,n])},canCreate_with_trigger_disable:function(e,t,n){return"icon-trigger"===e.icon&&this.canCreate.apply(this,[e,t,n])}})),r.Nodes.trigger}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(0),n(1),n(8),n(3),n(5),n(7)],void 0!==(o=function(e,t,n,i,o,a){return a.Nodes["coll-catalog_object_column"]||(o.Browser.Nodes["coll-catalog_object_column"]=o.Browser.Collection.extend({node:"catalog_object_column",label:e("catalog_object_column"),type:"coll-catalog_object_column",columns:["attname","attnum","cltype","description"],canDrop:!1,canDropCascade:!1})),a.Nodes.catalog_object_column||(o.Browser.Nodes.catalog_object_column=o.Browser.Node.extend({parent_type:"catalog_object",type:"catalog_object_column",label:e("catalog_object_column"),hasSQL:!1,hasScriptTypes:[],hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0)},model:o.Browser.Node.Model.extend({defaults:{attname:void 0,attowner:void 0,atttypid:void 0,attnum:void 0,cltype:void 0,collspcname:void 0,attacl:void 0,description:void 0},schema:[{id:"attname",label:e("Column"),cell:"string",type:"text",disabled:!0},{id:"attowner",label:e("Owner"),cell:"string",type:"text",disabled:!0},{id:"attnum",label:e("Position"),cell:"string",type:"text",disabled:!0},{id:"cltype",label:e("Data type"),cell:"string",group:e("Definition"),type:"text",disabled:!0},{id:"collspcname",label:e("Collation"),cell:"string",group:e("Definition"),type:"text",disabled:!0},{id:"attacl",label:e("Privileges"),cell:"string",group:e("Security"),type:"text",disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline",disabled:!0}]})})),a.Nodes.catalog_object_column}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(5),n(6),n(14),n(12),n(16),n(85)],void 0!==(o=function(e,t,n,i,o,a,r,l,s){return a.Nodes["coll-view"]||(a.Nodes["coll-view"]=a.Collection.extend({node:"view",label:e("Views"),type:"coll-view",columns:["name","owner"],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),a.Nodes.view||(a.Nodes.view=l.SchemaChildNode.extend({type:"view",sqlAlterHelp:"sql-alterview.html",sqlCreateHelp:"sql-createview.html",dialogHelp:t("help.static",{filename:"view_dialog.html"}),label:e("View"),hasSQL:!0,hasDepends:!0,hasScriptTypes:["create","select","insert"],collection_type:"coll-view",Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_view_on_coll",node:"coll-view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_view",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_view",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:17,label:e("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:!1},enable:"canCreate"}]))},model:a.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){if(0===i.size(e)){var n=t.node_info.schema._label||"public",o=a.serverInfo[t.node_info.server._id].user;this.set({schema:n,owner:o.name},{silent:!0})}a.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"notInSchema"},{id:"oid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",control:"node-list-by-name",node:"role",disabled:"notInSchema",select2:{allowClear:!1}},{id:"schema",label:e("Schema"),cell:"string",first_empty:!1,control:"node-list-by-name",type:"text",cache_level:"database",node:"schema",disabled:"notInSchema",mode:["create","edit"],select2:{allowClear:!1},cache_node:"database"},{id:"system_view",label:e("System view?"),cell:"string",type:"switch",disabled:!0,mode:["properties"]},{id:"acl",label:e("Privileges"),mode:["properties"],type:"text",group:e("Security")},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",disabled:"notInSchema"},{id:"security_barrier",label:e("Security barrier"),type:"switch",min_version:"90200",group:e("Definition"),disabled:"notInSchema"},{id:"check_option",label:e("Check options"),control:"select2",group:e("Definition"),type:"text",min_version:"90400",mode:["properties","create","edit"],select2:{allowClear:!1},disabled:"notInSchema",options:[{label:e("No"),value:"no"},{label:e("Local"),value:"local"},{label:e("Cascaded"),value:"cascaded"}]},{id:"definition",label:e("Definition"),cell:"string",type:"text",mode:["create","edit"],group:e("Definition"),control:r.SqlFieldControl,disabled:"notInSchema"},a.SecurityGroupSchema,{id:"datacl",label:e("Privileges"),type:"collection",model:a.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),uniqueCol:["grantee"],editable:!1,group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection",disabled:"notInSchema"},{id:"seclabels",label:e("Security labels"),model:a.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:"security",canDelete:!0,mode:["edit","create"],canAdd:!0,disabled:"notInSchema",control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(){var t,n={},o=this.get("name"),a=this.get("definition");return i.isUndefined(o)||i.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(n.name=e("Please specify name."),t=t||n.name,this.errorModel.set("name",t),t):(this.errorModel.unset("name"),i.isUndefined(a)||i.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(n.definition=e("Please enter view definition."),t=t||n.definition,this.errorModel.set("definition",t),t):(this.errorModel.unset("definition"),null))},notInSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)}})})),a.Nodes.view}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(11),n(5),n(6),n(14),n(12),n(16)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d){return r.Nodes["coll-mview"]||(r.Nodes["coll-mview"]=r.Collection.extend({node:"mview",label:e("Materialized Views"),type:"coll-mview",columns:["name","owner"],canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema})),r.Nodes.mview||(r.Nodes.mview=s.SchemaChildNode.extend({type:"mview",sqlAlterHelp:"sql-altermaterializedview.html",sqlCreateHelp:"sql-creatematerializedview.html",dialogHelp:t("help.static",{filename:"materialized_view_dialog.html"}),label:e("Materialized View"),hasSQL:!0,hasDepends:!0,hasScriptTypes:["create","select"],collection_type:"coll-mview",Init:function(){this.initialized||(this.initialized=!0,o.Browser.add_menu_category("refresh_mview",e("Refresh View"),18,""),r.add_menus([{name:"create_mview_on_coll",node:"coll-mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,icon:"wcTabIcon icon-mview",data:{action:"create",check:!0},enable:"canCreate",label:e("Materialized View...")},{name:"create_mview",node:"mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,icon:"wcTabIcon icon-mview",data:{action:"create",check:!0},enable:"canCreate",label:e("Materialized View...")},{name:"create_mview",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:18,icon:"wcTabIcon icon-mview",data:{action:"create",check:!1},enable:"canCreate",label:e("Materialized View...")},{name:"refresh_mview_data",node:"mview",module:this,priority:1,callback:"refresh_mview",category:"refresh_mview",applies:["object","context"],label:e("With data"),data:{concurrent:!1,with_data:!0},icon:"fa fa-recycle"},{name:"refresh_mview_nodata",node:"mview",callback:"refresh_mview",priority:2,module:this,category:"refresh_mview",applies:["object","context"],label:e("With no data"),data:{concurrent:!1,with_data:!1},icon:"fa fa-refresh"},{name:"refresh_mview_concurrent",node:"mview",module:this,category:"refresh_mview",enable:"is_version_supported",data:{concurrent:!0,with_data:!0},priority:3,applies:["object","context"],callback:"refresh_mview",label:e("With data (concurrently)"),icon:"fa fa-recycle"},{name:"refresh_mview_concurrent_nodata",node:"mview",module:this,category:"refresh_mview",enable:"is_version_supported",data:{concurrent:!0,with_data:!1},priority:4,applies:["object","context"],callback:"refresh_mview",label:e("With no data (concurrently)"),icon:"fa fa-refresh"}]))},model:r.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){if(0===i.size(e)){var n=t.node_info.schema._label||"public",o=r.serverInfo[t.node_info.server._id].user;this.set({schema:n,owner:o.name},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{spcname:void 0,toast_autovacuum_enabled:!1,autovacuum_enabled:!1},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",control:"node-list-by-name",select2:{allowClear:!1},node:"role",disabled:"inSchema"},{id:"schema",label:e("Schema"),cell:"string",first_empty:!1,control:"node-list-by-name",type:"text",cache_level:"database",node:"schema",mode:["create","edit"],cache_node:"database",disabled:"inSchema",select2:{allowClear:!1}},{id:"system_view",label:e("System view?"),cell:"string",type:"switch",disabled:!0,mode:["properties"]},r.SecurityGroupSchema,{id:"acl",label:e("Privileges"),mode:["properties"],type:"text",group:e("Security")},{id:"comment",label:e("Comment"),cell:"string",type:"multiline"},{id:"definition",label:"Definition",cell:"string",type:"text",mode:["create","edit"],group:e("Definition"),control:l.SqlFieldControl,extraClasses:["sql_field_width_full"]},{id:"with_data",label:e("With Data"),group:e("Storage"),mode:["edit","create"],type:"switch"},{id:"spcname",label:e("Tablespace"),cell:"string",type:"text",group:e("Storage"),first_empty:!1,control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label}},{id:"fillfactor",label:e("Fill Factor"),group:e("Storage"),mode:["edit","create"],type:"int"},{type:"nested",control:"tab",id:"materialization",label:e("Parameter"),mode:["edit","create"],group:e("Parameter"),schema:l.VacuumSettingsSchema},{id:"datacl",label:e("Privileges"),type:"collection",model:r.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),uniqueCol:["grantee"],editable:!1,group:"security",canAdd:!0,canDelete:!0,mode:["edit","create"],control:"unique-col-collection"},{id:"seclabels",label:e("Security Labels"),model:r.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:"security",canDelete:!0,mode:["edit","create"],canAdd:!0,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(t){var n,o={},a=this.get("name"),r=this.get("definition");return-1!=i.indexOf(t,"autovacuum_enabled")||-1!=i.indexOf(t,"toast_autovacuum_enabled")?null:i.isUndefined(a)||i.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(o.name=e("Please specify name."),n=n||o.name,this.errorModel.set("name",n),n):(this.errorModel.unset("name"),i.isUndefined(r)||i.isNull(r)||""==String(r).replace(/^\s+|\s+$/g,"")?(o.definition=e("Please enter view definition."),n=n||o.definition,this.errorModel.set("definition",n),n):(this.errorModel.unset("definition"),null))},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)}}),refresh_mview:function(t){var i=t||{},o=this,l=r.tree,s=i.item||l.selected(),d=s&&1==s.length?l.itemData(s):void 0;if(!d)return!1;n.ajax({url:o.generate_url(s,"refresh_data",d,!0),type:"PUT",data:{concurrent:t.concurrent,with_data:t.with_data},dataType:"json"}).done(function(t){1==t.success?a.success(e("View refreshed successfully")):a.alert(e("Error refreshing view"),t.data.result)}).fail(function(t,n,i){a.pgRespErrorNotify(t,i,e("Error refreshing view"))})},is_version_supported:function(e,t){var n=o.Browser.tree,i=t||n.selected(),a=e||(i&&1==i.length?n.itemData(i):void 0),r=this||a&&o.Browser.Nodes[a._type];return r.getTreeNodeHierarchy.apply(r,[i]).server.version>=90400}})),r.Nodes.mview}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(219),n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(11),n(6),n(13),n(220),n(14),n(12),n(7),n(221),n(222),n(86)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d,c,u,p,f){return l.Nodes["coll-table"]||(l.Nodes["coll-table"]=l.Collection.extend({node:"table",label:t("Tables"),type:"coll-table",columns:["name","relowner","is_partitioned","description"],hasStatistics:!0,statsPrettifyFields:[t("Size"),t("Indexes size"),t("Table size"),t("Toast table size"),t("Tuple length"),t("Dead tuple length"),t("Free space")],canDrop:f.isTreeItemOfChildOfSchema,canDropCascade:f.isTreeItemOfChildOfSchema})),l.Nodes.table||(l.Nodes.table=p.SchemaChildNode.extend({type:"table",label:t("Table"),collection_type:"coll-table",hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[t("Size"),t("Indexes size"),t("Table size"),t("Toast table size"),t("Tuple length"),t("Dead tuple length"),t("Free space")],sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-createtable.html",dialogHelp:n("help.static",{filename:"table_dialog.html"}),hasScriptTypes:["create","select","insert","update","delete"],width:"650px",Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_table_on_coll",node:"coll-table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:t("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_table",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:t("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_table__on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:!1},enable:"canCreate"},{name:"truncate_table",node:"table",module:this,applies:["object","context"],callback:"truncate_table",category:"Truncate",priority:3,label:t("Truncate"),icon:"fa fa-eraser",enable:"canCreate"},{name:"truncate_table_cascade",node:"table",module:this,applies:["object","context"],callback:"truncate_table_cascade",category:"Truncate",priority:3,label:t("Truncate Cascade"),icon:"fa fa-eraser",enable:"canCreate"},{name:"enable_all_triggers",node:"table",module:this,applies:["object","context"],callback:"enable_triggers_on_table",category:"Trigger(s)",priority:4,label:t("Enable All"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_all_triggers",node:"table",module:this,applies:["object","context"],callback:"disable_triggers_on_table",category:"Trigger(s)",priority:4,label:t("Disable All"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"reset_table_stats",node:"table",module:this,applies:["object","context"],callback:"reset_table_stats",category:"Reset",priority:4,label:t("Reset Statistics"),icon:"fa fa-bar-chart",enable:"canCreate"},{name:"count_table_rows",node:"table",module:this,applies:["object","context"],callback:"count_table_rows",category:"Count",priority:2,label:t("Count Rows"),enable:!0}]),l.Events.on("pgadmin:browser:node:table:updated",this.onTableUpdated,this),l.Events.on("pgadmin:browser:node:type:cache_cleared",this.handle_cache,this),l.Events.on("pgadmin:browser:node:domain:cache_cleared",this.handle_cache,this))},callbacks:{enable_triggers_on_table:function(t){e.enableTriggers(l.treeMenu,s,this.generate_url.bind(this),t)},disable_triggers_on_table:function(t){e.disableTriggers(l.treeMenu,s,this.generate_url.bind(this),t)},truncate_table:function(e){var t={cascade:!1};this.callbacks.truncate.apply(this,[e,t])},truncate_table_cascade:function(e){var t={cascade:!0};this.callbacks.truncate.apply(this,[e,t])},truncate:function(e,n){var o=e||{},r=this,d=l.tree,c=o.item||d.selected(),u=c&&1==c.length?d.itemData(c):void 0;if(!u)return!1;s.confirm(t("Truncate Table"),a(t("Are you sure you want to truncate table %s?")).sprintf(u.label).value(),function(e){if(e){var t=u;i.ajax({url:r.generate_url(c,"truncate",u,!0),type:"PUT",data:n,dataType:"json"}).done(function(e){1==e.success&&(s.success(e.info),d.removeIcon(c),t.icon=t.is_partitioned?"icon-partition":"icon-table",d.addIcon(c,{icon:t.icon}),d.unload(c),d.setInode(c),d.deselect(c),setTimeout(function(){d.select(c)},10))}).fail(function(e,t,n){s.pgRespErrorNotify(e,n),d.unload(c)})}},function(){})},reset_table_stats:function(e){var n=e||{},o=this,r=l.tree,d=n.item||r.selected(),c=d&&1==d.length?r.itemData(d):void 0;if(!c)return!1;s.confirm(t("Reset statistics"),a(t('Are you sure you want to reset the statistics for table "%s"?')).sprintf(c._label).value(),function(e){if(e){var t=c;i.ajax({url:o.generate_url(d,"reset",c,!0),type:"DELETE"}).done(function(e){1==e.success&&(s.success(e.info),r.removeIcon(d),t.icon=t.is_partitioned?"icon-partition":"icon-table",r.addIcon(d,{icon:t.icon}),r.unload(d),r.setInode(d),r.deselect(d),setTimeout(function(){r.select(d)},10))}).fail(function(e,t,n){s.pgRespErrorNotify(e,n),r.unload(d)})}},function(){})},count_table_rows:function(e){var t=e||{},n=this,o=l.tree,a=t.item||o.selected(),r=a&&1==a.length?o.itemData(a):void 0;if(!r)return!1;i.ajax({url:n.generate_url(a,"count_rows",r,!0),type:"GET"}).done(function(e){s.success(e.info),r.rows_cnt=e.data.total_rows,o.unload(a),o.setInode(a),o.deselect(a),setTimeout(function(){o.select(a)},10)}).fail(function(e,t,n){s.pgRespErrorNotify(e,n),o.unload(a)})}},model:l.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,spcoid:void 0,spcname:void 0,relowner:void 0,relacl:void 0,relhasoids:void 0,relhassubclass:void 0,reltuples:void 0,description:void 0,conname:void 0,conkey:void 0,isrepl:void 0,triggercount:void 0,relpersistence:void 0,fillfactor:void 0,reloftype:void 0,typname:void 0,labels:void 0,providers:void 0,is_sys_table:void 0,coll_inherits:[],hastoasttable:!0,toast_autovacuum_enabled:!1,autovacuum_enabled:!1,primary_key:[],partitions:[],partition_type:"range",is_partitioned:!1},initialize:function(e,t){if(0===o.size(e)){var n=l.serverInfo[t.node_info.server._id].user,i=t.node_info.schema;this.set({relowner:n.name,schema:i._label},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:t("Name"),type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:t("OID"),type:"text",mode:["properties"]},{id:"relowner",label:t("Owner"),type:"text",node:"role",mode:["properties","create","edit"],select2:{allowClear:!1},disabled:"inSchema",control:"node-list-by-name"},{id:"schema",label:t("Schema"),type:"text",node:"schema",control:"node-list-by-name",mode:["create","edit"],disabled:"inSchema",filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"spcname",label:t("Tablespace"),node:"tablespace",type:"text",control:"node-list-by-name",disabled:"inSchema",mode:["properties","create","edit"],filter:function(e){return!(e&&e.label.match(/pg_global/))}},{id:"partition",type:"group",label:t("Partition"),mode:["edit","create"],min_version:1e5,visible:function(e){return!(!e.isNew()&&!e.get("is_partitioned"))}},{id:"is_partitioned",label:t("Partitioned Table?"),cell:"switch",type:"switch",mode:["properties","create","edit"],visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){return!e.isNew()}},{id:"description",label:t("Comment"),type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"coll_inherits",label:t("Inherited from table(s)"),url:"get_inherits",type:"array",group:t("Columns"),disabled:"checkInheritance",deps:["typname","is_partitioned"],mode:["create","edit"],select2:{multiple:!0,allowClear:!0,placeholder:t("Select to inherit from...")},transform:function(e,t){return(t||this).model.inherited_tables_list=e,e},control:d.MultiSelectAjaxControl.extend({onChange:function(){d.MultiSelectAjaxControl.prototype.onChange.apply(this,arguments);var e=this,t=e.model.get("coll_inherits")||[],n=e.model.previous("coll_inherits")||[];if(!o.isUndefined(t)){var i=void 0,a=void 0;t.length>1&&t.length>n.length?(i=o.difference(t,n),a=this.get_table_oid(i[0]),this.add_columns(a)):1==t.length&&(a=this.get_table_oid(t[0]),this.add_columns(a)),t.length>0&&t.length<n.length?(i=o.difference(n,t),this.remove_columns(i[0])):1===n.length&&t.length<1&&(i=n[0],this.remove_columns(i))}},add_columns:function(e){var t=this,n=t.model.top||t.model,i=void 0,o=n.get("columns"),a={tid:e};i=t.model.fetch_columns_ajax.apply(t,[a]),o.set(i,{merge:!1,remove:!1})},remove_columns:function(e){var t=this.get_table_oid(e),n=this.model.get("columns");n.remove(n.where({inheritedid:t}))},get_table_oid:function(e){var t=void 0;return o.each(this.model.inherited_tables_list,function(n){n.label===e&&(t=n.tid)}),t}})},{id:"advanced",label:t("Advanced"),type:"group",visible:u.show_advanced_tab},{id:"coll_inherits",label:t("Inherited from table(s)"),type:"text",group:"advanced",mode:["properties"]},{id:"inherited_tables_cnt",label:t("Inherited tables count"),type:"text",mode:["properties"],group:"advanced",disabled:"inSchema"},{id:"columns",label:t("Columns"),type:"collection",group:t("Columns"),model:l.Nodes.column.model,subnode:l.Nodes.column.model,mode:["create","edit"],disabled:function(e){return e.isNew()&&e.get("is_partitioned")&&setTimeout(function(){var t=e.get("columns");t.remove(t.filter(function(e){return!o.isUndefined(e.get("inheritedfrom"))}))},10),!!(this.node_info&&"catalog"in this.node_info)},deps:["typname","is_partitioned"],canAdd:"check_grid_add_condition",canEdit:!0,canDelete:!0,canEditRow:"check_grid_row_edit_delete",canDeleteRow:"check_grid_row_edit_delete",uniqueCol:["name"],columns:["name","cltype","attlen","attprecision","attnotnull","is_primary_key"],control:d.UniqueColCollectionControl.extend({initialize:function(){d.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var e=this;e.model.get(e.field.get("name")).on("change:is_primary_key",function(t){var n,i,a=e.model.get("primary_key"),r=t.get("name");if(t.get("is_primary_key")){if(a.length<1?(n=new a.model({},{top:e.model,collection:a,handler:a}),a.add(n)):n=a.first(),o.isUndefined(n.get("oid"))){i=n.get("columns");var l=i.where({column:r});if(0==l.length){var s=new i.model({column:r},{silent:!0,top:e.model,collection:a,handler:a});i.add(s)}i.trigger("pgadmin:multicolumn:updated",i)}}else if(a.length>0){if(n=a.first(),!o.isUndefined(n.get("oid")))return;i=n.get("columns");var d=i.where({column:r});d.length>0&&(i.remove(d),o.each(d,function(e){e.destroy()}),0==i.length&&a.remove(a.first())),i.trigger("pgadmin:multicolumn:updated",i)}})},remove:function(){var e=this.model.get(this.field.get("name"));e&&e.off("change:is_primary_key"),d.UniqueColCollectionControl.prototype.remove.apply(this,arguments)}}),allowMultipleEmptyRow:!1},{type:"nested",control:"tab",group:t("Constraints"),mode:["edit","create"],schema:[{id:"primary_key",label:t("Primary key"),model:l.Nodes.primary_key.model,subnode:l.Nodes.primary_key.model,editable:!1,type:"collection",group:t("Primary Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(e){return!(e.get("is_partitioned")&&!o.isUndefined(e.top.node_info)&&!o.isUndefined(e.top.node_info.server)&&!o.isUndefined(e.top.node_info.server.version)&&e.top.node_info.server.version<11e4)||(setTimeout(function(){var t=e.get("primary_key");t.remove(t.filter(function(){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return e.get("primary_key")&&e.get("primary_key").length<1&&o.some(t.pluck("name"))}},{id:"foreign_key",label:t("Foreign key"),model:l.Nodes.foreign_key.model,subnode:l.Nodes.foreign_key.model,editable:!1,type:"collection",group:t("Foreign Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:function(e){return!(e.get("is_partitioned")&&!o.isUndefined(e.top.node_info)&&!o.isUndefined(e.top.node_info.server)&&!o.isUndefined(e.top.node_info.server.version)&&e.top.node_info.server.version<11e4)||(setTimeout(function(){var t=e.get("foreign_key");t.remove(t.filter(function(){return!0}))},10),!1)},columns:["name","columns"],canAddRow:function(e){var t=e.get("columns");return o.some(t.pluck("name"))}},{id:"check_constraint",label:t("Check constraint"),model:l.Nodes.check_constraint.model,subnode:l.Nodes.check_constraint.model,editable:!1,type:"collection",group:t("Check"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:!0,columns:["name","consrc"]},{id:"unique_constraint",label:t("Unique Constraint"),model:l.Nodes.unique_constraint.model,subnode:l.Nodes.unique_constraint.model,editable:!1,type:"collection",group:t("Unique"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(e){return!(e.get("is_partitioned")&&!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version<11e4)||(setTimeout(function(){var t=e.get("unique_constraint");t.remove(t.filter(function(){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return o.some(t.pluck("name"))}},{id:"exclude_constraint",label:t("Exclude constraint"),model:l.Nodes.exclusion_constraint.model,subnode:l.Nodes.exclusion_constraint.model,editable:!1,type:"collection",group:t("Exclude"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns","constraint"],canAdd:function(e){return!e.get("is_partitioned")||(setTimeout(function(){var t=e.get("exclude_constraint");t.remove(t.filter(function(){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return o.some(t.pluck("name"))}}]},{id:"typname",label:t("Of type"),type:"text",mode:["properties","create","edit"],disabled:"checkOfType",url:"get_oftype",group:"advanced",deps:["coll_inherits"],transform:function(e,t){return(t||this).model.of_types_tables=e,e},control:d.NodeAjaxOptionsControl.extend({onChange:function(){d.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this,n=e.model.get("typname"),i=void 0,a=void 0,r=e.model.get("columns");if(o.isUndefined(n)||o.isNull(n)||""===n||0===r.length)o.isUndefined(n)||""!==n||r.remove(r.filter(function(){return!0}));else{var l=t("Remove column definitions?"),c=t("Changing 'Of type' will remove column definitions.");s.confirm(l,c,function(){r.remove(r.filter(function(){return!0}))},function(){setTimeout(function(){e.model.set("typname",null)},10)})}o.isUndefined(n)||""===n||(a={tname:n},i=e.model.fetch_columns_ajax.apply(e,[a]),r.set(i,{merge:!1,remove:!1}))}})},{id:"fillfactor",label:t("Fill factor"),type:"int",mode:["create","edit"],min:10,max:100,disabled:"inSchema",group:"advanced"},{id:"relhasoids",label:t("Has OIDs?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchema",group:"advanced"},{id:"relpersistence",label:t("Unlogged?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:"advanced"},{id:"conname",label:t("Primary key"),cell:"string",type:"text",mode:["properties"],group:"advanced",disabled:"inSchema"},{id:"reltuples",label:t("Rows (estimated)"),cell:"string",type:"text",mode:["properties"],group:"advanced",disabled:"inSchema"},{id:"rows_cnt",label:t("Rows (counted)"),cell:"string",type:"text",mode:["properties"],group:"advanced",disabled:"inSchema",control:d.InputControl.extend({formatter:{fromRaw:function(e){var t=r.Browser.tree,n=t.selected(),i=n&&1==n.length?t.itemData(n):void 0;return i&&i.rows_cnt&&parseInt(i.rows_cnt,10)>0?i.rows_cnt:e},toRaw:function(e){return e}}})},{id:"relhassubclass",label:t("Inherits tables?"),cell:"switch",type:"switch",mode:["properties"],group:"advanced",disabled:"inSchema"},{id:"is_sys_table",label:t("System table?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{type:"nested",control:"fieldset",label:t("Like"),group:"advanced",schema:[{id:"like_relation",label:t("Relation"),type:"text",mode:["create","edit"],deps:["typname"],control:"node-ajax-options",url:"get_relations",disabled:"isLikeDisable",group:t("Like")},{id:"like_default_value",label:t("With default values?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:t("Like")},{id:"like_constraints",label:t("With constraints?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:t("Like")},{id:"like_indexes",label:t("With indexes?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:t("Like")},{id:"like_storage",label:t("With storage?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:t("Like")},{id:"like_comments",label:t("With comments?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:t("Like")}]},{id:"partition_type",label:t("Partition Type"),editable:!1,type:"select2",select2:{allowClear:!1},group:"partition",deps:["is_partitioned"],options:function(){var e=[{label:t("Range"),value:"range"},{label:t("List"),value:"list"}];return!o.isUndefined(this.node_info)&&!o.isUndefined(this.node_info.server)&&!o.isUndefined(this.node_info.server.version)&&this.node_info.server.version>=11e4&&e.push({label:t("Hash"),value:"hash"}),e},mode:["create"],visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){return!e.isNew()||!e.get("is_partitioned")}},{id:"partition_keys",label:t("Partition Keys"),model:d.PartitionKeyModel,subnode:d.PartitionKeyModel,editable:!0,type:"collection",group:"partition",mode:["create"],deps:["is_partitioned","partition_type","typname"],canEdit:!1,canDelete:!0,control:"sub-node-collection",canAdd:function(e){return!(!e.isNew()||!e.get("is_partitioned"))},canAddRow:function(e){var t=e.get("columns"),n=e.get("typname"),i=!1,a=1e3;return e.get("partition_type")&&"list"==e.get("partition_type")&&(a=1),t.length<=0&&!o.isUndefined(n)&&!o.isNull(n)&&e.of_types_tables.length>0?o.each(e.of_types_tables,function(e){e.label==n&&e.oftype_columns.length>0&&(i=!0)}):t.length>0&&(i=o.some(t.pluck("name"))),e.get("partition_keys")&&e.get("partition_keys").length<a&&i},visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.get("partition_keys")&&e.get("partition_keys").models.length>0&&setTimeout(function(){var t=e.get("partition_keys");t.remove(t.filter(function(){return!0}))},10)}},{id:"partition_scheme",label:t("Partition Scheme"),type:"note",group:"partition",mode:["edit"],visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.isNew()||(this.text=e.get("partition_scheme"))}},{id:"partition_key_note",label:t("Partition Keys"),type:"note",group:"partition",mode:["create"],text:["<br>&nbsp;&nbsp;",t("Partition table supports two types of keys:"),"<br><ul><li>",t("Column: User can select any column from the list of available columns."),"</li><li>",t("Expression: User can specify expression to create partition key."),"<br><p>",t("Example"),":",t("Let's say, we want to create a partition table based per year for the column 'saledate', having datatype 'date/timestamp', then we need to specify the expression as 'extract(YEAR from saledate)' as partition key."),"</p></li></ul>"].join(""),visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5}},{id:"partitions",label:t("Partitions"),model:d.PartitionsModel,subnode:d.PartitionsModel,editable:!0,type:"collection",group:"partition",mode:["edit","create"],deps:["is_partitioned","partition_type","typname"],canEdit:!1,canDelete:!0,customDeleteTitle:t("Detach Partition"),customDeleteMsg:t("Are you sure you wish to detach this partition?"),columns:["is_attach","partition_name","values_from","values_to","values_in","values_modulus","values_remainder"],control:d.SubNodeCollectionControl.extend({row:c.PartitionRow,initialize:function(){d.SubNodeCollectionControl.prototype.initialize.apply(this,arguments);var e=this;if(!this.model.isNew()){var n=this.field.get("schema_node"),o=this.field.get("node_info");i.ajax({url:n.generate_url.apply(n,[null,"get_attach_tables",this.field.get("node_data"),!0,o]),type:"GET",async:!1}).done(function(n){1==n.success?e.model.table_options=n.data:s.alert(t("Error fetching tables to be attached"),n.data.result)}).fail(function(e,t,n){s.pgRespErrorNotify(e,n)})}}}),canAdd:function(e){return!!e.get("is_partitioned")},visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.isNew()&&e.get("partitions")&&e.get("partitions").models.length>0&&setTimeout(function(){var t=e.get("partitions");t.remove(t.filter(function(){return!0}))},10)}},{id:"partition_note",label:t("Partitions"),type:"note",group:"partition",text:["<ul>"," <li>",t("Create a table: User can create multiple partitions while creating new partitioned table. Operation switch is disabled in this scenario."),"</li><li>",t("Edit existing table: User can create/attach/detach multiple partitions. In attach operation user can select table from the list of suitable tables to be attached."),"</li><li>",t("From/To/In input: Values for these fields must be quoted with single quote. For more than one partition key values must be comma(,) separated."),"<br>",t("Example"),":<ul><li>",t("From/To: Enabled for range partition. Consider partitioned table with multiple keys of type Integer, then values should be specified like '100','200'."),"</li><li> ",t("In: Enabled for list partition. Values must be comma(,) separated and quoted with single quote."),"</li></ul></li></ul>",t("Modulus/Remainder: Enabled for hash partition."),"</li></ul></li></ul>"].join(""),visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5}},{type:"nested",control:"tab",group:t("Parameter"),mode:["edit","create"],deps:["is_partitioned"],schema:d.VacuumSettingsSchema},{id:"relacl_str",label:t("Privileges"),disabled:"inSchema",type:"text",mode:["properties"],group:t("Security")},l.SecurityGroupSchema,{id:"relacl",label:t("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:l.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:t("Security labels"),canEdit:!1,model:l.SecLabelModel,editable:!1,canAdd:!0,type:"collection",min_version:90100,mode:["edit","create"],group:"security",canDelete:!0,control:"unique-col-collection"},{id:"vacuum_settings_str",label:t("Storage settings"),type:"multiline",group:"advanced",mode:["properties"]}],validate:function(){var e,n=this.get("name"),i=this.get("schema"),a=this.get("relowner"),r=this.get("is_partitioned"),l=this.get("partition_keys");return o.isUndefined(n)||o.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(e=t("Table name cannot be empty."),this.errorModel.set("name",e),e):(this.errorModel.unset("name"),o.isUndefined(i)||o.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(e=t("Table schema cannot be empty."),this.errorModel.set("schema",e),e):(this.errorModel.unset("schema"),o.isUndefined(a)||o.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(e=t("Table owner cannot be empty."),this.errorModel.set("relowner",e),e):(this.errorModel.unset("relowner"),r&&this.isNew()&&!o.isNull(l)&&l.length<=0?(e=t("Please specify at least one key for partitioned table."),this.errorModel.set("partition_keys",e),e):(this.errorModel.unset("partition_keys"),null))))},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},isInheritedTable:function(e){return!e.inSchema.apply(this,[e])&&!(!o.isUndefined(e.get("coll_inherits"))&&0!=e.get("coll_inherits").length||!o.isUndefined(e.get("typname"))&&""!==String(e.get("typname")).replace(/^\s+|\s+$/g,""))},checkInheritance:function(e){return e.get("is_partitioned")?(setTimeout(function(){e.set("coll_inherits",[])},10),!0):!(!e.inSchema.apply(this,[e])&&(o.isUndefined(e.get("typname"))||o.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},isLikeDisable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&(o.isUndefined(e.get("typname"))||o.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},check_grid_add_condition:function(e){var t=!0;return e.inSchema.apply(this,[e])||o.isUndefined(e.get("typname"))||o.isNull(e.get("typname"))||""===e.get("typname")||(t=!1),t},check_grid_row_edit_delete:function(e){var t=!0;return o.isUndefined(e.get("inheritedfrom"))||o.isNull(e.get("inheritedfrom"))||""===String(e.get("inheritedfrom")).replace(/^\s+|\s+$/g,"")||(t=!1),t},checkOfType:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&(o.isUndefined(e.get("coll_inherits"))||o.isNull(e.get("coll_inherits"))||""==String(e.get("coll_inherits")).replace(/^\s+|\s+$/g,"")))},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},isTableAutoVacuumEnable:function(e){return!(!e.inSchema.apply(this,[e])&&!0===e.get("autovacuum_enabled"))},isToastTableAutoVacuumEnable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&1==e.get("toast_autovacuum_enabled"))},fetch_columns_ajax:function(e){var t=this,n="get_columns",o=t.model.top||t.model,a=void 0,r=this.field.get("schema_node"),s=this.field.get("node_info"),d=r.generate_url.apply(r,[null,n,this.field.get("node_data"),this.field.get("url_with_id")||!1,s]),c=this.field.get("cache_level")||r.type,u=this.field.get("cache_node");return u=u&&l.Nodes[u]||r,o.trigger("pgadmin:view:fetching",o,t.field),i.ajax({async:!1,url:d,data:e}).done(function(e){a=u.cache(n,s,c,e.data)}).fail(function(){o.trigger("pgadmin:view:fetch:error",o,t.field)}),o.trigger("pgadmin:view:fetched",o,t.field),a=a&&a.data||[]}}),canCreate_with_trigger_enable:function(e,t,n){return e.tigger_count>0&&this.canCreate.apply(this,[e,t,n])},canCreate_with_trigger_disable:function(e,t,n){return e.tigger_count>0&&e.has_enable_triggers>0&&this.canCreate.apply(this,[e,t,n])},onTableUpdated:function(e,t,n){var i,a;if(n.is_partitioned&&"affected_partitions"in n){var s,d=n.affected_partitions,c=this,u=[],p=[];if("detached"in d&&d.detached.length>0){l.removeChildTreeNodesById(e,"coll-partition",o.map(d.detached,function(e){return parseInt(e.oid)})),s=l.findParentTreeNodeByType(e,"schema");var f=o.groupBy(d.detached,function(e){return parseInt(e.schema_id)});for(i in f)if(s=l.findSiblingTreeNode(s,i)){a=o.map(f[i],function(e){return parseInt(e.oid)});var m=l.findChildCollectionTreeNode(s,"coll-table");m&&p.push({parent:m,type:"table",treeHierarchy:r.Browser.Nodes.schema.getTreeNodeHierarchy(s),childrenIDs:o.clone(a)})}}if("attached"in d&&d.attached.length>0){s=l.findParentTreeNodeByType(e,"schema");var h=o.groupBy(d.attached,function(e){return parseInt(e.schema_id)});for(i in h)s=l.findSiblingTreeNode(s,i),s&&(a=o.map(h[i],function(e){return parseInt(e.oid)}),l.removeChildTreeNodesById(s,"coll-table",a)),u=u.concat(a)}if("created"in d&&d.created.length>0&&o.each(d.created,function(e){u.push(e.oid)}),u.length){var g=l.findChildCollectionTreeNode(e,"coll-partition");g&&p.push({parent:g,type:"partition",treeHierarchy:c.getTreeNodeHierarchy(e),childrenIDs:u})}!function e(){if(p.length){var t=p.pop();l.addChildTreeNodes(t.treeHierarchy,t.parent,t.type,t.childrenIDs,e)}}()}},handle_cache:function(){this.clear_cache.apply(this,null)}})),l.Nodes.table}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";function i(e,t,n,i){return a(e,t,n,i,{enable:"false"})}function o(e,t,n,i){return a(e,t,n,i,{enable:"true"})}function a(e,t,n,i,o){var a=r(i,e);if(!a||null===a.getData()||void 0===a.getData())return!1;s.default.put(n(a.getHtmlIdentifier(),"set_trigger",a.getData(),!0),o).then(function(n){1===n.data.success&&(t.success(n.data.info),a.reload(e))}).catch(function(n){try{var i=n.response.data;0===i.success&&t.error(i.errormsg)}catch(e){}a.unload(e)})}function r(e,t){var n=e||{},i=n.item||t.selected();return t.findNodeByDomElement(i)}Object.defineProperty(t,"__esModule",{value:!0}),t.disableTriggers=i,t.enableTriggers=o;var l=n(39),s=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function i(e){return!r.isUndefined(e.node_info)&&!r.isUndefined(e.node_info.server)&&"gpdb"===e.node_info.server.server_type}function o(e){return!i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.show_advanced_tab=o;var a=n(1),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(10),n(3),n(5),n(6),n(13),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d){r.Nodes["coll-column"]||(r.Nodes["coll-column"]=r.Collection.extend({node:"column",label:e("Columns"),type:"coll-column",columns:["name","atttypid","description"],canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema}));var c=l.VariablesModel=r.Node.Model.extend({idAttribute:"name",defaults:{name:null,value:null},schema:[{id:"name",label:e("Name"),cell:"select2",type:"text",disabled:!1,node:"column",options:[["n_distinct","n_distinct"],["n_distinct_inherited","n_distinct_inherited"]],select2:{placeholder:"Select variable"},cellHeaderClasses:"width_percent_50"},{id:"value",label:e("Value"),type:"text",disabled:!1,cellHeaderClasses:"width_percent_50"}],validate:function(){if(i.isUndefined(this.get("value"))||i.isNull(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")){var t=e("Please provide input for variable.");return this.errorModel.set("value",t),t}return this.errorModel.unset("value"),null}}),u=s.Extension.IntegerDepCell=s.IntegerCell.extend({initialize:function(){s.NumberCell.prototype.initialize.apply(this,arguments),s.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){this.$el.empty();var e=this.model,t=this.column,n=this.column.get("editable");return(i.isFunction(n)?!n.apply(t,[e]):!n)?this.$el.removeClass("editable"):this.$el.addClass("editable"),this.delegateEvents(),this},render:function(){s.NumberCell.prototype.render.apply(this,arguments);var e=this.model,t=this.column,n=this.column.get("editable");return(i.isFunction(n)?!n.apply(t,[e]):!n)?this.$el.removeClass("editable"):this.$el.addClass("editable"),this},remove:s.Extension.DependentCell.prototype.remove});return r.Nodes.column||(r.Nodes.column=r.Node.extend({parent_type:["table","view","mview"],collection_type:["coll-table","coll-view","coll-mview"],type:"column",label:e("Column"),hasSQL:!0,sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-altertable.html",dialogHelp:t("help.static",{filename:"column_dialog.html"}),canDrop:function(e,t){var n=r.treeMenu.findNodeByDomElement(t);return!!n&&n.anyParent(function(e){return"table"===e.getData()._type&&!e.anyParent(function(e){return"catalog"===e.getData()._type})})},hasDepends:!0,hasStatistics:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_column_on_coll",node:"coll-column",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_column",node:"column",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_column_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_column_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"}]))},model:r.Node.Model.extend({idAttribute:"attnum",defaults:{name:void 0,attowner:void 0,atttypid:void 0,attnum:void 0,cltype:void 0,collspcname:void 0,attacl:void 0,description:void 0,parent_tbl:void 0,min_val:void 0,max_val:void 0,edit_types:void 0,is_primary_key:!1,inheritedfrom:void 0,attstattarget:void 0,attnotnull:!1,attlen:null,attprecision:null},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"inSchemaWithColumnCheck",cellHeaderClasses:"width_percent_30",editable:"editable_check_for_table"},{id:"is_primary_key",label:e("Primary key?"),cell:s.Extension.TableChildSwitchCell,type:"switch",deps:["name"],cellHeaderClasses:"width_percent_5",options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary"},visible:function(e){return i.isUndefined(e.top.node_info.table||e.top.node_info.view||e.top.node_info.mview)},disabled:function(e){if(e.top&&(!i.isUndefined(e.top.get("oid"))&&e.top.get("primary_key").length>0&&!i.isUndefined(e.top.get("primary_key").first().get("oid"))||e.top.has("is_partitioned")&&e.top.get("is_partitioned")&&e.top.node_info.server&&e.top.node_info.server.version<11e3))return!0;var t=e.get("name");return!(e.inSchemaWithColumnCheck.apply(this,[e])||!i.isUndefined(t)&&!i.isNull(t)&&""!=t)},editable:function(e){var t=e.get("name");return e instanceof o.Collection||!(e.top&&!i.isUndefined(e.top.get("oid"))&&e.top.get("primary_key").length>0&&!i.isUndefined(e.top.get("primary_key").first().get("oid")))&&(e.top&&!i.isUndefined(e.top.get("is_partitioned"))&&e.top.get("is_partitioned")&&e.top.node_info.server&&e.top.node_info.server.version<11e3?(setTimeout(function(){e.set("is_primary_key",!1)},10),!1):!(e.inSchemaWithColumnCheck.apply(this,[e])||i.isUndefined(t)||i.isNull(t)||""===t))}},{id:"attnum",label:e("Position"),cell:"string",type:"text",disabled:"notInSchema",mode:["properties"]},{id:"cltype",label:e("Data type"),cell:s.Extension.NodeAjaxOptionsCell,type:"text",disabled:"inSchemaWithColumnCheck",control:"node-ajax-options",url:"get_types",node:"table",cellHeaderClasses:"width_percent_30",first_empty:!0,select2:{allowClear:!1},group:e("Definition"),cache_node:"table",transform:function(e,t){var n=t||this,o=n.model;n.model.datatypes=e;var a=o.get("edit_types"),r=[];return i.isUndefined(o.top)||o.top.isNew()?o.isNew()?e:(i.each(e,function(e){-1!=i.indexOf(a,e.value)&&r.push(e)}),r):(i.each(e,function(e){-1!=i.indexOf(a,e.value)&&r.push(e)}),r.length>0?r:e)},editable:"editable_check_for_table"},{id:"inheritedfrom",label:e("Inherited from table"),type:"text",disabled:!0,editable:!1,cellHeaderClasses:"width_percent_10",visible:function(e){return i.isUndefined(e.top.node_info.table||e.top.node_info.view||e.top.node_info.mview)}},{id:"attlen",label:e("Length"),cell:u,deps:["cltype"],type:"int",group:e("Definition"),cellHeaderClasses:"width_percent_20",disabled:function(e){var t=e.get("cltype"),n=!0;return i.each(e.datatypes,function(i){t==i.value&&i.length&&(e.set("min_val",i.min_val,{silent:!0}),e.set("max_val",i.max_val,{silent:!0}),n=!1)}),n&&setTimeout(function(){e.get("attlen")&&e.set("attlen",null)},10),n},editable:function(e){if(!i.isUndefined(e.get("inheritedfrom")))return!1;if(!e.datatypes)return!0;var t=e.get("cltype"),n=!1;return i.each(e.datatypes,function(i){t==i.value&&i.length&&(e.set("min_val",i.min_val,{silent:!0}),e.set("max_val",i.max_val,{silent:!0}),n=!0)}),!n&&setTimeout(function(){e.get("attlen")&&e.set("attlen",null,{silent:!0})},10),n}},{id:"attprecision",label:e("Precision"),cell:u,deps:["cltype"],type:"int",group:e("Definition"),cellHeaderClasses:"width_percent_20",disabled:function(e){var t=e.get("cltype"),n=!0;return i.each(e.datatypes,function(i){t==i.value&&i.precision&&(e.set("min_val",0,{silent:!0}),e.set("max_val",i.max_val,{silent:!0}),n=!1)}),n&&setTimeout(function(){e.get("attprecision")&&e.set("attprecision",null)},10),n},editable:function(e){if(!i.isUndefined(e.get("inheritedfrom")))return!1;if(!e.datatypes)return!0;var t=e.get("cltype"),n=!1;return i.each(e.datatypes,function(i){t==i.value&&i.precision&&(e.set("min_val",0,{silent:!0}),e.set("max_val",i.max_val,{silent:!0}),n=!0)}),!n&&setTimeout(function(){e.get("attprecision")&&e.set("attprecision",null)},10),n}},{id:"collspcname",label:e("Collation"),cell:"string",type:"text",control:"node-ajax-options",url:"get_collations",group:e("Definition"),node:"collation",deps:["cltype"],disabled:function(e){var t=e.get("cltype"),n=!0;return i.each(e.datatypes,function(e){t==e.value&&e.is_collatable&&(n=!1)}),n&&setTimeout(function(){e.get("collspcname")&&""!==e.get("collspcname")&&e.set("collspcname","")},10),n}},{id:"defval",label:e("Default Value"),cell:"string",type:"text",group:e("Definition"),deps:["cltype"],disabled:function(e){if(!e.inSchemaWithModelCheck.apply(this,[e])){var t=e.get("cltype");return"serial"==t||"bigserial"==t||"smallserial"==t}}},{id:"attnotnull",label:e("Not NULL?"),cell:"switch",type:"switch",disabled:"inSchemaWithColumnCheck",cellHeaderClasses:"width_percent_20",group:e("Definition"),editable:"editable_check_for_table",options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary"}},{id:"attstattarget",label:e("Statistics"),cell:"string",type:"text",disabled:"inSchemaWithColumnCheck",mode:["properties","edit"],group:e("Definition")},{id:"attstorage",label:e("Storage"),group:e("Definition"),type:"text",mode:["properties","edit"],cell:"string",disabled:"inSchemaWithColumnCheck",first_empty:!0,control:"select2",select2:{placeholder:"Select storage",allowClear:!1,width:"100%"},options:[{label:"PLAIN",value:"p"},{label:"MAIN",value:"m"},{label:"EXTERNAL",value:"e"},{label:"EXTENDED",value:"x"}]},{id:"is_pk",label:e("Primary key?"),type:"switch",disabled:!0,mode:["properties"],group:e("Definition")},{id:"is_fk",label:e("Foreign key?"),type:"switch",disabled:!0,mode:["properties"],group:e("Definition")},{id:"is_inherited",label:e("Inherited?"),type:"switch",disabled:!0,mode:["properties"],group:e("Definition")},{id:"tbls_inherited",label:e("Inherited from table(s)"),type:"text",disabled:!0,mode:["properties"],deps:["is_inherited"],group:e("Definition"),visible:function(e){return!(i.isUndefined(e.get("is_inherited"))||!e.get("is_inherited"))}},{id:"is_sys_column",label:e("System column?"),cell:"string",type:"switch",disabled:!0,mode:["properties"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"notInSchema"},{id:"attoptions",label:e("Variables"),type:"collection",group:e("Variables"),control:"unique-col-collection",model:c,uniqueCol:["name"],mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0},r.SecurityGroupSchema,{id:"attacl",label:e("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:r.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","x"]}),mode:["edit"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:e("Security Labels"),canAdd:!0,model:r.SecLabelModel,group:"security",mode:["edit","create"],editable:!1,type:"collection",min_version:90100,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(t){var n=void 0;return t&&0==t.length?(this.errorModel.clear(),null):(this.errorModel.clear(),i.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(n=e("Column name cannot be empty."),this.errorModel.set("name",n),n):i.isUndefined(this.get("cltype"))||""==String(this.get("cltype")).replace(/^\s+|\s+$/g,"")?(n=e("Column type cannot be empty."),this.errorModel.set("cltype",n),n):i.isUndefined(this.get("cltype"))||i.isUndefined(this.get("attlen"))||i.isNull(this.get("attlen"))||""===this.get("attlen")||(this.get("attlen")<this.get("min_val")&&(n=e("Length should not be less than: ")+this.get("min_val")),this.get("attlen")>this.get("max_val")&&(n=e("Length should not be greater than: ")+this.get("max_val")),!n)?i.isUndefined(this.get("cltype"))||i.isUndefined(this.get("attprecision"))||i.isNull(this.get("attprecision"))||""===this.get("attprecision")||(this.get("attprecision")<this.get("min_val")&&(n=e("Precision should not be less than: ")+this.get("min_val")),this.get("attprecision")>this.get("max_val")&&(n=e("Precision should not be greater than: ")+this.get("max_val")),!n)?null:(this.errorModel.set("attprecision",n),n):(this.errorModel.set("attlen",n),n))},notInSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithColumnCheck:function(e){var t=this.node_info||e.node_info||e.top.node_info;return!!(t&&("view"in t||"mview"in t)&&this&&i.has(this,"name")&&"defval"!=this.name)||(!(t&&"schema"in t)||(!i.isUndefined(e.get("inheritedfrom"))||!e.isNew()&&!(!i.isUndefined(e.get("attnum"))&&e.get("attnum")>0)))},editable_check_for_table:function(e){return e instanceof o.Collection?!e.model.prototype.inSchemaWithColumnCheck.apply(this,[e.top]):!e.inSchemaWithColumnCheck.apply(this,[e])}}),canCreate:function(e,t,n){if(n&&0==n.check)return!0;for(var o=r.tree,a=t,l=e,s=[];a;){if(i.indexOf(["schema"],l._type)>-1)return!0;if(i.indexOf(["view","coll-view","mview","coll-mview"],l._type)>-1){s.push(l._type);break}s.push(l._type),a=o.hasParent(a)?o.parent(a):null,l=a?o.itemData(a):null}return!(i.indexOf(s,"catalog")>-1||i.indexOf(s,"coll-view")>-1||i.indexOf(s,"coll-mview")>-1||i.indexOf(s,"mview")>-1||i.indexOf(s,"view")>-1)}})),r.Nodes.column}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(0),n(1),n(3),n(5),n(7),n(223),n(224),n(225),n(226),n(227)],void 0!==(o=function(e,t,n,i,o){return o.Nodes["coll-constraints"]||(i.Browser.Nodes["coll-constraints"]=i.Browser.Collection.extend({node:"constraints",label:e("Constraints"),type:"coll-constraints",columns:["name","comment"],canDrop:!1,canDropCascade:!1})),o.Nodes.constraints||(i.Browser.Nodes.constraints=o.Node.extend({type:"constraints",label:e("Constraints"),collection_type:"coll-constraints",parent_type:["table","partition"],Init:function(){this.initialized||(this.initialized=!0,o.add_menus([]))},model:i.Browser.Node.Model.extend({defaults:{name:void 0,oid:void 0,comment:void 0},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"]},{id:"oid",label:e("Oid"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"]}]})})),o.Nodes.constraints}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(5),n(6),n(13),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l){return a.Nodes.unique_constraint||(o.Browser.Nodes.unique_constraint=a.Node.extend({type:"unique_constraint",label:e("Unique constraint"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"unique_constraint_dialog.html"}),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[e("Index size")],parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_unique_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Unique constraint"),icon:"wcTabIcon icon-unique_constraint",data:{action:"create",check:!0},enable:"canCreate"}]))},canCreate:function(e,t,n){if(n&&0==n.check)return!0;for(var o=a.tree,r=t,l=e,s=[],d=!1,c=!1,u=this.getTreeNodeHierarchy(r).server.version;r;){if(d||"table"!=l._type&&"partition"!=l._type||(d=!0,"is_partitioned"in l&&l.is_partitioned&&u<11e4&&(c=!0)),i.indexOf(["schema"],l._type)>-1)return!c;s.push(l._type),r=o.hasParent(r)?o.parent(r):null,l=r?o.itemData(r):null}return!(i.indexOf(s,"catalog")>-1)&&!c},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,spcname:void 0,index:void 0,fillfactor:void 0,condeferrable:void 0,condeferred:void 0,columns:[],include:[]},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],editable:!0,cellHeaderClasses:"width_percent_40"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"],editable:!1,cellHeaderClasses:"width_percent_20"},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"columns",label:e("Columns"),type:"collection",group:e("Definition"),editable:!1,cell:l.StringCell.extend({initialize:function(){l.StringCell.prototype.initialize.apply(this,arguments);var e=this,t=this.model.get("columns");if(i.isUndefined(e.model.get("oid"))){var n=e.model.top.get("columns");e.listenTo(n,"remove",e.removeColumn),e.listenTo(n,"change:name",e.resetColOptions)}t.on("pgadmin:multicolumn:updated",function(){e.render.apply(e)}),e.listenTo(t,"add",e.render),e.listenTo(t,"remove",e.render)},removeColumn:function(e){var t=this,n=t.model.get("columns").where({column:e.get("name")});t.model.get("columns").remove(n),setTimeout(function(){t.render()},10);setTimeout(function(){var e=t.model.top.get("unique_constraint"),n=[];e.each(function(e){0==e.get("columns").length&&n.push(e)}),e.remove(n)},100)},resetColOptions:function(e){var t=this,n=t.model.get("columns").where({column:e.previous("name")});n.length>0&&n[0].set({column:e.get("name")},{silent:!0}),setTimeout(function(){t.render()},10)},formatter:{fromRaw:function(e){return e.pluck("column").toString()},toRaw:function(e){return e}},render:function(){return l.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns"),t=this.model.get("columns");t&&t.off("pgadmin:multicolumn:updated"),this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),l.StringCell.prototype.remove.apply(this,arguments)}}),canDelete:!0,canAdd:!0,control:r.MultiSelectAjaxControl.extend({defaults:i.extend({},r.NodeListByNameControl.prototype.defaults,{select2:{multiple:!0,allowClear:!0,width:"style",placeholder:e("Select the column(s)")}}),keyPathAccessor:function(e,t){var n=e;if(i.isArray(n))return i.map(n,function(e){return e.column});t=t.split(".");for(var o=0;o<t.length;o++){if(i.isNull(n))return null;i.isEmpty(t[o])||(i.isUndefined(n[t[o]])||(n=n[t[o]]))}return i.isObject(n)&&!i.isArray(n)?null:n},initialize:function(){var e=this;if(this.model.handler){if(r.Select2Control.prototype.initialize.apply(this,arguments),i.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else r.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments);e.model.get("columns").on("pgadmin:multicolumn:updated",function(){e.render.apply(e)})},resetColOptions:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},custom_options:function(){var e=this.model.top.get("columns"),t=[];e.length>0&&i.each(e.models,function(e){var n=e.get("name");i.isUndefined(n)||i.isNull(n)||t.push({label:n,value:n,image:"icon-column"})}),this.field.set("options",t)},onChange:function(){var e=this,t=this.model,n=this.field.get("name").split("."),o=n.shift(),a=this.getValueFromDOM(),r=t.get(o),l=[];this.stopListening(this.model,"change:"+o,this.render),r.each(function(e){var t=e.get("column"),n=i.indexOf(a,t);n>-1?a.splice(n,1):l.push(t)}),i.each(a,function(t){var n=new(e.field.get("model"))({column:t},{silent:!0,top:e.model.top,collection:r,handler:r});r.add(n)}),i.each(l,function(e){r.remove(r.where({column:e}))}),this.listenTo(this.model,"change:"+o,this.render)},remove:function(){if(this.model.handler){var e=this,t=e.model.top.get("columns");e.stopListening(t,"remove",e.resetColOptions),e.stopListening(t,"change:name",e.resetColOptions),e.model.get("columns").off("pgadmin:multicolumn:updated"),r.Select2Control.prototype.remove.apply(this,arguments)}else r.MultiSelectAjaxControl.prototype.remove.apply(this,arguments)}}),deps:["index"],node:"column",model:a.Node.Model.extend({defaults:{column:void 0},validate:function(){return null}}),transform:function(e){var t=[];return e&&i.isArray(e)&&i.each(e,function(e){t.push({label:e.label,value:e.label,image:"icon-column"})}),t},select2:{allowClear:!1},disabled:function(e){if(i.has(e,"top")&&!i.isUndefined(e.top)&&!e.top.isNew())return!i.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!i.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}},{id:"include",label:e("Include columns"),type:"array",group:e("Definition"),editable:!1,canDelete:!0,canAdd:!0,mode:["properties","create","edit"],visible:function(e){return e=e.top,!i.isUndefined(e.node_info)&&!i.isUndefined(e.node_info.server)&&!i.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=11e4},control:r.MultiSelectAjaxControl.extend({defaults:i.extend({},r.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:e("Select the column(s)")}}),initialize:function(){var e=this;if(this.model.handler){if(r.Select2Control.prototype.initialize.apply(this,arguments),i.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else r.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments)},resetColOptions:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},custom_options:function(){var e=this.model.top.get("columns"),t=[];e.length>0&&i.each(e.models,function(e){var n=e.get("name");i.isUndefined(n)||i.isNull(n)||t.push({label:n,value:n,image:"icon-column"})}),this.field.set("options",t)}}),deps:["index"],node:"column",disabled:function(e){if(i.has(e,"top")&&!i.isUndefined(e.top)&&!e.top.isNew())return!i.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!i.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}},{id:"spcname",label:e("Tablespace"),type:"text",group:e("Definition"),control:"node-list-by-name",node:"tablespace",deps:["index"],select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label},disabled:function(e){e=e.top||e;var t=e.get("index");return!i.isUndefined(t)&&""!=t&&(setTimeout(function(){e.set("spcname","")},10),!0)}},{id:"index",label:e("Index"),type:"text",group:e("Definition"),control:r.NodeListByNameControl.extend({initialize:function(){i.isUndefined(this.model.top)?r.NodeListByNameControl.prototype.initialize.apply(this,arguments):r.Control.prototype.initialize.apply(this,arguments)}}),select2:{allowClear:!0},node:"index",disabled:function(e){return!(!i.has(e,"top")||i.isUndefined(e.top)||e.top.isNew())||!e.isNew()},visible:function(e){return!i.isUndefined(e.top.node_info.table)}},{id:"fillfactor",label:e("Fill factor"),deps:["index"],type:"int",group:e("Definition"),allowNull:!0,disabled:function(e){var t=e.get("index");return!i.isUndefined(t)&&""!=t&&(setTimeout(function(){e.set("fillfactor",null)},10),!0)}},{id:"condeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),deps:["index"],disabled:function(e){if(i.has(e,"top")&&!i.isUndefined(e.top)&&!e.top.isNew())return!i.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!i.isUndefined(t)&&""!=t&&(setTimeout(function(){e.get("condeferrable")&&e.set("condeferrable",!1)},10),!0)}},{id:"condeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),deps:["condeferrable"],disabled:function(e){return!i.has(e,"top")||i.isUndefined(e.top)||e.top.isNew()?!e.isNew()||1!=e.get("condeferrable")&&(setTimeout(function(){e.get("condeferred")&&e.set("condeferred",!1)},10),!0):!i.isUndefined(e.get("oid"))}}],validate:function(){this.errorModel.clear(),i.has(this,"top")&&this.top.errorModel.clear();var t=this.get("columns"),n=this.get("index");if((i.isUndefined(n)||""==String(n).replace(/^\s+|\s+$/g,""))&&(i.isUndefined(t)||i.isNull(t)||t.length<1)){var o=e("Please specify columns for %(node)s",{node:e("Unique constraint")});return this.errorModel.set("columns",o),o}return null}})})),a.Nodes.unique_constraint}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(11),n(12),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s){return r.Nodes.check_constraint||(a.Browser.Nodes.check_constraint=r.Node.extend({type:"check_constraint",label:e("Check"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"check_dialog.html"}),hasSQL:!0,hasDepends:!0,parent_type:["table","partition"],Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_check_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Check..."),icon:"wcTabIcon icon-check_constraint",data:{action:"create",check:!0},enable:"canCreate"},{name:"validate_check_constraint",node:"check_constraint",module:this,applies:["object","context"],callback:"validate_check_constraint",category:"validate",priority:4,label:e("Validate check constraint"),icon:"fa fa-link",enable:"is_not_valid",data:{action:"edit",check:!0}}]))},is_not_valid:function(e,t,n){return!!this.canCreate(e,t,n)&&(e&&!e.valid)},callbacks:{validate_check_constraint:function(e){var t=e||{},i=this,o=r.tree,a=t.item||o.selected(),s=a&&1==a.length?o.itemData(a):void 0;if(!s)return!1;var d=s;return n.ajax({url:i.generate_url(a,"validate",s,!0),type:"GET"}).done(function(e){1==e.success&&(l.success(e.info),o.removeIcon(a),d.valid=!0,d.icon="icon-check_constraint",o.addIcon(a,{icon:d.icon}),setTimeout(function(){o.deselect(a)},10),setTimeout(function(){o.select(a)},100))}).fail(function(e,t,n){l.pgRespErrorNotify(e,n),o.unload(a)}),!1}},canDrop:s.isTreeItemOfChildOfSchema,model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,description:void 0,consrc:void 0,connoinherit:void 0,convalidated:!0},schema:[{id:"name",label:e("Name"),type:"text",cell:"string",disabled:"isDisabled"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:e("Comment"),type:"multiline",cell:"string",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"consrc",label:e("Check"),type:"multiline",cell:"string",group:e("Definition"),mode:["properties","create","edit"],disabled:function(e){return i.has(e,"handler")&&!i.isUndefined(e.handler)&&!i.isUndefined(e.get("oid"))||i.isFunction(e.isNew)&&!e.isNew()},editable:!1},{id:"connoinherit",label:e("No Inherit?"),type:"switch",cell:"boolean",group:e("Definition"),mode:["properties","create","edit"],min_version:90200,disabled:function(e){return i.has(e,"top")&&!i.isUndefined(e.top)&&e.top.get("is_partitioned")||i.has(e,"node_info")&&i.has(e.node_info,"table")&&i.has(e.node_info.table,"is_partitioned")&&e.node_info.table.is_partitioned?(setTimeout(function(){e.set("connoinherit",!1)},10),!0):i.has(e,"handler")&&!i.isUndefined(e.handler)&&!i.isUndefined(e.get("oid"))||i.isFunction(e.isNew)&&!e.isNew()}},{id:"convalidated",label:e("Don't validate?"),type:"switch",cell:"boolean",group:e("Definition"),min_version:90200,disabled:function(e){return!!(i.isFunction(e.isNew)&&!e.isNew()||i.has(e,"handler")&&!i.isUndefined(e.handler)&&!i.isUndefined(e.get("oid")))&&!e.get("convalidated")},mode:["properties","create","edit"]}],validate:function(){var t,n={};return(i.isUndefined(this.get("consrc"))||""==String(this.get("consrc")).replace(/^\s+|\s+$/g,""))&&(n.consrc=e("Check cannot be empty."),t=t||n.consrc),this.errorModel.clear().set(n),i.size(n)?(this.trigger("on-status",{msg:t}),t):null},isDisabled:function(e){if(i.has(e,"handler")&&!i.isUndefined(e.handler)&&!i.isUndefined(e.get("oid"))||i.isFunction(e.isNew)&&!e.isNew()){if((this.node_info||e.top.node_info).server.version<90200)return!0}return!1}}),canCreate:function(e,t,n){if(n&&0==n.check)return!0;for(var o=r.tree,a=t,l=e,s=[];a;){if(i.indexOf(["schema"],l._type)>-1)return!0;s.push(l._type),a=o.hasParent(a)?o.parent(a):null,l=a?o.itemData(a):null}return!(i.indexOf(s,"catalog")>-1)}})),r.Nodes.check_constraint}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(10),n(3),n(5),n(11),n(6),n(13),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d){var c=function(e){if(!e.id)return e.text;var t=n(e.element).data("image");return t?n('<span><span class="wcTabIcon '+t+'"/>'+e.text+"</span>"):e.text},u=i.template(["<div class=\"<%=Backform.controlsClassName%> <%=extraClasses.join(' ')%>\">",'  <select class="pgadmin-node-select form-control" name="<%=name%>" style="width:100%;" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> >','    <%=select2.first_empty ? " <option></option>" : ""%>',"    <% for (var i=0; i < options.length; i++) { %>","    <% var option = options[i]; %>",'    <option <% if (option.image) { %> data-image=<%= option.image %> <% } %> value=<%= formatter.fromRaw(option.value) %> <%=option.value === rawValue ? "selected=\'selected\'" : "" %>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n")),p=r.Node.Model.extend({defaults:{local_column:void 0,references:void 0,referenced:void 0},schema:[{id:"local_column",label:e("Local"),type:"text",editable:!1,cellHeaderClasses:"width_percent_50",cell:"string",headerCell:d.Extension.CustomHeaderCell},{id:"referenced",label:e("Referenced"),type:"text",editable:!1,cell:"string",cellHeaderClasses:"width_percent_50",headerCell:d.Extension.CustomHeaderCell}]}),f=s.ForeignKeyColumnControl=s.UniqueColCollectionControl.extend({initialize:function(){s.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var t=this,a=[{id:"local_column",label:"",type:"text",node:"column",control:s.NodeListByNameControl.extend({initialize:function(){if(t.model.handler){if(s.Select2Control.prototype.initialize.apply(this,arguments),i.isUndefined(t.model.get("oid"))){var e=t.model.top.get("columns");this.listenTo(e,"remove",this.removeColumn),this.listenTo(e,"change:name",this.resetColOptions)}this.custom_options()}else s.NodeListByNameControl.prototype.initialize.apply(this,arguments)},removeColumn:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},resetColOptions:function(e){var n=this;e.previous("name")==t.headerData.get("local_column")&&(t.headerData.set({local_column:e.get("name")}),t.headerDataChanged()),setTimeout(function(){n.custom_options(),n.render.apply(n)},50)},custom_options:function(){var e=t.model.top.get("columns"),n=[];e.length>0&&i.each(e.models,function(e){var t=e.get("name");i.isUndefined(t)||i.isNull(t)||n.push({label:t,value:t,image:"icon-column"})}),this.field.set("options",n)},template:u,remove:function(){if(t.model.handler){var e=t.model.top.get("columns");this.stopListening(e,"remove",this.removeColumn),this.stopListening(e,"change:name",this.resetColOptions),s.Select2Control.prototype.remove.apply(this,arguments)}else s.NodeListByNameControl.prototype.remove.apply(this,arguments)}}),select2:{allowClear:!1,width:"style",placeholder:e("Select column"),first_empty:!i.isUndefined(t.model.get("oid"))},version_compatible:t.field.get("version_compatible"),disabled:function(){return!i.isUndefined(t.model.get("oid"))}},{id:"references",label:"",type:"text",cache_level:"server",select2:{allowClear:!1,width:"style",placeholder:"Select foreign table"},first_empty:!0,control:s.NodeListByNameControl.extend({formatter:s.ControlFormatter,template:u}),url:"all_tables",node:"table",version_compatible:t.field.get("version_compatible"),disabled:function(){return!i.isUndefined(t.model.get("oid"))},transform:function(e){var t=[];return i.each(e,function(e){t.push({value:e.value,image:"icon-table",label:e.label})}),t}},{id:"referenced",label:"",type:"text",cache_level:"server",transform:function(e){var t=[];return i.each(e,function(e){t.push({value:e.name,image:"icon-column",label:e.name})}),t},control:s.Select2Control.extend({formatter:s.ControlFormatter,template:u,render:function(){var e=this,t=e.field.get("url")||e.defaults.url,o=e.model,a=o.get("references");if(o.set(e.field.get("name"),null,{silent:!0}),!t||i.isUndefined(a)||i.isNull(a)||""==a)e.field.set("options",[]);else{var r=this.field.get("schema_node"),l=this.field.get("node_info"),d=r.generate_url.apply(r,[null,t,this.field.get("node_data"),this.field.get("url_with_id")||!1,l]),c=[];this.field.get("version_compatible")&&(o.trigger("pgadmin:view:fetching",o,e.field),n.ajax({async:!1,data:{tid:a},url:d}).done(function(e){c=e.data}).fail(function(){o.trigger("pgadmin:view:fetch:error",o,e.field)}),o.trigger("pgadmin:view:fetched",o,e.field));var u=this.field.get("transform")||e.defaults.transform;u&&i.isFunction(u)?e.field.set("options",u.bind(e,c)):e.field.set("options",c)}return s.Select2Control.prototype.render.apply(this,arguments),this}}),url:"get_columns",select2:{allowClear:!1,width:"style",placeholder:e("Select column"),templateResult:c,templateSelection:c},deps:["references"],node:"table",version_compatible:t.field.get("version_compatible"),disabled:function(){return!i.isUndefined(t.model.get("oid"))}}],r={local_column:null,references:null,referenced:null},l=["local_column","references","referenced"];if(!t.model.isNew()&&i.isUndefined(t.model.handler)||i.has(t.model,"handler")&&!i.isUndefined(t.model.handler)&&!i.isUndefined(t.model.get("oid"))){var d=t.collection.first();d&&(r.references=d.get("references"))}t.headerData=new(o.Model.extend({defaults:r,schema:a}))({});var p=s.generateViewSchema(t.field.get("node_info"),t.headerData,"create","foreign_key",t.field.get("node_data")),f=[];i.each(p,function(e){f=f.concat(e.fields)}),t.headerFields=new s.Fields(f),t.gridSchema=s.generateGridColumnsFromModel(t.field.get("node_info"),t.field.get("model"),"edit",l,t.field.get("schema_node")),t.controls=[],t.listenTo(t.headerData,"change",t.headerDataChanged),t.listenTo(t.headerData,"select2",t.headerDataChanged),t.listenTo(t.collection,"add",t.onAddorRemoveColumns),t.listenTo(t.collection,"remove",t.onAddorRemoveColumns)},generateHeader:function(t){var o=['<div class="subnode-header-form">'," <div>",'  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-column_label%></label>',"   </div>",'   <div class="col-md-6" header="local_column"></div>',"  </div>",'  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-references_label%></label>',"   </div>",'   <div class="col-md-6" header="references"></div>',"  </div>",'  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-referenced_label%></label>',"   </div>",'   <div class="col-md-6" header="referenced"></div>',"  </div>"," </div>","</div>"].join("\n");i.extend(t,{column_label:e("Local column"),references_label:e("References"),referenced_label:e("Referencing")});var a=this,r=i.template(o),l=n(r(t)),s=this.controls;return this.headerFields.each(function(e){var t=new(e.get("control"))({field:e,model:a.headerData});l.find('div[header="'+e.get("name")+'"]').append(t.render().$el),s.push(t)}),"properties"==t.mode&&l.html(""),a.$header=l,l},events:i.extend({},s.UniqueColCollectionControl.prototype.events,{"click button.add":"addColumns"}),showGridControl:function(e){var t=this,o=i.template(['<div class="subnode-header">','  <label class="control-label pg-el-sm-10"><%-label%></label>','  <button class="btn btn-sm-sq btn-secondary add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> title="'+i("Add new row")+'"></button>',"</div>"].join("\n")),a=n("<div class='pgadmin-control-group backgrid form-group col-12 object subnode'></div>").append("properties"!==e.mode?o({label:e.label,canAdd:e.canAdd}):"");t.grid&&t.grid.remove(),a.append(t.generateHeader(e));var r=i.clone(this.gridSchema);0==e.disabled&&e.canDelete&&r.columns.unshift({name:"pg-backform-delete",label:"",cell:d.Extension.DeleteCell,editable:!1,cell_priority:-1});var l=t.grid=new d.Grid({columns:r.columns,collection:t.collection,className:"backgrid table-bordered table-noouter-border table-hover"});return t.$grid=l.render().$el,a.append(t.$grid),setTimeout(function(){t.headerData.set({local_column:t.$header.find('div[header="local_column"] select option:first').val(),referenced:t.$header.find('div[header="referenced"] select option:first').val(),references:t.$header.find('div[header="references"] select option:first').val()},{silent:!0})},10),"properties"===e.mode&&a.find(".subnode-header-form").removeClass("subnode-header-form"),t.$gridBody=a,a},headerDataChanged:function(){var e,t=this,n=this.headerData.toJSON(),o=!1,a=["local_column","referenced"];t.$header&&(t.control_data.canAdd?t.collection.each(function(t){o||i.each(a,function(a){o||(e=t.get(a),o=(i.isUndefined(e)||i.isNull(e))&&(i.isUndefined(n[a])||i.isNull(n[a]))||e==n[a])})}):o=!0,t.$gridBody.find("button.add").prop("disabled",o))},addColumns:function(e){e.preventDefault();var t=this,i=t.headerData.get("local_column"),o=t.headerData.get("referenced");if(!i||""==i||!o||""==o)return!1;var a=new(t.field.get("model"))(t.headerData.toJSON()),r=t.model.get(t.field.get("name"));r.add(a);var l=r.indexOf(a);if(l>-1){t.$grid.find(".new").removeClass("new");var s=t.grid.body.rows[l].$el;s.addClass("new"),n(s).pgMakeVisible("backform-tab")}return!1},onAddorRemoveColumns:function(){var e=this;setTimeout(function(){e.collection.length>0?e.$header.find('div[header="references"] select').prop("disabled",!0):e.$header.find('div[header="references"] select').prop("disabled",!1),e.collection.trigger("pgadmin:columns:updated",e.collection),e.headerDataChanged(),(!i.has(e.model,"handler")||i.has(e.model,"handler")&&i.isUndefined(e.model.handler)||i.has(e.model,"handler")&&!i.isUndefined(e.model.handler)&&!i.isUndefined(e.model.handler.get("oid")))&&e.getCoveringIndex()},10)},getCoveringIndex:function(){var e=this,t=e.model,i=[],o=null;if(e.collection.each(function(e){i.push(e.get("local_column"))}),i.length>0){var a=this.field.get("schema_node"),r=this.field.get("node_info"),l=a.generate_url.apply(a,[null,"get_coveringindex",this.field.get("node_data"),this.field.get("url_with_id")||!1,r]);this.field.get("version_compatible")&&(t.trigger("pgadmin:view:fetching",t,e.field),n.ajax({async:!1,data:{cols:JSON.stringify(i)},url:l}).done(function(e){o=e.data}).fail(function(){t.trigger("pgadmin:view:fetch:error",t,e.field)}),t.trigger("pgadmin:view:fetched",t,e.field))}o?(t.set("hasindex",!0),t.set("autoindex",!1),t.set("coveringindex",o)):(t.set("coveringindex",null),t.set("autoindex",!0),t.set("hasindex",!1))},remove:function(){this.stopListening(this.headerData,"change",this.headerDataChanged),this.listenTo(this.headerData,"select2",this.headerDataChanged),this.listenTo(this.collection,"remove",this.onRemoveVariable),i.each(this.controls,function(e){e.remove()}),f.__super__.remove.apply(this,arguments),delete this.headerData}});return r.Nodes.foreign_key||(a.Browser.Nodes.foreign_key=r.Node.extend({type:"foreign_key",label:e("Foreign key"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"foreign_key_dialog.html"}),hasSQL:!0,parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_foreign_key_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign key..."),icon:"wcTabIcon icon-foreign_key",data:{action:"create",check:!0},enable:"canCreate"},{name:"validate_foreign_key",node:"foreign_key",module:this,applies:["object","context"],callback:"validate_foreign_key",category:"validate",priority:4,label:e("Validate foreign key"),icon:"fa fa-link",enable:"is_not_valid"}]))},is_not_valid:function(e){return e&&!e.valid},callbacks:{validate_foreign_key:function(e){var t=e||{},i=this,o=r.tree,a=t.item||o.selected(),s=a&&1==a.length?o.itemData(a):void 0;if(!s)return!1;var d=s;return n.ajax({url:i.generate_url(a,"validate",s,!0),type:"GET"}).done(function(e){1==e.success&&(l.success(e.info),o.removeIcon(a),d.valid=!0,d.icon="icon-foreign_key",o.addIcon(a,{icon:d.icon}),setTimeout(function(){o.deselect(a)},10),setTimeout(function(){o.select(a)},100))}).fail(function(e,t,n){l.pgRespErrorNotify(e,n),o.unload(a)}),!1}},model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,condeferrable:void 0,condeferred:void 0,confmatchtype:void 0,convalidated:void 0,columns:void 0,confupdtype:"a",confdeltype:"a",autoindex:!0,coveringindex:void 0,hasindex:void 0},toJSON:function(){var e=a.Browser.Node.Model.prototype.toJSON.apply(this,arguments);return delete e.hasindex,e},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],editable:!0,headerCell:d.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"condeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),disabled:function(e){return i.has(e,"handler")&&!i.isUndefined(e.handler)?!i.isUndefined(e.get("oid")):!e.isNew()}},{id:"condeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),deps:["condeferrable"],disabled:function(e){return i.has(e,"handler")&&!i.isUndefined(e.handler)?!i.isUndefined(e.get("oid")):!e.isNew()||1!=e.get("condeferrable")&&(setTimeout(function(){e.get("condeferred")&&e.set("condeferred",!1)},10),!0)}},{id:"confmatchtype",label:e("Match type"),type:"switch",group:e("Definition"),options:{onText:"FULL",offText:"SIMPLE",width:"80"},disabled:function(e){return i.has(e,"handler")&&!i.isUndefined(e.handler)?!i.isUndefined(e.get("oid")):!e.isNew()}},{id:"convalidated",label:e("Validated?"),type:"switch",group:e("Definition"),options:{onText:e("Yes"),offText:e("No")},disabled:function(e){return i.has(e,"handler")&&!i.isUndefined(e.handler)?!(i.isUndefined(e.get("oid"))||e.get("convalidated")):!(e.isNew()||e.get("convalidated"))}},{id:"autoindex",label:e("Auto FK index?"),type:"switch",group:e("Definition"),deps:["name","hasindex"],options:{onText:e("Yes"),offText:e("No")},disabled:function(e){var t=e.get("coveringindex"),n=e.get("autoindex"),o=function(){var n=e.get("name"),o="fki_"+e.previous("name");if(e.get("hasindex"))return!0;if(!e.get("autoindex")||i.isUndefined(n)||i.isNull(n)||""==n||!i.isUndefined(t)&&!i.isNull(t)&&""!=t&&t!=o)return!1;var a="fki_"+n;return e.set("coveringindex",a),!1};return i.has(e,"handler")&&!i.isUndefined(e.handler)?i.isUndefined(e.get("oid"))&&i.isUndefined(e.handler.get("oid"))?(setTimeout(function(){e.get("autoindex")&&e.set("autoindex",!1)},10),!0):o():!(e.isNew()||!n||i.isUndefined(t)||i.isNull(t)||""==t||!e.get("hasindex"))||o()}},{id:"coveringindex",label:e("Covering index"),type:"text",mode:["properties","create","edit"],group:e("Definition"),deps:["autoindex","hasindex"],disabled:function(e){var t=e.get("coveringindex"),n=function(){return!!e.get("hasindex")||(e.get("autoindex")?(setTimeout(function(){var t=e.get("name"),n="fki_"+t;!e.get("autoindex")||i.isUndefined(t)||i.isNull(t)||""==t||e.set("coveringindex",n)}),!1):(setTimeout(function(){e.set("coveringindex",null)}),!0))};return i.has(e,"handler")&&!i.isUndefined(e.handler)?!(!i.isUndefined(e.get("oid"))||!i.isUndefined(e.handler.get("oid")))||n():!(e.isNew()||!e.get("autoindex")||i.isUndefined(t)||!i.isNull(t)||""!=t)||n()}},{id:"columns",label:e("Columns"),type:"collection",group:e("Columns"),node:"foreign_key",editable:!1,headerCell:d.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_50",cell:d.StringCell.extend({initialize:function(){d.StringCell.prototype.initialize.apply(this,arguments);var e=this,t=this.model.get("columns");if(i.isUndefined(e.model.get("oid"))){var n=e.model.top.get("columns");e.listenTo(n,"remove",e.removeColumn),e.listenTo(n,"change:name",e.resetColOptions)}e.model.get("columns").on("pgadmin:columns:updated",function(){e.render.apply(e)}),e.listenTo(t,"add",e.render),e.listenTo(t,"remove",e.render)},removeColumn:function(e){var t=this,n=t.model.get("columns").where({local_column:e.get("name")});t.model.get("columns").remove(n),setTimeout(function(){t.render()},10),setTimeout(function(){var e=t.model.top.get("foreign_key"),n=[];e.each(function(e){0==e.get("columns").length&&n.push(e)}),e.remove(n)},100)},resetColOptions:function(e){var t=this,n=t.model.get("columns").where({local_column:e.previous("name")});n.length>0&&n[0].set({local_column:e.get("name")}),setTimeout(function(){t.render()},10)},formatter:{fromRaw:function(e){var t=[],n=[];return e.length>0?(e.each(function(e){t.push(e.get("local_column")),n.push(e.get("referenced"))}),"("+t.join(", ")+") -> ("+n.join(", ")+")"):""},toRaw:function(e){return e}},render:function(){return d.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns");this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),d.StringCell.prototype.remove.apply(this,arguments)}}),canAdd:function(e){return e.isNew()},canDelete:!0,control:f,model:p,disabled:function(e){return i.has(e,"handler")&&!i.isUndefined(e.handler)?!i.isUndefined(e.get("oid")):!e.isNew()}},{id:"confupdtype",label:e("On update"),type:"select2",group:e("Action"),mode:["edit","create"],select2:{width:"50%",allowClear:!1},options:[{label:"NO ACTION",value:"a"},{label:"RESTRICT",value:"r"},{label:"CASCADE",value:"c"},{label:"SET NULL",value:"n"},{label:"SET DEFAULT",value:"d"}],disabled:function(e){return i.has(e,"handler")&&!i.isUndefined(e.handler)?!i.isUndefined(e.get("oid")):!e.isNew()}},{id:"confdeltype",label:e("On delete"),type:"select2",group:e("Action"),mode:["edit","create"],select2:{width:"50%",allowClear:!1},options:[{label:"NO ACTION",value:"a"},{label:"RESTRICT",value:"r"},{label:"CASCADE",value:"c"},{label:"SET NULL",value:"n"},{label:"SET DEFAULT",value:"d"}],disabled:function(e){return i.has(e,"handler")&&!i.isUndefined(e.handler)?!i.isUndefined(e.get("oid")):!e.isNew()}}],validate:function(){var t,n=this.get("columns");if(this.errorModel.clear(),i.isUndefined(n)||i.isNull(n)||n.length<1)return t=e("Please specify columns for Foreign key."),this.errorModel.set("columns",t),t;var o=this.get("coveringindex");return this.get("autoindex")&&(i.isUndefined(o)||i.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,""))?(t=e("Please specify covering index name."),this.errorModel.set("coveringindex",t),t):null}}),canCreate:function(e,t,n){if(n&&0==n.check)return!0;for(var o=r.tree,a=t,l=e,s=[],d=!1,c=!1,u=this.getTreeNodeHierarchy(a).server.version;a;){if(d||"table"!=l._type&&"partition"!=l._type||(d=!0,"is_partitioned"in l&&l.is_partitioned&&u<11e4&&(c=!0)),i.indexOf(["schema"],l._type)>-1)return!c;s.push(l._type),a=o.hasParent(a)?o.parent(a):null,l=a?o.itemData(a):null}return!(i.indexOf(s,"catalog")>-1)&&!c}})),r.Nodes.foreign_key}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(10),n(3),n(5),n(17),n(6),n(13),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d){var c=r.Node.Model.extend({defaults:{column:void 0,oper_class:void 0,order:!1,nulls_order:!1,operator:void 0,col_type:void 0,is_sort_nulls_applicable:!0},toJSON:function(){var e=r.Node.Model.prototype.toJSON.apply(this,arguments);return delete e.col_type,e},schema:[{id:"column",label:e("Column"),type:"text",editable:!1,cell:"string"},{id:"oper_class",label:e("Operator class"),type:"text",node:"table",url:"get_oper_class",first_empty:!0,editable:function(e){return e instanceof o.Collection||!(i.has(e.collection,"handler")&&!i.isUndefined(e.collection.handler)&&!i.isUndefined(e.collection.handler.get("oid")))&&!(i.has(e.collection,"handler")&&!i.isUndefined(e.collection.handler)&&!i.isUndefined(e.collection.handler.get("amname"))&&"btree"!=e.collection.handler.get("amname"))},select2:{allowClear:!0,width:"style",tags:!0,placeholder:e("Select the operator class")},cell:d.Extension.Select2Cell.extend({initialize:function(){d.Extension.Select2Cell.prototype.initialize.apply(this,arguments);var e=this,t=e.column.get("url")||e.defaults.url,o=e.model,a=e.model.collection.handler.get("amname");if(t&&("btree"==a||i.isUndefined(a)||i.isNull(a)||""==a)){setTimeout(function(){o.set("order",!0),o.set("nulls_order",!0)},10);var r=this.column.get("schema_node"),l=o.top||o,s=this.column.get("node_info"),c=r.generate_url.apply(r,[null,t,this.column.get("node_data"),this.column.get("url_with_id")||!1,s]),u=[];a="btree",this.column.get("version_compatible")&&(l.trigger("pgadmin:view:fetching",o,e.column),n.ajax({async:!1,data:{indextype:a},url:c}).done(function(t){u=t.data,e.column.set("options",u)}).fail(function(){l.trigger("pgadmin:view:fetch:error",o,e.column)}),l.trigger("pgadmin:view:fetched",o,e.column))}else e.column.set("options",[])}})},{id:"order",label:e("DESC"),type:"switch",options:{onText:"ASC",offText:"DESC"},editable:function(e){return e instanceof o.Collection||!(i.has(e.collection,"handler")&&!i.isUndefined(e.collection.handler)&&!i.isUndefined(e.collection.handler.get("oid")))&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1))}},{id:"nulls_order",label:e("NULLs order"),type:"switch",options:{onText:"FIRST",offText:"LAST"},editable:function(e){return e instanceof o.Collection||!(i.has(e.collection,"handler")&&!i.isUndefined(e.collection.handler)&&!i.isUndefined(e.collection.handler.get("oid")))&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1))}},{id:"operator",label:e("Operator"),type:"text",node:"table",url:"get_operator",editable:function(e){return e instanceof o.Collection||!(i.has(e.collection,"handler")&&!i.isUndefined(e.collection.handler)&&!i.isUndefined(e.collection.handler.get("oid")))},select2:{allowClear:!1,width:"style"},cell:d.Extension.Select2Cell.extend({initialize:function(){d.Extension.Select2Cell.prototype.initialize.apply(this,arguments);var e=this,t=e.column.get("url")||e.defaults.url,o=e.model,a=e.model.get("col_type");if(e.column.set("options",[]),t&&!i.isUndefined(a)&&!i.isNull(a)&&""!=a){var r=this.column.get("schema_node"),l=o.top||o,s=this.column.get("node_info"),c=r.generate_url.apply(r,[null,t,this.column.get("node_data"),this.column.get("url_with_id")||!1,s]),u=[];this.column.get("version_compatible")&&(l.trigger("pgadmin:view:fetching",o,e.column),n.ajax({async:!1,data:{col_type:a},url:c}).done(function(t){u=t.data,e.column.set("options",u)}).fail(function(){l.trigger("pgadmin:view:fetch:error",o,e.column)}),l.trigger("pgadmin:view:fetched",o,e.column))}}})}],validate:function(){this.errorModel.clear();var t=this.get("operator"),n=this.get("column");if(i.isUndefined(t)||i.isNull(t)){var o=e("Please specify operator for column: ")+n;return this.errorModel.set("operator",o),o}return null}}),u=s.ExclusionConstraintColumnControl=s.UniqueColCollectionControl.extend({initialize:function(){s.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var e=this,t=[{id:"column",label:"",type:"text",node:"column",control:s.NodeListByNameControl.extend({initialize:function(){if(e.model.handler){if(s.Select2Control.prototype.initialize.apply(this,arguments),i.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");this.listenTo(t,"remove",this.removeColumn),this.listenTo(t,"change:name",this.resetColOptions),this.listenTo(t,"change:cltype",this.resetColOptions)}this.custom_options()}else s.NodeListByNameControl.prototype.initialize.apply(this,arguments)},removeColumn:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},resetColOptions:function(t){var n=this;t.previous("name")==e.headerData.get("column")&&(e.headerData.set({column:t.get("name")}),e.headerDataChanged()),setTimeout(function(){n.custom_options(),n.render.apply(n)},50)},custom_options:function(){var t=e.model.top.get("columns"),n=[],o=[];t.length>0&&i.each(t.models,function(e){var t=e.get("name");i.isUndefined(t)||i.isNull(t)||(n.push({label:t,value:t,image:"icon-column"}),o.push({name:t,type:e.get("cltype")}))}),this.field.set("options",n),e.field.set("col_types",o)},remove:function(){if(e.model.handler){var t=e.model.top.get("columns");this.stopListening(t,"remove",this.removeColumn),this.stopListening(t,"change:name",this.resetColOptions),this.stopListening(t,"change:cltype",this.resetColOptions),s.Select2Control.prototype.remove.apply(this,arguments)}else s.NodeListByNameControl.prototype.remove.apply(this,arguments)},template:i.template(["<div class=\"<%=Backform.controlsClassName%> <%=extraClasses.join(' ')%>\">",'  <select class="pgadmin-node-select form-control" name="<%=name%>" style="width:100%;" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> >',"    <% for (var i=0; i < options.length; i++) { %>","    <% var option = options[i]; %>",'    <option <% if (option.image) { %> data-image=<%= option.image %> <% } %> value=<%= formatter.fromRaw(option.value) %> <%=option.value === rawValue ? "selected=\'selected\'" : "" %>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n"))}),transform:function(t){var n=this,o=n.field.get("schema_node"),a=[],r=[],l=n.field.get("filter")||function(){return!0};return l=l.bind(n),i.each(t,function(e){if(l(e)){var t=i.isFunction(o.node_label)?o.node_label.apply(o,[e,n.model,n]):e.label,s=i.isFunction(o.node_image)?o.node_image.apply(o,[e,n.model,n]):o.node_image||"icon-"+o.type;a.push({value:e.label,image:s,label:t}),r.push({name:e.label,type:e.datatype})}}),e.field.set("col_types",r),a},canAdd:function(e){return!(i.has(e,"handler")&&!i.isUndefined(e.handler)&&!i.isUndefined(e.get("oid"))||i.isFunction(e.isNew)&&!e.isNew())},select2:{allowClear:!1,width:"style",placeholder:"Select column"},first_empty:!e.model.isNew(),disabled:function(){return!i.isUndefined(e.model.get("oid"))}}],n={column:null},a=["column","oper_class","order","nulls_order","operator"];e.headerData=new(o.Model.extend({defaults:n,schema:t}))({});var r=s.generateViewSchema(e.field.get("node_info"),e.headerData,"create","exclusion_constraint",e.field.get("node_data")),l=[];i.each(r,function(e){l=l.concat(e.fields)}),e.headerFields=new s.Fields(l),e.gridSchema=s.generateGridColumnsFromModel(e.field.get("node_info"),e.field.get("model"),"edit",a,e.field.get("schema_node")),e.controls=[],e.listenTo(e.headerData,"change",e.headerDataChanged),e.listenTo(e.headerData,"select2",e.headerDataChanged),e.listenTo(e.collection,"add",e.onAddorRemoveColumns),e.listenTo(e.collection,"remove",e.onAddorRemoveColumns)},generateHeader:function(t){var o=['<div class="subnode-header-form">'," <div>",'  <div class="row">','   <div class="col-4">','    <label class="control-label"><%-column_label%></label>',"   </div>",'   <div class="col-4" header="column"></div>',"  </div>"," </div>","</div>"].join("\n");i.extend(t,{column_label:e("Column")});var a=this,r=i.template(o),l=n(r(t)),s=this.controls;return this.headerFields.each(function(e){var t=new(e.get("control"))({field:e,model:a.headerData});l.find('div[header="'+e.get("name")+'"]').append(t.render().$el),s.push(t)}),"properties"==t.mode&&l.html(""),a.$header=l,l},events:i.extend({},s.UniqueColCollectionControl.prototype.events,{"click button.add":"addColumns"}),showGridControl:function(e){var t=this,o=i.template(['<div class="subnode-header">','  <label class="control-label pg-el-sm-10"><%-label%></label>','  <button class="btn btn-sm-sq btn-secondary add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> title="'+i("Add new row")+'"></button>',"</div>"].join("\n")),a=n("<div class='pgadmin-control-group backgrid form-group col-12 object subnode'></div>").append("properties"!==e.mode?o({label:e.label,canAdd:e.canAdd}):"");a.append(t.generateHeader(e));var r=i.clone(this.gridSchema.columns);0==e.disabled&&e.canDelete&&r.unshift({name:"pg-backform-delete",label:"",cell:d.Extension.DeleteCell,editable:!1,cell_priority:-1}),t.grid&&(t.grid.remove(),t.grid.null);var l=t.grid=new d.Grid({columns:r,collection:t.collection,className:"backgrid table-bordered table-noouter-border table-hover"});return t.$grid=l.render().$el,a.append(t.$grid),setTimeout(function(){t.headerData.set({column:t.$header.find('div[header="column"] select').val()},{silent:!0})},10),"properties"===e.mode&&a.find(".subnode-header-form").removeClass("subnode-header-form"),t.$gridBody=a,a},headerDataChanged:function(){var e,t=this,n=this.headerData.toJSON(),o=!1,a=["column"];t.$header&&(t.control_data.canAdd?t.collection.each(function(t){o||i.each(a,function(a){o||(e=t.get(a),o=(i.isUndefined(e)||i.isNull(e))&&(i.isUndefined(n[a])||i.isNull(n[a]))||e==n[a])})}):o=!0,t.$gridBody.find("button.add").prop("disabled",o))},addColumns:function(e){e.preventDefault();var t=this,i=t.headerData.get("column");if(!i||""==i)return!1;for(var o=t.model.get(t.field.get("name")),a=new(t.field.get("model"))(t.headerData.toJSON(),{silent:!0,top:t.model.top,collection:o,handler:o}),r=t.field.get("col_types")||[],l=0;l<r.length;l++){var s=r[l];if(s.name==a.get("column")){a.set({col_type:s.type});break}}o.add(a);var d=o.indexOf(a);if(d>-1){t.$grid.find(".new").removeClass("new");var c=t.grid.body.rows[d].$el;c.addClass("new"),n(c).pgMakeVisible("backform-tab")}return!1},onAddorRemoveColumns:function(){var e=this;setTimeout(function(){e.collection.trigger("pgadmin:columns:updated",e.collection),e.headerDataChanged()},10)},remove:function(){this.stopListening(this.headerData,"change",this.headerDataChanged),this.listenTo(this.headerData,"select2",this.headerDataChanged),this.listenTo(this.collection,"remove",this.onAddorRemoveColumns),i.each(this.controls,function(e){e.remove()}),u.__super__.remove.apply(this,arguments),delete this.headerData}});return r.Nodes.exclusion_constraint||(a.Browser.Nodes.exclusion_constraint=r.Node.extend({type:"exclusion_constraint",label:e("Exclusion constraint"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"exclusion_constraint_dialog.html"}),hasSQL:!0,parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[e("Index size")],Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_exclusion_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Exclusion constraint..."),icon:"wcTabIcon icon-exclusion_constraint",data:{action:"create",check:!0},enable:"canCreate"}]))},is_not_valid:function(e){return e&&!e.valid},model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,spcname:void 0,amname:"gist",fillfactor:void 0,condeferrable:void 0,condeferred:void 0,columns:[],include:[]},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],editable:!0},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"spcname",label:e("Tablespace"),type:"text",group:e("Definition"),control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label}},{id:"amname",label:e("Access method"),type:"text",group:e("Definition"),url:"get_access_methods",node:"table",control:s.NodeAjaxOptionsControl.extend({onChange:function(){s.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this,n=t.model.get("amname"),i=t.model.previous("amname"),o=t.model.get("columns");if(o.length>0&&n!=i){var a=e("Changing access method will clear columns collection");l.confirm(a,function(){o.each(function(e){o.remove(e)}),setTimeout(function(){o.trigger("pgadmin:columns:updated",o)},10)},function(){setTimeout(function(){t.model.set("amname",i)},10)})}}}),select2:{allowClear:!0},disabled:function(e){return i.has(e,"handler")&&!i.isUndefined(e.handler)&&!i.isUndefined(e.get("oid"))||i.isFunction(e.isNew)&&!e.isNew()}},{id:"fillfactor",label:e("Fill factor"),type:"int",group:e("Definition"),allowNull:!0},{id:"condeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),deps:["index"],disabled:function(e){return i.has(e,"handler")&&!i.isUndefined(e.handler)&&!i.isUndefined(e.get("oid"))||i.isFunction(e.isNew)&&!e.isNew()}},{id:"condeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),deps:["condeferrable"],disabled:function(e){return!!(i.has(e,"handler")&&!i.isUndefined(e.handler)&&!i.isUndefined(e.get("oid"))||i.isFunction(e.isNew)&&!e.isNew())||1!=e.get("condeferrable")&&(setTimeout(function(){e.get("condeferred")&&e.set("condeferred",!1)},10),!0)}},{id:"indconstraint",label:e("Constraint"),cell:"string",type:"multiline",mode:["create","edit","properties"],editable:!1,group:e("Definition"),disabled:function(e){return i.has(e,"handler")&&!i.isUndefined(e.handler)&&!i.isUndefined(e.get("oid"))||i.isFunction(e.isNew)&&!e.isNew()}},{id:"columns",label:e("Columns"),type:"collection",group:e("Columns"),deps:["amname"],canDelete:!0,editable:!1,canAdd:function(e){return!(i.has(e,"handler")&&!i.isUndefined(e.handler)&&!i.isUndefined(e.get("oid"))||i.isFunction(e.isNew)&&!e.isNew())},control:u,model:c,disabled:function(e){return i.has(e,"handler")&&!i.isUndefined(e.handler)&&!i.isUndefined(e.get("oid"))||i.isFunction(e.isNew)&&!e.isNew()},cell:d.StringCell.extend({initialize:function(){d.StringCell.prototype.initialize.apply(this,arguments);var e=this;if(i.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.removeColumn),e.listenTo(t,"change:name",e.resetColOptions),e.listenTo(t,"change:cltype",e.removeColumnWithType)}this.model.get("columns").on("pgadmin:columns:updated",function(){e.render.apply(e)})},removeColumnWithType:function(e){var t=this,n=t.model.get("columns"),i=n.where({col_type:e.previous("cltype")});n.remove(i),setTimeout(function(){t.render()},10),setTimeout(function(){var e=t.model.top.get("exclude_constraint"),n=[];e.each(function(e){0==e.get("columns").length&&n.push(e)}),e.remove(n)},100)},removeColumn:function(e){var t=this,n=t.model.get("columns").where({column:e.get("name")});t.model.get("columns").remove(n),setTimeout(function(){t.render()},10),setTimeout(function(){var e=t.model.top.get("exclude_constraint"),n=[];e.each(function(e){0==e.get("columns").length&&n.push(e)}),e.remove(n)},100)},resetColOptions:function(e){var t=this,n=t.model.get("columns").where({column:e.previous("name")});n.length>0&&n[0].set({column:e.get("name")}),setTimeout(function(){t.render()},10)},formatter:{fromRaw:function(e){return e.pluck("column").toString()},toRaw:function(e){return e}},render:function(){return d.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns"),t=this.model.get("columns");t&&t.off("pgadmin:columns:updated"),this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),this.stopListening(e,"change:cltype",self.removeColumnWithType),d.StringCell.prototype.remove.apply(this,arguments)}})},{id:"include",label:e("Include columns"),type:"array",group:e("Columns"),editable:!1,canDelete:!0,canAdd:!0,mode:["properties","create","edit"],visible:function(e){return e=e.top,!i.isUndefined(e.node_info)&&!i.isUndefined(e.node_info.server)&&!i.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=11e4},control:s.MultiSelectAjaxControl.extend({defaults:i.extend({},s.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:e("Select the column(s)")}}),initialize:function(){var e=this;if(this.model.handler){if(s.Select2Control.prototype.initialize.apply(this,arguments),i.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else s.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments)},resetColOptions:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},custom_options:function(){var e=this.model.top.get("columns"),t=[];e.length>0&&i.each(e.models,function(e){var n=e.get("name");i.isUndefined(n)||i.isNull(n)||t.push({label:n,value:n,image:"icon-column"})}),this.field.set("options",t)}}),deps:["index"],node:"column",disabled:function(e){if(i.has(e,"top")&&!i.isUndefined(e.top)&&!e.top.isNew())return!i.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!i.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}}],validate:function(){this.errorModel.clear();var t,n=this.get("columns"),o=this.get("name");return i.isUndefined(o)||i.isNull(o)||o.length<1?(t=e("Please specify name for exclusion constraint."),this.errorModel.set("name",t),t):i.isUndefined(n)||i.isNull(n)||n.length<1?(t=e("Please specify columns for exclusion constraint."),this.errorModel.set("columns",t),t):null}}),canCreate:function(e,t,n){if(n&&0==n.check)return!0;for(var o=r.tree,a=t,l=e,s=[],d=!1,c=!1;a;){if(d||"table"!=l._type&&"partition"!=l._type||(d=!0,"is_partitioned"in l&&l.is_partitioned&&(c=!0)),i.indexOf(["schema"],l._type)>-1)return!c;s.push(l._type),a=o.hasParent(a)?o.parent(a):null,l=a?o.itemData(a):null}return!(i.indexOf(s,"catalog")>-1)&&!c}})),r.Nodes.exclusion_constraint}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(3),n(5),n(6),n(13),n(7)],void 0!==(o=function(e,t,n,i,o,a,r,l){return a.Nodes.primary_key||(o.Browser.Nodes.primary_key=a.Node.extend({type:"primary_key",label:e("Primary key"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"primary_key_dialog.html"}),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[e("Index size")],parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_primary_key_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Primary key"),icon:"wcTabIcon icon-primary_key",data:{action:"create",check:!0},enable:"canCreate"}]))},canCreate:function(e,t,o){if(o&&0==o.check)return!0;for(var r=a.tree,l=t,s=e,d=[],c=!1,u=!1,p=this.getTreeNodeHierarchy(l).server.version;l;){if(c||"table"!=s._type&&"partition"!=s._type||(c=!0,"is_partitioned"in s&&s.is_partitioned&&p<11e4&&(u=!0)),i.indexOf(["schema"],s._type)>-1){if(u)return!1;var f=r.children(arguments[1],!1),m=!1;return i.each(f,function(e){o=a.tree.itemData(n(e)),m||"primary_key"!=o._type||(m=!0)}),!m}d.push(s._type),l=r.hasParent(l)?r.parent(l):null,s=l?r.itemData(l):null}return!(i.indexOf(d,"catalog")>-1)&&!u},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,spcname:void 0,index:void 0,fillfactor:void 0,condeferrable:void 0,condeferred:void 0,columns:[],include:[]},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],editable:!0,cellHeaderClasses:"width_percent_40"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"],editable:!1,cellHeaderClasses:"width_percent_20"},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"columns",label:e("Columns"),type:"collection",group:e("Definition"),editable:!1,cell:l.StringCell.extend({initialize:function(){l.StringCell.prototype.initialize.apply(this,arguments);var e=this,t=this.model.get("columns");if(i.isUndefined(e.model.get("oid"))){var n=e.model.top.get("columns");e.listenTo(n,"remove",e.removeColumn),e.listenTo(n,"change:name",e.resetColOptions)}t.on("pgadmin:multicolumn:updated",function(){e.render.apply(e)}),e.listenTo(t,"add",e.render),e.listenTo(t,"remove",e.render)},removeColumn:function(e){var t=this,n=t.model.get("columns").where({column:e.get("name")});t.model.get("columns").remove(n),setTimeout(function(){t.render()},10);setTimeout(function(){var e=t.model.top.get("primary_key"),n=[];e.each(function(e){0==e.get("columns").length&&n.push(e)}),e.remove(n)},100)},resetColOptions:function(e){var t=this,n=t.model.get("columns").where({column:e.previous("name")});n.length>0&&n[0].set({column:e.get("name")},{silent:!0}),setTimeout(function(){t.render()},10)},formatter:{fromRaw:function(e){return e.pluck("column").toString()},toRaw:function(e){return e}},render:function(){return l.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns"),t=this.model.get("columns");t&&t.off("pgadmin:multicolumn:updated"),this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),l.StringCell.prototype.remove.apply(this,arguments)}}),canDelete:!0,canAdd:!0,control:r.MultiSelectAjaxControl.extend({defaults:i.extend({},r.NodeListByNameControl.prototype.defaults,{select2:{multiple:!0,allowClear:!0,width:"style",placeholder:e("Select the column(s)")}}),keyPathAccessor:function(e,t){var n=e;if(i.isArray(n))return i.map(n,function(e){return e.column});t=t.split(".");for(var o=0;o<t.length;o++){if(i.isNull(n))return null;i.isEmpty(t[o])||(i.isUndefined(n[t[o]])||(n=n[t[o]]))}return i.isObject(n)&&!i.isArray(n)?null:n},initialize:function(){var e=this;if(this.model.handler){if(r.Select2Control.prototype.initialize.apply(this,arguments),i.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else r.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments);e.model.get("columns").on("pgadmin:multicolumn:updated",function(){e.render.apply(e)})},resetColOptions:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},custom_options:function(){var e=this.model.top.get("columns"),t=[];e.length>0&&i.each(e.models,function(e){var n=e.get("name");i.isUndefined(n)||i.isNull(n)||t.push({label:n,value:n,image:"icon-column"})}),this.field.set("options",t)},onChange:function(){var e=this,t=this.model,n=this.field.get("name").split("."),o=n.shift(),a=this.getValueFromDOM(),r=t.get(o),l=[];this.stopListening(this.model,"change:"+o,this.render),r.each(function(e){var t=e.get("column"),n=i.indexOf(a,t);n>-1?a.splice(n,1):l.push(t)}),i.each(a,function(t){var n=new(e.field.get("model"))({column:t},{silent:!0,top:e.model.top,collection:r,handler:r});r.add(n)}),i.each(l,function(e){r.remove(r.where({column:e}))}),this.listenTo(this.model,"change:"+o,this.render)},remove:function(){if(this.model.handler){var e=this,t=e.model.top.get("columns");e.stopListening(t,"remove",e.resetColOptions),e.stopListening(t,"change:name",e.resetColOptions),e.model.get("columns").off("pgadmin:multicolumn:updated"),r.Select2Control.prototype.remove.apply(this,arguments)}else r.MultiSelectAjaxControl.prototype.remove.apply(this,arguments)}}),deps:["index"],node:"column",model:a.Node.Model.extend({defaults:{column:void 0},validate:function(){return null}}),transform:function(e){var t=[];return e&&i.isArray(e)&&i.each(e,function(e){t.push({label:e.label,value:e.label,image:"icon-column"})}),t},select2:{allowClear:!1},disabled:function(e){if(i.has(e,"top")&&!i.isUndefined(e.top)&&!e.top.isNew())return!i.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!i.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}},{id:"include",label:e("Include columns"),type:"array",group:e("Definition"),editable:!1,canDelete:!0,canAdd:!0,mode:["properties","create","edit"],visible:function(e){return e=e.top,!i.isUndefined(e.node_info)&&!i.isUndefined(e.node_info.server)&&!i.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=11e4},control:r.MultiSelectAjaxControl.extend({defaults:i.extend({},r.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:e("Select the column(s)")}}),initialize:function(){var e=this;if(this.model.handler){if(r.Select2Control.prototype.initialize.apply(this,arguments),i.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else r.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments)},resetColOptions:function(){var e=this;setTimeout(function(){e.custom_options(),e.render.apply(e)},50)},custom_options:function(){var e=this.model.top.get("columns"),t=[];e.length>0&&i.each(e.models,function(e){var n=e.get("name");i.isUndefined(n)||i.isNull(n)||t.push({label:n,value:n,image:"icon-column"})}),this.field.set("options",t)}}),deps:["index"],node:"column",disabled:function(e){if(i.has(e,"top")&&!i.isUndefined(e.top)&&!e.top.isNew())return!i.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!i.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}},{id:"spcname",label:e("Tablespace"),type:"text",group:e("Definition"),control:"node-list-by-name",node:"tablespace",deps:["index"],select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label},disabled:function(e){e=e.top||e;var t=e.get("index");return!i.isUndefined(t)&&""!=t&&(setTimeout(function(){e.set("spcname","")},10),!0)}},{id:"index",label:e("Index"),type:"text",group:e("Definition"),control:r.NodeListByNameControl.extend({initialize:function(){i.isUndefined(this.model.top)?r.NodeListByNameControl.prototype.initialize.apply(this,arguments):r.Control.prototype.initialize.apply(this,arguments)}}),select2:{allowClear:!0},node:"index",disabled:function(e){return!(!i.has(e,"top")||i.isUndefined(e.top)||e.top.isNew())||!e.isNew()},visible:function(e){return!i.isUndefined(e.top.node_info.table)}},{id:"fillfactor",label:e("Fill factor"),deps:["index"],type:"int",group:e("Definition"),allowNull:!0,disabled:function(e){var t=e.get("index");return!i.isUndefined(t)&&""!=t&&(setTimeout(function(){e.set("fillfactor",null)},10),!0)}},{id:"condeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),deps:["index"],disabled:function(e){if(i.has(e,"top")&&!i.isUndefined(e.top)&&!e.top.isNew())return!i.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!i.isUndefined(t)&&""!=t&&(setTimeout(function(){e.get("condeferrable")&&e.set("condeferrable",!1)},10),!0)}},{id:"condeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),deps:["condeferrable"],disabled:function(e){return!i.has(e,"top")||i.isUndefined(e.top)||e.top.isNew()?!e.isNew()||1!=e.get("condeferrable")&&(setTimeout(function(){e.get("condeferred")&&e.set("condeferred",!1)},10),!0):!i.isUndefined(e.get("oid"))}}],validate:function(){this.errorModel.clear(),i.has(this,"top")&&this.top.errorModel.clear();var t=this.get("columns"),n=this.get("index");if((i.isUndefined(n)||""==String(n).replace(/^\s+|\s+$/g,""))&&(i.isUndefined(t)||i.isNull(t)||t.length<1)){var o=e("Please specify columns for %(node)s",{node:e("Primary key")});return this.errorModel.set("columns",o),o}return null}})})),a.Nodes.primary_key}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(2),n(4),n(0),n(1),n(8),n(3),n(5),n(11),n(6),n(13),n(12),n(7),n(86)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d,c){return r.Nodes["coll-partition"]||(a.Browser.Nodes["coll-partition"]=a.Browser.Collection.extend({node:"partition",label:e("Partitions"),type:"coll-partition",columns:["name","schema","partition_value","is_partitioned","description"],canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema})),r.Nodes.partition||(a.Browser.Nodes.partition=r.Node.extend({parent_type:"table",collection_type:"coll-partition",type:"partition",label:e("Partition"),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[e("Size"),e("Indexes size"),e("Table size"),e("Toast table size"),e("Tuple length"),e("Dead tuple length"),e("Free space")],sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-createtable.html",dialogHelp:t("help.static",{filename:"table_dialog.html"}),hasScriptTypes:["create"],height:"95%",width:"85%",Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"truncate_table",node:"partition",module:this,applies:["object","context"],callback:"truncate_table",category:"Truncate",priority:3,label:e("Truncate"),icon:"fa fa-eraser",enable:"canCreate"},{name:"truncate_table_cascade",node:"partition",module:this,applies:["object","context"],callback:"truncate_table_cascade",category:"Truncate",priority:3,label:e("Truncate Cascade"),icon:"fa fa-eraser",enable:"canCreate"},{name:"enable_all_triggers",node:"partition",module:this,applies:["object","context"],callback:"enable_triggers_on_table",category:"Trigger(s)",priority:4,label:e("Enable All"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_all_triggers",node:"partition",module:this,applies:["object","context"],callback:"disable_triggers_on_table",category:"Trigger(s)",priority:4,label:e("Disable All"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"reset_table_stats",node:"partition",module:this,applies:["object","context"],callback:"reset_table_stats",category:"Reset",priority:4,label:e("Reset Statistics"),icon:"fa fa-bar-chart",enable:"canCreate"},{name:"detach_partition",node:"partition",module:this,applies:["object","context"],callback:"detach_partition",priority:2,label:e("Detach Partition"),icon:"fa fa-remove"}]))},generate_url:function(e,t,n,a,l){return-1==i.indexOf(["stats","statistics","dependency","dependent","reset","get_relations","get_oftype","get_attach_tables"],t)?r.Node.generate_url.apply(this,arguments):("statistics"==t&&(t="stats"),l=i.isUndefined(e)||i.isNull(e)?l||{}:this.getTreeNodeHierarchy(e),o("table/%s/%s/%s/%s/%s/%s").sprintf(encodeURIComponent(t),encodeURIComponent(l.server_group._id),encodeURIComponent(l.server._id),encodeURIComponent(l.database._id),encodeURIComponent(l.partition.schema_id),encodeURIComponent(l.partition._id)).value())},canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema,callbacks:{enable_triggers_on_table:function(e){var t={enable:!0};this.callbacks.set_triggers.apply(this,[e,t])},disable_triggers_on_table:function(e){var t={enable:!1};this.callbacks.set_triggers.apply(this,[e,t])},set_triggers:function(e,t){var i=e||{},o=this,a=r.tree,s=i.item||a.selected(),d=s&&1==s.length?a.itemData(s):void 0;if(!d)return!1;n.ajax({url:o.generate_url(s,"set_trigger",d,!0),type:"PUT",data:t,dataType:"json"}).done(function(e){1==e.success&&(l.success(e.info),a.unload(s),a.setInode(s),a.deselect(s),setTimeout(function(){a.select(s)},10))}).fail(function(e,t,n){l.pgRespErrorNotify(e,n),a.unload(s)})},truncate_table:function(e){var t={cascade:!1};this.callbacks.truncate.apply(this,[e,t])},truncate_table_cascade:function(e){var t={cascade:!0};this.callbacks.truncate.apply(this,[e,t])},truncate:function(t,i){var a=t||{},s=this,d=r.tree,c=a.item||d.selected(),u=c&&1==c.length?d.itemData(c):void 0;if(!u)return!1;l.confirm(e("Truncate Table"),o(e("Are you sure you want to truncate table %s?")).sprintf(u.label).value(),function(e){if(e){var t=u;n.ajax({url:s.generate_url(c,"truncate",u,!0),type:"PUT",data:i,dataType:"json"}).done(function(e){1==e.success&&(l.success(e.info),d.removeIcon(c),t.icon="icon-partition",d.addIcon(c,{icon:t.icon}),d.unload(c),d.setInode(c),d.deselect(c),setTimeout(function(){d.select(c)},10))}).fail(function(e,t,n){l.pgRespErrorNotify(e,n),d.unload(c)})}},function(){})},reset_table_stats:function(t){var i=t||{},a=this,s=r.tree,d=i.item||s.selected(),c=d&&1==d.length?s.itemData(d):void 0;if(!c)return!1;l.confirm(e("Reset statistics"),o(e('Are you sure you want to reset the statistics for table "%s"?')).sprintf(c._label).value(),function(e){if(e){var t=c;n.ajax({url:a.generate_url(d,"reset",c,!0),type:"DELETE"}).done(function(e){1==e.success&&(l.success(e.info),s.removeIcon(d),t.icon="icon-partition",s.addIcon(d,{icon:t.icon}),s.unload(d),s.setInode(d),s.deselect(d),setTimeout(function(){s.select(d)},10))}).fail(function(e,t,n){l.pgRespErrorNotify(e,n),s.unload(d)})}},function(){})},detach_partition:function(t){var i=t||{},a=this,s=r.tree,d=i.item||s.selected(),c=d&&1==d.length?s.itemData(d):void 0;if(!c)return!1;l.confirm(e("Detach Partition"),o(e("Are you sure you want to detach the partition %s?")).sprintf(c._label).value(),function(e){e&&n.ajax({url:a.generate_url(d,"detach",c,!0),type:"PUT"}).done(function(e){if(1==e.success){l.success(e.info);var t=s.next(d);t&&t.length||(t=s.prev(d))&&t.length||(t=s.parent(d),s.setInode(t,!0)),s.remove(d),t.length&&s.select(t)}}).fail(function(e,t,n){l.pgRespErrorNotify(e,n)})},function(){})}},model:r.Node.Model.extend({defaults:{name:void 0,oid:void 0,spcoid:void 0,spcname:void 0,relowner:void 0,relacl:void 0,relhasoids:void 0,relhassubclass:void 0,reltuples:void 0,description:void 0,conname:void 0,conkey:void 0,isrepl:void 0,triggercount:void 0,relpersistence:void 0,fillfactor:void 0,reloftype:void 0,typname:void 0,labels:void 0,providers:void 0,is_sys_table:void 0,coll_inherits:[],hastoasttable:!0,toast_autovacuum_enabled:!1,autovacuum_enabled:!1,primary_key:[],partitions:[],partition_type:"range",is_partitioned:!1,partition_value:void 0},initialize:function(e,t){if(0===i.size(e)){var n=r.serverInfo[t.node_info.server._id].user,o=t.node_info.schema;this.set({relowner:n.name,schema:o._label},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:e("OID"),type:"text",mode:["properties"]},{id:"relowner",label:e("Owner"),type:"text",node:"role",mode:["properties","create","edit"],select2:{allowClear:!1},disabled:"inSchema",control:"node-list-by-name"},{id:"schema",label:e("Schema"),type:"text",node:"schema",control:"node-list-by-name",mode:["create","edit","properties"],disabled:"inSchema",filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"spcname",label:e("Tablespace"),node:"tablespace",type:"text",control:"node-list-by-name",disabled:"inSchema",mode:["properties","create","edit"],filter:function(e){return!(e&&e.label.match(/pg_global/))}},{id:"partition",type:"group",label:e("Partition"),mode:["edit","create"],min_version:1e5,visible:function(e){return!(!e.isNew()&&!e.get("is_partitioned"))}},{id:"is_partitioned",label:e("Partitioned Table?"),cell:"switch",type:"switch",mode:["properties","create","edit"],visible:function(e){return!i.isUndefined(e.node_info)&&!i.isUndefined(e.node_info.server)&&!i.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){return!e.isNew()}},{id:"description",label:e("Comment"),type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"partition_value",label:e("Partition Scheme"),type:"text",visible:!1},{id:"coll_inherits",label:e("Inherited from table(s)"),type:"text",group:e("Advanced"),mode:["properties"]},{id:"Columns",type:"group",label:e("Columns"),mode:["edit","create"],min_version:1e5,visible:function(){return!1}},{id:"columns",label:e("Columns"),type:"collection",group:e("Columns"),model:r.Nodes.column.model,subnode:r.Nodes.column.model,mode:["create","edit"],disabled:function(e){return e.isNew()&&e.get("is_partitioned")&&setTimeout(function(){var t=e.get("columns");t.remove(t.filter(function(e){return!i.isUndefined(e.get("inheritedfrom"))}))},10),!!(this.node_info&&"catalog"in this.node_info)},deps:["typname","is_partitioned"],canAdd:"check_grid_add_condition",canEdit:!0,canDelete:!0,canEditRow:"check_grid_row_edit_delete",canDeleteRow:"check_grid_row_edit_delete",uniqueCol:["name"],columns:["name","cltype","attlen","attprecision","attnotnull","is_primary_key"],control:s.UniqueColCollectionControl.extend({initialize:function(){s.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var e=this;e.model.get(e.field.get("name")).on("change:is_primary_key",function(t){var n,o,a=e.model.get("primary_key"),r=t.get("name");if(t.get("is_primary_key")){if(a.length<1?(n=new a.model({},{top:e.model,collection:a,handler:a}),a.add(n)):n=a.first(),i.isUndefined(n.get("oid"))){o=n.get("columns");var l=o.where({column:r});if(0==l.length){var s=new o.model({column:r},{silent:!0,top:e.model,collection:a,handler:a});o.add(s)}o.trigger("pgadmin:multicolumn:updated",o)}}else if(a.length>0){if(n=a.first(),!i.isUndefined(n.get("oid")))return;o=n.get("columns");var d=o.where({column:r});d.length>0&&(o.remove(d),i.each(d,function(e){e.destroy()}),0==o.length&&setTimeout(function(){a.remove(a.first())},10)),o.trigger("pgadmin:multicolumn:updated",o)}})},remove:function(){var e=this.model.get(this.field.get("name"));e&&e.off("change:is_primary_key"),s.UniqueColCollectionControl.prototype.remove.apply(this,arguments)}}),allowMultipleEmptyRow:!1},{id:"inherited_tables_cnt",label:e("Inherited tables count"),type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{type:"nested",control:"tab",group:e("Constraints"),mode:["edit","create"],schema:[{id:"primary_key",label:e("Primary key"),model:r.Nodes.primary_key.model,subnode:r.Nodes.primary_key.model,editable:!1,type:"collection",group:e("Primary Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(e){return!e.get("is_partitioned")||(setTimeout(function(){var t=e.get("primary_key");t.remove(t.filter(function(){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return e.get("primary_key")&&e.get("primary_key").length<1&&i.some(t.pluck("name"))}},{id:"foreign_key",label:e("Foreign key"),model:r.Nodes.foreign_key.model,subnode:r.Nodes.foreign_key.model,editable:!1,type:"collection",group:e("Foreign Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:function(e){return!e.get("is_partitioned")||(setTimeout(function(){var t=e.get("foreign_key");t.remove(t.filter(function(){return!0}))},10),!1)},columns:["name","columns"],canAddRow:function(e){var t=e.get("columns");return i.some(t.pluck("name"))}},{id:"check_constraint",label:e("Check constraint"),model:r.Nodes.check_constraint.model,subnode:r.Nodes.check_constraint.model,editable:!1,type:"collection",group:e("Check"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:!0,columns:["name","consrc"]},{id:"unique_constraint",label:e("Unique Constraint"),model:r.Nodes.unique_constraint.model,subnode:r.Nodes.unique_constraint.model,editable:!1,type:"collection",group:e("Unique"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(e){return!e.get("is_partitioned")||(setTimeout(function(){var t=e.get("unique_constraint");t.remove(t.filter(function(){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return i.some(t.pluck("name"))}},{id:"exclude_constraint",label:e("Exclude constraint"),model:r.Nodes.exclusion_constraint.model,subnode:r.Nodes.exclusion_constraint.model,editable:!1,type:"collection",group:e("Exclude"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns","constraint"],canAdd:function(e){return!e.get("is_partitioned")||(setTimeout(function(){var t=e.get("exclude_constraint");t.remove(t.filter(function(){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return i.some(t.pluck("name"))}}]},{id:"typname",label:e("Of type"),type:"text",mode:["properties","create","edit"],group:e("Advanced"),disabled:"checkOfType",url:"get_oftype",deps:["coll_inherits","is_partitioned"],transform:function(e,t){return(t||this).model.of_types_tables=e,e},control:s.NodeAjaxOptionsControl.extend({onChange:function(){s.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this,n=t.model.get("typname"),o=void 0,a=void 0,r=t.model.get("columns");if(i.isUndefined(n)||""===n||0===r.length)i.isUndefined(n)||""!==n||r.reset();else{var d=e("Changing of table type will clear columns collection.");l.confirm(d,function(e){if(!e)return this;r.reset()})}i.isUndefined(n)||""===n||(a={tname:n},o=t.model.fetch_columns_ajax.apply(t,[a]),r.set(o,{merge:!1,remove:!1}))}})},{id:"fillfactor",label:e("Fill factor"),type:"int",mode:["create","edit"],min:10,max:100,disabled:"inSchema",group:e("Advanced")},{id:"relhasoids",label:e("Has OIDs?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchema",group:e("Advanced")},{id:"relpersistence",label:e("Unlogged?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:e("Advanced")},{id:"conname",label:e("Primary key"),cell:"string",type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"reltuples",label:e("Rows (estimated)"),cell:"string",type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"rows_cnt",label:e("Rows (counted)"),cell:"string",type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"relhassubclass",label:e("Inherits tables?"),cell:"switch",type:"switch",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"is_sys_table",label:e("System table?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{type:"nested",control:"fieldset",label:e("Like"),group:e("Advanced"),schema:[{id:"like_relation",label:e("Relation"),type:"text",mode:["create","edit"],deps:["typname"],control:"node-ajax-options",url:"get_relations",disabled:"isLikeDisable",group:e("Like")},{id:"like_default_value",label:e("With default values?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_constraints",label:e("With constraints?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_indexes",label:e("With indexes?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_storage",label:e("With storage?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_comments",label:e("With comments?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")}]},{id:"partition_type",label:e("Partition Type"),editable:!1,type:"select2",select2:{allowClear:!1},group:"partition",deps:["is_partitioned"],options:[{label:e("Range"),value:"range"},{label:e("List"),value:"list"}],mode:["create"],visible:function(e){return!i.isUndefined(e.node_info)&&!i.isUndefined(e.node_info.server)&&!i.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){return!e.isNew()||!e.get("is_partitioned")}},{id:"partition_keys",label:e("Partition Keys"),model:s.PartitionKeyModel,subnode:s.PartitionKeyModel,editable:!0,type:"collection",group:"partition",mode:["create"],deps:["is_partitioned","partition_type"],canEdit:!1,canDelete:!0,control:"sub-node-collection",canAdd:function(e){return!(!e.isNew()||!e.get("is_partitioned"))},canAddRow:function(e){var t=e.get("columns"),n=1e3;return e.get("partition_type")&&"list"==e.get("partition_type")&&(n=1),e.get("partition_keys")&&e.get("partition_keys").length<n&&i.some(t.pluck("name"))},visible:function(e){return!i.isUndefined(e.node_info)&&!i.isUndefined(e.node_info.server)&&!i.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.get("partition_keys")&&e.get("partition_keys").models.length>0&&setTimeout(function(){var t=e.get("partition_keys");t.remove(t.filter(function(){return!0}))},10)}},{id:"partition_scheme",label:e("Partition Scheme"),type:"note",group:"partition",mode:["edit"],visible:function(e){return!i.isUndefined(e.node_info)&&!i.isUndefined(e.node_info.server)&&!i.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.isNew()||(this.text=e.get("partition_scheme"))}},{id:"partitions",label:e("Partitions"),model:s.PartitionsModel,subnode:s.PartitionsModel,editable:!0,type:"collection",group:"partition",mode:["edit","create"],deps:["is_partitioned","partition_type"],canEdit:!1,canDelete:!0,customDeleteTitle:e("Detach Partition"),customDeleteMsg:e("Are you sure you wish to detach this partition?"),columns:["is_attach","partition_name","values_from","values_to","values_in"],control:s.SubNodeCollectionControl.extend({row:d.PartitionRow,initialize:function(){s.SubNodeCollectionControl.prototype.initialize.apply(this,arguments);var t=this;if(!this.model.isNew()){var i=this.field.get("schema_node"),o=this.field.get("node_info");n.ajax({url:i.generate_url.apply(i,[null,"get_attach_tables",this.field.get("node_data"),!0,o]),type:"GET",async:!1}).done(function(n){1==n.success?t.model.table_options=n.data:l.alert(e("Error fetching tables to be attached"),n.data.result)}).fail(function(t,n,i){l.pgRespErrorNotify(t,i,e("Error fetching tables to be attached"))})}}}),canAdd:function(e){return!!e.get("is_partitioned")},visible:function(e){return!i.isUndefined(e.node_info)&&!i.isUndefined(e.node_info.server)&&!i.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.isNew()&&e.get("partitions")&&e.get("partitions").models.length>0&&setTimeout(function(){var t=e.get("partitions");t.remove(t.filter(function(){return!0}))},10)}},{id:"partition_note",label:e("Partition"),type:"note",group:"partition",text:e("The control above is used to Create/Attach/Detach partitions.<br><ul><li>Create Mode: User will be able to create N number of partitions. Mode switch control is disabled in this scenario.</li><li>Edit Mode: User will be able to create/attach/detach N number of partitions. In attach mode there will be list of suitable tables to be attached.</li></ul>"),visible:function(e){return!i.isUndefined(e.node_info)&&!i.isUndefined(e.node_info.server)&&!i.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5}},{type:"nested",control:"tab",group:e("Parameter"),mode:["edit","create"],deps:["is_partitioned"],schema:s.VacuumSettingsSchema},{id:"relacl_str",label:e("Privileges"),disabled:"inSchema",type:"text",mode:["properties"],group:e("Security")},r.SecurityGroupSchema,{id:"relacl",label:e("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:r.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:e("Security labels"),canEdit:!1,model:r.SecLabelModel,editable:!1,canAdd:!0,type:"collection",min_version:90100,mode:["edit","create"],group:"security",canDelete:!0,control:"unique-col-collection"},{id:"vacuum_settings_str",label:e("Storage settings"),type:"multiline",group:e("Advanced"),mode:["properties"]}],validate:function(t){var n,o=this.get("name"),a=this.get("schema"),r=this.get("relowner"),l=this.get("is_partitioned"),s=this.get("partition_keys");return!t||0!=t.length&&-1==i.indexOf(t,"autovacuum_enabled")&&-1==i.indexOf(t,"toast_autovacuum_enabled")?(this.errorModel.clear(),i.isUndefined(o)||i.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(n=e("Table name cannot be empty."),this.errorModel.set("name",n),n):i.isUndefined(a)||i.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(n=e("Table schema cannot be empty."),this.errorModel.set("schema",n),n):i.isUndefined(r)||i.isNull(r)||""==String(r).replace(/^\s+|\s+$/g,"")?(n=e("Table owner cannot be empty."),this.errorModel.set("relowner",n),n):l&&this.isNew()&&!i.isNull(s)&&s.length<=0?(n=e("Please specify at least one key for partitioned table."),this.errorModel.set("partition_keys",n),n):null):null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},isInheritedTable:function(e){return!e.inSchema.apply(this,[e])&&!(!i.isUndefined(e.get("coll_inherits"))&&0!=e.get("coll_inherits").length||!i.isUndefined(e.get("typname"))&&""!==String(e.get("typname")).replace(/^\s+|\s+$/g,""))},checkInheritance:function(e){return e.get("is_partitioned")?(setTimeout(function(){e.set("coll_inherits",[])},10),!0):!(!e.inSchema.apply(this,[e])&&(i.isUndefined(e.get("typname"))||i.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},isLikeDisable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&(i.isUndefined(e.get("typname"))||i.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},check_grid_add_condition:function(e){var t=!0;return e.inSchema.apply(this,[e])||i.isUndefined(e.get("typname"))||i.isNull(e.get("typname"))||""===e.get("typname")||(t=!1),t},check_grid_row_edit_delete:function(e){var t=!0;return i.isUndefined(e.get("inheritedfrom"))||i.isNull(e.get("inheritedfrom"))||""===String(e.get("inheritedfrom")).replace(/^\s+|\s+$/g,"")||(t=!1),t},checkOfType:function(e){return e.get("is_partitioned")?(setTimeout(function(){e.set("typname",void 0)},10),!0):!(!e.inSchemaWithModelCheck.apply(this,[e])&&(i.isUndefined(e.get("coll_inherits"))||i.isNull(e.get("coll_inherits"))||""==String(e.get("coll_inherits")).replace(/^\s+|\s+$/g,"")))},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},isTableAutoVacuumEnable:function(e){return!(!e.inSchema.apply(this,[e])&&!0===e.get("autovacuum_enabled"))},isToastTableAutoVacuumEnable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&1==e.get("toast_autovacuum_enabled"))},fetch_columns_ajax:function(e){var t=this,i="get_columns",o=t.model.top||t.model,a=void 0,l=this.field.get("schema_node"),s=this.field.get("node_info"),d=l.generate_url.apply(l,[null,i,this.field.get("node_data"),this.field.get("url_with_id")||!1,s]),c=this.field.get("cache_level")||l.type,u=this.field.get("cache_node");return u=u&&r.Nodes.cache_node||l,o.trigger("pgadmin:view:fetching",o,t.field),n.ajax({async:!1,url:d,data:e}).done(function(e){a=u.cache(i,s,c,e.data)}).fail(function(){o.trigger("pgadmin:view:fetch:error",o,t.field)}),o.trigger("pgadmin:view:fetched",o,t.field),a=a&&a.data||[]}}),canCreate:c.isTreeItemOfChildOfSchema,canCreate_with_trigger_enable:function(e,t,n){if(this.canCreate.apply(this,[e,t,n]))return e.tigger_count>0},canCreate_with_trigger_disable:function(e,t,n){if(this.canCreate.apply(this,[e,t,n]))return e.tigger_count>0&&e.has_enable_triggers>0}})),r.Nodes.partition}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n,i,o){var c=t.treeMenu.findNodeByDomElement(o);if(void 0===c||!c.getData())return void n.alert((0,u.default)("Data Grid Error"),(0,u.default)("No object selected."));var p=m.getTreeNodeHierarchyFromIdentifier.call(t,o);if(!l(p)&&s(p)){var f=a(p),h=r(i,c.getData(),p),g=d(p,f,c.getData());e.create_transaction(h,null,"false",p.server.server_type,"",g,"")}}function a(e){return void 0!==e.schema?e.schema.label:void 0!==e.view?e.view.label:void 0!==e.catalog?e.catalog.label:""}function r(e,t,n){var i={cmd_type:e.mnuid,obj_type:t._type,sgid:n.server_group._id,sid:n.server._id,did:n.database._id,obj_id:t._id};return(0,f.default)("datagrid.initialize_datagrid",i)}function l(e){return void 0===e.server||void 0===e.database}function s(e){return void 0!==e.schema||void 0!==e.view||void 0!==e.catalog}function d(e,t,n){return t+"."+n.label}Object.defineProperty(t,"__esModule",{value:!0}),t.showDataGrid=o,t.retrieveNameSpaceName=a,t.generateDatagridTitle=d;var c=n(2),u=i(c),p=n(4),f=i(p),m=n(26)},function(e,t,n){"use strict";function i(e){return e.database?e.database.label:e.server.db}function o(e){return void 0===e.server}function a(e){var t=e.treeMenu.selected(),n=r.getTreeNodeHierarchyFromIdentifier.call(e,t);if(!o(n)){return i(n)+"/"+n.server.user.name+"@"+n.server.label}}Object.defineProperty(t,"__esModule",{value:!0}),t.getPanelTitle=a;var r=n(26)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){return e.database}function a(e){var t="datagrid.initialize_query_tool",n={sgid:e.server_group._id,sid:e.server._id};return o(e)&&(n.did=e.database._id,t="datagrid.initialize_query_tool_with_did"),(0,u.default)(t,n)}function r(e){return void 0===e.server}function l(e,t,n,i,o,l){var s=i||"",c=l||"";if(void 0===t.treeMenu.findNodeByDomElement(o))return void n.alert((0,d.default)("Query Tool Error"),(0,d.default)("No object selected."));var u=p.getTreeNodeHierarchyFromIdentifier.call(t,o);if(!r(u)){var f=a(u);e.create_transaction(f,null,"true",u.server.server_type,s,c,"",!1)}}Object.defineProperty(t,"__esModule",{value:!0}),t.showQueryTool=l;var s=n(2),d=i(s),c=n(4),u=i(c),p=n(26)},function(e,t,n){"use strict";var i,o;i=[n(2),n(17)],void 0!==(o=function(e,t){return{copyTextToClipboard:function(n){var i=document.createElement("textarea");i.style.position="fixed",i.style.top=0,i.style.left=0,i.style.width="2em",i.style.height="2em",i.style.padding=0,i.style.border="none",i.style.outline="none",i.style.boxShadow="none",i.style.background="transparent",document.body.appendChild(i),i.select();var o=function e(t){document.removeEventListener("copy",e);var i=t.clipboardData||window.clipboardData;i&&(i.setData("text",n),t.preventDefault())};document.addEventListener("copy",o);try{document.execCommand("copy")}catch(n){t.alert(e("Error"),e("Oops, unable to copy to clipboard"))}document.body.removeChild(i)}}}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";function i(e){return void 0===e.responseJSON&&void 0!==e.data?404===e.status&&e.data&&e.data.info&&"DATAGRID_TRANSACTION_REQUIRED"===e.data.info:404===e.status&&e.responseJSON&&e.responseJSON.info&&"DATAGRID_TRANSACTION_REQUIRED"===e.responseJSON.info}function o(e,t,n,o,a,r){return a=a&&a.length>0?a:[],e.Browser.UserManagement.isPgaLoginRequired(n)?(o&&t.saveState(o,a),e.Browser.UserManagement.pgaLogin()):r&&i(n)?(o&&t.saveState(o,a),t.initTransaction()):void 0}function a(e,t,n,i,a,r){if(0===n.readyState)return(0,l.default)("Not connected to the server or the connection to the server has been closed.");o(e,t,n,i,a,r);var s=n.responseText;return void 0!==n.responseJSON&&(void 0!==n.responseJSON.errormsg&&(s=n.responseJSON.errormsg),503===n.status&&void 0!==n.responseJSON.info&&"CONNECTION_LOST"==n.responseJSON.info&&setTimeout(function(){i&&t.saveState(i,a),t.handle_connection_lost(!1,n)})),s}Object.defineProperty(t,"__esModule",{value:!0}),t.httpResponseRequiresNewTransaction=i,t.handleLoginRequiredAndTransactionRequired=o,t.handleQueryToolAjaxError=a;var r=n(2),l=function(e){return e&&e.__esModule?e:{default:e}}(r)},,,,,,,,,,,,,function(e,t,n){"use strict";(function(t){function i(e){return e&&e.__esModule?e:{default:e}}var o=n(2),a=i(o),r=n(4),l=i(r),s=n(0),d=i(s),c=n(11),u=i(c),p=n(3),f=i(p),m=n(78);e.exports=u.default.dialog("fileSelectionDlg",function(){return{main:function(e){var n=this;t.isUndefined(e.dialog_title)&&(e.dialog_title="Select file"),n.dialog_type=e.dialog_type,this.set("title",e.dialog_title),this.params=JSON.stringify(e),this.elements.dialog.style.minWidth="630px",this.show()},settings:{label:void 0},settingUpdated:function(e,t,n){switch(e){case"message":this.setMessage(n);break;case"label":this.__internal.buttons[0].element&&(this.__internal.buttons[0].element.innerHTML=n)}},prepare:function(){var e=this;e.$container.find(".storage_content").remove(),e.$container.append("<div class='storage_content'></div>");var t=e.$container.find(".storage_content");t.empty(),(0,d.default)(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties"),d.default.get((0,l.default)("file_manager.index"),function(e){t.append(e)});var n,i=(0,m.getTransId)(e.params);4==i.readyState&&(n=JSON.parse(i.responseText)),e.trans_id=n.data.fileTransId,setTimeout(function(){(0,d.default)(e.$container.find(".file_manager")).on("enter-key",function(){(0,d.default)((0,d.default)(e.elements.footer).find(".file_manager_ok")).trigger("click")})},200),e.__internal.buttons[1].element.disabled=!0},setup:function(){return{buttons:[{text:(0,a.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button"},{text:(0,a.default)("Select"),key:13,className:"btn btn-primary fa fa-file file_manager_ok pg-alertify-button disabled"}],focus:{element:0},options:{closableByDimmer:!1,maximizable:!1,closable:!1,movable:!0,padding:!1,overflow:!1,model:0,resizable:!0,pinnable:!1,modal:!1,autoReset:!1}}},callback:function(e){var t;if(e.button.text==(0,a.default)("Select")){var n=(0,d.default)(".storage_dialog #uploader .input-path").val(),i={path:(0,d.default)(".currentpath").val()};f.default.Browser.Events.trigger("pgadmin-storage:finish_btn:"+this.dialog_type,n),t=(0,d.default)(this.elements.body).find(".storage_content"),(0,d.default)(t).find("*").off(),t.remove(),(0,m.removeTransId)(this.trans_id),(0,m.set_last_traversed_dir)(i,this.trans_id)}else e.button.text==(0,a.default)("Cancel")&&(t=(0,d.default)(this.elements.body).find(".storage_content"),(0,d.default)(t).find("*").off(),t.remove(),(0,m.removeTransId)(this.trans_id),f.default.Browser.Events.trigger("pgadmin-storage:cancel_btn:"+this.dialog_type))},build:function(){this.$container=(0,d.default)('<div class="storage_dialog file_selection_dlg"></div>'),this.elements.content.appendChild(this.$container.get(0)),u.default.pgDialogBuild.apply(this)},hooks:{onshow:function(){}}}})}).call(t,n(1))},function(e,t,n){"use strict";(function(t){function i(e){return e&&e.__esModule?e:{default:e}}var o=n(2),a=i(o),r=n(4),l=i(r),s=n(0),d=i(s),c=n(11),u=i(c),p=n(3),f=i(p),m=n(78);e.exports=u.default.dialog("createModeDlg",function(){return{setup:function(){return{buttons:[{text:(0,a.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times file_manager_create_cancel pg-alertify-button"},{text:(0,a.default)("Create"),key:13,className:"btn btn-primary fa fa-file file_manager_create file_manager_ok pg-alertify-button disabled"}],focus:{element:0},options:{closableByDimmer:!1,maximizable:!1,closable:!1,movable:!0,padding:!1,overflow:!1,model:0,resizable:!0,pinnable:!1,modal:!1,autoReset:!1}}},replace_file:function(){var e=(0,d.default)(".replace_file .btn_yes"),t=(0,d.default)(".replace_file .btn_no");(0,d.default)(".storage_dialog #uploader .input-path").attr("disabled",!0),(0,d.default)(".file_manager_ok").addClass("disabled"),(0,d.default)(".replace_file, .fm_dimmer").show(),e.on("click",function(){(0,d.default)(".replace_file, .fm_dimmer").hide(),e.off(),t.off();var n=(0,d.default)(".storage_dialog #uploader .input-path").val();f.default.Browser.Events.trigger("pgadmin-storage:finish_btn:create_file",n),(0,d.default)(".file_manager_create_cancel").trigger("click"),(0,d.default)(".storage_dialog #uploader .input-path").attr("disabled",!1),(0,d.default)(".file_manager_ok").removeClass("disabled")}),t.on("click",function(){(0,d.default)(".replace_file, .fm_dimmer").hide(),e.off(),t.off(),(0,d.default)(".storage_dialog #uploader .input-path").attr("disabled",!1),(0,d.default)(".file_manager_ok").removeClass("disabled")})},is_file_exist:function(){var e=(0,d.default)(".storage_dialog #uploader .input-path").val(),t=e.substr(0,e.lastIndexOf("/")+1),n=e.substr(e.lastIndexOf("/")+1),i=!1,o={path:t,name:n,mode:"is_file_exist"};return d.default.ajax({type:"POST",data:JSON.stringify(o),url:(0,l.default)("file_manager.filemanager",{trans_id:this.trans_id}),dataType:"json",contentType:"application/x-download; charset=utf-8",async:!1}).done(function(e){var t=e.data.result;i=1===t.Code}),i},check_permission:function(e){var t=!1,n={path:e,mode:"permission"};return d.default.ajax({type:"POST",data:JSON.stringify(n),url:(0,l.default)("file_manager.filemanager",{trans_id:this.trans_id}),dataType:"json",contentType:"application/json; charset=utf-8",async:!1}).done(function(e){var n=e.data.result;1===n.Code?t=!0:((0,d.default)(".file_manager_ok").addClass("disabled"),u.default.error(n.Error))}).fail(function(){(0,d.default)(".file_manager_ok").addClass("disabled"),u.default.error((0,a.default)("Error occurred while checking access permission."))}),t},callback:function(e){if(e.button.text==(0,a.default)("Create")){var n,i=(0,d.default)(".storage_dialog #uploader .input-path").val(),o={path:(0,d.default)(".currentpath").val()};if(!this.check_permission(i))return void(e.cancel=!0);!t.isUndefined(i)&&""!==i&&this.is_file_exist()?(this.replace_file(),e.cancel=!0):(f.default.Browser.Events.trigger("pgadmin-storage:finish_btn:create_file",i),n=(0,d.default)(this.elements.body).find(".storage_content"),(0,d.default)(n).find("*").off(),n.remove(),(0,m.removeTransId)(this.trans_id)),(0,m.set_last_traversed_dir)(o,this.trans_id)}else e.button.text==(0,a.default)("Cancel")&&(n=(0,d.default)(this.elements.body).find(".storage_content"),(0,d.default)(n).find("*").off(),n.remove(),(0,m.removeTransId)(this.trans_id),f.default.Browser.Events.trigger("pgadmin-storage:cancel_btn:create_file"))}}},!0,"fileSelectionDlg")}).call(t,n(1))},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i,o;i=[n(0),n(1),n(232),n(31),n(355)],void 0!==(o=function(e,t,n,i,o){var a=function(){var e=this||window,t=e.slickgrid,a=t.getColumns(),l=t.getSelectionModel().getSelectedRanges(),s=t.getData(),d=t.getSelectedRows(),c=t.CSVOptions;i.areAllRangesCompleteRows(t,l)?(e.copied_rows=d.map(function(e){return t.getDataItem(e)}),r(e.can_edit,!0)):(e.copied_rows=[],r(e.can_edit,!1));var u=o.rangesToCsv(s.getItems(),a,l,c);u&&n.copyTextToClipboard(u)},r=function(t,n){t&&e("#btn-paste-row").prop("disabled",!n)};return a}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a={_verbose:function(){return!(0,o.default)(".explain-verbose").hasClass("visibility-hidden")},_costsEnabled:function(){return!(0,o.default)(".explain-costs").hasClass("visibility-hidden")},_buffers:function(){return!(0,o.default)(".explain-buffers").hasClass("visibility-hidden")},_timing:function(){return!(0,o.default)(".explain-timing").hasClass("visibility-hidden")},_clearMessageTab:function(){(0,o.default)(".sql-editor-message").html("")},executeQuery:function(e){e.is_query_tool?(this._clearMessageTab(),e.execute()):(this._clearMessageTab(),e.execute_data_query())},explainAnalyze:function(e){var t=this._costsEnabled(),n=this._verbose(),i=this._buffers(),o=this._timing(),a={format:"json",analyze:!0,verbose:n,costs:t,buffers:i,timing:o,summary:!1};this._clearMessageTab(),e.execute(a)},explain:function(e){var t=this._costsEnabled(),n=this._verbose(),i={format:"json",analyze:!1,verbose:n,costs:t,buffers:!1,timing:!1,summary:!1};this._clearMessageTab(),e.execute(i)},download:function(e){var t=e.gridView.query_tool_obj.getSelection();if(t||(t=e.gridView.query_tool_obj.getValue()),t){var n="data-"+(new Date).getTime()+".csv";e.is_query_tool||(n=e.table_name+".csv"),e.trigger_csv_download(t,n)}},commentBlockCode:function(e){var t=e.gridView.query_tool_obj;t.getValue()&&t.toggleComment(t.getCursor(!0),t.getCursor(!1))},commentLineCode:function(e){var t=e.gridView.query_tool_obj;t.getValue()&&t.lineComment(t.getCursor(!0),t.getCursor(!1),{lineComment:"--"})},uncommentLineCode:function(e){var t=e.gridView.query_tool_obj;t.getValue()&&t.uncomment(t.getCursor(!0),t.getCursor(!1),{lineComment:"--"})},focusOut:function(){document.activeElement.blur(),window.top.document.activeElement.blur()},toggleCaseOfSelectedText:function(e){var t=e.gridView.query_tool_obj,n=t.getSelection();n&&(n===n.toUpperCase()?t.replaceSelection(n.toLowerCase()):t.replaceSelection(n.toUpperCase()))},executeCommit:function(e){var t=this;e.special_sql="COMMIT;",t.executeQuery(e)},executeRollback:function(e){var t=this;e.special_sql="ROLLBACK;",t.executeQuery(e)}};e.exports=a},,,,,,,,,,,,function(e,t,n){"use strict";function i(e,t){var n=(0,a.default)(t).diff(e),i="",o=void 0,r=void 0,l=void 0;return o=parseInt(n/1e3),n%=1e3,r=parseInt(o/60),o%=60,l=parseInt(r/60),r%=60,i=(l>0?l+" hr ":"")+(r>0?r+" min ":"")+(l<=0&&o>0?o+" secs ":"")+(l<=0&&r<=0?n+" msec ":""),i.trim()}Object.defineProperty(t,"__esModule",{value:!0}),t.calculateQueryRunTime=i;var o=n(37),a=function(e){return e&&e.__esModule?e:{default:e}}(o)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i,o;i=[n(241),n(2),n(4),n(0),n(264),n(346),n(1),n(8),n(11),n(3),n(10),n(29),n(347),n(351),n(354),n(232),n(265),n(31),n(356),n(357),n(358),n(30),n(359),n(233),n(360),n(362),n(372),n(374),n(22),n(111),n(34),n(266),n(430),n(170),n(52),n(278),n(431),n(432),n(433),n(245),n(443),n(444),n(445),n(448),n(5),n(108)],void 0!==(o=function(e,t,n,i,o,a,r,l,s,d,c,u,p,f,m,h,g,b,_,v,y,w,x,C,S,N,k,T,D,E,O,M,j,q,P,I,U,A){if(d.SqlEditor)return d.SqlEditor;var R=window.wcDocker,L=d.Browser,B=u.default,z=window.Slick,H=!1,F=c.View.extend({initialize:function(e){this.$el=e.el,this.handler=e.handler,this.handler.col_size={};var t=window.opener?window.opener.pgAdmin.Browser:window.top.pgAdmin.Browser;this.preferences=t.get_preferences_for_module("sqleditor"),this.handler.preferences=this.preferences,this.connIntervalId=null},events:{"click .btn-load-file":"on_file_load","click #btn-save":"on_save","click #btn-file-menu-save":"on_save","click #btn-file-menu-save-as":"on_save_as","click #btn-find":"on_find","click #btn-find-menu-find":"on_find","click #btn-find-menu-find-next":"on_find_next","click #btn-find-menu-find-previous":"on_find_previous","click #btn-find-menu-replace":"on_replace","click #btn-find-menu-replace-all":"on_replace_all","click #btn-find-menu-find-persistent":"on_find_persistent","click #btn-find-menu-jump":"on_jump","click #btn-delete-row":"on_delete","click #btn-filter":"on_show_filter","click #btn-filter-menu":"on_show_filter","click #btn-include-filter":"on_include_filter","click #btn-exclude-filter":"on_exclude_filter","click #btn-remove-filter":"on_remove_filter","click #btn-cancel":"on_cancel","click #btn-copy-row":"on_copy_row","click #btn-paste-row":"on_paste_row","click #btn-flash":"on_flash","click #btn-flash-menu":"on_flash","click #btn-cancel-query":"on_cancel_query","click #btn-download":"on_download","click #btn-clear":"on_clear","click #btn-auto-commit":"on_auto_commit","click #btn-auto-rollback":"on_auto_rollback","click #btn-clear-history":"on_clear_history","click .noclose":"do_not_close_menu","click #btn-explain":"on_explain","click #btn-explain-analyze":"on_explain_analyze","click #btn-explain-verbose":"on_explain_verbose","click #btn-explain-costs":"on_explain_costs","click #btn-explain-buffers":"on_explain_buffers","click #btn-explain-timing":"on_explain_timing","change .limit":"on_limit_change",keydown:"keyAction","click #btn-comment-code":"on_toggle_comment_block_code","click #btn-toggle-comment-block":"on_toggle_comment_block_code","click #btn-comment-line":"on_comment_line_code","click #btn-uncomment-line":"on_uncomment_line_code","click #btn-indent-code":"on_indent_code","click #btn-unindent-code":"on_unindent_code","click #btn-commit":"on_commit_transaction","click #btn-rollback":"on_rollback_transaction"},reflectPreferences:function(){var e=this,t=window.opener?window.opener.pgAdmin.Browser:window.top.pgAdmin.Browser;L.preference_version()<t.preference_version()&&(L.preference_version(t.preference_version()),e.preferences=t.get_preferences_for_module("sqleditor"),e.handler.preferences=e.preferences,A.updateUIPreferences(e))},render:function(){var e=this;i(".editor-title").text(r.unescape(e.editor_title)),e.gain_focus=function(){setTimeout(function(){w.updateConnectionStatusFlag("visible")},100)},e.lost_focus=function(){setTimeout(function(){w.updateConnectionStatusFlag("hidden")},100)};var o=new R("#editor-panel",{allowContextMenu:!0,allowCollapse:!1,loadingClass:"pg-sp-icon",themePath:n("static",{filename:"css"}),theme:"webcabin.overrides.css"});e.docker=o,new d.Browser.Panel({name:"sql_panel",title:t("Query Editor"),width:"75%",height:"33%",isCloseable:!1,isPrivate:!0}).load(o);var a=o.addPanel("sql_panel",R.DOCK.TOP),l=i('<textarea id="sql_query_tool" tabindex: "-1"></textarea>'),s=i('<div id="output-panel" tabindex: "0"></div>').append(l);a.$container.find(".pg-panel-content").append(s),e.query_tool_obj=B.fromTextArea(l.get(0),{tabindex:"0",lineNumbers:!0,styleSelectedText:!0,mode:"gpdb"===e.handler.server_type?"text/x-gpsql":"text/x-pgsql",foldOptions:{widget:"…"},foldGutter:{rangeFinder:B.fold.combine(B.pgadminBeginRangeFinder,B.pgadminIfRangeFinder,B.pgadminLoopRangeFinder,B.pgadminCaseRangeFinder)},gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:L.editor_shortcut_keys,scrollbarStyle:"simple"}),a.on(R.EVENT.RESIZE_ENDED,function(){setTimeout(function(){e&&e.query_tool_obj&&e.query_tool_obj.refresh()},200)});var c=new d.Browser.Panel({name:"data_output",title:t("Data Output"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,extraClasses:"hide-vertical-scrollbar",content:'<div id ="datagrid" class="sql-editor-grid-container text-12" tabindex: "0"></div>'}),u=new d.Browser.Panel({name:"explain",title:t("Explain"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div class="sql-editor-explain" tabindex: "0"></div>'}),p=new d.Browser.Panel({name:"messages",title:t("Messages"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div class="sql-editor-message" tabindex: "0"></div>'}),f=new d.Browser.Panel({name:"history",title:t("Query History"),width:"100%",height:"33%",isCloseable:!1,isPrivate:!0,content:'<div id ="history_grid" class="sql-editor-history-container" tabindex: "0"></div>'}),m=new d.Browser.Panel({name:"scratch",title:t("Scratch Pad"),width:"25%",height:"33%",isCloseable:!0,isPrivate:!1,content:'<div class="sql-scratch" tabindex: "0"><textarea wrap="off"></textarea></div>'}),h=new d.Browser.Panel({name:"notifications",title:t("Notifications"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div id ="notification_grid" class="sql-editor-notifications" tabindex: "0"></div>'}),g=new d.Browser.Panel({name:"geometry_viewer",title:t("Geometry Viewer"),width:"100%",height:"100%",isCloseable:!0,isPrivate:!0,content:'<div id ="geometry_viewer_panel" class="sql-editor-geometry-viewer" tabindex: "0"></div>'});c.load(o),u.load(o),p.load(o),f.load(o),m.load(o),h.load(o),g.load(o),e.scratch_panel=o.addPanel("scratch",R.DOCK.RIGHT,a),e.history_panel=o.addPanel("history",R.DOCK.STACKED,a),e.data_output_panel=o.addPanel("data_output",R.DOCK.BOTTOM),e.explain_panel=o.addPanel("explain",R.DOCK.STACKED,e.data_output_panel),e.messages_panel=o.addPanel("messages",R.DOCK.STACKED,e.data_output_panel),e.notifications_panel=o.addPanel("notifications",R.DOCK.STACKED,e.data_output_panel),e.render_history_grid(),j.renderNotificationsGrid(e.notifications_panel),e.preferences.new_browser_tab||(r.each(window.top.pgAdmin.Browser.docker.findPanels("frm_datagrid"),function(n){n.isVisible()&&(n.on(R.EVENT.CLOSING,function(){var i,o=!1;if(e.handler.can_edit&&e.preferences.prompt_save_data_changes){var a=e.handler.data_store;a&&(r.size(a.added)||r.size(a.updated))&&(i=t("The data has changed. Do you want to save changes?"),o=!0)}else e.handler.is_query_tool&&e.handler.is_query_changed&&e.preferences.prompt_save_query_changes&&(i=t("The text has changed. Do you want to save changes?"),o=!0);return!o||e.user_confirmation(n,i)}),n.on(R.EVENT.GAIN_FOCUS,function(){var t=i(this.$container),n=e.handler.transId;t.hasClass("wcPanelTabContentHidden")||(setTimeout(function(){e.handler.gridView.query_tool_obj.focus()},200),L.Events.trigger("pgadmin:query_tool:panel:gain_focus:"+n))}),n.on(R.EVENT.LOST_FOCUS,function(){var t=i(this.$container),n=e.handler.transId;t.hasClass("wcPanelTabContentHidden")&&L.Events.trigger("pgadmin:query_tool:panel:lost_focus:"+n)}))}),L.Events.on("pgadmin:query_tool:panel:gain_focus:"+e.handler.transId,e.gain_focus,e),L.Events.on("pgadmin:query_tool:panel:lost_focus:"+e.handler.transId,e.lost_focus,e)),setTimeout(function(){e.query_tool_obj.focus()},500),B.registerHelper("hint","sql",function(t){var o=[],a=t.getDoc(),l=a.getCursor(),s=l.ch,c={editor:t,url:n("sqleditor.autocomplete",{trans_id:e.transId}),data:o,current_line:l.line,hint_render:function(e,t,n){var i=document.createElement("span");switch(n.type){case"database":i.className="sqleditor-hint pg-icon-"+n.type;break;case"datatype":i.className="sqleditor-hint icon-type";break;case"keyword":i.className="fa fa-key";break;case"table alias":i.className="fa fa-at";break;default:i.className="sqleditor-hint icon-"+n.type}i.appendChild(document.createTextNode(n.text)),e.appendChild(i)}};return o.push(a.getValue()),o.push(a.getRange({line:0,ch:0},{line:c.current_line,ch:s})),{then:function(e){var t=this;i.ajax({url:t.url,method:"POST",contentType:"application/json",data:JSON.stringify(t.data)}).done(function(n){var i=[];r.each(n.data.result,function(e,n){i.push({text:n,type:e.object_type,render:t.hint_render})}),i.sort(function(e,t){var n=e.text.toLowerCase(),i=t.text.toLowerCase();return n<i?-1:n>i?1:0});var o,a,s,d=t.editor.getTokenAt(l);d.end>l.ch&&(d.end=l.ch,d.string=d.string.slice(0,l.ch-d.start)),d.string.match(/^[.`\w@]\w*$/)?(s=d.string,o=d.start,a=d.end):(o=a=l.ch,s=""),"."!=s.charAt(0)&&"``"!=s.charAt(0)||(o+=1),e({list:i,from:{line:t.current_line,ch:o},to:{line:t.current_line,ch:a}})}).fail(function(e){return C.handleLoginRequiredAndTransactionRequired(d,t,e,null,[],!1)})}.bind(c)}}),i(".dropdown-submenu").on("mouseenter",function(){var e=i(this).find("ul.dropdown-menu");if(i(e).offset().left+e.width()>i(window).width()){var t=-i(e).width();e.css("left",t)}}).on("mouseleave",function(){i(this).find("ul.dropdown-menu").css("left","")}),e.reflectPreferences(),e.preferences.auto_commit?i(".auto-commit").removeClass("visibility-hidden"):i(".auto-commit").addClass("visibility-hidden"),e.preferences.auto_rollback?i(".auto-rollback").removeClass("visibility-hidden"):i(".auto-rollback").addClass("visibility-hidden"),L.onPreferencesChange("sqleditor",function(){e.reflectPreferences()}),e.preferences.new_browser_tab&&setInterval(function(){window.opener.pgAdmin&&e.reflectPreferences()},1e3)},user_confirmation:function(e,n){var i=this;return s.confirmSave||s.dialog("confirmSave",function(){return{main:function(e,t){this.setHeader(e),this.setContent(t)},setup:function(){return{buttons:[{text:t("Cancel"),key:27,invokeOnClose:!0,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button"},{text:t("Don't save"),className:"btn btn-secondary fa fa-lg fa-trash-o pg-alertify-button"},{text:t("Save"),className:"btn btn-primary fa fa-lg fa-save pg-alertify-button"}],focus:{element:0,select:!1},options:{maximizable:!1,resizable:!1}}},callback:function(e){switch(e.index){case 0:break;case 1:i.handler.close_on_save=!1,i.handler.close();break;case 2:i.handler.close_on_save=!0,i.handler._save(i,i.handler)}}}}),s.confirmSave(t("Save changes?"),n),!1},render_grid:function(e,t,n,o,a){var l=this;l.handler.data_store={updated:{},added:{},staged_rows:{},deleted:{},updated_index:{},added_index:{}},l.handler.primary_keys_data={},l.client_primary_key=o,l.client_primary_key_counter=0,l.handler.slickgrid&&l.handler.slickgrid.destroy(),r.isArray(e)&&r.size(e)||(e=[]);var s,d=[],c=l.handler.col_size,u=l.handler.query,p=u.match(/select.*from\s+\w+\.*(\w+)/i);s=p?p[1]:w.getHash(u),l.handler.table_name=s,c[s]=c[s]||{},r.each(t,function(e){var t={id:e.name,pos:e.pos,field:e.name,name:e.label,display_name:e.display_name,column_type:e.column_type,column_type_internal:e.column_type_internal,not_null:e.not_null,has_default_val:e.has_default_val,is_array:e.is_array},o=e.column_type.trim(),a=e.name.length>o.length?e.name:o;r.isUndefined(c[s][e.name])?(t.width=w.calculateColumnWidth(a),c[s][e.name]=t.width):t.width=c[s][e.name],"oid"==e.cell&&"oid"==e.name?t.editor=null:"Json"==e.cell?(t.editor=n?z.Editors.JsonText:z.Editors.ReadOnlyJsonText,t.formatter=z.Formatters.JsonString):"number"==e.cell||"oid"==e.cell||-1!==i.inArray(e.type,["xid","real"])?(t.editor=n?z.Editors.CustomNumber:z.Editors.ReadOnlyText,t.formatter=z.Formatters.Numbers):"boolean"==e.cell?(t.editor=n?z.Editors.Checkbox:z.Editors.ReadOnlyCheckbox,t.formatter=z.Formatters.Checkmark):"binary"==e.cell?t.formatter=z.Formatters.Binary:"geometry"==e.cell||"geography"==e.cell?t.width+=28:(t.editor=n?z.Editors.pgText:z.Editors.ReadOnlypgText,t.formatter=z.Formatters.Text),d.push(t)});var h=new f;d=l.grid_columns=h.getColumnDefinitions(d),r.each(d,function(e){"geometry"!=e.column_type_internal&&"geography"!=e.column_type_internal||N.add_header_button(e)}),a&&(d[0].width=w.calculateColumnWidth(a));var g={editable:!0,enableAddRow:n,enableCellNavigation:!0,enableColumnReorder:!1,asyncEditorLoading:!1,autoEdit:!1},b=i("#datagrid"),x=i(this.data_output_panel.$container.parent().parent()).height()-35;b.height(x);var C=l.dataView=new z.Data.DataView,S=l.grid=new z.Grid(b,C,d,g);C.getItemMetadata=function(e){var t="",n=l.handler.data_store;return r.has(l.handler,"data_store")&&(e in n.added_index&&n.added_index[e]in n.added?(t="new_row",n.added[n.added_index[e]].err&&(t+=" error")):e in n.updated_index&&e in n.updated&&(t="updated_row",n.updated[n.updated_index[e]].err&&(t+=" error"))),!r.isUndefined(l.handler.rows_to_disable)&&l.handler.rows_to_disable.length>0&&-1!==r.indexOf(l.handler.rows_to_disable,e)&&(t+=" disabled_row"),{cssClasses:t}},S.registerPlugin(new z.AutoTooltips({enableForHeaderCells:!1})),S.registerPlugin(new m),S.setSelectionModel(new v),S.registerPlugin(h),S.registerPlugin(new z.AutoColumnSize);var k=new z.Plugins.HeaderButtons;k.onCommand.subscribe(function(e,t){if("view-geometries"===t.command){var n=t.grid.getColumns(),i=n.indexOf(t.column),o=t.grid.getSelectedRows();if(0===o.length)if(l.handler.has_more_rows)l.fetch_next_all(function(){h.onGridSelectAll.notify(t,new z.EventData);var e=t.grid.getData().getItems();N.render_geometries(l.handler,e,n,i)});else{h.onGridSelectAll.notify(t,new z.EventData);var a=t.grid.getData().getItems();N.render_geometries(l.handler,a,n,i)}else{var s=t.grid.getData().getItems(),d=r.map(o,function(e){return s[e]});N.render_geometries(l.handler,d,n,i)}}}),S.registerPlugin(k);var T={keys:r.isEmpty(l.handler.primary_keys)&&l.handler.has_oids?l.handler.oids:l.handler.primary_keys,vals:e,columns:t,grid:S,selection:S.getSelectionModel(),editor:l,client_primary_key:l.client_primary_key,has_oids:l.handler.has_oids};l.handler.slickgrid=S,l.handler.slickgrid.CSVOptions={quoting:l.preferences.results_grid_quoting,quote_char:l.preferences.results_grid_quote_char,field_separator:l.preferences.results_grid_field_separator},T.selection&&T.selection.onSelectedRangesChanged.subscribe(y.bind(T)),S.onColumnsResized.subscribe(function(){var e=this.getColumns();r.each(e,function(e){l.handler.col_size[l.handler.table_name][e.id]=e.width})}.bind(S)),h.onBeforeGridSelectAll.subscribe(function(e,t){l.handler.has_more_rows&&(e.stopImmediatePropagation(),l.fetch_next_all(function(){h.onGridSelectAll.notify(t,new z.EventData)}))}),h.onBeforeGridColumnSelectAll.subscribe(function(e,t){l.handler.has_more_rows&&(e.stopImmediatePropagation(),l.fetch_next_all(function(){h.onGridColumnSelectAll.notify(t,new z.EventData)}))}),C.onRowCountChanged.subscribe(function(){S.updateRowCount(),S.render()}),C.onRowsChanged.subscribe(function(e,t){S.invalidateRows(t.rows),S.render()}),S.onBeforeEditCell.subscribe(function(e,t){if("bytea"==t.column.column_type_internal||"bytea[]"==t.column.column_type_internal)return!1;var n=t.item;if(l.handler.rows_to_disable&&r.contains(l.handler.rows_to_disable,t.row))return!1;if(l.handler.can_edit&&n&&l.client_primary_key in n){var i=n[l.client_primary_key],o=l.handler.primary_keys,a={};if(i in l.handler.primary_keys_data)return;r.each(o,function(e,t){a[t]=n[t]}),l.handler.primary_keys_data[i]=a}}),S.onKeyDown.subscribe(function(e,t){var n=e.keyCode;(e.ctrlKey||e.metaKey)&&65==n&&l.handler.has_more_rows?l.fetch_next_all(function(){_(e,t)}):_(e,t)}),S.onCellChange.subscribe(function(e,t){var n=t.grid.getColumns()[t.cell].field,o=t.item[n],a=t.item[l.client_primary_key]||null,s={},d=t.grid,c=d.getDataItem(t.row);if(l.primary_keys&&r.all(r.values(r.pick(c,l.primary_keys)),function(e){return void 0!=e})&&l.handler.temp_new_rows){var u=l.handler.temp_new_rows.indexOf(t.row);u>-1&&l.handler.temp_new_rows.splice(u,1)}s[n]=o,a&&(a in l.handler.data_store.added?(r.extend(l.handler.data_store.added[a].data,s),l.handler.data_store.added[a].err=!1):a in l.handler.data_store.updated?(r.extend(l.handler.data_store.updated[a].data,s),l.handler.data_store.updated[a].err=!1):(l.handler.data_store.updated[a]={err:!1,data:s,primary_keys:l.handler.primary_keys_data[a]},l.handler.data_store.updated_index[t.row]=a)),i("#btn-save").prop("disabled",!1)}.bind(T)),S.onAddNewRow.subscribe(function(e,t){var n=t.column,o=t.item,a=this.grid.getDataLength(),s=(l.client_primary_key_counter++).toString(),d=this.grid.getData();r.isUndefined(o[0])&&l.handler.temp_new_rows.push(a),o&&(o[l.client_primary_key]=s),d.addItem(o),l.handler.data_store.added[s]={err:!1,data:o},l.handler.data_store.added_index[a]=s,{}[n.name]=r.where(this.columns,{pos:n.pos})[0].type,S.updateRowCount(),S.render(),i("#btn-save").prop("disabled",!1)}.bind(T)),S.onViewportChanged.subscribe(function(e,t){var n=t.grid.getRenderedRange(),i=t.grid.getDataLength();l.handler.has_more_rows&&!l.handler.fetching_rows&&n.bottom>i-100&&setTimeout(l.fetch_next.bind(l))}),i(window).resize(function(){l.data_output_panel.isVisible()&&l.grid_resize(S)}),l.data_output_panel.on(R.EVENT.RESIZE_ENDED,function(){l.data_output_panel.isVisible()&&l.grid_resize(S)}),l.data_output_panel.on(R.EVENT.VISIBILITY_CHANGED,function(){l.data_output_panel.isVisible()&&l.grid_resize(S)});for(var D=0;D<e.length;D++){for(var E={},O=1;O<d.length;O++)E[d[O].field]=e[D][d[O].pos];E[l.client_primary_key]=(l.client_primary_key_counter++).toString(),e[D]=E}C.setItems(e,l.client_primary_key)},fetch_next_all:function(e){this.fetch_next(!0,e)},fetch_next:function(e,o){var a=this,r="";a.handler.fetching_rows=!0,i("#btn-flash").prop("disabled",!0),i("#btn-download").prop("disabled",!0),e?(a.handler.trigger("pgadmin-sqleditor:loading-icon:show",t("Fetching all records...")),r=n("sqleditor.fetch_all",{trans_id:a.transId,fetch_all:1})):r=n("sqleditor.fetch",{trans_id:a.transId}),i.ajax({url:r,method:"GET"}).done(function(e){a.handler.has_more_rows=e.data.has_more_rows,i("#btn-flash").prop("disabled",!1),i("#btn-download").prop("disabled",!1),a.handler.trigger("pgadmin-sqleditor:loading-icon:hide"),a.update_grid_data(e.data.result),a.handler.fetching_rows=!1,"function"==typeof o&&o()}).fail(function(e){i("#btn-flash").prop("disabled",!1),i("#btn-download").prop("disabled",!1),a.handler.trigger("pgadmin-sqleditor:loading-icon:hide"),a.handler.has_more_rows=!1,a.handler.fetching_rows=!1,"function"==typeof o&&o();var t=C.handleQueryToolAjaxError(d,a,e,null,[],!1);a.update_msg_history(!1,t)})},update_grid_data:function(e){this.dataView.beginUpdate();for(var t=0;t<e.length;t++){for(var n={},i=1;i<this.grid_columns.length;i++)n[this.grid_columns[i].field]=e[t][this.grid_columns[i].pos];n[this.client_primary_key]=(this.client_primary_key_counter++).toString(),this.dataView.addItem(n)}this.dataView.endUpdate()},grid_resize:function(e){var t=i("#datagrid").height(),n=i(this.data_output_panel.$container.parent().parent()).height()-35,o=e.getViewport(),a=e.getRenderedRange(),r=e.getActiveCell();t!=n&&i("#datagrid").css({height:n+"px"}),e.resizeCanvas(),r&&e.scrollCellIntoView(r.row,r.cell),o.top!=a.top&&(o.bottom-2==a.bottom?e.scrollRowIntoView(o.bottom):e.scrollRowIntoView(o.bottom-2))},render_history_grid:function(){var e=this;e.history_collection||(e.history_collection=new k.HistoryCollection([]));var t,n=D.createElement(T.QueryHistory,{historyCollection:e.history_collection,ref:function(e){t=e},sqlEditorPref:{sql_font_size:w.calcFontSize(this.preferences.sql_font_size)}});E.render(n,i("#history_grid")[0]),e.history_panel.off(R.EVENT.VISIBILITY_CHANGED),e.history_panel.on(R.EVENT.VISIBILITY_CHANGED,function(){t.refocus()})},on_delete:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:button:deleterow",e,e.handler)},_stopEventPropogation:function(e){e=e||window.event,e.cancelBubble=!0,e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault()},_closeDropDown:function(e){var t=e&&(e.currentTarget||e.target);t&&i(t).closest(".editor-toolbar").find(".show").removeClass("show")},on_save:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.handler.close_on_save=!1,t.handler.trigger("pgadmin-sqleditor:button:save",t,t.handler)},on_save_as:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.handler.close_on_save=!1,t.handler.trigger("pgadmin-sqleditor:button:save",t,t.handler,!0)},on_find:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.query_tool_obj.execCommand("find")},on_find_next:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.query_tool_obj.execCommand("findNext")},on_find_previous:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.query_tool_obj.execCommand("findPrev")},on_replace:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.query_tool_obj.execCommand("replace")},on_replace_all:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.query_tool_obj.execCommand("replaceAll")},on_find_persistent:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.query_tool_obj.execCommand("findPersistent")},on_jump:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.query_tool_obj.execCommand("jumpToLine")},on_show_filter:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:button:show_filter",e,e.handler)},on_include_filter:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.handler.trigger("pgadmin-sqleditor:button:include_filter",t,t.handler)},on_exclude_filter:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.handler.trigger("pgadmin-sqleditor:button:exclude_filter",t,t.handler)},on_remove_filter:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.handler.trigger("pgadmin-sqleditor:button:remove_filter",t,t.handler)},on_cancel:function(){i("#filter").addClass("d-none"),i("#editor-panel").removeClass("sql-editor-busy-fetching")},on_copy_row:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:button:copy_row",e,e.handler)},on_paste_row:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:button:paste_row",e,e.handler)},on_limit_change:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:button:limit",e,e.handler)},on_flash:function(){M.executeQuery(this.handler)},on_cancel_query:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:button:cancel-query",e,e.handler)},on_comment_line_code:function(){M.commentLineCode(this.handler)},on_uncomment_line_code:function(){M.uncommentLineCode(this.handler)},on_toggle_comment_block_code:function(){M.commentBlockCode(this.handler)},on_indent_code:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:indent_selected_code",e,e.handler)},on_unindent_code:function(){var e=this;e.handler.trigger("pgadmin-sqleditor:unindent_selected_code",e,e.handler)},on_clear:function(e){var n=this;this._stopEventPropogation(e),this._closeDropDown(e),n.handler.is_query_changed?s.confirm(t("Unsaved changes"),t("Are you sure you wish to discard the current changes?"),function(){n.query_tool_obj.setValue(""),setTimeout(function(){n.query_tool_obj.focus()},200)},function(){return!0}).set("labels",{ok:t("Yes"),cancel:t("No")}):n.query_tool_obj.setValue("")},on_clear_history:function(e){var n=this;this._stopEventPropogation(e),this._closeDropDown(e),n.history_collection.length()&&s.confirm(t("Clear history"),t("Are you sure you wish to clear the history?"),function(){n.history_collection&&n.history_collection.reset(),setTimeout(function(){n.query_tool_obj.focus()},200)},function(){return!0}).set("labels",{ok:t("Yes"),cancel:t("No")})},on_auto_commit:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:auto_commit",t,t.handler)},on_auto_rollback:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:auto_rollback",t,t.handler)},on_explain:function(e){this._stopEventPropogation(e),this._closeDropDown(e),M.explain(this.handler)},on_explain_analyze:function(e){this._stopEventPropogation(e),this._closeDropDown(e),M.explainAnalyze(this.handler)},on_explain_verbose:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:explain-verbose",t,t.handler)},on_explain_costs:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:explain-costs",t,t.handler)},on_explain_buffers:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:explain-buffers",t,t.handler)},on_explain_timing:function(e){var t=this;this._stopEventPropogation(e),t.handler.trigger("pgadmin-sqleditor:button:explain-timing",t,t.handler)},do_not_close_menu:function(e){e.stopPropagation()},on_file_load:function(e){var t=this;this._stopEventPropogation(e),this._closeDropDown(e),t.handler.trigger("pgadmin-sqleditor:button:load_file",t,t.handler)},on_download:function(){M.download(this.handler)},keyAction:function(e){var t,n=this;t=O.processEventQueryTool(this.handler,M,e),r.isNull(t)||r.isUndefined(t)||(t++,this.docker.findPanels()[t].focus(),3==t&&setTimeout(function(){n.query_tool_obj.focus()},100))},on_commit_transaction:function(){M.executeCommit(this.handler)},on_rollback_transaction:function(){M.executeRollback(this.handler)}}),V=function(){this.initialize.apply(this,arguments)};return r.extend(V.prototype,c.Events,{initialize:function(e){var n=this;this.container=e,this.state={},P.modifyAlertifyAnimation(),s.dlgGetServerPass||s.dialog("dlgGetServerPass",function(){return{main:function(e,t){this.set("title",e),this.setting("message",t)},setup:function(){return{buttons:[{text:t("OK"),key:13,className:"btn btn-primary"},{text:t("Cancel"),key:27,className:"btn btn-danger"}],focus:{element:"#password",select:!0},options:{modal:0,resizable:!1,maximizable:!1,pinnable:!1}}},build:function(){},settings:{message:null},prepare:function(){this.setContent(this.setting("message"))},callback:function(e){if(e.button.text==t("OK")){var o=i(this.elements.content).find("#frmPassword").serialize();n.init_connection(!1,o)}}}}),this.on("pgadmin-datagrid:transaction:created",function(e){n.transId=e.gridTransId,n.warn_before_continue()}),L.Events.on("pgadmin:user:logged-in",function(){n.initTransaction()})},saveState:function(e,t){this.state=e?{fn:e,args:t}:{}},initTransaction:function(){var e;this.is_query_tool?(e="datagrid.initialize_query_tool",this.url_params.did&&(e="datagrid.initialize_query_tool_with_did")):e="datagrid.initialize_datagrid";var t=n(e,this.url_params);q.create_transaction(t,this,this.is_query_tool,this.server_type,"","","",!0)},handle_connection_lost:function(e,t){void 0!==t.responseJSON&&t.responseJSON.data&&!t.responseJSON.data.conn_id?this.init_connection(e):void 0!==t.data&&t.data.data&&!t.data.data.conn_id?this.init_connection(e):this.warn_before_continue()},warn_before_continue:function(){var e=this;s.confirm(t("Connection Warning"),'<p style="float:left"><span class="fa fa-exclamation-triangle warn-icon" aria-hidden="true"></span></p><p style="display: inline-block;"><span class="warn-header">'+t("The application has lost the database connection:")+'</span><br><span class="warn-body">'+t("⁃ If the connection was idle it may have been forcibly disconnected.")+"<br>"+t("⁃ The application server or database server may have been restarted.")+"<br>"+t("⁃ The user session may have timed out.")+'</span><br><span class="warn-footer">'+t("Do you want to continue and establish a new session?")+"</span></p>",function(){if("fn"in e.state){var t=e.state.fn,n=e.state.args;e.saveState(),-1==n.indexOf("connect")&&n.push("connect"),e[t].apply(e,n)}},function(){e.saveState()}).set({labels:{ok:t("Continue"),cancel:t("Cancel")}})},init_connection:function(e,o){var a=this;i.post(n("NODE-server.connect_id",{gid:this.url_params.sgid,sid:this.url_params.sid}),o).done(function(t){if(1==t.success)if(s.success(t.info),e)a.initTransaction();else if("fn"in a.state){var n=a.state.fn,i=a.state.args;a.saveState(),a[n].apply(a,i)}}).fail(function(e){var n=C.handleQueryToolAjaxError(d,a,e,null,[],!1);s.dlgGetServerPass(t("Connect to Server"),n)})},start:function(e,n,o,a,s,c){var u=this;if(u.is_query_tool=n,u.rows_affected=0,u.marked_line_no=0,u.has_more_rows=!1,u.fetching_rows=!1,u.close_on_save=!1,u.server_type=s,u.url_params=c,u.script_type_url=a,!u.gridView)if(u.gridView=new F({el:u.container,handler:u}),u.transId=u.gridView.transId=e,u.gridView.editor_title=r.unescape(o),u.gridView.current_file=void 0,u.gridView.render(),u.is_query_tool)a?i.ajax({url:a,type:"GET"}).done(function(e){u.gridView.query_tool_obj.refresh(),e&&""!==e&&u.gridView.query_tool_obj.setValue(e),u.init_events()}).fail(function(e){var n="";u.init_events(),n=C.handleQueryToolAjaxError(d,u,e,null,[],!1),L.report_error(l(t("Error fetching SQL for script: %s.")).sprintf(n).value())}):u.init_events();else{u.init_events(),u.gridView.query_tool_obj.setOption("readOnly",!0);var p=u.gridView.query_tool_obj.getWrapperElement();p&&(p.className+=" bg-gray-lighter opacity-5 hide-cursor-workaround"),u.disable_tool_buttons(!0),u.execute_data_query()}},init_events:function(){var e=this;d.Browser.Events.on("pgadmin-storage:finish_btn:select_file",e._select_file_handler,e),d.Browser.Events.on("pgadmin-storage:finish_btn:create_file",e._save_file_handler,e),e.is_query_tool&&e.gridView.query_tool_obj.on("change",e._on_query_change.bind(e)),e.on("pgadmin-sqleditor:button:load_file",e._load_file,e),e.on("pgadmin-sqleditor:button:save",e._save,e),e.on("pgadmin-sqleditor:button:deleterow",e._delete,e),e.on("pgadmin-sqleditor:button:show_filter",e._show_filter,e),e.on("pgadmin-sqleditor:button:include_filter",e._include_filter,e),e.on("pgadmin-sqleditor:button:exclude_filter",e._exclude_filter,e),e.on("pgadmin-sqleditor:button:remove_filter",e._remove_filter,e),e.on("pgadmin-sqleditor:button:copy_row",e._copy_row,e),e.on("pgadmin-sqleditor:button:paste_row",e._paste_row,e),e.on("pgadmin-sqleditor:button:limit",e._set_limit,e),e.on("pgadmin-sqleditor:button:cancel-query",e._cancel_query,e),e.on("pgadmin-sqleditor:button:auto_rollback",e._auto_rollback,e),e.on("pgadmin-sqleditor:button:auto_commit",e._auto_commit,e),e.on("pgadmin-sqleditor:button:explain-verbose",e._explain_verbose,e),e.on("pgadmin-sqleditor:button:explain-costs",e._explain_costs,e),e.on("pgadmin-sqleditor:button:explain-buffers",e._explain_buffers,e),e.on("pgadmin-sqleditor:button:explain-timing",e._explain_timing,e),e.on("pgadmin-sqleditor:indent_selected_code",e._indent_selected_code,e),e.on("pgadmin-sqleditor:unindent_selected_code",e._unindent_selected_code,e)},execute_data_query:function(){var e=this;r.has(e,"data_store")&&(r.size(e.data_store.added)||r.size(e.data_store.updated)||r.size(e.data_store.deleted))?s.confirm(t("Unsaved changes"),t("The data has been modified, but not saved. Are you sure you wish to discard the changes?"),function(){e._run_query()},function(){return!0}).set("labels",{ok:t("Yes"),cancel:t("No")}):e._run_query()},_run_query:function(){var e=this,o=n("sqleditor.view_data_start",{trans_id:e.transId});e.query_start_time=new Date,e.rows_affected=0,e._init_polling_flags(),e.rows_to_disable=new Array,e.temp_new_rows=new Array,e.has_more_rows=!1,e.fetching_rows=!1,e.trigger("pgadmin-sqleditor:loading-icon:show",t("Running query...")),i("#btn-flash").prop("disabled",!0),i("#btn-download").prop("disabled",!0),e.trigger("pgadmin-sqleditor:loading-icon:message",t("Waiting for the query to complete...")),arguments.length>0&&"connect"==arguments[arguments.length-1]&&(o+="?connect=1"),i.ajax({url:o,method:"GET"}).done(function(t){t.data.status?(e.can_edit=t.data.can_edit,e.can_filter=t.data.can_filter,e.info_notifier_timeout=t.data.info_notifier_timeout,e.gridView.query_tool_obj.setValue(t.data.sql),e.query=t.data.sql,e.can_filter&&t.data.filter_applied?(i("#btn-filter").removeClass("btn-secondary"),i("#btn-filter-dropdown").removeClass("btn-secondary"),i("#btn-filter").addClass("btn-primary"),i("#btn-filter-dropdown").addClass("btn-primary")):(i("#btn-filter").removeClass("btn-primary"),i("#btn-filter-dropdown").removeClass("btn-primary"),i("#btn-filter").addClass("btn-secondary"),i("#btn-filter-dropdown").addClass("btn-secondary")),i("#btn-save").prop("disabled",!0),i("#btn-file-menu-dropdown").prop("disabled",!0),i("#btn-copy-row").prop("disabled",!0),i("#btn-paste-row").prop("disabled",!0),i(".limit").val(t.data.limit),e._poll()):(e.trigger("pgadmin-sqleditor:loading-icon:hide"),e.update_msg_history(!1,t.data.result))}).fail(function(t){e.trigger("pgadmin-sqleditor:loading-icon:hide");var n=C.handleQueryToolAjaxError(d,e,t,"_run_query",[],!0);e.update_msg_history(!1,n)})},call_render_after_poll:function(e){U.callRenderAfterPoll(this,s,e)},_poll:function(){new x.ExecuteQuery(this,d.Browser.UserManagement).delayedPoll(this)},_render:function(e){var n=this;n.colinfo=e.col_info,n.primary_keys=r.isEmpty(e.primary_keys)&&e.has_oids?e.oids:e.primary_keys,n.client_primary_key=e.client_primary_key,n.cell_selected=!1,n.selected_model=null,n.changedModels=[],n.has_oids=e.has_oids,n.oids=e.oids,i(".sql-editor-explain").empty(),null!==n.primary_keys&&void 0!==n.primary_keys&&0!==r.size(n.primary_keys)||0!=n.has_oids?n.can_edit=!0:n.can_edit=!1,n.can_filter&&(i(".limit").prop("disabled",!1),i(".limit").addClass("limit-enabled"),i("#btn-filter").prop("disabled",!1),i("#btn-filter-dropdown").prop("disabled",!1)),i("#btn-delete-row").prop("disabled",!0),n.is_query_tool||n.can_edit||(i("#btn-save").prop("disabled",!0),i("#btn-file-menu-dropdown").prop("disabled",!0)),n.can_edit||(i("#btn-delete-row").prop("disabled",!0),i("#btn-copy-row").prop("disabled",!0),i("#btn-paste-row").prop("disabled",!0)),n._fetch_column_metadata.call(n,e,function(){var n=this;n.trigger("pgadmin-sqleditor:loading-icon:message",t("Loading data from the database server and rendering..."),n),n.total_time=I.calculateQueryRunTime(n.query_start_time,n.query_end_time);var o=l(t("Successfully run. Total query runtime: %s.")).sprintf(n.total_time).value(),a=l(t("%s rows affected.")).sprintf(n.rows_affected).value();n.info_notifier_timeout>=0&&s.success(o+" "+a,n.info_notifier_timeout);var d=o+"\n"+a;r.isNull(e.additional_messages)||r.isUndefined(e.additional_messages)||(d=e.additional_messages+"\n"+d),n.update_msg_history(!0,d,!1);var c=[],u=null;if("json"===e.types[0].typname){if((u=JSON.parse(e.result[0]))&&u[0]&&u[0].hasOwnProperty("Plan")&&r.isObject(u[0].Plan)){var f=[JSON.stringify(u,null,2)];c.push(f),n.gridView.data_output_panel.focus(),setTimeout(function(){n.gridView.render_grid(c,n.columns,n.can_edit,n.client_primary_key),n.gridView.explain_panel.focus(),p.DrawJSONPlan(i(".sql-editor-explain"),u)},10)}}else n.gridView.data_output_panel.focus(),setTimeout(function(){n.gridView.render_grid(e.result,n.columns,n.can_edit,n.client_primary_key,e.rows_affected)},10);n.trigger("pgadmin-sqleditor:loading-icon:hide"),i("#btn-flash").prop("disabled",!1),i("#btn-download").prop("disabled",!1)}.bind(n))},_fetch_column_metadata:function(e,t){var n=e.colinfo,i=e.primary_keys,o=[],a=this,l=new Array;r.each(e.types,function(e){l[e.oid]=[e.typname]}),r.each(n,function(e){var t=!1;r.size(i)>0&&r.each(i,function(n,i){i===e.name&&(t=!0)});var n,s="",d="",c=l[e.type_code]?l[e.type_code][0]:l[l.length-1][0]?l[l.length-1][0]:"unknown";switch(s+=t?"[PK] "+c:c,e.precision&&e.precision>=0&&65535!=e.precision&&(s+=" ("+e.precision,s+=e.scale&&65535!=e.scale?","+e.scale+")":")"),c){case"oid":n="oid";break;case"json":case"json[]":case"jsonb":case"jsonb[]":n="Json";break;case"smallint":case"smallint[]":case"integer":case"integer[]":case"bigint":case"bigint[]":case"decimal":case"decimal[]":case"numeric":case"numeric[]":case"real":case"real[]":case"double precision":case"double precision[]":n="number";break;case"boolean":n="boolean";break;case"character":case"character[]":case'"char"':case'"char"[]':case"character varying":case"character varying[]":e.internal_size&&e.internal_size>=0&&65535!=e.internal_size&&(s+=" ("+e.internal_size+")"),n="string";break;case"bytea":case"bytea[]":n="binary";break;case"geometry":n="geometry";break;case"geography":n="geography";break;default:n="string"}d=e.display_name+"<br>"+s;var u=c.lastIndexOf("[]"),p={name:e.name,display_name:e.display_name,column_type:s,column_type_internal:c,pos:e.pos,label:d,cell:n,can_edit:"oid"!=e.name&&a.can_edit,type:c,not_null:e.not_null,has_default_val:e.has_default_val,is_array:u>-1&&u+2==c.length};o.push(p)}),a.columns=o,t&&"function"==typeof t&&t()},resetQueryHistoryObject:function(e){e.total_time="-"},update_msg_history:function(e,t,n){var o=this;void 0===n&&(n=!0),o.gridView.messages_panel.focus(),n?(o.gridView.handler.slickgrid&&o.gridView.handler.slickgrid.destroy(),o.columns=void 0,o.collection=void 0,i(".sql-editor-message").text(t)):i(".sql-editor-message").append(r.escape(t)),setTimeout(function(){i(".sql-editor-message").scrollTop(i(".sql-editor-message")[0].scrollHeight)},10),"Busy"!=e&&(i("#btn-flash").prop("disabled",!1),i("#btn-download").prop("disabled",!1),o.trigger("pgadmin-sqleditor:loading-icon:hide"),o.gridView.history_collection.add({status:e,start_time:o.query_start_time,query:o.query,row_affected:o.rows_affected,total_time:o.total_time,message:t}))},is_editable:function(e){var t=this;return!(e instanceof c.Collection)&&t.get("can_edit")},rows_to_delete:function(e){var t=this,n=t.primary_keys;t.temp_new_rows=[],e.forEach(function(e,i){var o=r.pick(e,n);(Object.keys(o).length?o[0]:void 0)||t.temp_new_rows.push(i)}),t.rows_to_disable=r.clone(t.temp_new_rows)},_delete:function(){var e=this,n=[],o=r.size(e.data_store.added),a=r.size(e.data_store.updated);if(o&&r.each(e.data_store.added,function(t,i){i in e.data_store.staged_rows&&(n.push(i),delete e.data_store.staged_rows[i],delete e.data_store.added[i],delete e.data_store.added_index[i])}),0==r.size(e.data_store.staged_rows)){var l=e.slickgrid,d=l.getData();l.resetActiveCell(),d.beginUpdate();for(var c=0;c<n.length;c++)d.deleteItem(n[c]);d.endUpdate(),e.rows_to_delete.apply(e,[d.getItems()]),l.resetActiveCell(),l.setSelectedRows([]),l.invalidate(),i("#btn-delete-row").prop("disabled",!0),i("#btn-copy-row").prop("disabled",!0),r.size(e.data_store.added)||a?i("#btn-save").prop("disabled",!1):i("#btn-save").prop("disabled",!0),s.success(t("Row(s) deleted."))}else{if(a)return void s.alert(t("Operation failed"),t("There are unsaved changes in the grid. Please save them first to avoid data inconsistencies."));s.confirm(t("Delete Row(s)"),t("Are you sure you wish to delete selected row(s)?"),function(){i("#btn-delete-row").prop("disabled",!0),i("#btn-copy-row").prop("disabled",!0),e.data_store.deleted=e.data_store.staged_rows,e.data_store.staged_rows={},e._save()},function(){}).set("labels",{ok:t("Yes"),cancel:t("No")})}},_save:function(e,o,a){var c=this;if(c.is_query_tool){var u=c.gridView.current_file;if(r.isUndefined(u)||a){var p={supported_types:["*","sql"],dialog_type:"create_file",dialog_title:"Save File",btn_primary:"Save"};d.FileManager.init(),d.FileManager.show_dialog(p)}else c._save_file_handler(u)}else{i("#btn-save").prop("disabled",!0),i("#btn-file-menu-dropdown").prop("disabled",!0);var f=r.size(c.data_store.added),m=r.size(c.data_store.updated),h=r.size(c.data_store.deleted);if(f||m||h){c.trigger("pgadmin-sqleditor:loading-icon:show",t("Saving the updated data..."));var g=c.data_store;g.columns=e?e.handler.columns:c.columns,i.ajax({url:n("sqleditor.save",{trans_id:c.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(g)}).done(function(e){var n=c.slickgrid,o=n.getData(),a=o.getLength(),d=[];if(e.data.status){if(f&&(o.beginUpdate(),r.each(e.data.query_result,function(e){if(!r.isNull(e.row_added)){var t=Object.keys(e.row_added)[0];r.each(g.added_index,function(i,o){if(i==t){var a=n.getDataItem(o);r.extend(a,e.row_added[t])}})}}),o.endUpdate()),r.each(d,function(e){e.is_row_copied&&delete e.is_row_copied}),n.copied_rows&&delete n.copied_rows,h){var u=n.getSelectedRows();if(a==u.length)d=[],o.setItems(d,c.client_primary_key);else{o.beginUpdate();for(var p=0;p<u.length;p++){var m=n.getDataItem(u[p]);d.push(m),o.deleteItem(m[c.client_primary_key])}o.endUpdate()}c.rows_to_delete.apply(c,[d]),n.setSelectedRows([])}n.setSelectedRows([]),c.data_store={added:{},updated:{},deleted:{},added_index:{},updated_index:{}},c.primary_keys_data={},i(".sql-editor-message").html(""),s.success(t("Data saved successfully."))}else{i("#btn-flash").prop("disabled",!1),i("#btn-download").prop("disabled",!1),i(".sql-editor-message").text(e.data.result);var b=l(t("%s.")).sprintf(e.data.result).value();if(s.error(b,20),n.setSelectedRows([]),r.has(e.data,"_rowid")&&(!r.isUndefined(e.data._rowid)||!r.isNull(e.data._rowid))){var _=c._find_rowindex(e.data._rowid);if(_ in c.data_store.added_index){var v=c.handler.temp_new_rows.indexOf(e.data._rowid);v>-1&&c.handler.temp_new_rows.splice(v,1),c.data_store.added[c.data_store.added_index[_]].err=!0}else _ in c.data_store.updated_index&&(c.data_store.updated[c.data_store.updated_index[_]].err=!0)}n.gotoCell(_,1)}r.each(e.data.query_result,function(e){c.gridView.history_collection.add({status:e.status,start_time:c.query_start_time,query:e.sql,row_affected:e.rows_affected,total_time:c.total_time,message:e.result})}),c.trigger("pgadmin-sqleditor:loading-icon:hide"),n.invalidate(),c.close_on_save&&c.close()}).fail(function(t){var n=[e,o,a],i=C.handleQueryToolAjaxError(d,c,t,"_save",n,!0);c.update_msg_history(!1,i)})}}},_find_rowindex:function(e){var t,n=this,i=n.slickgrid,o=i.getData(),a=o.getItems(),l=0,s=-1;if(r.isObject(e))t=e;else{if(!r.isString(e))return s;e={},e[n.client_primary_key]=e,t=e}return r.find(a,function(e){var n=[];if(n.push(e),r.findWhere(n,t))return s=l,!0;l++}),s},_save_as:function(){return this._save(!0)},setTitle:function(e,t){this.preferences.new_browser_tab?window.document.title=e:r.each(window.top.pgAdmin.Browser.docker.findPanels("frm_datagrid"),function(n){n.isVisible()&&(t&&(e=r.escape(e)),n.title(e))})},_load_file:function(){var e=this;e.is_query_changed?s.confirm(t("Unsaved changes"),t("Are you sure you wish to discard the current changes?"),function(){e._open_select_file_manager()},function(){return!0}).set("labels",{ok:"Yes",cancel:"No"}):e._open_select_file_manager()},_open_select_file_manager:function(){var e={supported_types:["sql"],dialog_type:"select_file"};d.FileManager.init(),d.FileManager.show_dialog(e)},_select_file_handler:function(e){var o=this,a=e,r={file_name:decodeURI(e)};o.trigger("pgadmin-sqleditor:loading-icon:show",t("Loading the file..."));var l=i(".sql-editor-busy-fetching");l.addClass("show_progress"),i.ajax({url:n("sqleditor.load_file"),method:"POST",contentType:"application/json",data:JSON.stringify(r)}).done(function(t){o.gridView.query_tool_obj.setValue(t),o.gridView.current_file=e,o.setTitle(o.gridView.current_file.split("\\").pop().split("/").pop(),!0),o.trigger("pgadmin-sqleditor:loading-icon:hide"),l.removeClass("show_progress"),i("#btn-save").prop("disabled",!0),i("#btn-file-menu-save").css("display","none"),o.is_query_changed=!1,setTimeout(function(){o.gridView.query_tool_obj.focus()},200)}).fail(function(e){o.trigger("pgadmin-sqleditor:loading-icon:hide");var t=[a],n=C.handleQueryToolAjaxError(d,o,e,"_select_file_handler",t,!1);s.error(n),l.removeClass("show_progress")})},_save_file_handler:function(e){var o=this,a=e,r={file_name:decodeURI(e),file_content:o.gridView.query_tool_obj.getValue()};o.trigger("pgadmin-sqleditor:loading-icon:show",t("Saving the queries in the file...")),i.ajax({url:n("sqleditor.save_file"),method:"POST",contentType:"application/json",data:JSON.stringify(r)}).done(function(n){n.data.status&&(s.success(t("File saved successfully.")),o.gridView.current_file=e,o.setTitle(o.gridView.current_file.replace(/^.*[\\\/]/g,""),!0),i("#btn-save").prop("disabled",!0),i("#btn-file-menu-save").css("display","none"),o.is_query_changed=!1,setTimeout(function(){o.gridView.query_tool_obj.focus()},200)),o.trigger("pgadmin-sqleditor:loading-icon:hide"),o.close_on_save&&o.close()}).fail(function(e){o.trigger("pgadmin-sqleditor:loading-icon:hide");var t=[a],n=C.handleQueryToolAjaxError(d,o,e,"_save_file_handler",t,!1);s.error(n)})},_on_query_change:function(){var e=this;if(!e.is_query_changed){if(e.is_query_changed=!0,e.gridView.current_file){var t=e.gridView.current_file.replace(/^.*[\\\/]/g,"")+" *";e.setTitle(t,!0)}else e.preferences.new_browser_tab?t=window.document.title+" *":(r.each(window.top.pgAdmin.Browser.docker.findPanels("frm_datagrid"),function(t){t.isVisible()&&(e.gridView.panel_title=i(t._title).text())}),t=e.gridView.panel_title+" *"),e.setTitle(t);i("#btn-save").prop("disabled",!1),i("#btn-file-menu-save").css("display","block"),i("#btn-file-menu-dropdown").prop("disabled",!1)}},_init_polling_flags:function(){var e=this;e.POLL_FALLBACK_TIME=function(){var t=parseInt((Date.now()-e.query_start_time.getTime())/1e3);return t>=10&&t<30?500:t>=30&&t<60?1e3:t>=60&&t<90?2e3:t>=90?5e3:1}},_show_filter:function(){var e=this,t=!1;arguments.length>0&&"connect"==arguments[arguments.length-1]&&(t=!0),S.dialog(e,t)},_include_filter:function(){var e,o,a,l,c=this,u={};e=c.slickgrid,o=e.getActiveCell(),r.isNull(o)||r.isUndefined(o)||(a=e.getColumns()[o.cell],l=e.getDataItem(o.row,o.cell),r.isNull(l)||r.isUndefined(l)||(u[a.field]=l[a.field]||"",c.trigger("pgadmin-sqleditor:loading-icon:show",t("Applying the new filter...")),i.ajax({url:n("sqleditor.inclusive_filter",{trans_id:c.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(u)}).done(function(e){c.trigger("pgadmin-sqleditor:loading-icon:hide"),setTimeout(function(){e.data.status?M.executeQuery(c):s.alert(t("Filter By Selection Error"),e.data.result)})}).fail(function(e){c.trigger("pgadmin-sqleditor:loading-icon:hide");var n=C.handleQueryToolAjaxError(d,c,e,"_include_filter",[],!0);s.alert(t("Filter By Selection Error"),n)})))},_exclude_filter:function(){var e,o,a,l,c=this,u={};e=c.slickgrid,o=e.getActiveCell(),r.isNull(o)||r.isUndefined(o)||(a=e.getColumns()[o.cell],l=e.getDataItem(o.row,o.cell),r.isNull(l)||r.isUndefined(l)||(u[a.field]=l[a.field]||"",c.trigger("pgadmin-sqleditor:loading-icon:show",t("Applying the new filter...")),i.ajax({url:n("sqleditor.exclusive_filter",{trans_id:c.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(u)}).done(function(e){c.trigger("pgadmin-sqleditor:loading-icon:hide"),setTimeout(function(){e.data.status?M.executeQuery(c):s.alert(t("Filter Exclude Selection Error"),e.data.result)},10)}).fail(function(e){c.trigger("pgadmin-sqleditor:loading-icon:hide");var n=C.handleQueryToolAjaxError(d,c,e,"_exclude_filter",[],!0);s.alert(t("Filter Exclude Selection Error"),n)})))},_remove_filter:function(){var e=this;e.trigger("pgadmin-sqleditor:loading-icon:show",t("Removing the filter...")),i.ajax({url:n("sqleditor.remove_filter",{trans_id:e.transId}),method:"POST"}).done(function(n){e.trigger("pgadmin-sqleditor:loading-icon:hide"),setTimeout(function(){n.data.status?M.executeQuery(e):s.alert(t("Remove Filter Error"),n.data.result)})}).fail(function(n){e.trigger("pgadmin-sqleditor:loading-icon:hide");var i=C.handleQueryToolAjaxError(d,e,n,"_remove_filter",[],!0);s.alert(t("Remove Filter Error"),i)})},_copy_row:g,_paste_row:function(){var e=this,t=e.slickgrid,n=t.getData(),o=n.getItems(),a=n.getLength(),l=t.getSelectedRows().sort(function(e,t){return e-t}),s=l.map(function(e){return o[e]}),d=[];for(var c in e.columns)e.columns[c].is_array&&d.push(e.columns[c].name);if(l=0==l.length?e.last_copied_rows:l,e.last_copied_rows=l,s.length>0){i("#btn-save").prop("disabled",!1);var u=function(e){var t={};return r.each(e,function(n,i){void 0!==e[i]&&(r.isObject(e[i])&&-1==d.indexOf(i)?t[String(i)]=JSON.stringify(e[i]):t[String(i)]=e[i])}),t};n.beginUpdate(),r.each(s,function(t){var i=u(t),o=(e.gridView.client_primary_key_counter++).toString();i.is_row_copied=!0,e.temp_new_rows.push(a),i[e.client_primary_key]=o,n.addItem(i),e.data_store.added[o]={err:!1,data:i},e.data_store.added_index[a]=o,a++}),n.endUpdate(),t.updateRowCount(),t.scrollRowIntoView(n.getLength()),t.setSelectedRows([])}},_set_limit:function(){var e=this,o=parseInt(i(".limit").val());e.trigger("pgadmin-sqleditor:loading-icon:show",t("Setting the limit on the result...")),i.ajax({url:n("sqleditor.set_limit",{trans_id:e.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(o)}).done(function(n){e.trigger("pgadmin-sqleditor:loading-icon:hide"),setTimeout(function(){n.data.status?M.executeQuery(e):s.alert(t("Change limit Error"),n.data.result)},10)}).fail(function(n){e.trigger("pgadmin-sqleditor:loading-icon:hide");var i=C.handleQueryToolAjaxError(d,e,n,"_set_limit",[],!0);s.alert(t("Change limit Error"),i)})},disable_tool_buttons:function(e){i("#btn-clear-dropdown").prop("disabled",e),i("#btn-explain").prop("disabled",e),i("#btn-explain-analyze").prop("disabled",e),i("#btn-explain-options-dropdown").prop("disabled",e),i("#btn-edit-dropdown").prop("disabled",e),i("#btn-load-file").prop("disabled",e),i("#btn-save").prop("disabled",e),i("#btn-file-menu-dropdown").prop("disabled",e),i("#btn-find").prop("disabled",e),i("#btn-find-menu-dropdown").prop("disabled",e),this.is_query_tool?(i("#btn-cancel-query").prop("disabled",!e),i("#btn-query-dropdown").prop("disabled",!this.is_transaction_buttons_disabled)):i("#btn-query-dropdown").prop("disabled",e)},disable_transaction_buttons:function(e){this.is_transaction_buttons_disabled=e,this.is_query_tool&&(i("#btn-commit").prop("disabled",e),i("#btn-rollback").prop("disabled",e))},execute:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,i="";if(n.has_more_rows=!1,n.fetching_rows=!1,r.isUndefined(n.special_sql)){var o=n.gridView.query_tool_obj.getSelection();i=o.length>0?o:n.gridView.query_tool_obj.getValue()}else i=n.special_sql;new x.ExecuteQuery(this,d.Browser.UserManagement).execute(i,e,t)},_highlight_error:function(e){var t=this,n=0,i=0,o=0,a=0;t.gridView.query_tool_obj.removeLineClass(t.marked_line_no,"wrap","CodeMirror-activeline-background"),t.gridView.query_tool_obj.getSelection().length>0&&(a=t.gridView.query_tool_obj.getCursor(!0).line);var r=/LINE (\d+)/.exec(e),l=/Character: (\d+)/.exec(e);if(null!=r&&null!=l){n=t.marked_line_no=parseInt(r[1])-1+a;for(var s=parseInt(l[1])-1,d=0,c=a>0?a:0,u=c;u<n;u++)d+=t.gridView.query_tool_obj.getLine(u).length+1;i=s-d;var p=t.gridView.query_tool_obj.getLine(n);o=p.indexOf(" ",i),o<0&&(o=p.length),t.gridView.marker=t.gridView.query_tool_obj.markText({line:n,ch:i},{line:n,ch:o},{className:"sql-editor-mark"}),t.gridView.query_tool_obj.addLineClass(t.marked_line_no,"wrap","CodeMirror-activeline-background")}},_cancel_query:function(){var e=this;i.ajax({url:n("sqleditor.cancel_transaction",{trans_id:e.transId}),method:"POST",contentType:"application/json"}).done(function(n){n.data.status||s.alert(t("Cancel Query Error"),n.data.result),e.disable_tool_buttons(!1),H=!1,r.isUndefined(e.download_csv_obj)||(e.download_csv_obj.abort(),i("#btn-flash").prop("disabled",!1),i("#btn-download").prop("disabled",!1),e.trigger("pgadmin-sqleditor:loading-icon:hide")),setTimeout(function(){e.gridView.query_tool_obj.focus()},200)}).fail(function(n){e.disable_tool_buttons(!1);var i=C.handleQueryToolAjaxError(d,e,n,"_cancel_query",[],!1);s.alert(t("Cancel Query Error"),i)})},trigger_csv_download:function(e,o){var a=this,r=n("sqleditor.query_tool_download",{trans_id:a.transId}),l={query:e,filename:o};a.download_csv_obj=i.ajax({type:"POST",url:r,data:l,cache:!1,async:!0,xhrFields:{responseType:"blob"},beforeSend:function(){i("#btn-flash").prop("disabled",!0),i("#btn-download").prop("disabled",!0),a.disable_tool_buttons(!0),a.trigger("pgadmin-sqleditor:loading-icon:show",t("Downloading CSV..."))}}).done(function(e){var t=window.URL||window.webkitURL,n=t.createObjectURL(e),r=document.createElement("a");"IE"===d.Browser.get_browser().name&&window.navigator.msSaveBlob?window.navigator.msSaveBlob(e,o):(r.setAttribute("href",n),r.setAttribute("download",o),r.click()),a.download_csv_obj=void 0,i("#btn-flash").prop("disabled",!1),i("#btn-download").prop("disabled",!1),a.disable_tool_buttons(!1),a.trigger("pgadmin-sqleditor:loading-icon:hide")}).fail(function(e){var n="";n="abort"==e.statusText?t("CSV Download cancelled."):C.handleQueryToolAjaxError(d,a,e,t("Download CSV"),[],!0),s.alert(t("Download CSV error"),n)})},call_cache_preferences:function(){(window.opener?window.opener.pgAdmin.Browser:window.top.pgAdmin.Browser).cache_preferences("sqleditor"),L.preference_version(L.generate_preference_version())},_auto_rollback:function(){var e=this,o=!0;!0===i(".auto-rollback").hasClass("visibility-hidden")?i(".auto-rollback").removeClass("visibility-hidden"):(i(".auto-rollback").addClass("visibility-hidden"),o=!1),i.ajax({url:n("sqleditor.auto_rollback",{trans_id:e.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(o)}).done(function(e){e.data.status||s.alert(t("Auto Rollback Error"),e.data.result)}).fail(function(n){var i=C.handleQueryToolAjaxError(d,e,n,"_auto_rollback",[],!0);s.alert(t("Auto Rollback Error"),i)})},_auto_commit:function(){var e=this,o=!0;!0===i(".auto-commit").hasClass("visibility-hidden")?i(".auto-commit").removeClass("visibility-hidden"):(i(".auto-commit").addClass("visibility-hidden"),o=!1),i.ajax({url:n("sqleditor.auto_commit",{trans_id:e.transId}),method:"POST",contentType:"application/json",data:JSON.stringify(o)}).done(function(e){e.data.status||s.alert(t("Auto Commit Error"),e.data.result)}).fail(function(n){var i=C.handleQueryToolAjaxError(d,e,n,"_auto_commit",[],!0);s.alert(t("Auto Commit Error"),i)})},explainPreferenceUpdate:function(e,o,a){var r=this;i.ajax({url:n("sqleditor.query_tool_preferences",{trans_id:r.transId}),method:"PUT",contentType:"application/json",data:JSON.stringify(o)}).done(function(n){void 0!=n.success&&n.success?r.call_cache_preferences():s.alert(t("Explain options error"),t("Error occurred while setting %(subItem)s option in explain.",{subItem:e}))}).fail(function(e){var n=C.handleQueryToolAjaxError(d,r,e,a,[],!0);s.alert(t("Explain options error"),n)})},_explain_verbose:function(){var e=this,t=!1;!0===i(".explain-verbose").hasClass("visibility-hidden")?(i(".explain-verbose").removeClass("visibility-hidden"),t=!0):(i(".explain-verbose").addClass("visibility-hidden"),t=!1),e.explainPreferenceUpdate("verbose",{explain_verbose:t},"_explain_verbose")},_explain_costs:function(){var e=this,t=!1;!0===i(".explain-costs").hasClass("visibility-hidden")?(i(".explain-costs").removeClass("visibility-hidden"),t=!0):(i(".explain-costs").addClass("visibility-hidden"),t=!1),e.explainPreferenceUpdate("costs",{explain_costs:t},"_explain_costs")},_explain_buffers:function(){var e=this,t=!1;!0===i(".explain-buffers").hasClass("visibility-hidden")?(i(".explain-buffers").removeClass("visibility-hidden"),t=!0):(i(".explain-buffers").addClass("visibility-hidden"),t=!1),e.explainPreferenceUpdate("buffers",{explain_buffers:t},"_explain_buffers")},_explain_timing:function(){var e=this,t=!1;!0===i(".explain-timing").hasClass("visibility-hidden")?(i(".explain-timing").removeClass("visibility-hidden"),t=!0):(i(".explain-timing").addClass("visibility-hidden"),t=!1),e.explainPreferenceUpdate("timing",{explain_timing:t},"_explain_timing")},_indent_selected_code:function(){this.gridView.query_tool_obj.execCommand("indentMore")},_unindent_selected_code:function(){this.gridView.query_tool_obj.execCommand("indentLess")},isQueryRunning:function(){return H},setIsQueryRunning:function(e){H=e},close:function(){var e=this;L.Events.off("pgadmin:user:logged-in",this.initTransaction),r.each(window.top.pgAdmin.Browser.docker.findPanels("frm_datagrid"),function(t){t.isVisible()&&(window.onbeforeunload=null,t.off(R.EVENT.CLOSING),r.isUndefined(e.col_size)||delete e.col_size,window.top.pgAdmin.Browser.docker.removePanel(t))})},update_notifications:function(e){j.updateNotifications(e)}}),d.SqlEditor={create:function(e){return new V(e)},jquery:i,S:l},d.SqlEditor}.apply(t,i))&&(e.exports=o)},,function(e,t,n){"use strict";var i,o;i=[n(4),n(0),n(1),n(8),n(3),n(10),n(348),n(349),n(350)],void 0!==(o=function(e,t,n,i,o,a,r,l,s){if(o=o||window.pgAdmin||{},s=s.default,r.plugin(function(e,t,n){n.prototype.multitext=function(t,n,i,o,a){var r=e(),l="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",s=r.text(0,0,l);s.attr(a);var d=s.getBBox().width/l.length,c=Math.round(o/d)-1;r.remove();for(var u=i.split(" "),p=0,f=[],m="",h=0;h<u.length;h++){var g=function e(t,n,i){var a=i.length,r=[];return 0==a?r:(n&&n+a*d>o?(r.push(t),r=r.concat(e("",0,i))):n?r.push(t+" "+i):(t&&r.push(t),i.length>c+1?r.push(i.slice(0,c)+"-"):r.push(i),r=r.concat(e("",0,i.slice(c)))),r)}(m,p,u[h]);m&&(f=f.slice(0,f.length-1)),f=f.concat(g),m=f[f.length-1],p=m.length*d}var b=this.text(t,n,f).attr(a);return b.selectAll("tspan:nth-child(n+2)").attr({dy:"1.2em",x:t}),b}}),o.Explain)return o.Explain;var d=o.Explain={prefix:e("misc.index")+"static/explain/img/"},c={Aggregate:{image:"ex_aggregate.svg",image_text:"Aggregate"},Append:{image:"ex_append.svg",image_text:"Append"},"Bitmap Index Scan":function(e){return{image:"ex_bmp_index.svg",image_text:e["Index Name"]}},"Bitmap Heap Scan":function(e){return{image:"ex_bmp_heap.svg",image_text:e["Relation Name"]}},BitmapAnd:{image:"ex_bmp_and.svg",image_text:"Bitmap AND"},BitmapOr:{image:"ex_bmp_or.svg",image_text:"Bitmap OR"},"CTE Scan":{image:"ex_cte_scan.svg",image_text:"CTE Scan"},"Function Scan":{image:"ex_result.svg",image_text:"Function Scan"},"Foreign Scan":{image:"ex_foreign_scan.svg",image_text:"Foreign Scan"},Gather:{image:"ex_gather_motion.svg",image_text:"Gather"},Group:{image:"ex_group.svg",image_text:"Group"},GroupAggregate:{image:"ex_aggregate.svg",image_text:"Group Aggregate"},Hash:{image:"ex_hash.svg",image_text:"Hash"},"Hash Join":function(e){if(!e["Join Type"])return{image:"ex_join.svg",image_text:"Join"};switch(e["Join Type"]){case"Anti":return{image:"ex_hash_anti_join.svg",image_text:"Hash Anti Join"};case"Semi":return{image:"ex_hash_semi_join.svg",image_text:"Hash Semi Join"};default:return{image:"ex_hash.svg",image_text:String("Hash "+e["Join Type"]+" Join")}}},HashAggregate:{image:"ex_aggregate.svg",image_text:"Hash Aggregate"},"Index Only Scan":function(e){return{image:"ex_index_only_scan.svg",image_text:e["Index Name"]}},"Index Scan":function(e){return{image:"ex_index_scan.svg",image_text:e["Index Name"]}},"Index Scan Backword":{image:"ex_index_scan.svg",image_text:"Index Backward Scan"},Limit:{image:"ex_limit.svg",image_text:"Limit"},LockRows:{image:"ex_lock_rows.svg",image_text:"Lock Rows"},Materialize:{image:"ex_materialize.svg",image_text:"Materialize"},"Merge Append":{image:"ex_merge_append.svg",image_text:"Merge Append"},"Merge Join":function(e){switch(e["Join Type"]){case"Anti":return{image:"ex_merge_anti_join.svg",image_text:"Merge Anti Join"};case"Semi":return{image:"ex_merge_semi_join.svg",image_text:"Merge Semi Join"};default:return{image:"ex_merge.svg",image_text:String("Merge "+e["Join Type"]+" Join")}}},ModifyTable:function(e){switch(e.Operation){case"Insert":return{image:"ex_insert.svg",image_text:"Insert"};case"Update":return{image:"ex_update.svg",image_text:"Update"};case"Delete":return{image:"ex_delete.svg",image_text:"Delete"}}},"Nested Loop":function(e){switch(e["Join Type"]){case"Anti":return{image:"ex_nested_loop_anti_join.svg",image_text:"Nested Loop Anti Join"};case"Semi":return{image:"ex_nested_loop_semi_join.svg",image_text:"Nested Loop Semi Join"};default:return{image:"ex_nested.svg",image_text:"Nested Loop "+e["Join Type"]+" Join"}}},"Recursive Union":{image:"ex_recursive_union.svg",image_text:"Recursive Union"},Result:{image:"ex_result.svg",image_text:"Result"},"Sample Scan":{image:"ex_scan.svg",image_text:"Sample Scan"},Scan:{image:"ex_scan.svg",image_text:"Scan"},Seek:{image:"ex_seek.svg",image_text:"Seek"},SetOp:function(e){var t=e.Strategy,n=e.Command;return"Hashed"==t?i.startsWith(n,"Intersect")?"Intersect All"==n?{image:"ex_hash_setop_intersect_all.svg",image_text:"Hashed Intersect All"}:{image:"ex_hash_setop_intersect.svg",image_text:"Hashed Intersect"}:i.startsWith(n,"Except")?"Except All"==n?{image:"ex_hash_setop_except_all.svg",image_text:"Hashed Except All"}:{image:"ex_hash_setop_except.svg",image_text:"Hash Except"}:{image:"ex_hash_setop_unknown.svg",image_text:"Hashed SetOp Unknown"}:{image:"ex_setop.svg",image_text:"SetOp"}},"Seq Scan":function(e){return{image:"ex_scan.svg",image_text:e["Relation Name"]}},"Subquery Scan":{image:"ex_subplan.svg",image_text:"SubQuery Scan"},Sort:{image:"ex_sort.svg",image_text:"Sort"},"Tid Scan":{image:"ex_tid_scan.svg",image_text:"Tid Scan"},Unique:{image:"ex_unique.svg",image_text:"Unique"},"Values Scan":{image:"ex_values_scan.svg",image_text:"Values Scan"},WindowAgg:{image:"ex_window_aggregate.svg",image_text:"Window Aggregate"},"WorkTable Scan":{image:"ex_worktable_scan.svg",image_text:"WorkTable Scan"},Undefined:{image:"ex_unknown.svg",image_text:"Undefined"}},u=a.Model.extend({defaults:{Plans:[],level:[],image:void 0,image_text:void 0,xpos:void 0,ypos:void 0,width:100,height:100},parse:function(e){var t=1,o=e.level=e.level||[t],a=[],r=e["Node Type"],l=e.xpos=e.xpos-100,s=e.ypos,d=0;e.width=100,e.height=100,"SubPlan"===e["Parent Relationship"]&&(e.width+=62.5,e.height+=50,e.ypos+=25,l-=25,s+=25),i.startsWith(r,"(slice")&&(r=r.substring(0,7));var p=n.isFunction(c[r])&&c[r].apply(void 0,[e])||c[r]||{image:"ex_unknown.svg",image_text:r};return e.image=p.image,e.image_text=p.image_text,"Plans"in e&&(e.width+=200,n.each(e.Plans,function(i){var r=n.clone(o),c=new u;r.push(t),c.set(c.parse(n.extend(i,{level:r,xpos:l-200,ypos:s}))),d<c.get("width")&&(d=c.get("width"));var p=c.get("height");1!==t?e.height=e.height+p+60:p>e.height&&(e.height=p),s+=p+60,a.push(c),t++})),e.width+=d,e.Plans=a,e},toJSON:function(e){var t=a.Model.prototype.toJSON.apply(this,arguments);if(e)delete t.Plans;else{var i=[];n.each(t.Plans,function(e){i.push(e.toJSON())}),t.Plans=i}return t},drawPolyLine:function(e,t,n,i,o,a,r){var l=t+(i-t)/3,s=t+(i-t)/3*2,d=e.polygon([0,10,5,10,2.5,0,0,10]).transform("r90"),c=d.marker(0,0,10,10,0,5).attr(r);e.line(t,n,l,n).attr(a),e.line(l-1,n,s,o).attr(a),e.line(s,o,i,o).attr(a).attr({markerEnd:c})},draw:function(e,t,i,a,l,s,c){var u=e.g(),p=t+this.get("xpos"),f=i+this.get("ypos"),m="SubPlan"===this.get("Parent Relationship");m&&(u.rect(p-this.get("width")+100+25,f-this.get("height")+100+25-5,this.get("width")-25,this.get("height")+(f-25),5).attr({stroke:"#444444",strokeWidth:1.2,fill:"gray",fillOpacity:.2}),u.text(p+100-this.get("width")/2-25,f+100-this.get("height")/2-25,this.get("Subplan Name")).attr({fontSize:"15px","text-anchor":"start",fill:"red"}));var h=o.Browser.get_browser();if("IE"===h.name||"Safari"===h.name&&parseInt(h.version)<10)this.draw_image(u,d.prefix+this.get("image"),p,f,s,c);else{var g=this,b=function(t){var n=r();n.append(t),g.draw_image(u,n.toDataURL(),p,f,s,c),e.parent().attr({"xmlns:xlink":"http://www.w3.org/1999/xlink"})},_=d.prefix+this.get("image");r.load(_,b)}var v=void 0==this.get("Schema")?this.get("image_text"):this.get("Schema")+"."+this.get("image_text");if(u.multitext(p+50+5,f+100-5,v,150,{"font-size":"15px","text-anchor":"middle"}),!n.isUndefined(l)){var y=p+100,w=f+50,x=a-10,C=l+50,S=this.get("Startup Cost"),N=this.get("Total Cost"),k=2;void 0!=S&&void 0!=N&&(k=Math.round(Math.log((S+N)/2+S)),k=k<1?1:k>10?10:k);var T=[0,0,20,20],D={stroke:"#000000",strokeWidth:k+2},E={stroke:"#866486",strokeWidth:k+2},O={viewBox:T.join(" ")};this.drawPolyLine(u,y,w,x,C,m?E:D,O)}var M=this.get("Plans");n.each(M,function(n){n.draw(e,t,i,p,f,s,c)})},draw_image:function(e,i,o,a,l,s){var d=e.image(i,o+25,a+25,50,50),c=this.toJSON(),u="<title>";n.each(c,function(e,t){"image"!==t&&"Plans"!==t&&"level"!==t&&"image"!==t&&"image_text"!==t&&"xpos"!==t&&"ypos"!==t&&"width"!==t&&"height"!==t&&(u+=t+": "+e+"\n")}),u+="</title>",d.append(r.parse(u)),d.mouseover(function(){s.empty(),d.node.textContent="";var e=t("<table></table>",{class:"pgadmin-tooltip-table"}).appendTo(s);n.each(c,function(t,i){"image"!==i&&"Plans"!==i&&"level"!==i&&"image"!==i&&"image_text"!==i&&"xpos"!==i&&"ypos"!==i&&"width"!==i&&"height"!==i&&(i=n.escape(i),t=n.escape(t),e.append('\n              <tr>\n                <td class="label explain-tooltip">'+i+'</td>\n                <td class="label explain-tooltip-val">'+t+"</td>\n              </tr>\n            "))});var i=l.data("zoom-factor"),r=(o+100)*i-l.scrollLeft(),u=(a+100)*i-l.scrollTop();l.width()<r+s[0].clientWidth&&(r-=s[0].clientWidth+100*i),l.height()<u+s[0].clientHeight&&(u-=s[0].clientHeight+50*i),r=r<0?0:r,u=u<0?0:u,s.css({opacity:"0.8"}),s.css("left",r),s.css("top",u),t(".pgadmin-explain-tooltip").css("padding","5px"),t(".pgadmin-explain-tooltip").css("border","1px solid white")}),d.mouseout(function(){d.append(r.parse(u)),s.empty(),s.css({opacity:"0"}),s.css("left",0),s.css("top",0)})}}),p=a.Model.extend({defaults:{Plan:void 0,xpos:0,ypos:0},initialize:function(){this.set("Plan",new u),this.set("Statistics",new l)},parse:function(e){if(e&&"Plan"in e){var t=this.get("Plan");t.set(t.parse(n.extend(e.Plan,{xpos:0,ypos:0}))),e.xpos=0,e.ypos=0,e.width=t.get("width")+50,e.height=t.get("height")+100,delete e.Plan}var i=this.get("Statistics");return e&&"JIT"in e&&(i.set("JIT",e.JIT),delete e.JIT),e&&"Triggers"in e&&(i.set("Triggers",e.Triggers),delete e.Triggers),e},toJSON:function(){var e=a.Model.prototype.toJSON.apply(this,arguments);return e.Plan&&(e.Plan=e.Plan.toJSON()),e},draw:function(e,t,n,i,o){var a=e.g();a.rect(0,0,this.get("width")-10,this.get("height")-10,5).attr({fill:"#FFF"}),this.get("Plan").draw(a,t,n,void 0,void 0,i,o),this.get("Statistics").set_statistics(o)}});return n.extend(d,{DrawJSONPlan:function(e,i){e.empty();var a=1,l=t("<div></div>",{class:"pg-explain-zoom-area btn-group",role:"group"}).appendTo(e),d=t("<button></button>",{class:"btn btn-secondary pg-explain-zoom-btn badge",title:"Zoom in",tabindex:0}).appendTo(l).append(t("<i></i>",{class:"fa fa-search-plus"})),c=t("<button></button>",{class:"btn btn-secondary pg-explain-zoom-btn badge",title:"Zoom to original",tabindex:0}).appendTo(l).append(t("<i></i>",{class:"fa fa-arrows-alt"})),u=t("<button></button>",{class:"btn btn-secondary pg-explain-zoom-btn badge",title:"Zoom out",tabindex:0}).appendTo(l).append(t("<i></i>",{class:"fa fa-search-minus"})),f=t("<div></div>",{class:"pg-explain-download-area btn-group",role:"group"}).appendTo(e),m=t("<button></button>",{id:"btn-explain-download",class:"btn btn-secondary pg-explain-download-btn badge",title:"Download",tabindex:0,disabled:function(){var e=o.Browser.get_browser();return"IE"===e.name?(this.title="Not supported for Internet Explorer",!0):"Safari"===e.name&&parseInt(e.version)<10&&(this.title="Not supported for Safari version less than 10.1",!0)}}).appendTo(f).append(t("<i></i>",{class:"fa fa-download"})),h=t("<div></div>",{class:"pg-explain-stats-area d-none",role:"group"}).appendTo(e);t("<button></button>",{id:"btn-explain-stats",class:"btn btn-secondary pg-explain-stats-btn badge",title:"Statistics",tabindex:0}).appendTo(h).append(t("<i></i>",{class:"fa fa-line-chart"}));var g=t("<div></div>",{class:"pgadmin-explain-container"}).appendTo(e),b=t("<div></div>",{id:"toolTip",class:"pgadmin-explain-tooltip"}).appendTo(e);b.empty(),g.data("zoom-factor",a);var _=0,v=25;n.each(i,function(e){var n=new p;n.set(n.parse(e)),_=n.get("width"),v=n.get("height");var i=r(_,v),o=t(i.node).detach();g.append(o),n.draw(i,_-25,25,g,b);var l=g.width();if(l<_){a=l/_,a=a<.01?.01:a,a=a>1?1:a;var f=new r.matrix;f.scale(a,a),o.find("g").first().attr({transform:f}),o.attr({width:_*a,height:v*a}),g.data("zoom-factor",a)}d.on("click",function(){a=a+.05>2?2:a+.05;var e=new r.matrix;e.scale(a,a),o.find("g").first().attr({transform:e}),o.attr({width:_*a,height:v*a}),g.data("zoom-factor",a),d.trigger("blur")}),u.on("click",function(){a=a-.05<.01?.01:a-.05;var e=new r.matrix;e.scale(a,a),o.find("g").first().attr({transform:e}),o.attr({width:_*a,height:v*a}),g.data("zoom-factor",a),u.trigger("blur")}),c.on("click",function(){a=1;var e=new r.matrix;e.scale(a,a),o.find("g").first().attr({transform:e}),o.attr({width:_*a,height:v*a}),g.data("zoom-factor",a),c.trigger("blur")}),m.on("click",function(){var e=r(".pgadmin-explain-container svg"),t=new Date,n="explain_plan_"+t.getTime()+".svg";s.downloadSVG(e.toString(),n),m.trigger("blur")})})}}),d}.apply(t,i))&&(e.exports=o)},,function(e,t,n){"use strict";(function(t){function i(e){return e&&e.__esModule?e:{default:e}}var o=n(0),a=i(o),r=n(10),l=i(r),s=l.default.Model.extend({defaults:{JIT:[],Triggers:[]},set_statistics:function(e){var n=this.get("JIT"),i=this.get("Triggers");(Object.keys(n).length>0||Object.keys(i).length>0)&&(0,a.default)(".pg-explain-stats-area").removeClass("d-none"),(0,a.default)(".pg-explain-stats-area").on("mouseover",function(){if(e.empty(),0!=Object.keys(n).length||0!=Object.keys(i).length){var o=(0,a.default)("<table></table>",{class:"pgadmin-tooltip-table"}).appendTo(e);Object.keys(n).length>0&&(o.append('<tr><td class="label explain-tooltip">JIT:</td></tr>'),t.each(n,function(e,n){n=t.escape(n),e=t.escape(e),o.append('\n            <tr>\n              <td class="label explain-tooltip">  '+n+'</td>\n              <td class="label explain-tooltip-val">'+e+"</td>\n            </tr>\n          ")})),Object.keys(i).length>0&&(o.append('<tr><td class="label explain-tooltip">Triggers:</td></tr>'),t.each(i,function(e,n){e instanceof Object?t.each(e,function(e,n){"Trigger Name"===n?(n=t.escape(n),e=t.escape(e),o.append('\n                  <tr>\n                    <td class="label explain-tooltip">  '+n+'</td>\n                    <td class="label explain-tooltip-val">'+e+"</td>\n                  </tr>\n                ")):(n=t.escape(n),e=t.escape(e),o.append('\n                  <tr>\n                    <td class="label explain-tooltip">    '+n+'</td>\n                    <td class="label explain-tooltip-val">'+e+"</td>\n                  </tr>\n                "))}):(n=t.escape(n),e=t.escape(e),o.append('\n              <tr>\n                <td class="label explain-tooltip">  '+n+'</td>\n                <td class="label explain-tooltip-val">'+e+"</td>\n              </tr>\n            "))})),e.css({opacity:"0.8",left:"",right:"65px",top:"15px"}),(0,a.default)(".pgadmin-explain-tooltip").css("padding","5px"),(0,a.default)(".pgadmin-explain-tooltip").css("border","1px solid white")}}),(0,a.default)(".pg-explain-stats-area").on("mouseout",function(){e.empty(),e.css({opacity:"0",left:0,top:0})})}});e.exports=s}).call(t,n(1))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={blobURL:function(e,t){var n=new Blob([e],{type:t});return(window.URL||window.webkitURL).createObjectURL(n)},downloadSVG:function(e,t){e=e.replace(/NS\d+:href/gi,"xlink:href");var n=this.blobURL(e,"image/svg+xml"),i=document.createElement("a");i.href=n,i.setAttribute("download",t),document.body.appendChild(i),i.click(),document.body.removeChild(i)}};t.default=i},function(e,t,n){"use strict";var i,o;i=[n(0),n(2),n(352),n(353),n(31),n(4)],void 0!==(o=function(e,t,n,i,o,a){return function(r){function l(t){o.isEntireGridSelected(t)?e("[data-id='select-all']").addClass("selected"):e("[data-id='select-all']").removeClass("selected")}function s(e,t,n){o.isEntireGridSelected(e)?d(e):(f.notify(n,t),t.isPropagationStopped()||t.isImmediatePropagationStopped()||o.selectAll(e))}function d(e){e.getSelectionModel().setSelectedRanges([])}var c=window.Slick,u=new i(r),p=new n(r),f=new c.Event,m=new c.Event,h=p.onBeforeColumnSelectAll,g=p.onColumnSelectAll,b=function(t){this.grid=t,t.onHeaderClick.subscribe(function(n,i){i.column.selectAllOnClick&&!e(n.target).hasClass("slick-resizable-handle")&&s(t,n,i)}),t.getSelectionModel().onSelectedRangesChanged.subscribe(l.bind(null,t)),t.registerPlugin(u),t.registerPlugin(p),m.subscribe(function(e,t){o.selectAll(t.grid)})},_=function(e){return e=p.getColumnDefinitions(e),e=u.getColumnDefinitions(e),e[0].selectAllOnClick=!0,e[0].name='<span data-id="select-all" title="'+t("Select/Deselect All")+'"><br>'+e[0].name+'<img class="select-all-icon" src="'+a("static",{filename:"img/select-all-icon.png"})+'"></img>',e};e.extend(this,{init:b,getColumnDefinitions:_,onBeforeGridSelectAll:f,onGridSelectAll:m,onBeforeGridColumnSelectAll:h,onGridColumnSelectAll:g})}}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";(function(i){var o,a;o=[n(0),n(31),n(87)],void 0!==(a=function(e,t){return function(){var n=window.Slick,o=new n.EventHandler,a=new n.Event,r=new n.Event,l=function(e){o.subscribe(e.onHeaderClick,s.bind(null,e)),e.getSelectionModel().onSelectedRangesChanged.subscribe(d.bind(null,e)),r.subscribe(function(e,t){c(t.grid,t.column.id)})},s=function(t,n,i){var o=i.column;if(t.focus(),p(o)){var r=e(n.target);if(u(n)){if(e(n.target).hasClass("slick-resizable-handle"))return;r=e(n.target).parents(".slick-header-column")}r.toggleClass("selected"),r.hasClass("selected")&&a.notify(i,n),n.isPropagationStopped()||n.isImmediatePropagationStopped()||c(t,o.id)}},d=function(t,n,i){e(".slick-header-column").each(function(n,o){var a=e(o).find('[data-cell-type="column-header-row"]'),r=t.getColumnIndex(a.data("column-id"));f(t,i,r)?e(o).addClass("selected"):e(o).removeClass("selected")})},c=function(e,n){var i,o=e.getSelectionModel(),a=o.getSelectedRanges(),r=e.getColumnIndex(n),l=t.rangeForColumn(e,r);i=t.isRangeSelected(a,l)?t.removeRange(a,l):t.areAllRangesSingleColumns(a,e)?t.addRange(a,l):[l],o.setSelectedRanges(i)},u=function(t){return!e(t.target).hasClass("slick-header-column")},p=function(e){return!1!==e.selectable},f=function(e,n,i){var o=t.areAllRangesCompleteRows(e,n);return m(e,n,i)&&!o},m=function(e,n,i){var o=t.isRangeEntirelyWithinSelectedRanges(n,t.rangeForColumn(e,i)),a=t.isAnyCellOfColumnSelected(n,i);return o||a},h=function(e){return i.map(e,function(e){if(p(e)){var t="<span data-cell-type='column-header-row'        data-test='output-column-header'       data-column-id='"+e.id+"'>  <span class='column-description'>    <span class='column-name'>"+e.display_name+"</span>    <span class='column-type'>"+e.column_type+"</span>  </span></span>";return i.extend(e,{name:t})}return e})};e.extend(this,{init:l,getColumnDefinitions:h,onBeforeColumnSelectAll:a,onColumnSelectAll:r})}}.apply(t,o))&&(e.exports=a)}).call(t,n(1))},function(e,t,n){"use strict";var i,o;i=[n(0),n(31),n(87)],void 0!==(o=function(e,t){return function(){var n=window.Slick,i=new n.EventHandler,o=function(e){e.getSelectionModel().onSelectedRangesChanged.subscribe(r.bind(null,e)),i.subscribe(e.onClick,a.bind(null,e))},a=function(t,n,i){if("row-header-column"===t.getColumns()[i.cell].id){var o=e(n.target);"row-header-selector"!=o.data("cell-type")&&(o=e(n.target).find('[data-cell-type="row-header-selector"]')),o.parent().toggleClass("selected"),l(t,i.row)}},r=function(t,n,i){e('[data-cell-type="row-header-selector"]').each(function(n,o){var a=e(o),r=parseInt(a.data("row"));d(t,i,r)?a.parent().addClass("selected"):a.parent().removeClass("selected")})},l=function(e,n){var i,o=e.getSelectionModel(),a=o.getSelectedRanges(),r=t.rangeForRow(e,n);i=t.isRangeSelected(a,r)?t.removeRange(a,r):t.areAllRangesSingleRows(a,e)?t.addRange(a,r):[r],o.setSelectedRanges(i)},s=function(e,n,i){var o=t.isRangeEntirelyWithinSelectedRanges(n,t.rangeForRow(e,i)),a=t.isAnyCellOfRowSelected(n,i);return o||a},d=function(e,n,i){var o=t.areAllRangesCompleteColumns(e,n);return s(e,n,i)&&!o},c=function(e){return e.unshift({id:"row-header-column",name:"",selectable:!1,focusable:!1,formatter:function(e){return'<span data-row="'+e+'" data-cell-type="row-header-selector">'+(e+1)+"</span>"},width:30}),e};e.extend(this,{init:o,getColumnDefinitions:c})}}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(0),n(31)],void 0!==(o=function(e,t){return function(){function n(e,t){D=!0,C.setActiveCell(t.range.start.row,t.range.start.cell)}function i(t,n){if(u())return E=!1,void t.stopPropagation();if(!e(t.target).hasClass("slick-resizable-handle")){D=!0;var i=n.column.pos+1;p(0,i)?g()?C.resetActiveCell():C.setActiveCell(0,b().fromCell):f(i)||C.setActiveCell(0,i)}}function o(e){return e>=C.getDataLength()}function a(){O=!1}function r(){O=!0,E=!1}function l(){E=!0}function s(e,t){if(m(t.cell)){D=!0;var n=t.row;if(o(n))return;p(n,1)?g()?C.resetActiveCell():C.setActiveCell(b().fromRow,1):h(n)||C.setActiveCell(n,1)}}function d(e){D&&(D=!1,e.stopPropagation())}function c(e){w()&&y(e)&&x()}function u(){return O&&E}function p(e,t){return w()&&C.getActiveCell().row===e&&C.getActiveCell().cell===t}function f(e){var n=t.rangeForColumn(C,e),i=C.getSelectionModel(),o=i.getSelectedRanges();return t.isRangeSelected(o,n)}function m(e){return"row-header-column"===C.getColumns()[e].id}function h(e){var n=t.rangeForRow(C,e),i=C.getSelectionModel(),o=i.getSelectedRanges();return t.isRangeSelected(o,n)}function g(){return 1===C.getSelectionModel().getSelectedRanges().length}function b(){var e=C.getSelectionModel(),t=e.getSelectedRanges();return t[t.length-2]}function _(e){return e.which===S||e.which===k||e.which===N||e.which===T}function v(e){return e.shiftKey&&!e.ctrlKey&&!e.altKey}function y(e){return v(e)&&_(e)}function w(){return!!C.getActiveCell()}function x(){var e=C.getSelectionModel(),t=e.getSelectedRanges();t.length>1&&e.setSelectedRanges([t.pop()])}var C,S=39,N=37,k=38,T=40,D=!1,E=!1,O=!1,M=function(e){C=e,C.onDragEnd.subscribe(n),C.onHeaderClick.subscribe(i),C.onClick.subscribe(s),C.onActiveCellChanged.subscribe(d),C.onKeyDown.subscribe(c),C.onHeaderMouseEnter.subscribe(r),C.onHeaderMouseLeave.subscribe(a),C.onColumnsResized.subscribe(l)},j=function(){C.onDragEnd.unsubscribe(n),C.onHeaderClick.unsubscribe(i),C.onActiveCellChanged.unsubscribe(d),C.onKeyDown.unsubscribe(c),C.onHeaderMouseEnter.unsubscribe(r),C.onHeaderMouseLeave.unsubscribe(a),C.onColumnsResized.unsubscribe(l)};e.extend(this,{init:M,destroy:j})}}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";(function(i){var o,a;o=[n(31)],void 0!==(a=function(e){return{getUnion:function(e){function t(e,t){return e[0]-t[0]}function n(e,t){return e[0]<=t[1]+1}function o(e,t){return e[1]<=t[1]}if(i.isEmpty(e))return[];e.sort(t);var a=[e[0]];return e.forEach(function(e){var t=i.last(a);n(e,t)?o(e,t)||(t[1]=e[1]):a.push(e)}),a},mapDimensionBoundaryUnion:function(e,t){var n=[];return e.forEach(function(e){for(var i=e[0];i<=e[1];i+=1)n.push(t(i))}),n},mapOver2DArray:function(e,t,n,i){var o=this.getUnion(e),a=this.getUnion(t);return this.mapDimensionBoundaryUnion(o,function(e){var t=this.mapDimensionBoundaryUnion(a,function(t){return n(e,t)});return i(t)}.bind(this))},rangesToCsv:function(t,n,i,o){var a=i.map(function(e){return[e.fromRow,e.toRow]}),r=i.map(function(e){return[e.fromCell,e.toCell]});return e.isFirstColumnData(n)||(r=this.removeFirstColumn(r)),this.mapOver2DArray(a,r,this.csvCell.bind(this,t,n,o),function(e){var t=o.field_separator||"\t";return e.join(t)}).join("\n")},removeFirstColumn:function(e){var t=this.getUnion(e);if(0==t.length)return[];return function(){return 0==t[0][0]}()&&(!function(){return 0==t[0][1]}()?t[0][0]=1:t.shift()),t},csvCell:function(e,t,n,o,a){var r=e[o][t[a].field],l=n.quoting||"strings",s=n.quote_char||'"';return"all"==l?r&&i.isObject(r)?r=s+JSON.stringify(r)+s:r?r=s+r.toString()+s:(i.isNull(r)||i.isUndefined(r))&&(r=""):"strings"==l&&(r&&i.isObject(r)?r=s+JSON.stringify(r)+s:r&&"number"!=typeof r&&"boolean"!=typeof r?r=s+r.toString()+s:(i.isNull(r)||i.isUndefined(r))&&(r="")),r}}}.apply(t,o))&&(e.exports=a)}).call(t,n(1))},function(e,t,n){"use strict";var i,o;i=[n(265),n(31)],void 0!==(o=function(e,t){return function(n,i){var o=n.keyCode,a=n.ctrlKey||n.metaKey,r=this||window;r.slickgrid=i.grid,r.csvOptions,a&&67==o&&e.apply(r),a&&65==o&&t.selectAll(r.slickgrid)}}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(0),n(1),n(31),n(87)],void 0!==(o=function(e,t,n){return function(i){function o(t){v=e.extend(!0,{},D,i),_=t,_.onActiveCellChanged.subscribe(p),_.onKeyDown.subscribe(g),t.registerPlugin(T),T.onCellRangeSelected.subscribe(u),T.onBeforeCellRangeSelected.subscribe(c),e(window.parent).on("mouseup",b)}function a(){_.onActiveCellChanged.unsubscribe(p),_.onKeyDown.unsubscribe(g),T.onCellRangeSelected.unsubscribe(u),T.onBeforeCellRangeSelected.unsubscribe(c),_.unregisterPlugin(T),e(window.parent).off("mouseup",b)}function r(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];_.canCellBeSelected(i.fromRow,i.fromCell)&&_.canCellBeSelected(i.toRow,i.toCell)&&t.push(i)}return t}function l(e){(N&&0!==N.length||e&&0!==e.length)&&(N=r(e),k.onSelectedRangesChanged.notify(N))}function s(){return N}function d(e){N=[];for(var t=0;t<e.length;t++)N.push(n.rangeForRow(_,e[t]))}function c(e){if(_.getEditorLock().isActive())return e.stopPropagation(),!1}function u(e,t){l([t.range])}function p(e,t){v.selectActiveCell&&null!=t.row&&null!=t.cell&&l([new S.Range(t.row,t.cell)])}function f(e){return e.which==y||e.which==w||e.which==x||e.which==C}function m(e){return e.shiftKey&&!e.ctrlKey&&!e.altKey&&f(e)}function h(e){return r([e]).length}function g(e){function t(t){return e.which===t}var n,i,o=_.getActiveCell();if(o&&m(e)){n=s(),n.length||n.push(new S.Range(o.row,o.cell)),i=n.pop(),i.contains(o.row,o.cell)||(i=new S.Range(o.row,o.cell));var a=function(e,t){var n={};return n.row=e.fromRow===t.row?e.toRow:e.fromRow,n.cell=e.fromCell===t.cell?e.toCell:e.fromCell,n}(i,o);switch(function(){return e.which}()){case w:a.cell-=1;break;case y:a.cell+=1;break;case x:a.row-=1;break;case C:a.row+=1}var r=function(e,t){var n=e.cell<=t.cell?e.cell:t.cell,i=e.cell<=t.cell?t.cell:e.cell,o=e.row<=t.row?e.row:t.row,a=e.row<=t.row?t.row:e.row;return new S.Range(o,n,a,i)}(o,a);if(h(r)){var d=function(){return o.row===r.fromRow}()?r.toRow:r.fromRow,c=function(){return o.cell===r.fromCell}()?r.toCell:r.fromCell;t(y)||t(w)?_.scrollColumnIntoView(c):(t(x)||t(C))&&_.scrollRowIntoView(d),n.push(r)}else n.push(i);l(n),e.preventDefault(),e.stopPropagation()}}function b(){var e=T.getCurrentRange();t.isUndefined(e)||_.onDragEnd.notify({range:e})}var _,v,y=39,w=37,x=38,C=40,S=window.Slick,N=[],k=this,T=new S.CellRangeSelector({selectionCss:{border:"2px solid black"},offset:{top:0,left:-1,height:2,width:1}}),D={selectActiveCell:!0};e.extend(this,{getSelectedRanges:s,setSelectedRanges:l,setSelectedRows:d,init:o,destroy:a,onSelectedRangesChanged:new S.Event})}}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";var i,o;i=[n(0),n(1),n(31)],void 0!==(o=function(e,t,n){function i(t){e(t).prop("disabled",!0)}function o(t){e(t).prop("disabled",!1)}function a(e,n,i,o){return t.reduce(e,function(e,t){var a=i.getItem(t);return r(a,n)?e:(e[a[o]]=l(n,a),e)},{})}function r(e,n){return!!t.isUndefined(e)||!t.isUndefined(t.find(n,function(n){return t.isUndefined(e[n])}))}function l(e,n){var i={};return e&&e.length&&t.each(t.keys(n),function(o){t.contains(e,o)&&(i[o]=n[o])}),i}function s(e,n){var i=e.grid.getData();return a(n,t.keys(e.keys),i,e.client_primary_key)}return function(){function e(e){a.editor.handler.data_store.staged_rows=e}var a=this;if(i("#btn-delete-row"),i("#btn-copy-row"),this.selection.getSelectedRanges().length>0&&o("#btn-copy-row"),function(){return n.areAllRangesCompleteRows(a.grid,a.selection.getSelectedRanges())}()){var r=n.getIndexesOfCompleteRows(this.grid,this.selection.getSelectedRanges()),l=s(a,r);e(l),t.isEmpty(l)&&this.selection.setSelectedRows([]),function(){return a.editor.handler.can_edit}()&&o("#btn-delete-row")}else e({})}}.apply(t,i))&&(e.exports=o)},function(e,t,n){"use strict";(function(t){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(2),s=i(l),d=n(0),c=i(d),u=n(4),p=i(u),f=n(39),m=i(f),h=n(233),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(h),b=function(){function e(t){o(this,e),this.sqlEditor=t}return r(e,[{key:"setMessage",value:function(e){this.sqlEditor.trigger("pgadmin-sqleditor:loading-icon:message",(0,s.default)(e))}},{key:"show",value:function(e){this.sqlEditor.trigger("pgadmin-sqleditor:loading-icon:show",e)}},{key:"hide",value:function(){this.sqlEditor.trigger("pgadmin-sqleditor:loading-icon:hide")}}]),e}(),_=function(){function e(t,n){o(this,e),this.sqlServerObject=t,this.loadingScreen=new b(t),this.userManagement=n}return r(e,[{key:"delayedPoll",value:function(){var e=this;setTimeout(function(){e.poll()},e.sqlServerObject.POLL_FALLBACK_TIME())}},{key:"execute",value:function(t,n,i){if(!(t.length<=0)){var o=this,a=m.default.create({});o.explainPlan=n;var r=e.prepareAnalyzeSql(t,n);o.initializeExecutionOnSqlEditor(r),a.post(this.generateURLReconnectionFlag(i),JSON.stringify(r),{headers:{"Content-Type":"application/json"}}).then(function(t){var n=t.data;o.removeGridViewMarker(),e.isSqlCorrect(n)?(o.loadingScreen.setMessage("Waiting for the query to complete..."),o.updateSqlEditorStateWithInformationFromServer(n.data),o.delayedPoll()):(o.loadingScreen.hide(),o.enableSQLEditorButtons(),2==t.data.data.transaction_status||3==t.data.data.transaction_status?o.enableTransactionButtons():o.disableTransactionButtons(),o.sqlServerObject.update_msg_history(!1,n.data.result),"notifies"in n.data&&o.sqlServerObject.update_notifications(n.data.notifies),o.sqlServerObject._highlight_error(n.data.result))}).catch(function(e){o.onExecuteHTTPError(e)})}}},{key:"generateURLReconnectionFlag",value:function(e){var t=(0,p.default)("sqleditor.query_tool_start",{trans_id:this.sqlServerObject.transId});return e&&(t+="?connect=1"),t}},{key:"poll",value:function(){var t=this,n=this;m.default.create({}).get((0,p.default)("sqleditor.poll",{trans_id:n.sqlServerObject.transId})).then(function(i){2==i.data.data.transaction_status||3==i.data.data.transaction_status?n.enableTransactionButtons():n.disableTransactionButtons(),e.isQueryFinished(i)?(n.loadingScreen.setMessage("Loading data from the database server and rendering..."),n.sqlServerObject.call_render_after_poll(i.data.data),"notifies"in i.data.data&&n.sqlServerObject.update_notifications(i.data.data.notifies)):e.isQueryStillRunning(i)?(t.delayedPoll(),n.sqlServerObject.setIsQueryRunning(!0),i.data.data.result&&n.sqlServerObject.update_msg_history(i.data.data.status,i.data.data.result,!1)):e.isConnectionToServerLostWhilePolling(i)?(n.loadingScreen.hide(),n.sqlServerObject.is_query_tool&&n.enableSQLEditorButtons(),n.sqlServerObject.update_msg_history(!1,i.data.data.result,!0)):e.isQueryCancelled(i)&&(n.loadingScreen.hide(),n.sqlServerObject.update_msg_history(!1,"Execution Cancelled!",!0))}).catch(function(t){if(n.sqlServerObject.resetQueryHistoryObject(n.sqlServerObject),n.loadingScreen.hide(),n.sqlServerObject.is_query_tool&&n.enableSQLEditorButtons(),e.wasConnectionLostToPythonServer(t.response))return void n.handleConnectionToServerLost();var i=t.response.data;if(n.userManagement.isPgaLoginRequired(i))return n.userManagement.pgaLogin();var o=e.extractErrorMessage(i);n.sqlServerObject.update_msg_history(!1,o),n.sqlServerObject._highlight_error(o)})}},{key:"initializeExecutionOnSqlEditor",value:function(e){this.loadingScreen.show("Running query..."),(0,c.default)("#btn-flash").prop("disabled",!0),(0,c.default)("#btn-download").prop("disabled",!0),this.sqlServerObject.query_start_time=new Date,"object"===(void 0===e?"undefined":a(e))?this.sqlServerObject.query=e.sql:this.sqlServerObject.query=e,this.sqlServerObject.rows_affected=0,this.sqlServerObject._init_polling_flags(),this.disableSQLEditorButtons(),this.disableTransactionButtons()}},{key:"onExecuteHTTPError",value:function(t){if(this.loadingScreen.hide(),this.enableSQLEditorButtons(),e.wasConnectionLostToPythonServer(t.response))return void this.handleConnectionToServerLost();this.userManagement.isPgaLoginRequired(t.response)&&(this.sqlServerObject.saveState("execute",[this.explainPlan]),this.userManagement.pgaLogin()),g.httpResponseRequiresNewTransaction(t.response)&&(this.sqlServerObject.saveState("execute",[this.explainPlan]),this.sqlServerObject.initTransaction()),this.wasDatabaseConnectionLost(t)&&(this.sqlServerObject.saveState("execute",[this.explainPlan]),this.sqlServerObject.handle_connection_lost(!1,t));var n=t.response.data.errormsg;this.sqlServerObject.update_msg_history(!1,n)}},{key:"wasDatabaseConnectionLost",value:function(e){return 503===e.response.status&&void 0!==e.response.data.info&&"CONNECTION_LOST"===e.response.data.info}},{key:"removeGridViewMarker",value:function(){this.sqlServerObject.gridView.marker&&(this.sqlServerObject.gridView.marker.clear(),delete this.sqlServerObject.gridView.marker,this.sqlServerObject.gridView.marker=null,this.sqlServerObject.gridView.query_tool_obj.removeLineClass(this.sqlServerObject.marked_line_no,"wrap","CodeMirror-activeline-background"))}},{key:"enableSQLEditorButtons",value:function(){this.sqlServerObject.disable_tool_buttons(!1)}},{key:"disableSQLEditorButtons",value:function(){this.sqlServerObject.disable_tool_buttons(!0)}},{key:"enableTransactionButtons",value:function(){this.sqlServerObject.disable_transaction_buttons(!1)}},{key:"disableTransactionButtons",value:function(){this.sqlServerObject.special_sql=void 0,this.sqlServerObject.disable_transaction_buttons(!0)}},{key:"handleConnectionToServerLost",value:function(){this.sqlServerObject.update_msg_history(!1,(0,s.default)("Not connected to the server or the connection to the server has been closed."))}},{key:"updateSqlEditorStateWithInformationFromServer",value:function(e){this.sqlServerObject.can_edit=e.can_edit,this.sqlServerObject.can_filter=e.can_filter,this.sqlServerObject.info_notifier_timeout=e.info_notifier_timeout}}],[{key:"prepareAnalyzeSql",value:function(e,t){return{sql:e,explain_plan:t}}},{key:"wasConnectionLostToPythonServer",value:function(e){return t.isUndefined(e)||t.isUndefined(e.data)}},{key:"isSqlCorrect",value:function(e){return e.data.status}},{key:"extractErrorMessage",value:function(e){var t=e.errormsg;return void 0!==e.responseJSON&&void 0!==e.responseJSON.errormsg&&(t=e.responseJSON.errormsg),t}},{key:"isQueryFinished",value:function(e){return"Success"===e.data.data.status}},{key:"isQueryStillRunning",value:function(e){return"Busy"===e.data.data.status}},{key:"isQueryCancelled",value:function(e){return"Cancel"===e.data.data.status}},{key:"isConnectionToServerLostWhilePolling",value:function(e){return"NotConnected"===e.data.data.status}}]),e}();e.exports={ExecuteQuery:_}}).call(t,n(1))},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(2),a=i(o),r=n(4),l=i(r),s=n(0),d=i(s),c=n(11),u=i(c),p=n(3),f=i(p),m=n(6),h=i(m),g=n(39),b=i(g),_=n(266),v=i(_),y=n(361),w=i(y),x=n(233),C={geturl:function(e,t){var n=(0,l.default)("sqleditor.get_filter_data",{trans_id:e});return t&&(n+="?connect=1"),n},dialog:function(e,t){var n=(0,a.default)("Sort/Filter options");d.default.ajax({url:this.geturl(e.transId,t),headers:{"Cache-Control":"no-cache"}}).done(function(t){var i=t.data.result;u.default.filterDialog&&delete u.default.filterDialog,u.default.dialog("filterDialog",function(){var t=(0,d.default)("<div class='data_sorting_dialog'></div>");return{main:function(){this.set("title",(0,a.default)("Sort/Filter options"))},build:function(){this.elements.content.appendChild(t.get(0)),u.default.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:(0,a.default)("Help"),url:(0,l.default)("help.static",{filename:"editgrid.html"})}},{text:(0,a.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button","data-btn-name":"cancel"},{text:(0,a.default)("OK"),className:"btn btn-primary fa fa-check pg-alertify-button","data-btn-name":"ok"}],options:{title:n,padding:!1,overflow:!1,model:0,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,modal:!1,autoReset:!1}}},hooks:{onclose:function(){this.view&&(this.filterCollectionModel.stopSession(),this.view.model.stopSession(),this.view.remove({data:!0,internal:!0,silent:!0}))}},prepare:function(){var e=this;t.html(""),this.__internal.buttons[2].element.disabled=!0,this.statusBar=(0,d.default)('<div class=\'pg-prop-status-bar pg-el-xs-12 d-none\'>  <div class="error-in-footer">     <div class="d-flex px-2 py-1">       <div class="pr-2">         <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i>       </div>       <div class="alert-text"></div>     </div>   </div> </div>').appendTo(t),this.showFilterProgress=(0,d.default)('<div id="show_filter_progress" class="pg-sp-container sql-editor-busy-fetching d-none">\n                  <div class="pg-sp-content">\n                      <div class="row"><div class="col-12 pg-sp-icon sql-editor-busy-icon"></div></div>\n                      <div class="row"><div class="col-12 pg-sp-text sql-editor-busy-text">'+(0,a.default)("Loading data...")+"</div></div>\n                  </div>\n              </div>").appendTo(t),(0,d.default)(e.showFilterProgress[0]).removeClass("d-none"),e.filterCollectionModel=(0,w.default)(i);var n=h.default.generateViewSchema(null,e.filterCollectionModel,"create",null,null,!0),o=this.view=new h.default.Dialog({el:"<div></div>",model:e.filterCollectionModel,schema:n});(0,d.default)(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),t.append(o.render().$el),o.listenTo(o.model,"pgadmin-session:start",function(){o.listenTo(o.model,"pgadmin-session:invalid",function(t){e.statusBar.removeClass("d-none"),(0,d.default)(e.statusBar.find(".alert-text")).html(t),e.__internal.buttons[2].element.disabled=!0}),o.listenTo(o.model,"pgadmin-session:valid",function(){e.statusBar.addClass("d-none"),(0,d.default)(e.statusBar.find(".alert-text")).html(""),e.__internal.buttons[2].element.disabled=!1})}),o.listenTo(o.model,"pgadmin-session:stop",function(){o.stopListening(o.model,"pgadmin-session:invalid"),o.stopListening(o.model,"pgadmin-session:valid")}),o.model.startNewSession(),o.model.get("data_sorting").add(i.data_sorting),(0,d.default)(e.showFilterProgress[0]).addClass("d-none")},callback:function(t){var n=this;if("dialog_help"==t.button.element.name)return t.cancel=!0,void f.default.Browser.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null);if("ok"===t.button["data-btn-name"]){t.cancel=!0;var i=this.filterCollectionModel.toJSON();(0,d.default)(n.showFilterProgress[0]).removeClass("d-none"),b.default.put((0,l.default)("sqleditor.set_filter_data",{trans_id:e.transId}),i).then(function(t){(0,d.default)(n.showFilterProgress[0]).addClass("d-none");var i=t.data.data;i.status?setTimeout(function(){n.close(),u.default.success((0,a.default)("Filter updated successfully")),v.default.executeQuery(e)},10):u.default.alert((0,a.default)("Validation Error"),i.result)}).catch(function(t){(0,d.default)(n.showFilterProgress[0]).addClass("d-none"),e.onExecuteHTTPError(t),setTimeout(function(){u.default.error(t)},10)})}else n.close()}}}),u.default.filterDialog(n).resizeTo(f.default.Browser.stdW.md,f.default.Browser.stdH.md)}).fail(function(t){(0,x.handleQueryToolAjaxError)(f.default,e,t,"_show_filter",[],!0)})}};e.exports=C},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(2),a=i(o),r=n(1),l=i(r),s=n(3),d=i(s),c=n(13),u=i(c),p=n(6),f=i(p),m=function(e){var t={asc:(0,a.default)("ASC"),desc:(0,a.default)("DESC")},n=d.default.Browser.DataModel.extend({idAttribute:"name",defaults:{name:void 0,order:"asc"},schema:[{id:"name",name:"name",label:(0,a.default)("Column"),cell:"select2",editable:!0,cellHeaderClasses:"width_percent_60",headerCell:u.default.Extension.CustomHeaderCell,disabled:!1,control:"select2",select2:{allowClear:!1},options:function(){return l.default.map(e.column_list,function(e){return{value:e,label:e}})}},{id:"order",name:"order",label:(0,a.default)("Order"),control:"select2",cell:"select2",cellHeaderClasses:"width_percent_40",headerCell:u.default.Extension.CustomHeaderCell,editable:!0,deps:["type"],select2:{allowClear:!1},options:function(){return l.default.map(t,function(e,t){return{value:t,label:e}})}}],validate:function(){var e=null;return this.errorModel.clear(),l.default.isUndefined(this.get("name"))||l.default.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(e=(0,a.default)("Please select a column."),this.errorModel.set("name",e),e):l.default.isUndefined(this.get("order"))||l.default.isNull(this.get("order"))||""==String(this.get("order")).replace(/^\s+|\s+$/g,"")?(e=(0,a.default)("Please select the order."),this.errorModel.set("order",e),e):null}});return new(d.default.Browser.DataModel.extend({idAttribute:"sql",defaults:{sql:e.sql||null},schema:[{id:"sql",label:(0,a.default)("SQL Filter"),cell:"string",type:"text",mode:["create"],control:f.default.SqlFieldControl.extend({render:function(){var e=f.default.SqlFieldControl.prototype.render.apply(this,arguments);return setTimeout(function(){e.sqlCtrl.focus()},1e3),e}}),extraClasses:["custom_height_css_class"]},{id:"data_sorting",name:"data_sorting",label:(0,a.default)("Data Sorting"),model:n,editable:!0,type:"collection",mode:["create"],control:"unique-col-collection",uniqueCol:["name"],canAdd:!0,canEdit:!1,canDelete:!0,visible:!0,version_compatible:!0}],validate:function(){return null}}))};e.exports=m},function(e,t,n){"use strict";(function(t){function i(e){return e&&e.__esModule?e:{default:e}}function o(){var e={radius:4,weight:3},n={weight:2},i={closeButton:!1,minWidth:260,maxWidth:300,maxHeight:300},o=(0,h.default)('<div class="geometry-viewer-container"></div>'),a=f.default.map(o.get(0),{preferCanvas:!0}).setZoom(0);a.attributionControl.setPrefix("");var r=f.default.geoJSON([],{style:n,pointToLayer:function(t,n){return f.default.circleMarker(n,e)}});r.addTo(a);var s={Empty:f.default.tileLayer(""),Street:f.default.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>'}),Topography:f.default.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{maxZoom:17,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>, &copy; <a href="http://viewfinderpanoramas.org" target="_blank">SRTM</a>, &copy; <a href="https://opentopomap.org" target="_blank">OpenTopoMap</a>'}),"Gray Style":f.default.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>, &copy; <a href="http://cartodb.com/attributions" target="_blank">CartoDB</a>',subdomains:"abcd",maxZoom:19}),"Light Color":f.default.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>, &copy; <a href="http://cartodb.com/attributions" target="_blank">CartoDB</a>',subdomains:"abcd",maxZoom:19}),"Dark Matter":f.default.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>, &copy; <a href="http://cartodb.com/attributions" target="_blank">CartoDB</a>',subdomains:"abcd",maxZoom:19})},d=f.default.control.layers(s),c=s.Street,u=t.values(s),p=f.default.control({position:"topright"});p.onAdd=function(){return this._div=f.default.DomUtil.create("div","geometry-viewer-info-control"),this._div},p.update=function(e){this._div.innerHTML=e};var m=function(){a.options.crs!==f.default.CRS.EPSG3857&&(a.options.crs=f.default.CRS.EPSG3857,d.addTo(a),a.addLayer(c),o.addClass("geometry-viewer-container-plain-background"),a.setMinZoom(0))},g=function(){a.options.crs!==f.default.CRS.Simple&&(a.options.crs=f.default.CRS.Simple,d.remove(),t.each(u,function(e){a.hasLayer(e)&&(c=e,e.remove())}),o.removeClass("geometry-viewer-container-plain-background"))};return g(),m(),{mapContainer:o,clearMap:function(){a.closePopup(),p.remove(),r.clearLayers()},renderMap:function(e){var t=e.geoJSONs,n=e.selectedSRID,o=e.getPopupContent,s=e.infoList,c=!1;0===t.length&&(c=!0);try{r.addData(t)}catch(e){s.push("An error occurred while rendering data."),c=!0}var u=r.getBounds();if(u.isValid()||(c=!0),s.length>0){a.options.crs===f.default.CRS.EPSG3857?(d.remove(),p.addTo(a),d.addTo(a)):p.addTo(a);var h=l(s);p.update(h)}if(c)return g(),void a.setView([0,0],a.getZoom());if("function"==typeof o){var b=function(e){e.bindPopup(function(){return o(e.feature.geometry)},i)};r.eachLayer(b)}u=u.pad(.1);var _=Math.max(u.getNorth()-u.getSouth(),u.getEast()-u.getWest());if(4326===n)m();else if(g(),_>=180){var v=Math.floor(Math.log2(360/_))-2;a.setMinZoom(v)}else a.setMinZoom(0);_>0?a.fitBounds(u):a.setView(u.getCenter(),a.getZoom())},resizeMap:function(){setTimeout(function(){a.invalidateSize()},10)}}}function a(e,n,i){var o=n[i].field,a=[],l=[],s=[],p=[],f=new Map,m=!1,h=0,g=!1,b=!1;if(0===e.length)return p.push("Empty row."),{geoJSONs:[],selectedSRID:0,getPopupContent:void 0,infoList:p};if(t.every(e,function(e){try{var t=e[o],n=u.Buffer.from(t,"hex"),i=c.Geometry.parse(n);if(i.hasZ)a.push(i);else{if((h+=n.byteLength)>20971520)return g=!0,!1;if(l.length>=1e5)return b=!0,!1;i.srid||(i.srid=0),l.push(i),f.set(i,e)}}catch(t){s.push(e)}return!0}),(g||b)&&p.push(l.length+" of "+e.length+" geometries rendered."),a.length>0&&p.push((0,d.default)("3D geometries not rendered.")),s.length>0&&p.push((0,d.default)("Unsupported geometries not rendered.")),0===l.length)return{geoJSONs:[],selectedSRID:0,getPopupContent:void 0,infoList:p};var _=t.groupBy(l,"srid"),v=t.pairs(_);v.length>1&&(m=!0);var y=t.max(v,function(e){return e[1].length}),w=parseInt(y[0]),x=y[1],C=t.map(x,function(e){return e.toGeoJSON()}),S=void 0;return n.length>=3&&(S=function(e){var t=x[C.indexOf(e)];return r(f.get(t),n,i)}),m&&p.push((0,d.default)("Geometries with non-SRID")+w+" not rendered."),{geoJSONs:C,selectedSRID:w,getPopupContent:S,infoList:p}}function r(e,n,i){for(var o='<table class="table table-bordered table-striped view-geometry-property-table"><tbody>',a=1;a<n.length;a++)if(a!==i){var r=n[a];o+="<tr><th>"+r.display_name+"</th>";var l=e[r.field];t.isUndefined(l)&&r.has_default_val?o+='<td class="td-disabled">[default]</td>':t.isUndefined(l)&&r.not_null||t.isUndefined(l)||null===l?o+='<td class="td-disabled">[null]</td>':o+="<td>"+l+"</td>",o+="</tr>"}return o+="</tbody></table>"}function l(e){return e.join("<br>")}var s=n(2),d=i(s),c=n(363),u=n(110),p=n(371),f=i(p),m=n(0),h=i(m),g={panel_closed:!0,render_geometries:function(e,t,n,i){var r=this;if(r.map_component||(r.map_component=o()),r.panel_closed){var l=window.wcDocker,s=e.gridView.geometry_viewer=e.gridView.docker.addPanel("geometry_viewer",l.DOCK.STACKED,e.gridView.data_output_panel);(0,h.default)("#geometry_viewer_panel")[0].appendChild(r.map_component.mapContainer.get(0)),r.panel_closed=!1,s.on(l.EVENT.CLOSED,function(){(0,h.default)("#geometry_viewer_panel").empty(),r.map_component.clearMap(),r.panel_closed=!0}),s.on(l.EVENT.RESIZE_ENDED,function(){s.isVisible()&&r.map_component.resizeMap()}),s.on(l.EVENT.VISIBILITY_CHANGED,function(e){e&&r.map_component.resizeMap()})}e.gridView.geometry_viewer.focus(),r.map_component.clearMap();var d=a(t,n,i);r.map_component.renderMap(d)},add_header_button:function(e){e.header={buttons:[{cssClass:"div-view-geometry-column",tooltip:"View all geometries in this column",showOnHover:!1,command:"view-geometries",content:'<button class="btn-xs btn-primary"><i class="fa fa-eye" aria-hidden="true"></i></button>'}]}},parse_data:a};e.exports=g}).call(t,n(1))},,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HistoryCollection=void 0;var i=n(373),o=function(e){return e&&e.__esModule?e:{default:e}}(i);t.HistoryCollection=o.default},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(){function e(t){i(this,e),this.historyList=t,this.onChange(function(){})}return o(e,[{key:"length",value:function(){return this.historyList.length}},{key:"add",value:function(e){this.historyList.push(e),this.onChangeHandler(this.historyList)}},{key:"reset",value:function(){this.historyList=[],this.onResetHandler(this.historyList)}},{key:"onChange",value:function(e){this.onChangeHandler=e}},{key:"onReset",value:function(e){this.onResetHandler=e}}]),e}();t.default=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.QueryHistory=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(22),d=i(s),c=n(111),u=i(c),p=n(383),f=i(p),m=n(1),h=i(m),g=n(2),b=i(g),_=n(421),v=i(_),y=n(427),w=i(y),x=n(54),C=i(x),S={overflowY:"auto"},N={display:"flex"},k=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={history:[],selectedEntry:0},n.selectHistoryEntry=n.selectHistoryEntry.bind(n),n}return r(t,e),l(t,[{key:"componentWillMount",value:function(){var e=this;this.setHistory(this.props.historyCollection.historyList),this.selectHistoryEntry(0),this.props.historyCollection.onChange(function(t){e.setHistory(t),e.selectHistoryEntry(0)}),this.props.historyCollection.onReset(function(){e.setState({history:[],currentHistoryDetail:void 0,selectedEntry:0})})}},{key:"componentDidMount",value:function(){this.selectHistoryEntry(0)}},{key:"refocus",value:function(){var e=this;this.state.history.length>0&&setTimeout(function(){return e.retrieveSelectedQuery().parentElement.focus()},0)}},{key:"retrieveSelectedQuery",value:function(){return u.default.findDOMNode(this).getElementsByClassName("selected")[0]}},{key:"setHistory",value:function(e){this.setState({history:this.orderedHistory(e)})}},{key:"selectHistoryEntry",value:function(e){this.setState({currentHistoryDetail:this.state.history[e],selectedEntry:e})}},{key:"orderedHistory",value:function(e){return h.default.chain(e).sortBy(function(e){return e.start_time}).reverse().value()}},{key:"render",value:function(){return 0==this.state.history.length?d.default.createElement("div",{className:"alert alert-info pg-panel-message"},(0,b.default)("No history found")):d.default.createElement(f.default,{defaultSize:"50%",split:"vertical",pane1Style:S,pane2Style:N},d.default.createElement(w.default,{historyEntries:this.state.history,selectedEntry:this.state.selectedEntry,onSelectEntry:this.selectHistoryEntry}),d.default.createElement(v.default,{historyEntry:this.state.currentHistoryDetail,sqlEditorPref:this.props.sqlEditorPref}))}}]),t}(d.default.Component);t.default=k,k.propTypes={historyCollection:C.default.historyCollectionClass.isRequired,sqlEditorPref:C.default.sqlEditorPrefObj},t.QueryHistory=k},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(22),d=i(s),c=n(422),u=i(c),p=n(423),f=i(p),m=n(425),h=i(m),g=n(426),b=i(g),_=n(54),v=i(_),y=function(t){function n(){return o(this,n),a(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return r(n,t),l(n,[{key:"render",value:function(){if(e.isUndefined(this.props.historyEntry))return d.default.createElement("p",null);var t=null;return this.props.historyEntry.status||(t=d.default.createElement("div",{className:"error-message-block"},d.default.createElement(b.default,this.props))),d.default.createElement("div",{id:"query_detail",className:"query-detail"},t,d.default.createElement("div",{className:"metadata-block"},d.default.createElement(u.default,this.props)),d.default.createElement("div",{className:"query-statement-block"},d.default.createElement(f.default,this.props)),d.default.createElement("div",null,d.default.createElement("hr",{className:"block-divider"})),d.default.createElement("div",{className:"message-block"},d.default.createElement(h.default,this.props)))}}]),n}(d.default.Component);t.default=y,y.propTypes={historyEntry:v.default.historyDetail}}).call(t,n(1))},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(22),d=i(s),c=n(37),u=i(c),p=n(54),f=i(p),m=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),l(t,[{key:"formatDate",value:function(e){return(0,u.default)(e).format("M-D-YY HH:mm:ss")}},{key:"queryMetaData",value:function(e,t){return d.default.createElement("div",{className:"item"},d.default.createElement("span",{className:"value"},e),d.default.createElement("span",{className:"description"},t))}},{key:"render",value:function(){return d.default.createElement("div",{className:"metadata"},this.queryMetaData(this.formatDate(this.props.historyEntry.start_time),"Date"),this.queryMetaData(this.props.historyEntry.row_affected.toLocaleString(),"Rows Affected"),this.queryMetaData(this.props.historyEntry.total_time,"Duration"))}}]),t}(d.default.Component);t.default=m,m.propTypes={historyEntry:f.default.historyDetail}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(22),d=i(s);n(55);var c=n(424),u=i(c),p=n(54),f=i(p),m=n(232),h=i(m),g=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.copyAllHandler=n.copyAllHandler.bind(n),n.state={isCopied:!1},n.timeout=void 0,n}return r(t,e),l(t,[{key:"copyAllHandler",value:function(){var e=this;h.default.copyTextToClipboard(this.props.historyEntry.query),this.clearPreviousTimeout(),this.setState({isCopied:!0}),this.timeout=setTimeout(function(){e.setState({isCopied:!1})},1500)}},{key:"clearPreviousTimeout",value:function(){void 0!==this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0)}},{key:"copyButtonText",value:function(){return this.state.isCopied?"Copied!":"Copy All"}},{key:"copyButtonClass",value:function(){return this.state.isCopied?"was-copied":"copy-all"}},{key:"render",value:function(){return d.default.createElement("div",{id:"history-detail-query"},d.default.createElement("button",{className:this.copyButtonClass(),tabIndex:0,accessKey:"y",onClick:this.copyAllHandler},this.copyButtonText()),d.default.createElement(u.default,{value:this.props.historyEntry.query,options:{tabindex:-1,mode:"text/x-pgsql",readOnly:!0},sqlFontSize:this.props.sqlEditorPref.sql_font_size}))}}]),t}(d.default.Component);t.default=g,g.propTypes={historyEntry:f.default.historyDetail,sqlEditorPref:f.default.sqlEditorPrefObj}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(22),d=i(s),c=n(0),u=i(c),p=n(29),f=i(p),m=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={shouldHydrate:!0},n}return r(t,e),l(t,[{key:"componentDidMount",value:function(){this.editor=(0,f.default)(this.container),this.hydrateInterval=setInterval(this.hydrateWhenBecomesVisible.bind(this),100),this.hydrate(this.props)}},{key:"componentWillUnmount",value:function(){clearInterval(this.hydrateInterval)}},{key:"componentWillReceiveProps",value:function(e){this.hydrate(e)}},{key:"hydrateWhenBecomesVisible",value:function(){var e=(0,u.default)(this.container).is(":visible");e&&this.state.shouldHydrate?(this.hydrate(this.props),this.setState({shouldHydrate:!1})):e||this.setState({shouldHydrate:!0})}},{key:"hydrate",value:function(e){var t=this;Object.keys(e.options||{}).forEach(function(n){return t.editor.setOption(n,e.options[n])}),this.editor.setValue(e.value||""),e.sqlFontSize&&(0,u.default)(this.editor.getWrapperElement()).css("font-size",e.sqlFontSize),this.editor.refresh()}},{key:"render",value:function(){var e=this;return d.default.createElement("div",{ref:function(t){return e.container=t}})}}]),t}(d.default.Component);t.default=m},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(22),d=i(s),c=n(54),u=i(c),p=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),l(t,[{key:"render",value:function(){return d.default.createElement("div",{className:"message"},d.default.createElement("div",{className:"message-header"},"Messages"),d.default.createElement("div",{className:"content"},d.default.createElement("pre",{className:"content-value"},this.props.historyEntry.message)))}}]),t}(d.default.Component);t.default=p,p.propTypes={historyEntry:u.default.historyDetail}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(22),d=i(s),c=n(54),u=i(c),p=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),l(t,[{key:"parseErrorMessage",value:function(e){return e.match(/ERROR:\s*([^\n\r]*)/i)?e.match(/ERROR:\s*([^\n\r]*)/i)[1]:e}},{key:"render",value:function(){return d.default.createElement("div",{className:"history-error-text"},d.default.createElement("span",null,"Error Message")," ",this.parseErrorMessage(this.props.historyEntry.message))}}]),t}(d.default.Component);t.default=p,p.propTypes={historyEntry:u.default.historyDetail}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(22),d=i(s),c=n(111),u=i(c),p=n(1),f=i(p),m=n(37),h=i(m),g=n(44),b=i(g),_=n(428),v=i(_),y=n(429),w=i(y),x=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.navigateUpAndDown=n.navigateUpAndDown.bind(n),n}return r(t,e),l(t,[{key:"navigateUpAndDown",value:function(e){var t=[38,40],n=e.keyCode||e.which;return!(t.indexOf(n)>-1)||(e.preventDefault(),this.onKeyDownHandler(e),!1)}},{key:"onKeyDownHandler",value:function(e){if(this.isArrowDown(e)){if(!this.isLastEntry()){var t=this.props.selectedEntry+1;this.props.onSelectEntry(t),this.isInvisible(this.getEntryFromList(t))&&this.getEntryFromList(t).scrollIntoView(!1)}}else if(this.isArrowUp(e)&&!this.isFirstEntry()){var n=this.props.selectedEntry-1;this.props.onSelectEntry(n),this.isInvisible(this.getEntryFromList(n))&&this.getEntryFromList(n).scrollIntoView(!0)}}},{key:"retrieveGroups",value:function(){var e=this,t=f.default.groupBy(this.props.historyEntries,function(e){return(0,h.default)(e.start_time).format("YYYY MM DD")}),n=this.sortDesc(t).map(function(n,i){var o=e.retrieveDateGroup(t,n,i),a=(0,h.default)(n,"YYYY MM DD").toDate();return o.unshift(d.default.createElement("li",{key:"group-"+i},d.default.createElement(w.default,{date:a}))),o});return d.default.createElement("ul",null,f.default.flatten(n).map(function(e){return e}))}},{key:"retrieveDateGroup",value:function(e,t,n){var i=this,o=f.default.reduce(f.default.first(this.sortDesc(e),n),function(t,n){return t+e[n].length},0);return e[t].map(function(e,t){return d.default.createElement("li",{key:"group-"+n+"-entry-"+t,className:"list-item",tabIndex:0,onClick:function(){return i.props.onSelectEntry(o+t)},onKeyDown:i.navigateUpAndDown},d.default.createElement(v.default,{historyEntry:e,isSelected:o+t===i.props.selectedEntry}))})}},{key:"sortDesc",value:function(e){return Object.keys(e).sort().reverse()}},{key:"isInvisible",value:function(e){return this.isAbovePaneTop(e)||this.isBelowPaneBottom(e)}},{key:"isArrowUp",value:function(e){return 38===(e.keyCode||e.which)}},{key:"isArrowDown",value:function(e){return 40===(e.keyCode||e.which)}},{key:"isFirstEntry",value:function(){return 0===this.props.selectedEntry}},{key:"isLastEntry",value:function(){return this.props.selectedEntry===this.props.historyEntries.length-1}},{key:"isAbovePaneTop",value:function(e){var t=u.default.findDOMNode(this).parentElement;return e.getBoundingClientRect().top<t.getBoundingClientRect().top}},{key:"isBelowPaneBottom",value:function(e){var t=u.default.findDOMNode(this).parentElement;return e.getBoundingClientRect().bottom>t.getBoundingClientRect().bottom}},{key:"getEntryFromList",value:function(e){return u.default.findDOMNode(this).getElementsByClassName("entry")[e]}},{key:"render",value:function(){return d.default.createElement("div",{id:"query_list",className:"query-history"},this.retrieveGroups())}}]),t}(d.default.Component);t.default=x,x.propTypes={historyEntries:b.default.array.isRequired,selectedEntry:b.default.number.isRequired,onSelectEntry:b.default.func.isRequired}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(22),d=i(s),c=n(54),u=i(c),p=n(37),f=i(p),m=n(44),h=i(m),g=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),l(t,[{key:"formatDate",value:function(e){return(0,f.default)(e).format("HH:mm:ss")}},{key:"renderWithClasses",value:function(e){return d.default.createElement("div",{className:"entry "+e},d.default.createElement("div",{className:"query"},this.props.historyEntry.query),d.default.createElement("div",{className:"other-info"},d.default.createElement("div",{className:"timestamp"},this.formatDate(this.props.historyEntry.start_time))))}},{key:"render",value:function(){return this.hasError()?this.props.isSelected?this.renderWithClasses("error selected"):this.renderWithClasses("error"):this.props.isSelected?this.renderWithClasses("selected"):this.renderWithClasses("")}},{key:"hasError",value:function(){return!this.props.historyEntry.status}}]),t}(d.default.Component);t.default=g,g.propTypes={historyEntry:u.default.historyDetail,isSelected:h.default.bool}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(22),d=i(s),c=n(37),u=i(c),p=n(44),f=i(p),m=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),l(t,[{key:"getDatePrefix",value:function(){var e="";return this.isDaysBefore(0)?e="Today - ":this.isDaysBefore(1)&&(e="Yesterday - "),e}},{key:"getDateFormatted",value:function(e){return e.format(t.formatString)}},{key:"getDateMoment",value:function(){return(0,u.default)(this.props.date)}},{key:"isDaysBefore",value:function(e){return this.getDateFormatted(this.getDateMoment())===this.getDateFormatted((0,u.default)().subtract(e,"days"))}},{key:"render",value:function(){return d.default.createElement("div",{className:"date-label"},this.getDatePrefix(),this.getDateFormatted(this.getDateMoment()))}}]),t}(d.default.Component);t.default=m,m.propTypes={date:f.default.instanceOf(Date).isRequired},m.formatString="MMM DD YYYY"},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(2),a=i(o),r=n(13),l=i(r),s=n(10),d=i(s),c=n(11),u=i(c),p=d.default.Model.extend({defaults:{recorded_time:void 0,event:void 0,pid:void 0,payload:void 0},schema:[{id:"recorded_time",label:(0,a.default)("Recorded time"),cell:"string",type:"text",editable:!1,cellHeaderClasses:"width_percent_20",headerCell:l.default.Extension.CustomHeaderCell},{id:"channel",label:(0,a.default)("Event"),cell:"string",type:"text",editable:!1,cellHeaderClasses:"width_percent_20",headerCell:l.default.Extension.CustomHeaderCell},{id:"pid",label:(0,a.default)("Process ID"),cell:"string",type:"text",editable:!1,cellHeaderClasses:"width_percent_20",headerCell:l.default.Extension.CustomHeaderCell},{id:"payload",label:(0,a.default)("Payload"),cell:"string",type:"text",editable:!1,cellHeaderClasses:"width_percent_40",headerCell:l.default.Extension.CustomHeaderCell}]}),f=d.default.Collection.extend({model:p}),m={collection:null,renderNotificationsGrid:function(e){m.collection||(m.collection=new f);var t=[{name:"recorded_time",label:(0,a.default)("Recorded time"),type:"text",editable:!1,cell:"string"},{name:"channel",label:(0,a.default)("Event"),type:"text",editable:!1,cell:"string"},{name:"pid",label:(0,a.default)("Process ID"),type:"text",editable:!1,cell:"string"},{name:"payload",label:(0,a.default)("Payload"),type:"text",editable:!1,cell:"string"}],n=new l.default.Grid({emptyText:"No data found",columns:t,collection:m.collection,className:"backgrid presentation table table-bordered table-hover table-noouter-border table-bottom-border"});n&&e.$container.find(".sql-editor-notifications").append(n.render().el)},updateNotifications:function(e){if(null!=e&&e.length>0){for(var t in e){var n="";n=""!=e[t].payload?(0,a.default)('Asynchronous notification "')+e[t].channel+(0,a.default)('" with payload "')+e[t].payload+(0,a.default)('" received from server process with PID ')+e[t].pid:(0,a.default)('Asynchronous notification "')+e[t].channel+(0,a.default)('" received from server process with PID ')+e[t].pid,u.default.info(n)}m.collection.add(e)}}};e.exports=m},function(e,t,n){"use strict";function i(e){return null!=e.colinfo}function o(e){return e.is_query_tool}function a(e){return e.info_notifier_timeout>=0}function r(e,t,n){if(e.query_end_time=new Date,e.rows_affected=n.rows_affected,e.has_more_rows=n.has_more_rows,i(n))e._render(n);else{e.total_time=(0,l.calculateQueryRunTime)(e.query_start_time,e.query_end_time);var r=(0,c.sprintf)((0,d.default)("Query returned successfully in %s."),e.total_time);n.result+="\n\n"+r,e.update_msg_history(!0,n.result,!1),a(e)&&t.success(r,e.info_notifier_timeout)}o(e)&&e.disable_tool_buttons(!1),e.setIsQueryRunning(!1),e.trigger("pgadmin-sqleditor:loading-icon:hide")}Object.defineProperty(t,"__esModule",{value:!0}),t.callRenderAfterPoll=r;var l=n(278),s=n(2),d=function(e){return e&&e.__esModule?e:{default:e}}(s),c=n(36)},function(e,t,n){"use strict";function i(e){var t=e.$el,n=e.preferences;if(e.handler.slickgrid&&(e.handler.slickgrid.CSVOptions={quoting:e.preferences.results_grid_quoting,quote_char:e.preferences.results_grid_quote_char,field_separator:e.preferences.results_grid_field_separator}),t.find("#btn-load-file").attr("title",(0,o.shortcut_accesskey_title)("Open File",n.btn_open_file)).attr("accesskey",(0,o.shortcut_key)(n.btn_open_file)),t.find("#btn-save").attr("title",(0,o.shortcut_accesskey_title)("Save File",n.btn_save_file)).attr("accesskey",(0,o.shortcut_key)(n.btn_save_file)),t.find("#btn-find-menu-dropdown").attr("title",(0,o.shortcut_accesskey_title)("Find",n.btn_find_options)).attr("accesskey",(0,o.shortcut_key)(n.btn_find_options)),t.find("#btn-copy-row").attr("title",(0,o.shortcut_accesskey_title)("Copy",n.btn_copy_row)).attr("accesskey",(0,o.shortcut_key)(n.btn_copy_row)),t.find("#btn-paste-row").attr("title",(0,o.shortcut_accesskey_title)("Paste",n.btn_paste_row)).attr("accesskey",(0,o.shortcut_key)(n.btn_paste_row)),t.find("#btn-delete-row").attr("title",(0,o.shortcut_accesskey_title)("Delete",n.btn_delete_row)).attr("accesskey",(0,o.shortcut_key)(n.btn_delete_row)),t.find("#btn-filter").attr("title",(0,o.shortcut_accesskey_title)("Filter",n.btn_filter_dialog)).attr("accesskey",(0,o.shortcut_key)(n.btn_filter_dialog)),t.find("#btn-filter-dropdown").attr("title",(0,o.shortcut_accesskey_title)("Filter options",n.btn_filter_options)).attr("accesskey",(0,o.shortcut_key)(n.btn_filter_options)),t.find("#btn-rows-limit").attr("title",(0,o.shortcut_accesskey_title)("Rows limit",n.btn_rows_limit)).attr("accesskey",(0,o.shortcut_key)(n.btn_rows_limit)),t.find("#btn-query-dropdown").attr("title",(0,o.shortcut_accesskey_title)("Execute options",n.btn_execute_options)).attr("accesskey",(0,o.shortcut_key)(n.btn_execute_options)),t.find("#btn-cancel-query").attr("title",(0,o.shortcut_accesskey_title)("Cancel query",n.btn_cancel_query)).attr("accesskey",(0,o.shortcut_key)(n.btn_cancel_query)),t.find("#btn-clear-dropdown").attr("title",(0,o.shortcut_accesskey_title)("Clear",n.btn_clear_options)).attr("accesskey",(0,o.shortcut_key)(n.btn_clear_options)),t.find("#btn-conn-status").attr("accesskey",(0,o.shortcut_key)(n.btn_conn_status)).find("i").attr("title",(0,o.shortcut_accesskey_title)("Connection status (click for details)",n.btn_conn_status)),t.find("#btn-flash").attr("title",(0,o.shortcut_title)("Execute/Refresh",n.execute_query)),t.find("#btn-explain").attr("title",(0,o.shortcut_title)("Explain",n.explain_query)),t.find("#btn-explain-analyze").attr("title",(0,o.shortcut_title)("Explain Analyze",n.explain_analyze_query)),t.find("#btn-download").attr("title",(0,o.shortcut_title)("Download as CSV",n.download_csv)),t.find("#btn-commit").attr("title",(0,o.shortcut_title)("Commit",n.commit_transaction)),t.find("#btn-rollback").attr("title",(0,o.shortcut_title)("Rollback",n.rollback_transaction)),n.explain_verbose?t.find(".explain-verbose").removeClass("visibility-hidden"):t.find(".explain-verbose").addClass("visibility-hidden"),n.explain_costs?t.find(".explain-costs").removeClass("visibility-hidden"):t.find(".explain-costs").addClass("visibility-hidden"),n.explain_buffers?t.find(".explain-buffers").removeClass("visibility-hidden"):t.find(".explain-buffers").addClass("visibility-hidden"),n.explain_timing?t.find(".explain-timing").removeClass("visibility-hidden"):t.find(".explain-timing").addClass("visibility-hidden"),null!=e.connIntervalId&&(clearInterval(e.connIntervalId),e.connIntervalId=null),n.connection_status){var i=t.find("#btn-conn-status"),a=i.find("i");i.popover(),i.removeClass("connection-status-hide"),r.fetchConnectionStatus(e.handler,i,a),e.connIntervalId=setInterval(r.fetchConnectionStatus.bind(null,e.handler,i,a),1e3*n.connection_status_fetch_time)}else t.find("#btn-conn-status").addClass("connection-status-hide");var l=r.calcFontSize(n.sql_font_size);(0,s.default)(e.query_tool_obj.getWrapperElement()).css("font-size",l),e.query_tool_obj.setOption("indentWithTabs",!n.use_spaces),e.query_tool_obj.setOption("indentUnit",n.tab_size),e.query_tool_obj.setOption("tabSize",n.tab_size),e.query_tool_obj.setOption("lineWrapping",n.wrap_code),e.query_tool_obj.setOption("autoCloseBrackets",n.insert_pair_brackets),e.query_tool_obj.setOption("matchBrackets",n.brace_matching),e.query_tool_obj.refresh(),e.render_history_grid()}Object.defineProperty(t,"__esModule",{value:!0}),t.updateUIPreferences=void 0;var o=n(34),a=n(30),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a),l=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(l);t.updateUIPreferences=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(434),n(264),n(87),n(435),n(436),n(437),n(438),n(439),n(440),n(441),n(442),t.default=window.Slick},,,,,,,,,function(e,t,n){"use strict";(function(e){!function(e){function t(t){function n(n){t=e.extend(!0,{},c,t),l=n,d.subscribe(l.onHeaderCellRendered,o).subscribe(l.onBeforeHeaderCellDestroy,a),l.setColumns(l.getColumns())}function i(){d.unsubscribeAll()}function o(n,i){var o=i.column;if(o.header&&o.header.buttons)for(var a=o.header.buttons.length;a--;){var l=o.header.buttons[a],s=e("<div></div>").addClass(t.buttonCssClass).data("column",o).data("button",l);l.content&&s.append(l.content),l.showOnHover&&s.addClass("slick-header-button-hidden"),l.image&&s.css("backgroundImage","url("+l.image+")"),l.cssClass&&s.addClass(l.cssClass),l.tooltip&&s.attr("title",l.tooltip),l.command&&s.data("command",l.command),l.handler&&s.bind("click",l.handler),s.bind("click",r).prependTo(i.node)}}function a(n,i){var o=i.column;o.header&&o.header.buttons&&e(i.node).find("."+t.buttonCssClass).remove()}function r(t){var n=e(this).data("command"),i=e(this).data("column"),o=e(this).data("button");null!=n&&(s.onCommand.notify({grid:l,column:i,command:n,button:o},t,s),l.updateColumnHeader(i.id)),t.preventDefault(),t.stopPropagation()}var l,s=this,d=new window.Slick.EventHandler,c={buttonCssClass:"slick-header-button"};e.extend(this,{init:n,destroy:i,onCommand:new window.Slick.Event})}e.extend(!0,window,{Slick:{Plugins:{HeaderButtons:t}}})}(e)}).call(t,n(0))},,,,,,function(e,t,n){"use strict";(function(e){!function(e){function t(t){function n(n){m=n,t=t||200,h=e(m.getContainerNode()),h.on("dblclick.autosize",".slick-resizable-handle",r),h.keydown(o),g=document.createElement("canvas").getContext("2d")}function i(){h.off()}function o(e){e.ctrlKey&&e.shiftKey&&e.keyCode===b.A&&a()}function a(){var n=h.find(".slick-header-column"),i=m.getColumns();n.each(function(n,o){var a=e(o).data("column"),r=p(o),s=m.getColumnIndex(a.id),d=i[s],c=Math.max(r,l(a,s))+1;c=Math.min(t,c),d.width=c}),m.setColumns(i),m.onColumnsResized.notify()}function r(t){var n=e(t.currentTarget).closest(".slick-header-column"),i=n.data("column");if(i&&i.resizable){t.preventDefault(),t.stopPropagation();var o=p(n[0]),a=m.getColumnIndex(i.id),r=m.getColumns(),s=r[a],d=Math.max(o,l(i,a))+1;d!==s.width&&(s.width=d,m.setColumns(r),m.onColumnsResized.notify())}}function l(e,t){var n=[],i=c(),o=m.getData();window.Slick.Data&&o instanceof window.Slick.Data.DataView&&(o=o.getItems());for(var a=0;a<o.length;a++)n.push(o[a][e.field]);var r=d(n,e,t,o,i),l=s(i,r);return u(i),l}function s(t,n){var i=e(t.find(".slick-cell"));return i.append(n),e(i).find("*").css("position","relative"),i.outerWidth()+1}function d(t,n,i,o,a){var r=0,l=null,s=n.formatter;return e(t).each(function(t,d){var c;s&&(c=e("<span>"+s(t,i,d,n,o[t])+"</span>"),d=c.text()||d);var u=d?f(a,d):0;u>r&&(r=u,l=c||d)}),l}function c(){var t=e('<div class="slick-row"><div class="slick-cell"></div></div>');t.find(".slick-cell").css({visibility:"hidden","text-overflow":"initial","white-space":"nowrap"});var n=h.find(".grid-canvas");return e(n).append(t),t}function u(t){e(t).remove()}function p(e){var t,n=e.cloneNode(!0);return n.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",e.parentNode.insertBefore(n,e),t=n.offsetWidth,n.parentNode.removeChild(n),t}function f(e,t){return g.font=e.css("font-size")+" "+e.css("font-family"),g.measureText(t).width}var m,h,g,b={A:65};return{init:n,destroy:i}}e.extend(!0,window,{Slick:{AutoColumnSize:t}})}(e)}).call(t,n(0))}],[345]).default});